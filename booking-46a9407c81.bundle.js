"use strict";angular.module("app.booking",["ngDialog","payment","ngRedux"]).run(["$ngRedux","RAIframeReducer","ChekinModelReducer","BookingModelReducer","EquipmentReducer","InsuranceReducer","GroundTransfersReducer","CarhireReducer","CarRentalReducer","ParkingReducer","FastTrackReducer","LockFareReducer","SeatsReducer","SpecialAssistanceReducer","NameChangeReducer","BagsReducer","VoucherReducer","RefundReducer","CabinBagReducer","SamsoniteReducer","FlightExtrasReducer","PriorityBoardingReducer","ChangeFlightReducer","BreakfastReducer","FareUpgradeReducer","InflightProductsReducer","TransfersReducer",function(e,r,a,c,d,u,n,i,s,R,t,g,o,l,f,h,k,p,m,B,C,F,b,T,x,P,y){e.addReducers&&e.addReducers({raiframe:r,checkin:a,bookingModel:c,equipment:d,seats:o,insurance:u,transfers:y,groundTransfers:n,carhire:i,carRental:s,parking:R,fastTrack:t,lockFare:g,specialAssistance:l,bags:h,refund:p,voucher:k,nameChange:f,cabinBag:m,samsonite:B,priorityBoarding:F,flightExtras:C,changeFlight:b,breakfast:T,fareUpgrade:x,inflightProducts:P})}]);


"use strict";angular.module("app.booking").constant("BOOKING_STATES",{PENDING:"Pending",HOLD:"Hold",AVAILABLE:"Available",CONFIRMED:"Confirmed"}).constant("BOOKING_STATES_OPS",{CONFIRMED:"CONFIRMED"}).constant("FLIGHT_TYPES",{OUT:"flight_out",BACK:"flight_back"}).constant("DIRECT_CONNECTING_FLIGHT_SEATMAP_STEPS",{"seats.outboundMap":0,"seats.inboundMap":1,"seats.inboundSegmentMap":2}).constant("CARD_STATES",{DEFAULT:"DEFAULT",UNAVAILABLE:"UNAVAILABLE",ADDED_SOME:"ADDED_SOME",ADDED_ALL:"ADDED_ALL",PURCHASED_ALL:"PURCHASED_ALL",PURCHASED_SOME:"PURCHASED_SOME",DISCOUNTED:"DISCOUNTED",CHANGE_SEATS:"CHANGE_SEATS",CHANGED:"CHANGED",INCLUDED_SOME:"INCLUDED_SOME",INCLUDED_ALL:"INCLUDED_ALL",INCLUDED_ONE_LEG:"INCLUDED_ONE_LEG",SOLD_OUT:"SOLD_OUT"}).constant("BAG_OFFER_CODES",{BBG:"BBG",BAG:"BAG"}).constant("BAG_STATES",{PURCHASED:"PURCHASED",MODIFY:"MODIFY",UPGRADE:"UPGRADE",INCLUDED:"INCLUDED",REMOVE:"REMOVE"}).constant("CARD_CODES",{CARHIRE:"CARHIRE",HOTEL:"HOTEL",SEAT:"SEAT",INFLIGHT:"INFLIGHT",INSURANCE:"INSURANCE",BAGS:"BAGS",PRIOBRDNG:"PRIOBRDNG",FAST:"FAST",PARKING:"PARKING",TRANSFER:"TRANSFER",GRTANSFER:"GRTANSFER",BABY:"BABY",SPORTS:"SPORTS",MUSIC:"MUSIC",BREK:"BREK",CBAG:"CBAG",FAMI:"FAMI",PLUS:"PLUS",SURE:"SURE",FARE_UPGRADE:"FARE_UPGRADE",CARRENTAL:"CARRENTAL"}).constant("REQUEST_AREA",{FARE_SELECT:"FARE_SELECT",POTENTIAL:"POTENTIAL",ACTIVE:"ACTIVE",PAYMENT:"PAYMENT",HOMEPAGE:"HOMEPAGE"}).constant("FARE_OPTION_TRANSLATION_KEYS",{PLUS:"business_plus",SURE:"leisure_plus",STANDARD:"standard",GL:"go_light",SG:"go_smart"}).constant("FARE_TYPES",{BUSINESS_PLUS:"business_plus",LEISURE_PLUS:"leisure_plus",FAMILY_PLUS:"family_plus",CONNECTING_FLIGHT:"connecting_flight",ERASMUS:"erasmus",STANDARD:"standard",REGULAR:"regular"}).constant("TRIP_TYPES",{BUSINESS:"business",CITY_BREAK:"city_break",FAMILY:"family",NONE:"none",OTHER:"other",SUN_BREAK:"sun_break"}).constant("SUB_TRIP_TYPES",{ADULT_CITY_BREAK:"adult_city_break",ADULT_SUN_BREAK:"adult_sun_break",BUSINESS:"business",COUPLE_CITY_BREAK:"couple_city_break",COUPLE_SUN_BREAK:"couple_sun_break",FAMILY:"family",OTHER:"other",NONE:"none"}).constant("PRODUCT_FARE_TYPES",{REGULAR:"regular",BUSINESS:"business",FAMILY:"family",LEISURE:"leisure"}).constant("FARE_UPGRADE_CODES",{SURE:"leisure",PLUS:"business",FAMI:"family"}).constant("CHANGE_FLIGHT_THRESHOLD",150).constant("CHANGE_FLIGHT_PAST_THRESHOLD",48).constant("CHANGE_DOCUMENT_THRESHOLD",240).constant("NAME_CHANGE_THRESHOLD",2000).constant("HIDDEN_ITINERARY_SSRS",["BAFV","BAPV","PLUS","SURE","BUND","CHNG","ERAS","REGU","ATO2","HALF","ATO"]).constant("HIDDEN_ITINERARY_ADDONS",["EVENTS"]).constant("RECOMMENDED_COUNTRIES",["ie","gb"]).constant("WEEKEND",[6,0]).constant("FARES_ALL_BENEFITS",{regular:{LOWEST_FARE:{desc:"trips.flight_list_table.benefits.lowest_fare",connecting_flight_desc:"trips.flight_list_table.benefits.lowest_fare_connecting_flight"},REFUND_NOTE:{desc:"trips.basket.group.booking.journey.footnote.standard",connecting_flight_desc:"trips.basket.group.booking.journey.footnote.standard"},SMALL_CABIN_BAG:{desc:"trips.flight_list_table.benefits.small_cabin_bag",connecting_flight_desc:"trips.flight_list_table.benefits.small_cabin_bag"},PRIORITY_BOARDING:{desc:"trips.flight_list_table.benefits.priority_boarding",connecting_flight_desc:"trips.flight_list_table.benefits.priority_boarding"},SEAT:{desc:"trips.flight_list_table.benefits.seat",connecting_flight_desc:"trips.flight_list_table.benefits.seat"},BAG:{desc:"trips.flight_list_table.benefits.bag",connecting_flight_desc:"trips.flight_list_table.benefits.bag"},FAST_TRACK:{desc:"trips.flight_list_table.benefits.fast_track",connecting_flight_desc:"trips.flight_list_table.benefits.fast_track"},AIRPORT_CHECKIN_BUSINESS:{desc:"trips.flight_list_table.benefits.airport_checkin_business",connecting_flight_desc:"trips.flight_list_table.benefits.airport_checkin_business"},FLEXIBILITY:{desc:"trips.flight_list_table.benefits.flexibility",connecting_flight_desc:"trips.flight_list_table.benefits.flexibility"}},leisure:{LOWEST_FARE:{desc:"trips.flight_list_table.benefits.lowest_fare",connecting_flight_desc:"trips.flight_list_table.benefits.lowest_fare_connecting_flight"},SMALL_CABIN_BAG:{desc:"trips.flight_list_table.benefits.small_cabin_bag",connecting_flight_desc:"trips.flight_list_table.benefits.small_cabin_bag"},REFUND_NOTE:{desc:"trips.basket.group.booking.journey.footnote.leisure_plus",connecting_flight_desc:"trips.basket.group.booking.journey.footnote.leisure_plus"},PRIORITY_BOARDING:{desc:"trips.flight_list_table.benefits.priority_boarding",connecting_flight_desc:"trips.flight_list_table.benefits.priority_boarding"},SEAT:{desc:"trips.flight_list_table.benefits.seat",connecting_flight_desc:"trips.flight_list_table.benefits.seat"},BAG:{desc:"trips.flight_list_table.benefits.bag",connecting_flight_desc:"trips.flight_list_table.benefits.bag"},FAST_TRACK:{desc:"trips.flight_list_table.benefits.fast_track",connecting_flight_desc:"trips.flight_list_table.benefits.fast_track"},AIRPORT_CHECKIN_BUSINESS:{desc:"trips.flight_list_table.benefits.airport_checkin_business",connecting_flight_desc:"trips.flight_list_table.benefits.airport_checkin_business"},FLEXIBILITY:{desc:"trips.flight_list_table.benefits.flexibility",connecting_flight_desc:"trips.flight_list_table.benefits.flexibility"}},business:{LOWEST_FARE:{desc:"trips.flight_list_table.benefits.lowest_fare",connecting_flight_desc:"trips.flight_list_table.benefits.lowest_fare_connecting_flight"},REFUND_NOTE:{desc:"trips.basket.group.booking.journey.footnote.business_plus",connecting_flight_desc:"trips.basket.group.booking.journey.footnote.business_plus"},PRIORITY_BOARDING:{desc:"trips.flight_list_table.benefits.priority_boarding",connecting_flight_desc:"trips.flight_list_table.benefits.priority_boarding"},SEAT:{desc:"trips.flight_list_table.benefits.business_seat",connecting_flight_desc:"trips.flight_list_table.benefits.business_seat"},BAG:{desc:"trips.flight_list_table.benefits.bag",connecting_flight_desc:"trips.flight_list_table.benefits.bag"},FAST_TRACK:{desc:"trips.flight_list_table.benefits.fast_track",connecting_flight_desc:"trips.flight_list_table.benefits.fast_track"},AIRPORT_CHECKIN_BUSINESS:{desc:"trips.flight_list_table.benefits.airport_checkin_business",connecting_flight_desc:"trips.flight_list_table.benefits.airport_checkin_business"},FLEXIBILITY:{desc:"trips.flight_list_table.benefits.flexibility",connecting_flight_desc:"trips.flight_list_table.benefits.flexibility"}},family:{LOWEST_FARE:{desc:"trips.flight_list_table.benefits.lowest_fare",connecting_flight_desc:"trips.flight_list_table.benefits.lowest_fare_connecting_flight"},REFUND_NOTE:{desc:"trips.basket.group.booking.journey.footnote.family_plus",connecting_flight_desc:"trips.basket.group.booking.journey.footnote.family_plus"},CHECK_IN_10KG_BAG:{desc:"trips.flight_list_table.benefits.bag_10kg",connecting_flight_desc:"trips.flight_list_table.benefits.bag_10kg"},BAG:{desc:"trips.flight_list_table.benefits.family_bag",connecting_flight_desc:"trips.flight_list_table.benefits.family_bag"},SEAT:{desc:"trips.flight_list_table.benefits.family_seat",connecting_flight_desc:"trips.flight_list_table.benefits.family_seat"},FREE_SEAT_CHILDREN:{desc:"trips.flight_list_table.benefits.free_children_seat",connecting_flight_desc:"trips.flight_list_table.benefits.free_children_seat"},FAST_TRACK:{desc:"trips.flight_list_table.benefits.fast_track",connecting_flight_desc:"trips.flight_list_table.benefits.fast_track"},AIRPORT_CHECKIN_BUSINESS:{desc:"trips.flight_list_table.benefits.airport_checkin_business",connecting_flight_desc:"trips.flight_list_table.benefits.airport_checkin_business"},FLEXIBILITY:{desc:"trips.flight_list_table.benefits.flexibility",connecting_flight_desc:"trips.flight_list_table.benefits.flexibility"}}}).constant("FARES_CONFIG",{regular:{label:"trips.flight_list_table.table_heading.regular-fare",code:"standard",benefits:[{icon:"glyphs.plane",colorIcon:"plane",desc:"trips.flight_list_table.benefits.lowest_fare",connecting_flight_desc:"trips.flight_list_table.benefits.lowest_fare_connecting_flight"}],activeBenefits:["LOWEST_FARE"],activeBenefitsNewFare:["LOWEST_FARE"],withSaveInfoLabel:!1},leisure:{label:"trips.flight_list_table.table_heading.leisure-plus",code:"leisure-plus",logoIcon:"plus",type:"SURE",titleText:"trips.active.plus.upgrade.title",purchasedText:"trips.plus.upgrade.purchased",mobileTitleText:"trips.active.plus.upgrade.title",cardImage:"/resources/ui/illustrations/products/plus-card-image",titleImage:"/resources/ui/img/logos/PLUS/on-white-background/horizontal-long/PLUS",benefits:[{icon:"glyphs.baggage",colorIcon:"baggage",desc:"trips.flight_list_table.benefits.bag",connecting_flight_desc:"trips.flight_list_table.benefits.bag",data:{weight:20}},{icon:"glyphs.priority-boarding",colorIcon:"priority-boarding",desc:"trips.flight_list_table.benefits.priority_boarding",connecting_flight_desc:"trips.flight_list_table.benefits.priority_boarding"},{icon:"glyphs.seat",colorIcon:"seat",desc:"trips.flight_list_table.benefits.seat",connecting_flight_desc:"trips.flight_list_table.benefits.seat"}],activeBenefits:["LOWEST_FARE","AIRPORT_CHECKIN","BAG","PRIORITY_BOARDING","SEAT"],activeBenefitsNewFare:["LOWEST_FARE","AIRPORT_CHECKIN","BAG","SEAT","AIRPORT_CHECKIN_BUSINESS"],withSaveInfoLabel:!0,footerMessage:"trips.flight_list_table.leisure-plus_save_info"},business:{label:"trips.flight_list_table.table_heading.business-plus",code:"business-plus",logoIcon:"flexi-plus",type:"PLUS",cardImage:"/resources/ui/illustrations/products/flexi-plus-card-image",titleImage:"/resources/ui/img/logos/PLUS/on-white-background/horizontal-long/flexi-PLUS",benefits:[{icon:"glyphs.boarding-pass",colorIcon:"boarding-pass",desc:"trips.flight_list_table.benefits.flexibility",connecting_flight_desc:"trips.flight_list_table.benefits.flexibility"},{icon:"glyphs.check-in",colorIcon:"check-in",desc:"trips.flight_list_table.benefits.airport_checkin_business",connecting_flight_desc:"trips.flight_list_table.benefits.airport_checkin_business"},{icon:"glyphs.clock",colorIcon:"clock",desc:"trips.flight_list_table.benefits.fast_track",connecting_flight_desc:"trips.flight_list_table.benefits.fast_track"},{icon:"glyphs.priority-boarding",colorIcon:"priority-boarding",desc:"trips.flight_list_table.benefits.priority_boarding",connecting_flight_desc:"trips.flight_list_table.benefits.priority_boarding"},{icon:"glyphs.seat",colorIcon:"seat",desc:"trips.flight_list_table.benefits.priority_seat",connecting_flight_desc:"trips.flight_list_table.benefits.priority_seat"}],activeBenefits:["LOWEST_FARE","AIRPORT_CHECKIN","PRIORITY_BOARDING","SEAT","FLEXIBILITY","AIRPORT_CHECKIN_BUSINESS","FAST_TRACK"],activeBenefitsNewFare:["LOWEST_FARE","AIRPORT_CHECKIN","PRIORITY_BOARDING","SEAT","FLEXIBILITY","AIRPORT_CHECKIN_BUSINESS","FAST_TRACK"],withSaveInfoLabel:!0,footerMessage:"trips.flight_list_table.business-plus_save_info"},family:{label:"trips.flight_list_table.table_heading.family-plus",code:"family-plus",logoIcon:"family-plus",type:"FAMI",titleText:"trips.flight_selector_fare_upgrade.sub_title_family",purchasedText:"trips.family.upgrade.purchased",mobileTitleText:"trips.active.plus.upgrade.title",cardImage:"/resources/ui/illustrations/products/family-plus-card-image",titleImage:"/resources/ui/img/logos/PLUS/on-white-background/horizontal-long/family-PLUS",benefits:[{code:"CHECK_IN_10KG_BAG",icon:"glyphs.baggage",colorIcon:"10kg-check-in-bag",desc:"trips.flight_list_table.benefits.bag_10kg",connecting_flight_desc:"trips.flight_list_table.benefits.bag_10kg"},{code:"BAGS",icon:"glyphs.baggage",colorIcon:"baggage",desc:"trips.flight_list_table.benefits.family_bag",connecting_flight_desc:"trips.flight_list_table.benefits.family_bag"},{code:"SEAT",dynamic:!0,icon:"glyphs.seat",colorIcon:"seat",desc:"trips.flight_list_table.benefits.family_seat",connecting_flight_desc:"trips.flight_list_table.benefits.family_seat"},{code:"FREE_SEAT_CHILDREN",icon:"glyphs.seat",colorIcon:"seat",desc:"trips.flight_list_table.benefits.free_children_seat",connecting_flight_desc:"trips.flight_list_table.benefits.free_children_seat"}],activeBenefits:["LOWEST_FARE","BAG","CHECK_IN_10KG_BAG","SEAT","FREE_SEAT_CHILDREN"],activeBenefitsNewFare:["LOWEST_FARE","BAG","CHECK_IN_10KG_BAG","SEAT","FREE_SEAT_CHILDREN"]}}).constant("MAX_FAMILY_PAX_COUNT",6).constant("RECOMMENDED_PAX_COUNT",6).constant("SEAT_PROMPT_IMG",{count:10}).constant("FREE_BUNDLED_SSRS",["BBG","UXBBG","UXCBG","FAST","PS","PF","BREK","BAG","SEAT"]).constant("SEAT_GROUP_TYPES",{STANDARD:"STANDARD",ONSALE:"ONSALE",EXTRALEG:"EXTRALEG",PRIORITY:"PRIORITY"}).constant("BOARDING_PASSES_PRODUCTS",[{code:"FAST",link:"booking.active.fast-track",icon:"glyphs.clock"},{code:"GRTANSFER",link:"booking.active.transfers",icon:"glyphs.transport"}]).constant("BAGS_OPTIONS",{CARRY_ON:"carry-on",CABIN_BAG:"cabin-bag",PRIORITY_BOARDING:"priority-boarding"}).constant("CARRIER_CODES",["FR","OE","RR"]).constant("PB_BUTTON_TYPES",{ADD:"add",REMOVE:"remove",ADD_ALL:"addAll",REMOVE_ALL:"removeAll"});


"use strict";angular.module("app.booking").service("BagsActions",["$http","RezApiConfig","BAGS_ACTION_TYPES","BagsUtils","BasketMessageQueue","Flatnmap","FlatmapMaps","BOOKING_MODEL_ACTION_TYPES","BookingRead","TOTAL_HEADER_ACTION_TYPES","CARD_CODES","AEMConfig","$injector","CABINBAG_ACTION_TYPES","FEATURE_CONFIG",function(e,t,a,n,o,r,s,u,i,d,c,p,g,y,l){var A=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1;return{model:{sold:!1,type:t?"BAGUPGRADES":c.BAGS,code:e.code,isPartOfBundle:!1,qty:1,vat:0,amt:e.amount||e.total,total:e.total},key:{passengers:e.passengerNum,journeys:e.journeyNum,segments:0},local:e.local,identity:"ssrs"}},_=function(e,t,n){return{type:a.ADD_DISCOUNT_TO_SMALLER,payload:{price:e,journeyNum:t,passengerNum:n}}},B=function(e,t,a,o,r){return n.hasApplicableDiscount("BAG",a,t,o,r)&&"BBG"===e&&1===n.getAddedBagsQty("BBG",a,t,r)},m=function(e){var t=R.pipe(i.getCabinBagItems(!1),R.pluck("key"))(e),a=R.pipe(i.getBagItemsByCode("BBG"),R.pluck("key"))(e);return R.difference(t,a)},E=function(e){var t=R.concat(i.getSsrsByType(c.BAGS,e),i.getSsrsByType("BAGUPGRADES",e)),n=R.clone(t),o=R.groupWith(function(e,t){return e.key.passengers===t.key.passengers&&e.key.journeys===t.key.journeys},n),r=o.map(function(e){var t=R.groupWith(function(e,t){return e.key.segments===t.key.segments},e);return t.reduce(function(e,a,n){for(var o=0;o<t[0].length;o+=1){var r=t[n][o];e[o]?e[o].model.total+=r.model.total:e[o]=r}return e},[])});return{type:a.SYNC_LOCAL_BAGS,payload:{ssrs:R.flatten(r)}}},S={syncBags:function(){return function(e,t){var a=t(),n=a.bookingModel;e(E(n))}},getMetadata:function(){return function(n,o){var r=o(),s=r.bookingModel;n({type:a.FETCH_OFFERS_START}),n(E(s));var u={showUpgrade:!0};return e.get(t.bag,{params:u}).then(function(e){n({type:a.FETCH_OFFERS_SUCCESS,payload:{offers:e.data}})})["catch"](function(e){n({type:a.FETCH_OFFERS_ERROR,payload:e})})}},removeDiscountFromSmaller:function(e,t,n){return{type:a.REMOVE_DISCOUNT_FROM_SMALLER,payload:{price:e,journeyNum:t,passengerNum:n}}},addBagFromCheckInBags:function(e,t,n,o){return function(r){var s=A({code:e,passengerNum:t,journeyNum:n,total:o});r({type:a.ADD_BAG,payload:{bagModel:s}})}},addBag:function(e,t,o){return function(r,s){var u=s(),i=u.bookingModel,d=u.bags,c=n.getPriceForBag({code:e,passenger:t,journey:o,bookingModel:i,bagsStore:d});if(n.hasApplicableDiscount("BAG",o,t,i,d)&&"BBG"===e&&!n.getAddedBagsQty("BBG",o,t,d)){c=n.getSpanishDiscountPrice(e,o,s().bags);var p=n.getPriceForBag({code:"BAG",passenger:t,journey:o,bookingModel:i,bagsStore:s().bags});r(S.removeDiscountFromSmaller(p,o.key.id,t.model.num))}var g=A({code:e,passengerNum:t.model.num,journeyNum:o.key.id,total:c});r({type:a.ADD_BAG,payload:{bagModel:g}})}},quickAdd:function(){return function(u,p){u({type:a.QUICK_ADD_START});var y=i.filterUnavailableJourneys(p().bookingModel).map(function(e){return{journeyNum:e.key.id,paxNum:0,code:"BBG",qty:1}});e.post(t.bag,y).then(function(e){var t=p(),i=t.bags,y=n.getTotalUnsoldData(i);u({type:d.SHOW_EXTRAS_INFO,payload:{count:y.unsoldQty,text:"trips.header.title.extras_bags_plural"}}),o.enqueue({code:"BAGS_EXTRAS",qty:y.unsoldQty,total:y.totalBalance});var l=R.pluck("paxNum",e.data);u({type:a.QUICK_ADD_SUCCESS,payload:{ssrs:R.pathOr([],["ssrs"],r.normalize(s.postBags,e.data)),paxesToUpdate:l},meta:{analytics:{event:"rynProductTrack",action:"QUICK_ADD",type:c.BAGS,identity:"ssrs"}}});var A=g.get("PromotionActions");u(A.productAddedNotification({productAdded:c.BAGS}))})["catch"](function(e){u({type:a.QUICK_ADD_ERROR,payload:e})})}},removeUpgrade:function(e,t,n){return function(o,r){var s=r();o({type:a.REMOVE_BAG_UPGRADE,payload:{code:e,segments:i.getSegmentsFor(n.key.id,s.bookingModel),passengerNum:t.model.num,journeyNum:n.key.id},meta:{analytics:{event:"rynProductTrack",action:"REMOVE",type:"BAGUPGRADES",identity:"ssrs"}}})}},removeBag:function(e,t,o){return function(r,s){var u=s(),d=u.bookingModel,c=u.bags;if(B(e,t,o,d,c)){var p=n.getSpanishDiscountPrice("BAG",o,c);r(_(p,o.key.id,t.model.num))}r({type:a.REMOVE_BAG,payload:{code:e,segments:i.getSegmentsFor(o.key.id,d),passengerNum:t.model.num,journeyNum:o.key.id}})}},removeAllByCode:function(o){return function(d,p){d({type:a.REMOVE_ALL_BAG_BY_CODE_START});var A=p(),_=A.bags,B=n.getPayload(_,[o]);return e.post(t.bag,B).then(function(e){var t=R.pathOr({},["bookingModel"],p()),n=R.pluck("paxNum",e.data);if(d({type:a.REMOVE_ALL_BAG_BY_CODE_SUCCESS,payload:{ssrs:R.pathOr([],["ssrs"],r.normalize(s.postBags,e.data)),paxesToUpdate:n},meta:{analytics:{event:"rynProductTrack",action:"REMOVE",type:c.BAGS,identity:"ssrs"}}}),l["at-products-cabin-bag"]&&"BBG"===o){var A=m(t),_=i.isBooked(t);A.length&&!_&&d({type:y.REMOVE_CABIN_BAGS_FOR_SELECTED_PAX,payload:A});var B=g.get("CabinBagActions");d(B.update(!1)).then(function(){return d(B.updateCabinBagsForJourneys(!1))}).then(function(){return d(B.submitBasket(!0))})}i.getBagAndBagUpgradeItems(!1)(t).length&&d({type:u.RESET_SARA_VALIDATION})})["catch"](function(e){d({type:a.REMOVE_ALL_BAG_BY_CODE_ERROR,payload:e})})["finally"](function(){d(S.syncBags())})}},resetBags:function(){return{type:a.RESET_BAGS}},postBags:function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=o.isCheckInFlow,d=void 0===u?!1:u,p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1;return function(o,u){o({type:a.UPDATE_TO_BOOKING_MODEL_START});var A=u(),_=A.bags,B=A.bookingModel,m=A.flightExtras,E=n.getPayload(_),S=n.getRemovedBagsAndUpgrades(_,B),f=n.getPayload({ssrs:S},R.map(R.path(["model","code"]))(S));return e.post(t.bag+"?IsCheckInFlow="+d,R.concat(E,f)).then(function(e){var t=R.pluck("paxNum",e.data),u=n.setDiscountInPayload(m,e.data);if(o({type:a.UPDATE_TO_BOOKING_MODEL_SUCCESS,payload:{ssrs:R.pathOr([],["ssrs"],r.normalize(s.postBags,u)),paxesToUpdate:t},meta:{analytics:{event:"rynProductTrack",action:"UPDATE",type:c.BAGS,identity:"ssrs"}}}),l["at-products-cabin-bag"]&&f.length){var d=R.pipe(i.getCabinBagItems(!1),R.pluck("key"),R.filter(function(e){return f.some(function(t){return t.paxNum===e.passengers&&t.journeyNum===e.journeys})}))(B);d.length&&!p&&o({type:y.REMOVE_CABIN_BAGS_FOR_SELECTED_PAX,payload:d})}var A=g.get("PromotionActions");o(A.productAddedNotification({productAdded:c.BAGS}))})["catch"](function(e){o({type:a.UPDATE_TO_BOOKING_MODEL_ERROR,payload:e})})}},addUpgrade:function(e,t,o,r){return function(s,u){var i=u().bags,d=n.getPriceForUpgrade({bagCode:e,upgradeCode:t,journey:r,bagsStore:i}),c=A({code:t,passengerNum:o.model.num,journeyNum:r.key.id,total:d},!0);s({type:a.ADD_BAG_UPGRADE,payload:{upgradeModel:c},meta:{analytics:{event:"rynProductTrack",action:"ADD",type:"BAGUPGRADES",identity:"ssrs"}}})}},getBagsInsuranceConfig:function(){return function(t){t({type:a.FETCH_BAGS_INSURANCE_CONFIG_START});var n=p.getBagsInsuranceConfig();return e.get(n).then(function(e){t({type:a.FETCH_BAGS_INSURANCsE_CONFIG_SUCCESS,payload:e.data})})["catch"](function(e){t({type:a.FETCH_BAGS_INSURANCE_CONFIG_ERROR,payload:e})})}}};return S}]);


"use strict";angular.module("app.booking").service("BookingModelActions",["Flatnmap","FlatmapMaps","FlightSearchUtil","RezApiConfig","AirlineService","$log","$state","$stateParams","Currency","Session","$q","$http","DialogManager","FLIGHT_SEARCH_ACTION_TYPES","BOOKING_MODEL_ACTION_TYPES",function(e,t,n,o,r,a,i,u,l,s,p,c,d,g,E){var f=R.evolve({groundTransfer:R.map(R.when(R.pathEq(["model","status"],"CONFIRMED"),function(e){return babelHelpers["extends"]({},e,{model:babelHelpers["extends"]({},e.model,{sold:!0,total:R.pipe(R.pathOr(0,["model","totalPrice"]),Number)(e)})})}))}),y=function(e){var t=function(t){return R.pathOr(null,["info",t],e)},o=function(t,o){return{flightKey:t.flightKey,fareKey:t.fareKey,freeMoveRange:t.freeMoveRange,promoDiscount:t.farePromoDiscount,fareOption:n.getFareOption(e,o)}},r=R.pipe(t,R.reject(R.pipe(R.keys,R.isEmpty)),R.addIndex(R.map)(o))("flights");return babelHelpers["extends"]({PromoCode:t("promoCode"),DISC:t("discount"),OperatedBy:t("operatedBy"),OutboundDate:R.pathOr(null,["flightDate"],t("outbound")),InboundDate:t("isReturn")?R.pathOr(null,["flightDate"],t("inbound")):null,flights:r},R.filter(function(e){return null!==e},e.passengers))},S=function(e){i.go("booking.active",{confirmation:!1,payment:null,tripId:e})};return{reset:function(){return{type:E.RESET}},createBooking:function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(u,s){u({type:E.CREATE_BOOKING_MODEL_START});var p=s(),d=p.flightSearch,g=p.bookingModel.zoneDiscount,f=babelHelpers["extends"]({},R.filter(function(e){return null!==e},d.passengers),{DISC:R.pathOr("",["0","model","pct"],g),flights:R.pathOr([],["info","flights"],d).map(function(e,t){return{flightKey:e.flightKey,fareKey:e.fareKey,promoDiscount:e.farePromoDiscount,FareOption:n.getFareOption(d,t)}}),promoCode:R.path(["info","promoCode"],d)}),y=r.getAirlineApiConfig(d.info.operatedBy).postFlight;return c({method:"POST",url:y,data:f}).then(function(n){var r=n.data;""!==o&&i.go(o,a),l.set("vmCurrency",r.info.curr),u({type:E.CREATE_BOOKING_MODEL_SUCCESS,payload:e.normalize(t.bookingModel,r),meta:{analytics:{event:"rynBookingCreate"}}})})["catch"](function(e){u({type:E.CREATE_BOOKING_MODEL_FAILED,payload:e.data})})}},postSelectedFlight:function(){return function(n,o){n({type:E.POST_SELECTED_FLIGHT_START});var a=o(),i=a.flightSearch,u=r.getAirlineApiConfig(i.info.operatedBy).postPrice,l=y(i);return c.post(u,l).then(function(o){n({type:E.POST_SELECTED_FLIGHT_SUCCESS,payload:e.normalize(t.bookingModel,o.data),meta:{analytics:{event:"rynFlightSelect"}}}),n({type:g.SAVE_FLIGHT_SEARCH_PAYLOAD,payload:l})})["catch"](function(e){n({type:E.POST_SELECTED_FLIGHT_ERROR,payload:e.data})})}},refresh:function(n,r){var u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!1;return function(d,g){var y=function(e){a.warn(E.PAGE_REFRESH_ERROR,": ",e),d({type:E.PAGE_REFRESH_ERROR,payload:e.data}),i.go(n)},S=function(n){var o=n.data,r=e.normalize(t.bookingModel,o),a=R.when(R.propSatisfies(function(e){return!R.isNil(e)&&!R.isEmpty(e)},"groundTransfer"),f)(r);l.set("vmCurrency",o.info.curr),d({type:E.PAGE_REFRESH_SUCCESS,payload:a,meta:{analytics:{event:"rynBookingCreate"}}})};return u||R.isEmpty(R.pathOr([],["bookingModel","journeys"],g()))?(d({type:E.PAGE_REFRESH_START}),s.getSessionStorage("ryanair:token")?c({method:"GET",url:r?o.revertBooking:o.retrieveBooking}).then(S)["catch"](y):p.when(y({data:"SESSION TOKEN NOT PRESENT"}))):(d({type:E.PAGE_REFRESH_AVOIDED}),p.resolve())}},retrieveBooking:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!0;return function(a){a({type:E.GET_BOOKING_MODEL_START});var i=function(e){return a({type:E.GET_BOOKING_MODEL_FAILED,payload:e.data}),p.reject(e)},u=function(n){var o=R.path(["data","tripId"],n),i=R.path(["data","sessionToken"],n);l.set("vmCurrency",n.data.info.curr),s.set("bookingRetrieved",!0);var u=n.headers("jwt");s.setSessionStorage("ryanair:jwt",u),s.setSessionStorage("ryanair:token",i),d.closeAllDialogs(),r&&S(o);var p=e.normalize(t.bookingModel,n.data),c=f(p);a({type:E.GET_BOOKING_MODEL_SUCCESS,payload:c,meta:{analytics:{event:"rynBookingCreate"}}})},g=void 0;return g=n.BookingId?c({method:"POST",url:o.reservationByBookingId,cache:!1,data:{bookingId:""+n.BookingId,surrogateId:n.SurrogateId}}).then(u)["catch"](i):c({method:"POST",url:o.reservationByNumber,cache:!1,data:n}).then(u)["catch"](i)}},retrieveUnbalancedBooking:function(n){return function(r){r({type:E.GET_UNBALANCED_BOOKING_MODEL_START});var a=function(e){r({type:E.GET_UNBALANCED_BOOKING_MODEL_FAILED,payload:e})},u=function(n){var o=n.data;l.set("vmCurrency",o.info.curr),s.set("bookingRetrieved",!0),/^booking\.active$/.test(i.current.name)?i.reload():i.go("unbalanced-account.payment",{os:i.params.os,path:i.params.path,origin:i.params.origin,returnTo:i.params.returnTo}),r({type:E.GET_UNBALANCED_BOOKING_MODEL_SUCCESS,payload:e.normalize(t.bookingModel,o)})};return c({method:"POST",url:o.unbalancedBooking,data:n}).then(u)["catch"](a)}},resetSaraValidation:function(){return{type:E.RESET_SARA_VALIDATION}}}}]);


"use strict";angular.module("app.booking").service("BreakfastActions",["BREAKFAST_ACTION_TYPES","$http","RezApiConfig","BookingRead","Flatnmap","FlatmapMaps","BreakfastUtil","CARD_CODES","$injector",function(e,t,n,a,r,o,u,i,s){var p=function(e,t,n,r,o){var u=a.getCities(t),i=a.getAllSoldBreakfast(n,t);return r.map(function(t){var a=n.map(function(e){return e.key.id}),r=o.some(function(e){return R.contains(e.key.passengers,a)&&t.key.id===e.key.journeys}),s=n.length>1?"modify":"remove",p="add",f=r?s:p;return{offer:e[t.key.id][0],passengers:n.map(function(e){return{num:e.key.id,name:e.model.name,hasSoldBreakfast:i.some(function(n){return n.key.passengers===e.key.id&&n.key.journeys===t.key.id})}}),journeyNum:t.key.id,airport:u[t.key.id],ctaState:f,isAvailable:!!e[t.key.id][0]}})},f=function(e){return{model:{sold:!1,type:i.BREK,code:i.BREK,qty:1,vat:0,amt:e.total,total:e.total},key:{passengers:e.paxNum,journeys:e.journeyNum,segments:0},identity:"breakfast"}},y=function(){return function(a){a({type:e.REMOVE_ALL_FROM_BOOKING_MODEL_START}),t["delete"](n.breakfast).then(function(t){return t&&a({type:e.REMOVE_ALL_FROM_BOOKING_MODEL_SUCCESS,meta:{analytics:{event:"rynProductTrack",action:"DELETE",type:i.BREK,identity:"ssrs"}}}),t})["catch"](function(t){a({type:e.REMOVE_ALL_FROM_BOOKING_MODEL_ERROR,payload:t.data})})}},c=function(r,o){var u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!1;return function(i,s){i({type:e.GET_OFFERS_START});var y=s(),c=y.bookingModel,d=y.breakfast,m=r||c.passengers,l=o||c.journeys;t.get(n.breakfast).then(function(t){var n=u?R.pathOr([],["items"],d):a.getAllUnpaidBreakfast(m,c),r=p(t.data,c,m,l,n),o=n.map(function(e){return f({paxNum:e.key.passengers,journeyNum:e.key.journeys,total:R.pipe(R.find(function(t){return t.journeyNum===e.key.journeys}),R.pathOr(0,["offer","price"]))(r)})});i({type:e.GET_OFFERS_SUCCESS,payload:{prices:r,items:o}})})["catch"](function(t){i({type:e.GET_OFFERS_ERROR,payload:t.data})})}},d=function(t,n){return function(a,r){var o=r(),u=o.breakfast,i=u.prices.find(function(e){return e.journeyNum===n}),s=f({paxNum:t,journeyNum:n,total:i.offer.price});a({type:e.ADD_SELECTED,payload:{item:s,state:"remove"}})}},m=function(t,n){return function(a){a({type:e.REMOVE_SELECTED,payload:{paxNum:t,journeyNum:n,state:"add"}})}},l=function(t){return function(n,a){var r=[],o=1===t.length,u=R.pipe(R.pathOr([],["breakfast","prices"]),R.filter(R.prop("isAvailable")))(a()),i=u.filter(function(e){return"modify"!==e.ctaState&&"remove"!==e.ctaState});r=o?i.map(function(e){return f({paxNum:e.passengers[0].num,journeyNum:e.journeyNum,total:e.offer.price})}):R.pipe(R.map(function(e){return e.passengers.reduce(function(t,n){return n.hasSoldBreakfast?t:R.append(f({paxNum:n.num,journeyNum:e.journeyNum,total:e.offer.price,local:!0}),t)},[])}),R.flatten)(u),n({type:e.ADD_FOR_ALL_PAX_AND_ALL_JOURNEYS,payload:{items:r,journeysNum:i.map(function(e){return e.journeyNum}),state:o?"remove":"modify"}})}},_=function(){return function(t){t({type:e.REMOVE_FOR_ALL_PAX_AND_ALL_JOURNEYS,payload:{state:"add"}})}},E=function(t){var n=R.pipe(R.filter(function(e){return e.isSelected}),R.map(function(e){return e.num}))(t.passengers);return function(a,r){var o=R.path(["breakfast","prices"],r()),u=n.map(function(e){return f({paxNum:e,journeyNum:t.journeyNum,total:R.pipe(R.find(function(e){return e.journeyNum===t.journeyNum}),R.path(["offer","price"]))(o),local:!0})});a({type:e.UPDATE_LOCAL,payload:{items:u,journeyNum:t.journeyNum,state:u.length?"modify":"add"}})}},O=function(){return{type:e.RESET}},k=function(a){return function(p,f){var c=f(),d=c.bookingModel,m=c.breakfast,l=a?u.getUpdateBreakfastPayload(d,a):u.getPostBreakfastPayload(m);return l.length?(p({type:e.POST_TO_BOOKING_MODEL_START}),t.post(n.breakfast,l).then(function(t){var n=R.propOr([],"ssrs",r.normalize(o.postInflightProduct,t.data));p({type:e.POST_TO_BOOKING_MODEL_SUCCESS,payload:n,meta:{analytics:{event:"rynProductTrack",action:"ADD",type:i.BREK,identity:"ssrs"}}});var a=s.get("PromotionActions");return p(a.productAddedNotification({productAdded:i.BREK})),t})["catch"](function(t){p({type:e.POST_TO_BOOKING_MODEL_ERROR,payload:t.data})})):p(y())}};return{deleteBreakfasts:y,getOffer:c,addBreakfastToJourney:d,removeBreakfastFromJourney:m,addBreakfastForAllPaxToAllJourneys:l,removeBreakfastForAllPaxFromAllJourneys:_,updateLocallyAddedBreakfast:E,postBreakfasts:k,reset:O}}]);


"use strict";angular.module("app.booking").service("CabinBagActions",["RezApiConfig","$q","$http","ModelQuery","BookingModelActions","$httpParamSerializer","LEG_TYPE","CABINBAG_ACTION_TYPES","Flatnmap","FlatmapMaps","$filter","BookingRead","BasketMessageQueue","CARD_CODES","$injector","PriorityBoardingUtil",function(n,e,t,r,a,o,u,i,s,c,p,d,y,l,g,f){var m=function(n){return{local:!0,model:{sold:!1,type:"",code:l.CBAG,qty:1,vat:0,amt:n.amount||n.total,total:n.total},key:{passengers:n.paxNum,journeys:n.journeyNum,segments:0},identity:"ssrs"}},B=function(n,e,t){return R.pipe(r.byIdentity("ssrs"),r.byModel({code:l.CBAG,sold:!1}),r.byKey({passengers:n,journeys:e}),r.hasAny)(t)},A=function(n,e,t){return R.pipe(r.byIdentity("ssrs"),r.byKey({passengers:n,journeys:e}),r.byModel({type:l.BAGS,sold:!0}),r.hasAny)(t)},E=R.pipe(r.byIdentity("ssrs"),r.byModel({type:l.PRIOBRDNG}),r.hasAny),_=R.pipe(R.propOr([],"prioritySelection"),R.map(R.head),R.any(R.identity)),O=function(n){return R.pipe(r.byIdentity("ssrs"),r.byModel({code:l.CBAG,sold:!1}),r.byLocal(!0))(n)},b=function(n){return R.pipe(r.byIdentity("ssrs"),r.byModel({code:l.CBAG,sold:!1}))(n)},C=R.curry(function(n,e){return R.pipe(r.byIdentity("ssrs"),r.byModel({code:l.CBAG,sold:!1}),r.byKey(e))(n)}),D=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,t=void 0;return n>-1&&(t={journeys:n}),e>-1&&(t.passengers=e),t},N=R.curry(function(n,e){return R.pipe(r.byIdentity("ssrs"),r.byModel({code:l.CBAG}),r.byKey(e))(n)}),h=function(n){return n.map(function(n){return{paxNum:n.key.passengers,journeyNum:n.key.journeys}})},v={ADDED:"ADDED",REMOVED:"REMOVED",UPDATED:"UPDATED"},S=null,M=function(n){y.enqueue({code:"CBAG_UPDATE",translation:"trips.active.basket.message.CBAG."+n})},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=n.cabinBag,a=void 0;return e>-1&&(a={journeyNum:e}),t>-1&&(a.paxNum=t),a?r+"?"+o(a):r},L=function(n){return function(e,r){var a=T(e,r);return t["delete"](a).then(function(e){return n.push(e)})}},G=function(n,e,t){return R.pipe(C(R.__,{journeys:t}),R.length,R.equals(e.length))(n)},j=function(n,e,t){return function(r,a){var o=a().cabinBag.meta;return r({type:i.ADD_SELECTED_CABIN_BAGS,payload:[m({paxNum:n.num,journeyNum:e,total:t||R.pathOr(0,[e,"offers","CBAG","prices",n.type],o)})]})}},k=function(n,e){return function(t){return t({type:i.REMOVE_SELECTED_CABIN_BAGS,payload:{paxNum:n,journeyNum:e}})}},F=function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments[2];return function(a){var o=R.path(["key","id"],a),u=r.byKey({passengers:o,journeys:t})(e),i=babelHelpers.slicedToArray(u,1),s=i[0],c=R.pathOr(!1,["model","sold"],s),p={name:a.model.name,num:a.model.num,type:a.model.type,hasCabinBag:c||B(o,t,n),hasSoldCabinBag:c};return s&&!c&&j(p,t),p}},I=function(n){var e={};return n.forEach(function(n){var t=Math.pow(2,53)-1;e[n.journeyNum]={maxPerPax:n.maxPerPassenger,offers:{}},n.offers.forEach(function(r){e[n.journeyNum].offers[r.code]={prices:{}},r.price.forEach(function(a){e[n.journeyNum].offers[r.code].prices[a.paxType]=a.total,t>a.total&&(t=a.total)})}),e[n.journeyNum].minPrice=t}),e},P=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments[1];return R.map(function(n){return Object.assign(n,{isAddedToAllPax:e,passengers:n.passengers.map(function(t){return Object.assign(t,{hasCabinBag:R.prop("isAvailable",n)&&e||t.hasSoldCabinBag})})})},R.clone(n))},x=function(n,a){var o=[];if(S=v.REMOVED,!n)return t["delete"](T());var i=function(e){return r.byKey({journeys:e})(n)},s=L(o),c=function(n){var e=R.path(["key","journeys"],R.head(n));return G(a,n,e)?s(e):n.map(function(n){return s(R.path(["key","journeys"],n),R.path(["key","passengers"],n))})},p=[u.outbound,u.inbound].map(i).filter(function(n){return n.length}).map(c);return e.all(R.flatten(p)).then(function(){return R.last(o)})},U=function(e,r){return function(a){return S=S===v.REMOVED?v.UPDATED:v.ADDED,a({type:i.ADD_TO_BOOKING_MODEL_START}),t.post(n.cabinBag,e).then(function(n){M(S);var e=s.normalize(c.postCabinbag,n.data).ssrs||[];a({type:i.ADD_TO_BOOKING_MODEL_SUCCESS,payload:{ssrs:e},meta:{analytics:{event:"rynProductTrack",action:"ADD",type:l.CBAG,identity:"ssrs"}}}),r&&a({type:i.ADD_BUNDLE_TO_BOOKING_MODEL_SUCCESS})})["catch"](function(n){a({type:i.ADD_TO_BOOKING_MODEL_ERROR,payload:n})})}},K=function(n,e){return function(t){return t({type:i.REMOVE_FROM_BOOKING_MODEL_START}),x(n).then(function(n){var r=n.data;S=v.UPDATED;var a=s.normalize(c.postCabinbag,r).ssrs||[];M(S),t({type:i.REMOVE_FROM_BOOKING_MODEL_SUCCESS,payload:{ssrs:a},meta:{analytics:{event:"rynProductTrack",action:"REMOVE",type:l.CBAG,identity:"ssrs"}}}),e&&t({type:i.REMOVE_BUNDLE_FROM_BOOKING_MODEL_SUCCESS})})["catch"](function(n){t({type:i.REMOVE_FROM_BOOKING_MODEL_ERROR,payload:n.data})})}},V={addToLocalBasket:j,removeFromLocalBasket:k,resetLocalBasket:function(){return{type:i.REMOVE_ALL}},updateLocalBasket:function(n,e){return function(t,a){var o=a(),u=o.bookingModel,i=R.pipe(r.byIdentity("ssrs"),r.byModel({code:l.CBAG}),r.byKey({passengers:n.num,journeys:e}),r.hasAny)(u);return i?k(n.num,e)(t):j(n,e)(t,a)}},addAllToLocalBasket:function(){return function(n,e){var t=e().cabinBag,r=t.meta,a=t.cabinBagFor,o=R.pipe(R.filter(function(n){return n.isAvailable}),R.map(function(n){return n.passengers.map(function(e){return m({paxNum:e.num,journeyNum:n.model.journeyNum,total:r[n.model.journeyNum].offers.CBAG.prices[e.type]})})}),R.flatten)(a);return n({type:i.ADD_SELECTED_CABIN_BAGS,payload:o})}},addForAllLocally:function(){return function(n,e){var t=e(),r=t.cabinBag.meta,a=t.bookingModel,o=function(n){return R.map(function(e){return m({paxNum:e.key.id,journeyNum:n.key.id,total:r[n.key.id].offers.CBAG.prices[e.model.type]})},a.passengers)},u=R.pipe(d.filterUnavailableJourneys,R.filter(function(n){return!f.isCabinBagLaudaRulesDisabled(n)}),R.map(o),R.flatten)(a);return n({type:i.ADD_SELECTED_CABIN_BAGS,payload:u})}},addForJourneyLocally:function(n,e){return function(t,r){var a=r(),o=a.cabinBag.meta,u=R.map(function(n){return m({paxNum:n.key.id,journeyNum:e,total:o[e].offers.CBAG.prices[n.model.type]})},n);return t({type:i.ADD_SELECTED_CABIN_BAGS,payload:u})}},removeFromJourneyLocally:function(n,e){return function(t){n.forEach(function(n){return k(n,e)(t)})}},updateCabinBagsForJourneys:function(n){return function(e,t){var r=t().cabinBag.cabinBagFor;return e({type:i.UPDATE_CABIN_BAGS_FOR_JOURNEYS,payload:{cabinBagsFor:P(r,n)}})}},updateAllPassengersFor:function(n){return function(e,t){var r=t().cabinBag.cabinBagFor,a=R.clone(r),o=a.find(function(e){return e.model.journeyNum===n.model.journeyNum}),u=!o.isAddedToAllPax;return a=R.update(a.indexOf(o),Object.assign(o,{isAddedToAllPax:u,passengers:o.passengers.map(function(n){return Object.assign(n,{hasCabinBag:u})})}),a),e({type:i.UPDATE_CABIN_BAG_FOR_JOURNEY,payload:{cabinBagsFor:a}})}},updatePax:function(n,e){return function(t,r){var a=r().cabinBag.cabinBagFor,o=R.clone(a),u=o.find(function(n){return n.model.journeyNum===e.model.journeyNum}),s=u.passengers.find(function(e){return e.num===n.num}),c=R.update(u.passengers.indexOf(s),Object.assign(s,{hasCabinBag:!s.hasCabinBag}),u.passengers);return o=R.update(o.indexOf(u),Object.assign(u,{passengers:c,isAddedToAllPax:c.every(function(n){return n.hasCabinBag})}),o),t({type:i.UPDATE_CABIN_BAG_FOR_JOURNEY,payload:{cabinBagsFor:o}})}},togglePassengerListFor:function(n){return function(e,t){var r=t().cabinBag.cabinBagFor,a=R.clone(r);a=R.map(function(e){return e.model.journeyNum===n.model.journeyNum?Object.assign(e,{isPaxListOpen:!e.isPaxListOpen}):Object.assign(e,{isPaxListOpen:!1})},a),e({type:i.UPDATE_CABIN_BAG_FOR_JOURNEY,payload:{cabinBagsFor:a}})}},closePassengerListFor:function(n){return function(e,t){var r=t().cabinBag.cabinBagFor,a=R.clone(r);a=R.map(function(e){return e.model.journeyNum===n.model.journeyNum?Object.assign(e,{isPaxListOpen:!1}):e},a),e({type:i.UPDATE_CABIN_BAG_FOR_JOURNEY,payload:{cabinBagsFor:a}})}},updateCtaState:function(){return function(n,e){var t=e().cabinBag.cabinBagFor,r=[];return t.forEach(function(n){var e=n.passengers.some(function(n){return n.hasCabinBag&&!n.hasSoldCabinBag}),t=void 0;1===n.passengers.length?t=e?"remove":"add":n.passengers.length>1&&(t=e?"modify":"add"),r.push(babelHelpers["extends"]({},n,{ctaState:t}))}),n({type:i.UPDATE_CABIN_BAGS_FOR_JOURNEYS,payload:{cabinBagsFor:r}})}},getMeta:function(){return function(e){return e({type:i.CABIN_BAGS_AVAILABLE}),e({type:i.FETCH_META_START}),t.get(n.cabinBag).then(function(n){return e({type:i.FETCH_META_SUCCESS,payload:{meta:I(n.data),originalOffers:n.data}})})["catch"](function(n){return e({type:i.FETCH_META_ERROR,payload:{meta:{},error:n}})})}},prepareCabinBagsForJourneys:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(t,a){var o=a(),u=o.bookingModel,s=o.priorityBoarding,c=o.checkin,y=o.cabinBag.meta,g=_(c)||E(u)||E(s),m=e.map(function(e){var t=R.path(["model","journeyNum"],e),a=p("iataToStationName")(R.path(["model","orig"],e)),o=R.path([t,"offers",l.CBAG,"prices"],y),i=R.path(["ADT"],o),s=R.pipe(r.byIdentity("ssrs"),r.byModel({code:l.CBAG}))(u),c=d.isRyanairFlight(t,u),m=f.isPriorityAndCabinBagsCampaignLaunched([e]),B=g?[]:R.pipe(R.map(F(u,s,t)),R.filter(function(n){return!R.isEmpty(n)}))(n),A=R.is(Object,R.path([t],y))&&m&&c&&R.lt(0,R.length(B));return babelHelpers["extends"]({},e,{airport:a,price:i,prices:o,passengers:B,isAvailable:A,isMaxedOut:R.all(function(n){return n.hasSoldCabinBag},B),soldCabinBags:B.reduce(function(n,e){return n+(e.hasSoldCabinBag?1:0)},0),maxCabinBags:A?B.length:0})});return t({type:i.PREPARE_CABIN_BAGS_FOR_JOURNEYS,payload:{cabinBagsFor:m}})}},submitBasket:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!1;return function(a,o){var u=O(o().bookingModel),p=b(o().bookingModel);if(!R.isEmpty(u)||r&&!R.isEmpty(p)){var d=void 0;return d=r?p.map(function(n){return{paxNum:n.key.passengers,journeyNum:n.key.journeys}}):u.map(function(n){return{paxNum:n.key.passengers,journeyNum:n.key.journeys}}),a({type:i.ADD_TO_BOOKING_MODEL_START}),t.post(n.cabinBag,d).then(function(n){a({type:i.ADD_TO_BOOKING_MODEL_SUCCESS,payload:s.normalize(c.postCabinbag,n.data),meta:{analytics:{event:"rynProductTrack",action:"ADD",type:l.CBAG,identity:"ssrs"}}});var e=g.get("PromotionActions");a(e.productAddedNotification({productAdded:l.CBAG})),M(S===v.REMOVED?v.UPDATED:v.ADDED)})["catch"](function(n){a({type:i.ADD_TO_BOOKING_MODEL_ERROR,payload:n})})}return e.when([])}},removeFromBasket:function(){return function(e){return e({type:i.REMOVE_FROM_BOOKING_MODEL_START}),t["delete"](n.cabinBag).then(function(n){var t=n.data,r=s.normalize(c.postCabinbag,t).ssrs||[];e({type:i.REMOVE_FROM_BOOKING_MODEL_SUCCESS,payload:{ssrs:r},meta:{analytics:{event:"rynProductTrack",action:"REMOVE",type:l.CBAG,identity:"ssrs"}}})})["catch"](function(n){var t=n.data;return e({type:i.REMOVE_FROM_BOOKING_MODEL_ERROR,payload:t})})}},clearLocalSelection:function(){return{type:i.CLEAR_LOCAL_SELECTION}},addToJourney:function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments[4];return function(o,u){var s=u(),c=s.bookingModel,p=s.cabinBag,y=d.get("passengers",c),g=R.pipe(R.find(R.propEq("journeyNum",e)),R.propOr([],"offers"),R.find(R.propEq("code",l.CBAG)),R.propOr([],"price"))(p.originalOffers),f=[];if(n){var B=d.getSsrsByTypeAndSold(l.BAGS,!0)(c),A=R.pipe(R.pluck("key"),R.filter(function(n){return n.journeys===e}),R.pluck("passengers"),R.uniq)(B);f=t>-1?y.filter(function(n){return!R.contains(R.path(["key","id"],n),A)&&R.path(["key","id"],n)===t}):y.filter(function(n){return!R.contains(R.path(["key","id"],n),A)})}else f=t>-1?y.filter(function(n){return R.path(["key","id"],n)===t}):y.filter(function(n){return R.any(function(e){return e.paxNum===R.path(["key","id"],n)})(g)});var E=void 0;E=R.not(R.isNil(a))||R.not(R.isNil(r))?a||r:R.pathOr(0,["0","total"])(g);var _=f.map(function(n){return m({paxNum:n.key.id,journeyNum:e,total:E})});o({type:i.ADD_SELECTED_CABIN_BAGS_LOCALLY,payload:{addForBundle:n,items:_,basketItems:R.pipe(D,N(c))(e,t)}})}},removeFromJourney:function(n,e,t){return function(r,a){var o=a(),u=o.bookingModel,s=D(e,t),c=C(u,s),p=n?c.filter(function(n){return!A(n.key.passengers,n.key.journeys,u)}):c;r({type:i.REMOVE_SELECTED_CABIN_BAGS_LOCALLY,payload:{items:[{keyQuery:s,basketItems:p}],removedForBundle:n}})}},update:function(n){return function(t,r){var a=r().cabinBag,o=n?a.bundleRemoved:a.removed,u=n?a.bundleAdded:a.added,i=h(u),s=void 0;return o.length&&(s=t(K(o,n))),e.when(s).then(function(){return i.length?t(U(i,n)):s})}}};return V}]);


"use strict";angular.module("app.booking").service("CheckinModelActions",["CHECKIN_MODEL_ACTION_TYPES","BOOKING_MODEL_ACTION_TYPES","MAX_UPLOAD_PCR_FILE_SIZE_BYTES","MAX_UPLOAD_PCR_FILES_AMOUNT_PER_PAX","CheckinProducts","$http","$state","$stateParams","AEMConfig","RezApiConfig","$q","Flatnmap","FlatmapMaps","BookingRead","SEATS_ACTION_TYPES","CHECKIN","CheckinModelSelectors","BookingReadCheckin","CheckinFlow","TRAVEL_DOCUMENTS_ACTIONS_TYPES","SeatsActions","BookingModelActions","FareUpgradeActions","PriorityBoardingActions","CabinBagActions","$injector","FEATURE_CONFIG","Session","MarketConfig",function(e,t,n,a,o,r,i,c,u,s,p,l,S,d,E,y,T,_,C,f,O,P,g,A,h,N,m,I,k){var v=function(e){return{journeyNum:e.journeyNumber,paxNum:e.paxNumber,key:e.fileInfoModel.key,name:e.fileInfoModel.metaData["x-amz-meta-filename"],link:e.fileInfoModel.publicLink,isFileSaved:e.isFileSaved,percent:100}},U={selectPassenger:function(t){return function(n){n({type:e.SELECT_PAX,payload:t}),n(U.updateTravelDocsList()),n(U.updateCtaStatus())}},unselectPassenger:function(t){return function(n){n({type:e.UNSELECT_PAX,payload:t}),n(U.updateTravelDocsList()),n(U.updateCtaStatus())}},selelectPassengers:function(t){return function(n){n({type:e.SELECT_PASSENGERS,payload:t}),n(U.updateTravelDocsList()),n(U.updateCtaStatus())}},updateTravelDocsList:function(){return function(e,t){var n=T.generateTravelDocumentsList(t());e({type:f.UPDATE_TRAVEL_DOCS_LIST,payload:{travelDocumentsList:n}})}},fetchCovidDocs:function(){return function(t){t({type:e.FETCH_DOCS_START}),r.get(s.pcrFetch).then(function(n){t({type:e.FETCH_DOCS_SUCCESS,payload:n.data.map(v)})})["catch"](function(n){return 404===n.status?void t({type:e.FETCH_DOCS_SUCCESS,payload:[]}):void t({type:e.FETCH_DOCS_ERROR})})}},removeCovidDoc:function(t,n,a){return function(o){o({type:e.REMOVE_DOCS_START,payload:{journeyNum:n,paxNum:a,fileKey:t}}),r.post(s.pcrRemove,{journeyNumber:n,paxNumber:a,keys:[t]}).then(function(t){o({type:e.REMOVE_DOCS_SUCCESS,payload:{journeyNum:n,paxNum:a,files:t.data.map(v)}})})["catch"](function(r){return 404===r.status&&r.data&&0===r.data.length?void o({type:e.REMOVE_DOCS_SUCCESS,payload:{journeyNum:n,paxNum:a,files:[]}}):void o({type:e.REMOVE_DOCS_ERROR,payload:{journeyNum:n,paxNum:a,fileKey:t,error:"trips.checkin.boarding.upload.error.remove"}})})}},uploadCovidDocs:function(t,o,i){return function(c){var u=null;if(t.length>a?u="trips.checkin.boarding.upload.error.amount-six":t.some(function(e){return e.size>n})?u="trips.checkin.boarding.upload.error.size-one-file":t.reduce(function(e,t){return e+t.size},0)>n*a&&(u="trips.checkin.boarding.upload.error.size-one-upload"),u)return void c({type:e.UPLOAD_ERROR,payload:{journeyNum:o,paxNum:i,files:[],error:u}});var p=new FormData,l=!0,S=!1,d=void 0;try{for(var E,y=t[Symbol.iterator]();!(l=(E=y.next()).done);l=!0){var T=E.value;p.append("file",T,T.name)}}catch(_){S=!0,d=_}finally{try{!l&&y["return"]&&y["return"]()}finally{if(S)throw d}}c({type:e.UPLOAD_START,payload:{journeyNum:o,paxNum:i,files:t}}),r.post(s.pcrUpload+"?JourneyNumber="+o+"&PaxNumber="+i,p,{headers:{"Content-Type":void 0},uploadEventHandlers:{progress:function(n){n.lengthComputable&&c({type:e.UPLOAD_PROGRESS,payload:{journeyNum:o,paxNum:i,files:t,percent:Math.round(n.loaded/n.total*100)}})}}}).then(function(t){c({type:e.UPLOAD_SUCCESS,payload:{journeyNum:o,paxNum:i,files:t.data.map(v)}})})["catch"](function(n){var a=null;a=412===n.status&&n.data&&"FileSize"===n.data.code?"trips.checkin.boarding.upload.error.size":412===n.status&&n.data&&"FileCount"===n.data.code?"trips.checkin.boarding.upload.error.amount-six":"trips.checkin.boarding.upload.error.default",c({type:e.UPLOAD_ERROR,payload:{journeyNum:o,paxNum:i,files:t,error:a}})})}},commitCovidDocs:function(){return function(n){n({type:e.COMMIT_DOCS_START}),r.post(s.commitNoEmail).then(function(a){n({type:t.CREATE_BOOKING_MODEL_SUCCESS,payload:l.normalize(S.bookingModel,a.data)}),n(U.fetchCovidDocs()),n({type:e.COMMIT_DOCS_SUCCESS})})["catch"](function(){n({type:e.COMMIT_DOCS_ERROR})})}},getCheckinProducts:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!0;return function(n,a){n({type:e.GET_PRODUCTS_START,payload:{reload:t}});var r=a(),i=T.getSelectedPassengers(r),c=T.getSelectedJourneysToCheckin(r);o.getProducts().then(function(t){var a=C.filterProducts(t,r);n({type:e.GET_PRODUCTS_SUCCESS,products:C.generateMinPrice(a,i,c)}),n(A.getPrices(i,c,!0))})["finally"](function(){n({type:e.GET_PRODUCTS_END})})}},removeProduct:function(t){return{type:e.REMOVE_PRODUCT,code:t}},getCases:function(){return function(t){t({type:e.GET_CASES_START}),r.get(u.getCheckinCardCasesUrl(),{cache:!0}).then(function(n){t({type:e.GET_CASES_SUCCESS,payload:{cases:n.data}})})["catch"](function(){t({type:e.GET_CASES_ERROR})})}},checkinPassengers:function(t){return function(n,a){return n({type:e.CHECKIN_PAX_START}),r.post(s.checkin.checkinPassengers,t).then(function(t){var o=t.data,r=l.normalize(S.postCheckin,o);n({type:e.CHECKIN_PAX_SUCCESS,payload:{checkin:r.checkin}});var i=R.path(["checkin","hasLas"],a());if(r.seats&&!R.isEmpty(r.seats)){n({type:E.CONFIRM_SEATS_SUCCESS_ON_CHECKIN,payload:{seats:r.seats}});var c=N.get("NotificationCentreActions");n(c.validateMessage());var u=n(P.refresh("",!1,!0));if(i)return u.then(function(){return r},function(){return r})}return i?n(P.refresh("",!1,!0)).then(function(){return r},function(){return r}):r})["catch"](function(t){return n({type:e.CHECKIN_PAX_ERROR,payload:{err:t}}),p.reject(t)})}},setCTA:function(t){return function(n,a){var o=T.getState(a()).ctaEnabled;o!==t&&n({type:e.SET_CTA,payload:{ctaEnabled:t}})}},setCtaOnSeatMap:function(e){return function(t,n){var a=n(),o=a.checkin.allocationForm,r=o[e.journeys].manualChoice||o[e.journeys].manualEarly||a.checkin.mandatorySeatMap,i=d.isPlusUpgradeAdded(a.bookingModel)?d.get("passengers",a.bookingModel):T.getSelectedPassengers(a),c=!m["open-seatmap-in-check-in"]&&!r,u=c||d.allSelectedPassengersHaveSeatsOnSegment(i,e,a.bookingModel);t(U.setCTA(u))}},reset:function(){return function(t){t({type:e.RESET}),t(A.emptyStore())}},setShowBackBtn:function(t){return{type:e.SET_SHOW_BACK_BTN,payload:t}},setOptions:function(t){return{type:e.SET_OPTIONS,payload:t}},selectOption:function(t,n){return{type:e.SELECT_OPTION,payload:{legIndex:t,value:n}}},setFooterVibisility:function(t){return{type:e.SET_FOOTER_VISIBILITY,payload:t}},updateSteps:function(){return function(t,n){var a=C.updateCheckinSteps(n(),T.getCheckinTotalToPay(n())),o=C.getPreviousCurrentNext(n()),r=o.currentStep,i=o.previousStep;return t({type:e.UPDATE_CHECKIN_STEPS,payload:{checkinSteps:a}}),r===y.ROUTES.ALLOCATION&&t({type:e.SET_REGULAR_SEATS_STEP_PASSED,payload:!1}),r===y.ROUTES.SEATS&&i===y.ROUTES.ALLOCATION&&t({type:e.SET_REGULAR_SEATS_STEP_PASSED,payload:!0}),a}},start:function(){return function(e,t){C.skipSelect(t())&&e(U.selectPassenger(0)),e(U.updateSteps());var n="booking.active.checkin.boarding-pass"===i.current.name?t().checkin.checkinSteps.length-1:0,a=C.getRouteObj(t().checkin.checkinSteps[n]),o=a.route,r=a.params;i.go(o,r)}},setMandatorySeatMap:function(t){return{type:e.SET_MANDATORY_SEAT_MAP,payload:t}},updateCtaStatus:function(){return function(t,n){var a=T.getSelectedPassengers(n()),o=t(U.updateSteps()),r=n(),u=C.matchRouteIndex(i.current,c,o),s=void 0;switch(o[u].state){case y.ROUTES.SELECT_PAX:s=R.both(R.complement(R.isEmpty),R.all(_.canPaxSelectCheckin(R.__,babelHelpers["extends"]({},r.bookingModel,{selectedPassengers:a}))))(a);break;case y.ROUTES.DOCUMENTS:break;case y.ROUTES.INSURANCE:break;case y.ROUTES.ALLOCATION:break;case y.ROUTES.SEATS:case y.ROUTES.PRIORITY:case y.ROUTES.EXTRAS:case y.ROUTES.PAYMENT:case y.ROUTES.BOARDING:default:s=!1}t({type:e.SET_CTA,payload:{ctaEnabled:s}})}},nextStep:function(){return function(e,t){C.completeCurrentTask().then(function(n){"skipStepUpdate"!==n&&e(U.updateSteps());var a=C.getNextRoute(t()),o=a.route,r=a.params,c=t(),u=c.launchDarkly,s=c.bookingModel;if("booking.active.checkin.boarding-pass"===o&&u["boarding-pass-redirect-3-0"]){var p=d.getTpParams(s);window.location.assign(k.getPath()+"/trip/flights/boarding-pass?"+p)}else i.go(o,r),e(U.setShowBackBtn(!0))})}},previousStep:function(){return function(e,t){C.completeBackTask().then(function(){var n=t(),a=R.path(["checkin","checkinSteps"],n),o=d.isPlusBundle(n.bookingModel),r=d.hasFamilyPlus(n.bookingModel),c=d.getCabinBagItems(!1)(n.bookingModel),u=R.find(function(e){return!e.local})(c),s=R.find(function(e){return e.local})(c),p=C.getCurrentRoute(n),l=function(e,t){return R.pipe(R.filter(function(t){return t.state===e}),R.head)(t)},S=function(e){return R.equals("booking.active.checkin."+e,R.pathOr("",["route"],p))},E=C.getPreviousRoute(n),y=E.route,T=E.params,_=function(){e(A.resetPriorityBoardings()),e(U.resetCheckinPrioritySelection()),e(U.resetCheckinPrioritySelectionNewPolicy()),u&&e(h.removeFromBasket()),s&&e(h.resetLocalBasket())};(o||r)&&S("seats")&&l("seats",a)&&(e(g.removeUpgrade()),e(U.resetCheckinPrioritySelection()),e(U.resetCheckinPrioritySelectionNewPolicy())),(o||r)&&S("extras")&&l("extras",a)&&(e(g.removeUpgrade()),R.equals(y,"booking.active.checkin.priority")||_()),S("priority")&&_(),i.go(y,T)})}},getSeatsAvailability:function(e){return function(t,n){var a=C.getPreviousCurrentNext(n()),o=a.previousStep,r=a.currentStep,i=a.nextStep,c=r===y.ROUTES.BOARDING&&(o===y.ROUTES.PAYMENT||o===y.ROUTES.EXTRAS),u=e===y.ROUTES.BOARDING&&r===y.ROUTES.EXTRAS&&i===y.ROUTES.PAYMENT,s=R.path(["seats","aircraftMap","length"],n());(i===y.ROUTES.BOARDING||c||u)&&(0===s&&t(O.retrieveAircraftMaps()),t(O.getAvailability()))}},requestBoardingPasses:function(e){return function(t,n){t(U.getSeatsAvailability(e));var a=n(),o=a.bookingModel,r=T.getSelectedPassengers(n()),i=T.getSelectedJourneysToCheckin(n()),c=C.getCheckinPayload(o,r,i);return t(U.checkinPassengers(c))}},cleanSeats:function(){return function(e,t){var n=t();return d.hasUnsoldSeats(n.bookingModel)?e(O.clearAllSeats()):p.resolve()}},setPriorityPopupAcceptedJourneyNums:function(t){return{type:e.SET_PRIORITY_POPUP_ACCEPTED_JOURNEY_NUMS,payload:t}},setCheckinPrioritySelection:function(t,n){return{type:e.SET_PRIORITY_SELECTION,payload:{journeyNum:t,selection:n}}},resetCheckinPrioritySelection:function(){return{type:e.RESET_PRIORITY_SELECTION}},setCheckinPrioritySelectionNewPolicy:function(t,n){return{type:e.SET_PRIORITY_SELECTION_NEW_POLICY,payload:{journeyNum:t,selection:n}}},resetCheckinPrioritySelectionNewPolicy:function(){return{type:e.RESET_PRIORITY_SELECTION_NEW_POLICY}},productsEngagedFromBoardingPass:function(t){return{type:e.PRODUCTS_ENGAGED_FROM_BOARDING_PASS,payload:t}},productsAddedFromBoardingPass:function(t){return{type:e.PRODUCTS_ADDED_FROM_BOARDING_PASS,payload:t}},passProductToPaymentPage:function(t){return{type:e.PRODUCT_TO_SHOW_ON_PAYMENT_PAGE,payload:t}},getPriorityAvailability:function(){return function(t){var n={codes:"PRIOBRDNG",partialAvailability:!0,isPotential:!1,session:I.getSessionStorage("ryanair:token")};return r.get(s.extras+"?IsCheckInFlow=true",{params:n}).then(function(n){var a=n.data,o=R.pathOr([],["0","availableForSegments"],a),r=R.pathOr({},["0","minPrice"],a),i={value:R.pathOr(0,["0","dsc"],a),type:R.pathOr("RegularDiscount",["0","discountType"],a),originalPrice:R.pathOr(r,["0","details","0","originalPrice"],a)},c=o.reduce(function(e,t){return[].concat(babelHelpers.toConsumableArray(e),[babelHelpers["extends"]({},t,{minPrice:r,discount:i})])},[]);t({type:e.GET_PRIORITY_AVAILABILITY,payload:c})})["catch"](function(n){t({type:e.GET_PRIORITY_AVAILABILITY_ERROR,payload:n.data})})}},getPriorityBoardingImages:function(){return function(t){return r({method:"GET",url:u.getPriorityBoardingImagesUrl()}).then(function(n){var a=n.data;t({type:e.GET_PRIORITY_BOARDING_IMAGES_SUCCESS,payload:a})})["catch"](function(n){t({type:e.GET_PRIORITY_BOARDING_IMAGES_ERROR,payload:n.data})})}},toggleSelectedJourney:function(t){return function(n){n({type:e.TOGGLE_SELECTED_JOURNEY,payload:t})}},verifySelectedJourneys:function(){return function(t){t({type:e.VERIFIY_SELECTED_JOURNEYS})}},showAllocationOptions:function(t){return function(n){n({type:e.SHOW_ALLOCATION_OPTIONS,payload:t})}},hideAllocationOptions:function(t){return function(n){n({type:e.HIDE_ALLOCATION_OPTIONS,payload:t})}},getCheckinExtrasConfig:function(){return function(t){return r({method:"GET",url:u.getCheckinExtrasConfig()}).then(function(n){var a=n.data;t({type:e.GET_CHECKIN_EXTRAS_CONFIG_SUCCESS,payload:a})})["catch"](function(n){t({type:e.GET_CHECKIN_EXTRAS_CONFIG_ERROR,payload:n.data})})}},showSeatsPopup:function(){return function(t){return t({type:e.SHOW_SEATS_POPUP})}}};return U}]);


"use strict";angular.module("app.booking").service("EquipmentActions",["$http","RezApiConfig","EQUIPMENT_ACTION_TYPES","PASSENGER_TYPES","EQUIPMENT_CODES","BookingRead","BasketMessageQueue","DialogManager","ModelQuery","Flatnmap","FlatmapMaps","TotalHeaderActions","$injector",function(e,t,n,r,o,u,a,i,c,s,p,l,d){var f=function(e){return Object.keys(e).map(function(e){return r[e]}).filter(function(e){return e!==r.Infant})},m=function(e,t){return R.filter(function(e){return!R.contains(e,t)})(e)},y=function(e,t){var n=R.map(R.path(["selectedEquipment","code"])),r=n(e),o=m(t,r);return[].concat(babelHelpers.toConsumableArray(e),babelHelpers.toConsumableArray(o.map(function(e){return{selectedEquipment:{code:e},getFlightOutCounter:function(){return 0},getFlightBackCounter:function(){return 0}}})))},g=function(e,t,n){var r=["getFlightOutCounter","getFlightBackCounter"];return e.map(function(e,o){var u=y(e.equipmentCards,t);return{segSsrs:R.pipe(R.filter(function(e){return e.selectedEquipment}),R.map(function(e){return[0,1].filter(function(e){return 0===e||1===e&&n}).map(function(t){return{paxNum:o,journeyNum:t,code:e.selectedEquipment.code,qty:e[r[t]]()}})}),R.reduce(function(e,t){return e.concat(t)},[]))(u)}})},T=function(e,t,n){return function(r){return r.model.code===e&&r.key.journeys===t&&r.key.passengers===n}},E=function(e){var t=e.equipmentItems,n=e.passengers,r=e.codeToRemove,o=e.codes;return n.map(function(e,n){return{segSsrs:o.map(function(e){return[0,1].map(function(o){return t.filter(T(e,o,n)).reduce(function(t,u){return{paxNum:n,journeyNum:o,code:e,qty:u.model.code===r?0:u.model.qty}},null)})}).reduce(function(e,t){return[].concat(babelHelpers.toConsumableArray(e),babelHelpers.toConsumableArray(t))},[]).filter(function(e){return!!e})}})},_=function(e,t){a.enqueue({code:"EQUIPMENT_PRODUCT_ADD",qty:e.qty,amt:e.total,translation:"trips.extra."+t.toLowerCase()+"_equipment.basket_message_description"})},O=function(e,t){return t.filter(function(t){return!t.model.sold&&t.model.type===e}).reduce(function(e,t){return{qty:e.qty+t.model.qty,total:e.total+t.model.total}},{qty:0,total:0})},b={getOffers:function(){var a=function(e){return e.map(function(e){return babelHelpers["extends"]({},e,{offers:e.offers.map(function(e){return babelHelpers["extends"]({},e,{prices:e.prices.map(function(e){return babelHelpers["extends"]({},e,{paxType:u.changeStaffPaxType(e.paxType)})})})})})})};return function(i,c){var s=u.isStaffBooking(c().bookingModel);i({type:n.FETCH_OFFERS_START}),e.get(t.equipment.get).then(function(e){i({type:n.FETCH_OFFERS_SUCCESS,payload:{codes:o,info:s?a(e.data):e.data,paxTypes:f(r)}})})["catch"](function(e){i({type:n.FETCH_OFFERS_ERROR,payload:e.data})})}},addToBookingModel:function(r,o){return function(u){u({type:n.ADD_TO_BOOKING_MODEL_START}),e.post(t.equipment.post,r).then(function(e){var t=e.data,r=function(e){return e.model.type===o},a=R.filter(r)(s.normalize(p.postSsr,t).ssrs||[]),c=O(o,a);u(l.showExtrasInfo({totalCount:c.qty,text:"trips.header.title.extras_"+o.toLowerCase()})),_(c,o),u({type:n.ADD_TO_BOOKING_MODEL_SUCCESS,payload:{equipmentType:o,items:a},meta:{analytics:{event:"rynProductTrack",action:"UPDATE",type:o,identity:"ssrs"}}});var f=d.get("PromotionActions");u(f.productAddedNotification({productAdded:o})),i.close(o)})["catch"](function(e){u({type:n.ADD_TO_BOOKING_MODEL_ERROR,payload:e.data})})}},addToBookingModelFromPassengers:function(e,t,n){var r=g(e,o[t],n).reduce(function(e,t){return e.concat(t.segSsrs)},[]);return b.addToBookingModel(r,t)},removeAll:function(e,t){return function(n,r){var u=r(),a=u.bookingModel,i=a.passengers,s=E({equipmentItems:c.byModel({type:t,sold:!1})(a.ssrs),passengers:i,codeToRemove:e,codes:o[t]}).reduce(function(e,t){return e.concat(t.segSsrs)},[]);n(b.addToBookingModel(s,t))}},updateTotalPrice:function(e,t){return{type:n.UPDATE_TOTAL_PRICE,payload:{equipmentType:e,value:t}}},reset:function(){return{type:n.RESET}}};return b}]);


"use strict";angular.module("app.booking").service("FastTrackActions",["FAST_TRACK_ACTION_TYPES","FastTrackUtils","$http","RezApiConfig","BasketMessageQueue","BookingRead","Flatnmap","FlatmapMaps","ModelQuery","$httpParamSerializer","$q","LEG_TYPE","PRIORITY_BOARDING_ACTIONS_TYPES","FlightExtrasActions","PriorityBoardingUtil","CARD_CODES","$injector","DialogManager","PASSENGER_TYPES",function(e,t,n,r,a,o,u,i,s,c,y,l,p,d,f,g,m,E,T){var A=function(e){return{model:{sold:!1,type:g.FAST,code:g.FAST,qty:1,vat:0,amt:e.amount||e.total,total:e.total},key:{passengers:e.passengerNum,journeys:e.journeyNum,segments:0},identity:"ssrs"}},S={ADDED:"ADDED",REMOVED:"REMOVED",UPDATED:"UPDATED"},_=null,D=function(e){a.enqueue({code:"FAST_UPDATE",translation:"trips.extras.basket.message.FAST."+e})},k=function(e,t){var n=o.getModel("journeys",t),r=o.getPassengerBreakdownAsObject(t);return R.pipe(R.map(function(t){var n=t.journeyNum;return R.pipe(R.filter(function(e){return e.journeyNum===n}),R.map(function(e){var t=o.changeStaffPaxType(e.paxType),a=r[t];return{journeyNum:n,paxType:t,qty:a,total:a*e.price||e.price,unitTotal:e.price}}))(e)}))(n)},O=function(e){return e.map(function(e){return{paxNum:e.key.passengers,journeyNum:e.key.journeys,segmentNum:0}})},v=function(e,t){return function(n,r){var a=r(),u=a.bookingModel;f.areAllIncluded(u)||f.areAllPrioritySold(u)||n(d.getExtras([g.PRIOBRDNG]));var i=s.byModel({type:g.PRIOBRDNG,sold:!1})(e),c=o.getPriorityBoardingItems(!1)(u),y=R.unionWith(R.eqProps("key"),i,c);y.length&&n({type:t,payload:{priority:y},meta:{analytics:{event:"rynProductTrack",action:t===p.ADD_ALL_SUCCESS?"ADD":"REMOVE",type:g.PRIOBRDNG,identity:"ssrs"}}})}},b=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:angular.noop;return function(c,y){var l=y(),d=l.bookingModel;return _=_===S.REMOVED?S.UPDATED:S.ADDED,c({type:e.ADD_TO_BOOKING_MODEL_START}),n.post(r.fasttrack,t).then(function(t){var n=t.data;D(_),a();var r=u.normalize(i.postSsr,n).ssrs||[],y=R.pipe(o.getAllFastTrackItems,R.unionWith(R.eqProps("key"),r),s.byModel({type:g.FAST,sold:!1}))(d);c({type:e.ADD_TO_BOOKING_MODEL_SUCCESS,payload:y,meta:{analytics:{event:"rynProductTrack",action:"UPDATE",type:g.FAST,identity:"ssrs"}}});var l=m.get("PromotionActions");c(l.productAddedNotification({productAdded:g.FAST})),c(v(r,p.ADD_ALL_SUCCESS))})["catch"](function(t){c({type:e.ADD_TO_BOOKING_MODEL_ERROR,payload:t.data})})}},M=function(e,t){var n=r.fasttrack,a=void 0;return"number"==typeof e&&(a={journeyNum:e}),"number"==typeof t&&(a.paxNum=t),a?n+"?"+c(a):n},F=R.curry(function(e,t){return R.pipe(o.getFastTrackItems(!1),s.byKey(t))(e)}),h=R.curry(function(e,t){return R.pipe(s.byIdentity("ssrs"),s.byModel({code:g.FAST}),s.byKey(t))(e)}),P=function(e){return function(t,r){var a=M(t,r);return n["delete"](a).then(function(t){return e.push(t)})}},C=function(e,t,n){return R.pipe(F(R.__,{journeys:n}),R.length,R.equals(t.length))(e)},N=function(e,t){var r=[];if(_=S.REMOVED,!e)return n["delete"](M());var a=function(t){return s.byKey({journeys:t})(e)},o=P(r),u=function(e){var n=R.path(["key","journeys"],R.head(e));return C(t,e,n)?o(n):e.map(function(e){return o(e.key.journeys,e.key.passengers)})},i=[l.outbound,l.inbound].map(a).filter(function(e){return e.length}).map(u);return y.all(R.flatten(i)).then(function(){return R.last(r)})},I=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:angular.noop;return function(r,a){return r({type:e.REMOVE_FROM_BOOKING_MODEL_START}),N(t,a().bookingModel).then(function(t){var a=t.data;n(),_=S.REMOVED;var o=u.normalize(i.postSsr,a).ssrs||[];D(_),r({type:e.REMOVE_FROM_BOOKING_MODEL_SUCCESS,payload:s.byModel({type:g.FAST,sold:!1})(o),meta:{analytics:{event:"rynProductTrack",action:"REMOVE",type:g.FAST,identity:"ssrs"}}}),E.dialogsKeyToIdMap.boardingPassPaymentDialog&&E.closeByKey("boardingPassPaymentDialog"),r(v(o,p.ADD_ALL_SUCCESS))})["catch"](function(t){r({type:e.REMOVE_FROM_BOOKING_MODEL_ERROR,payload:t.data})})}},L=function(e,t){var n=void 0;return"number"==typeof e&&(n={journeys:e}),"number"==typeof t&&(n.passengers=t),n},B=function(e,n,r,a){return h(r,L(e,n)).length&&!t.isLocallyRemoved(e,n,a.removed)||t.isLocallyAdded(e,n,a.added)},j=function(e){return R.pipe(s.byIdentity("passengers"),s.findByKey({id:e}),R.path(["model","type"]),R.equals(T.Adult))},K=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:angular.noop;return function(t,n){var r=n().fastTrack,a=r.removed,o=O(r.added),u=void 0;return a.length&&(u=t(I(a))),y.when(u).then(function(){return o.length?t(b(o,e)):void e()})}},x={getPrices:function(){return function(t,a){return o.getOperator(a().bookingModel)?y.when({}):(t({type:e.FETCH_OFFERS_START}),n.get(r.fasttrack).then(function(n){t({type:e.FETCH_OFFERS_SUCCESS,payload:{priceBreakdown:k(n.data,a().bookingModel)}})})["catch"](function(n){t({type:e.FETCH_OFFERS_ERROR,payload:n.data})}))}},removeAllFromBasket:I,update:K,removeFromJourney:function(t,n,r){return function(a,u){var i=u(),s=i.bookingModel,c=i.fastTrack,y=!R.isNil(n)&&j(n)(s)&&R.pipe(o.getPaxType,R.filter(function(e){return B(t,e.key.id,s,c)}),function(e){return!(e.length-1)})(T.Adult,s),l=y?[].concat(babelHelpers.toConsumableArray(o.getPaxType(T.Child,s)),babelHelpers.toConsumableArray(o.getPaxType(T.Teen,s))).map(function(e){var n=L(t,e.key.id),r=F(s,n);return{keyQuery:n,basketItems:r}}):[],p=L(t,n),d=F(s,p);a({type:e.REMOVE_SELECTED_FAST_TRACKS,payload:[{keyQuery:p,basketItems:d}].concat(babelHelpers.toConsumableArray(l))}),r&&a(K())}},addToJourney:function(t,n,r){return function(a,u){var i=u(),s=i.bookingModel,c=o.get("passengers",s),y="number"==typeof n?c.filter(function(e){return e.key.id===n}):c,l=y.map(function(e){return A({passengerNum:e.key.id,journeyNum:t,total:u().fastTrack.priceBreakdown[t].find(function(t){return t.paxType===e.model.type}).unitTotal})});a({type:e.ADD_SELECTED_FAST_TRACKS,payload:{items:l,basketItems:R.pipe(L,h(s))(t,n)}}),r&&a(K())}},updateFastTrackAllPassengers:function(e,t){return function(n){var r="add"===t?x.addToJourney:x.removeFromJourney;e.forEach(function(e){e.passengers.forEach(function(t){t.hasSoldFasttrack||n(r(e.journeyNum,t.num))})})}},addAllToBookingModel:function(){return function(e,n){var r=n(),a=r.bookingModel,u=o.get("passengers",a),i=o.get("journeys",a),s=function(e){return u.map(function(t){return{paxNum:t.key.id,journeyNum:e,segmentNum:0}})},c=function(e){return t.isAvailableForLeg({leg:e,bookingModel:a,fastTrackState:n().fastTrack})},y=R.pipe(R.map(R.path(["key","id"])),R.filter(c),R.map(s),R.flatten)(i);return e(b(y))}},clearLocalSelection:function(){return{type:e.CLEAR_LOCAL_SELECTION}}};return x}]);


"use strict";angular.module("app.booking").service("FlightExtrasActions",["$http","FLIGHT_EXTRAS_ACTION_TYPES","RezApiConfig","FlightExtras","FlightSearch","BookingRead",function(t,n,e,i,o,a){return{getQuickAddAbility:function(){return function(i){o.model.operatedBy||(i({type:n.GET_QUICK_ADD_START}),t.get(e.quickAdd).then(function(t){var e=t.data;i({type:n.GET_QUICK_ADD_SUCCESS,payload:{quickAddAbility:e}})})["catch"](function(){i({type:n.GET_QUICK_ADD_ERROR})}))}},getExtras:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments[2];return function(r,u){return t||r({type:n.GET_EXTRAS_START}),e.isPotential=a.isPotentialBooking(u().bookingModel),i.getExtras(t,e,o).then(function(t){r({type:n.GET_EXTRAS_SUCCESS,payload:{extras:t}})})["catch"](function(){r({type:n.GET_EXTRAS_ERROR})})}},clearAll:function(){return{type:n.CLEAR_ALL}}}}]);


"use strict";angular.module("app.booking").service("InsuranceActions",["INSURANCE_ACTION_TYPES","ngFolktale","RezApiConfig","$log","BasketMessageQueue","ModelQuery","$ngRedux","TotalHeaderActions","$http","$q","Dates","CARD_CODES","AllPlaces","$injector","BookingRead",function(e,t,n,r,a,o,u,i,c,d,s,E,p,f,_){var O=function(e){return s.formatISO(s.parse(e))},l=function(e,t){return R.pipe(o.byIdentity("addons"),o.byModel({code:"INS",sold:!1}),o.byLocal(!0),o.byRemoved(!1))(e).map(function(e){var n=R.pathOr(-1,["model","paxNum"],e),r=R.pathOr("",["model","itemId"],e),a=R.pathOr([],[n],t),o=a.find(function(e){return e.code===r}),u={paxNum:n,offerKey:o.offerKey,skuKey:o.skuKey},i=R.path(["model","start"],e);return"ANNUAL2"===o.code&&""!==i&&(u.annualInsuranceStartDateTime=O(i)),u})},S=function(e,t){return R.pipe(R.path(["passengers"]),R.map(function(e){return e.key.id}),R.map(function(t){var n=e.find(function(e){return e.paxNum===t});return n?n:{paxNum:t,offerKey:"",skuKey:"",annualInsuranceStartDateTime:""}}))(t)},m=function(){return{type:e.CLEAR}},y=function(t){var n=R.pipe(o.byIdentity("addons"),o.byModel({code:"INS"}),o.byLocal(!0))(u.getState().bookingModel),r=R.pathOr(t,["0","model","src"],n),a=R.pathOr([],["bookingModel","passengers"],u.getState()),i=R.pathOr(0,["0","model","paxNum"],n),c=new Array(a.length).fill(!1);return c[i]=!0,{type:e.SAME_INSURANCE_COR,passengers:a,cor:r,paxHavePackage:c}},N=function(t){return{type:e.SET_PAX_HAVE_PACKAGE,forPax:t}},A=function(){return function(t){return t({type:e.FETCH_COUNTRIES_START}),c({method:"GET",url:n.insuranceCountries}).then(function(n){t({type:e.FETCH_COUNTRIES_SUCCESS,countries:n.data})})["catch"](function(n){t({type:e.FETCH_COUNTRIES_ERROR,payload:{error:n}})})}},g=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"IE",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!0;return function(i){i({type:e.FETCH_OFFERS_FOR_PASSENGER_START,paxnum:o,country:a,updateCORs:u}),t.$http({method:"GET",url:n.insurance,params:{country:a,paxnum:o}}).map(function(e){return R.path(["data","0","offers"],e)}).fork(function(t){r.error(e.FETCH_OFFERS_FOR_PASSENGER_ERROR,": ",t),i({type:e.FETCH_OFFERS_FOR_PASSENGER_ERROR})},function(t){i({type:e.FETCH_OFFERS_FOR_PASSENGER_SUCCESS,paxnum:o,offer:t})})}},C=function(t){var r=t.countryCode,a=void 0===r?"IE":r,o=t.updateCORs,u=void 0===o?!0:o;return function(t){return t({type:e.FETCH_OFFERS_FOR_ALL_PASSENGERS_START}),c({method:"GET",url:n.insurance,params:{country:a}}).then(function(n){var r=n.data,o=R.reduce(function(e,t){var n=t.offers;return R.append(n,e)},[],r);t({type:e.FETCH_OFFERS_FOR_ALL_PASSENGERS_SUCCESS,payload:{offersForPax:o,countryCode:a,updateCORs:u}})})["catch"](function(){t({type:e.FETCH_OFFERS_FOR_ALL_PASSENGERS_ERROR})})}},I=function(){return function(t,r){t({type:e.ADD_TO_BOOKING_MODEL_START});var o=r(),u=o.bookingModel,d=o.insurance,s=R.pathOr({},["offersForPax"],d),p=l(u,s),_=n.insurance,O=void 0;return R.isEmpty(p)?O=c({method:"DELETE",url:_}):(p=S(p,u),O=c({method:"POST",url:_,data:p})),O.then(function(n){var r=n.data,o=R.filter(R.whereEq({code:"INS"}),r);t(i.showExtrasInfo({totalCount:r.reduce(function(e,t){return e+t.qty},0),text:"trips.header.title.extras_INS"})),t({type:e.ADD_TO_BOOKING_MODEL_SUCCESS,payload:o,meta:{analytics:{event:"rynProductTrack",action:"UPDATE",type:E.INSURANCE,identity:"addons"}}});var u=f.get("PromotionActions");t(u.productAddedNotification({productAdded:E.INSURANCE})),a.enqueue({code:"INSURANCE_UPDATED",price:r.reduce(function(e,t){return e+t.total},0),numberOfItems:r.length})})["catch"](function(n){t({type:e.REMOVE_FROM_BOOKING_MODEL_ERROR,error:n})})}},T=function(r){return function(a){var i=d.defer(),c=function(t){a({type:e.REMOVE_FROM_BOOKING_MODEL_ERROR,error:t}),i.reject()},s=function(){a({type:e.REMOVE_FROM_BOOKING_MODEL_SUCCESS,forType:r,meta:{analytics:{event:"rynProductTrack",action:"REMOVE",type:E.INSURANCE,identity:"addons"}}}),i.resolve()};if(a({type:e.REMOVE_FROM_BOOKING_MODEL_START}),r){var p=R.pipe(o.byIdentity("addons"),o.byModel({code:"INS",sold:!1,itemId:r}))(R.path(["bookingModel"],u.getState())).map(function(e){return R.path(["model","paxNum"],e)});R.traverse(t.Task.of,function(e){return t.$http({method:"DELETE",url:n.insurance,params:{paxnum:e}})},p).fork(c,s)}else t.$http({method:"DELETE",url:n.insurance}).fork(c,s);return i.promise}},h=function(){return{type:e.DRAWER_CLOSED}},D=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{type:e.ADD_INSURANCE,payload:{paxNum:t,insurance:n}}},v=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return{type:e.REMOVE_INSURANCE,payload:{paxNum:t}}},F=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.offerKey,a=n.skuKey,o=n.code,u=n.price,i=n.start,c="ANNUAL2"===o&&i?{annualInsuranceStartDateTime:O(i)}:void 0;return{type:e.ADD_SELECTED_INSURANCE,payload:{paxNum:t,insurance:babelHelpers["extends"]({paxNum:t,offerKey:r,skuKey:a,price:u},c)}}},M=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return{type:e.REMOVE_SELECTED_INSURANCE,payload:{paxNum:t}}},U=function(){return function(t,r){t({type:e.ADD_TO_BOOKING_MODEL_START});var o=r(),u=o.bookingModel,d=o.insurance,s=void 0,p=R.prop("selectedOffers",d),_=n.insurance;return R.isEmpty(p)?s=c({method:"DELETE",url:_}):(p=S(p,u),s=c({method:"POST",url:_,data:p})),s.then(function(n){var r=n.data,o=R.filter(R.whereEq({code:"INS"}),r);t(i.showExtrasInfo({totalCount:r.reduce(function(e,t){return e+t.qty},0),text:"trips.header.title.extras_INS"})),t({type:e.ADD_TO_BOOKING_MODEL_SUCCESS,payload:o,meta:{analytics:{event:"rynProductTrack",action:"UPDATE",type:E.INSURANCE,identity:"addons"}}});var u=f.get("PromotionActions");t(u.productAddedNotification({productAdded:E.INSURANCE})),a.enqueue({code:"INSURANCE_UPDATED",price:r.reduce(function(e,t){return e+t.total},0),numberOfItems:r.length})})["catch"](function(n){t({type:e.ADD_TO_BOOKING_MODEL_ERROR,error:n})})}},P=function(t){return function(n){p.findOne("category","airport",t).then(function(t){n({type:e.ADD_COR_BY_FLIGHT_ORIGIN,payload:t})})}},L=function(){return function(t,n){var r=n(),a=r.bookingModel,o=_.getAllAddonsByCode("INS",a).map(function(e){return e.model});t({type:e.ADD_TO_BOOKING_MODEL_SUCCESS,payload:o,meta:{analytics:{event:"rynProductTrack",action:"UPDATE",type:E.INSURANCE,identity:"addons"}}})}},k=function(){return function(t){t({type:e.MAKE_CHOICE})}},x=function(){return function(t){t({type:e.UNMAKE_CHOICE})}};return{clear:m,sameCountry:y,setPaxHavePackage:N,getCountries:A,getOffer:g,getOfferForAllPassengers:C,updateInsurance:I,removeAllInsurance:T,drawerClosed:h,addInsuranceFor:D,removeInsuranceFor:v,addSelectedInsuranceFor:F,removeSelectedInsuranceFor:M,confirmSelectedInsurance:U,getFlightOriginInsuranceCountry:P,refreshSelectedInsurance:L,makeChoice:k,unmakeChoice:x}}]);


"use strict";angular.module("app.booking").factory("LockFareActions",["LOCK_FARE_ACTION_TYPES","RezApiConfig","ngFolktale","$ngRedux","$http","$state","BookingModelActions","DialogManager","Flatnmap","FlatmapMaps",function(t,n,o,e,a,r,c,i,p,u){var _=function(t,n){return R.pipe(R.pathOr([],["bookingModel",t]),R.length)(n)},l=function(t){return a.post(n.hold,'"'+t+'"')},g={getLockFarePrices:function(){return function(o){o({type:t.FETCH_PRICES_START}),a.get(n.hold).then(function(n){var a=n.data[0];o({type:t.FETCH_PRICES_SUCCESS,payload:{lockInfo:a,totalPrice:a.segSsrs.reduce(function(t,n){return t+n.total},0)*_("passengers",e.getState())}})})["catch"](function(n){o({type:t.FETCH_PRICES_ERROR,payload:n.data})})}},confirm:function(n){return function(o){o({type:t.ADD_TO_BOOKING_MODEL_START}),l(n).then(function(n){o({type:t.ADD_TO_BOOKING_MODEL_SUCCESS,payload:p.normalize(u.postSsr,n.data)}),r.go("booking.payment")})["catch"](function(){o({type:t.ADD_TO_BOOKING_MODEL_ERROR})})}}};return g}]);


"use strict";angular.module("app.booking").service("ManageTripsActions",["MANAGE_TRIPS_ACTION_TYPES","Flatnmap","FlatmapMaps",function(o,e,n){return{requestForBookingModelUpdates:function(e){return{type:o[e]}},updateBookingModel:function(t,a){return{type:o[a],payload:e.normalize(n.bookingModel,t)}}}}]);


"use strict";angular.module("app.booking").service("PriorityBoardingActions",["PRIORITY_BOARDING_ACTIONS_TYPES","BasketMessageQueue","BookingRead","$http","RezApiConfig","PriorityBoardingUtil","AEMConfig","Flatnmap","FlatmapMaps","ModelQuery","SEATS_ACTION_TYPES","Dates","DateConfig","FlightExtras","LEG_TYPE","$q","CARD_CODES","$injector","PB_BUTTON_TYPES","Session",function(e,t,n,r,o,a,i,u,s,p,l,y,d,c,f,m,g,A,_,S){var T=function(e){return n.isReturnTrip(e)?e.passengers.length>1?"trips.potential.pb.pax_count_return_trip":"trips.potential.pb.one_pax_return_trip":e.passengers.length>1?"trips.potential.pb.pax_count_one_way_trip":"trips.potential.pb.one_pax_one_way_trip"},h=function(e,r,o){var i=R.differenceWith(function(e,t){return R.equals(e.key,t.key)},r,o);t.enqueue({code:"PRIORITY_BOARDING",qty:R.pluck("model")(a.getPriorityBoardingItems(e)).filter(function(e){return"PS"===e.code}).length,passengerCount:n.getPriorityBoardingPaxCount({ssrs:i}),isReturn:n.isReturnTrip(e),additionalMessageInfo:T(e)})},E=function(e){return{model:{sold:!1,isPartOfBundle:!1,type:g.PRIOBRDNG,code:"PS",qty:1,vat:0,amt:e.amount||e.total,total:e.total},key:{passengers:e.passengerNum,journeys:e.journeyNum,segments:0},identity:"ssrs",local:e.local}},P=function(e){return R.pipe(n.getPriorityBoardingItems(!1),p.byKey(e))},v=function(e,t){var n=o.priorityBoardingCard,a=void 0;return"number"==typeof e&&(a={journeyNum:e}),"number"==typeof t&&(a.paxNum=t),r["delete"](n,{params:a})},I=function(e){return function(t,n){return v(t,n).then(function(t){return e.push(t)})}},O=function(e,t,n){return R.pipe(P({journeys:n}),R.length,R.equals(t.length))(e)},b=function(e,t){var n=[];if(!e)return r["delete"](v());var o=function(t){return p.byKey({journeys:t})(e)},a=I(n),i=function(e){var n=R.path(["key","journeys"],R.head(e));return O(t,e,n)?a(n):e.map(function(e){return a(e.key.journeys,e.key.passengers)})},u=[f.outbound,f.inbound].map(o).filter(function(e){return e.length}).map(i);return m.all(R.flatten(u)).then(function(){return R.last(n)})},N=function(e,t){return e.reduce(function(e,n){var r=R.pipe(p.byKey({passengers:R.path(["key","passengers"],n),journeys:R.path(["key","journeys"],n)}),p.byModel({code:"BUND"}),R.length)(t.ssrs),o=R.pipe(p.byKey({passengers:R.path(["key","passengers"],n),journeys:R.path(["key","journeys"],n)}),p.byModel({type:"PRIOBRDNG"}),R.length)(t.ssrs);return r&&o?e:[].concat(babelHelpers.toConsumableArray(e),[n])},[])},C=function(){return function(t,i){var y=i(),d=y.bookingModel;t({type:e.ADD_ALL_START});var c=a.getAddAllPayload(d.segments,d.passengers);return r.post(o.priorityBoardingCard,c).then(function(r){var o=r.data,a=R.pipe(u.normalize(s.postSsr),R.pathOr([],["ssrs"]),p.byModel({sold:!1}))(o),y=n.getPriorityBoardingItems(!1)(d),c=R.pipe(n.getIncludedPriorityBoardingItems,p.byModel({sold:!1}))(d),f=R.unionWith(R.eqProps("key"),a,c);t({type:e.ADD_ALL_SUCCESS,payload:{priority:f},meta:{analytics:{event:"rynProductTrack",action:"ADD",type:g.PRIOBRDNG,identity:"ssrs"}}});var m=A.get("PromotionActions");t(m.productAddedNotification({productAdded:g.PRIOBRDNG})),i().seats.changeSeatsMode&&t({type:l.CHANGED_SEAT_ADDED_PRIORITY_SUCCESS}),h(i().bookingModel,f,y)})["catch"](function(n){t({type:e.ADD_ALL_ERROR,payload:n})})}},k=function(){return function(t,a){return t({type:e.REMOVE_ALL_START}),r["delete"](o.priorityBoardingCard).then(function(r){var o=r.data,i=R.pathOr([],["ssrs"],u.normalize(s.postSsr,o)),p=n.getPriorityBoardingItems(!1)(a().bookingModel);t({type:e.REMOVE_ALL_SUCCESS,meta:{analytics:{event:"rynProductTrack",action:"REMOVE",type:g.PRIOBRDNG,identity:"ssrs"}}}),h(a().bookingModel,i,p)})["catch"](function(n){t({type:e.REMOVE_ALL_ERROR,payload:n})})}},B=function(e,t,r,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=n.getCities(t),s=o.map(function(n){var o=R.or(R.pipe(p.byIdentity("ssrs"),p.byModel({type:g.PRIOBRDNG,sold:!1,isPartOfBundle:!1}),p.byKey({journeys:n.key.id}),p.hasAny)(t),R.contains(n.ctaState,["remove","modify"])),s=1===r.length?"remove":"modify",l=R.pipe(R.length,R.gt(R.__,1)),c=function(e,t){return function(n){var r=R.find(function(n){return R.pathOr([],["dscAppliesTo"],n).some(function(n){return n.journeyNum===t.key.id&&n.paxNum===e.key.id})})(n);if(!r){var o=n.filter(function(t){return t.paxType===e.model.type});return{price:R.pathOr(0,[t.key.id,"price"],o)}}return r}};return{passengers:r.map(function(t){return{price:R.pipe(R.filter(function(e){return e.paxType===t.model.type}),R.ifElse(l,c(t,n),R.head),R.path(["price"]))(e),paxType:t.model.type,num:t.key.id,name:t.model.name,defaultName:"trips.extra.baby_"+t.model.type+"_title",typeEnum:t.model["enum"],hasInf:!!t.model.inf}}),journeyNum:n.key.id,airport:u[n.key.id],flightDate:y.format(y.utc(n.model.depart),d.displayFormats.activeFromTo),ctaState:o?s:"add",isAvailable:a.isAvailable(n.key.id,t),isPBAvailable:a.isPBAvailable(n.key.id,i)}}).map(function(e){return babelHelpers["extends"]({},e,{total:Math.min.apply(Math,babelHelpers.toConsumableArray(e.passengers.map(function(e){return e.price})))})});return s},D=function(t,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!1;return function(a,i){var u=i(),s=u.bookingModel,p=u.flightExtras,l=u.priorityBoarding,y=n.getAllpriorityBoardingItems(s);if(a({type:e.GET_PRICES_START}),!o){var d=n.isPotentialBooking(s);return c.getExtras([g.PRIOBRDNG],{isPotential:d}).then(function(o){var i=R.pipe(R.find(R.propEq("code",g.PRIOBRDNG)),R.pathOr([],["details"]),R.map(function(e){return babelHelpers["extends"]({},e,{paxType:n.changeStaffPaxType(e.paxType)})}))(o),u=R.find(R.propEq("code",g.PRIOBRDNG))(o);return a({type:e.GET_PRICES,payload:{prices:B(i,s,t,r,u),items:y}})})}var f=l.prices;y=i().priorityBoarding.ssrs;var A=R.pipe(R.pathOr([],["extras"]),R.find(R.propEq("code",g.PRIOBRDNG)),R.pathOr([],["details"]))(p),_=r.reduce(function(e,t){var n=f.find(function(e){return t.key.journey===e.journeyNum&&e.ctaState});return n?e.concat(babelHelpers["extends"]({},t,{ctaState:n.ctaState})):e.concat(t)},[]);return a({type:e.GET_PRICES,payload:{prices:B(A,s,t,_),items:y}}),m.when()}},L=function(t,n,r){return function(o){var a=E({passengerNum:n,journeyNum:t,total:r,local:!0});o({type:e.ADD_SELECTED,payload:{paxNum:n,leg:t,item:babelHelpers["extends"]({},a,{local:!0})}}),o({type:e.SET_CTA_STATUS,payload:{legs:[t],state:"remove"}})}},j=function(t,n){return function(r){r({type:e.REMOVE_SELECTED,payload:{paxNum:n,leg:t}}),r({type:e.SET_CTA_STATUS,payload:{legs:[t],state:"add"}})}},M=function(t,r,o,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:!1;return function(u,s){var p=[],l=t.filter(function(e){return e.allBtnType===_.ADD_ALL||"modify"!==e.ctaState&&"remove"!==e.ctaState});if(r&&!i)p=R.flatten(l.map(function(e){return e.passengers.map(function(t){return E({passengerNum:t.num,journeyNum:e.journeyNum,total:t.price,local:!0})})}));else if(o)p=R.flatten(o.map(function(e){return e.passengers.filter(function(e){return!e.isSelected&&!e.isSold&&!e.isIncluded}).map(function(e){return E({passengerNum:e.num,journeyNum:e.journeyNum,total:R.pipe(R.find(function(t){return t.journeyNum===e.journeyNum}),R.pathOr([],["passengers"]),R.find(function(t){return t.num===e.num}),R.pathOr([],["price"]))(t),local:!0})})}));else if(i){var y=s(),d=y.priorityBoarding,c=y.bookingModel,f=function(e){return d.ssrs.filter(function(t){return t.key.journeys===e}).map(R.path(["key","passengers"]))};p=R.pipe(n.filterUnavailableJourneys,R.map(function(e){var n=function(e){return R.filter(function(t){return!R.contains(t.key.id,f(e))},c.passengers)};return R.map(function(n){return E({passengerNum:n.key.id,journeyNum:e.model.journeyNum,total:R.pipe(R.find(function(e){return e.journeyNum===a}),R.pathOr([],["passengers"]),R.find(function(e){return e.num===n.key.id}),R.pathOr([],["price"]))(t)})})(n(e.key.id))}),R.flatten)(c)}else if(null!==a&&!i){var m=s(),g=m.priorityBoarding,A=m.bookingModel.passengers,S=g.ssrs.filter(function(e){return e.key.journeys===a}).map(R.path(["key","passengers"]));p=A.filter(function(e){return!R.contains(e.key.id,S)}).map(function(e){return E({passengerNum:e.key.id,journeyNum:a,total:R.pipe(R.find(function(e){return e.journeyNum===a}),R.pathOr([],["passengers"]),R.find(function(t){return t.num===e.key.id}),R.pathOr([],["price"]))(t)})})}u({type:e.ADD_ALL_LOCAL,payload:{items:p.map(function(e){return babelHelpers["extends"]({},e,{local:!0})})}}),u({type:e.SET_CTA_STATUS,payload:{legs:l.map(function(e){return e.journeyNum}),state:r?"remove":"modify"}})}},x=function(t,n){return function(r){var o=t.filter(function(e){return"remove"===e.ctaState||"modify"===e.ctaState});r({type:e.REMOVE_ALL_LOCAL,payload:{journeyNum:n}}),r({type:e.SET_CTA_STATUS,payload:{legs:o.map(function(e){return e.journeyNum}),state:"add"}})}},G=function(t,n){return function(r,o){var a=R.path(["priorityBoarding","prices"],o()),i=t.filter(function(e){return e.isSelected&&!e.isSold&&!e.isIncluded}).map(function(e){return E({passengerNum:e.num,journeyNum:e.journeyNum,total:R.pipe(R.find(function(t){return t.journeyNum===e.journeyNum}),R.pathOr([],["passengers"]),R.find(function(t){return t.num===e.num}),R.pathOr([],["price"]))(a),local:!0})});r({type:e.UPDATE_LOCAL,payload:{items:i,journeyNum:n}}),r({type:e.SET_CTA_STATUS,payload:{legs:[n],state:i.length?"modify":"add"}})}},F=function(){return{type:e.RESET}},U=function(){return{type:e.RESET_OFFERS}},Y=function(){return{type:e.EMPTY}},q=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.isCheckInFlow,l=void 0===i?!1:i;return function(t,i){var y=i(),d=y.priorityBoarding,c=y.bookingModel,f=y.flightExtras,_=a.getPayloadForSsrs(d.ssrs),S=a.getRemovedPriorityBoardings(d,c);return _.length>0||S.length>0?(t({type:e.ADD_ALL_START}),m.all([_.length>0?r.post(o.priorityBoardingCard+"?IsCheckInFlow="+l,_):null,b(S,c)]).then(function(r){r.forEach(function(r){if(r&&r.data){var o=r.data,l=a.setDiscountInPayload(f,o),y=R.pipe(n.getIncludedPriorityBoardingItems,p.byModel({sold:!1}))(c),d=n.getPriorityBoardingItems(!1)(c),m=R.pipe(u.normalize(s.postSsr),R.pathOr([],["ssrs"]),p.byModel({sold:!1}))(l),_=R.unionWith(R.eqProps("key"),m,y),S=N(_,c);t({type:e.ADD_ALL_SUCCESS,payload:{priority:S},meta:{analytics:{event:"rynProductTrack",action:"ADD",type:g.PRIOBRDNG,identity:"ssrs"}}});var T=A.get("PromotionActions");t(T.productAddedNotification({productAdded:g.PRIOBRDNG})),h(i().bookingModel,S,d)}})})["catch"](function(n){t({type:e.ADD_ALL_ERROR,payload:n})})):m.when()}},H=function(t,r,o){return function(a,i){var u=i(),s=u.priorityBoarding,p=u.bookingModel,l=u.bookingModel.passengers,y=R.pipe(R.filter(R.pathEq(["key","journeys"],r)),R.map(R.path(["key","passengers"])))(s.ssrs),d=R.pipe(n.getPriorityBoardingItems(!0),R.filter(R.pathEq(["key","journeys"],r)),R.map(R.path(["key","passengers"])),R.union(y))(p),c=R.pipe(R.filter(function(e){return!R.contains(e.key.id,d)&&R.contains(e.key.id,o)}),R.map(function(e){return E({passengerNum:e.key.id,journeyNum:r,total:t,local:!0})}))(l);a({type:e.ADD_ALL_LOCAL,payload:{items:c}})}},V=function(t){return function(n){n({type:e.REMOVE_ALL_LOCAL,payload:{journeyNum:t}})}},w=function(){return function(t,n){var r=n(),o=r.bookingModel,i=a.isPriorityAndCabinBagsCampaignLaunched(R.prop("journeys",o));t({type:e.SET_CAMPAIGN_AVAILABILITY,payload:{isCampaignAvailable:i}})}},J=function(t){return function(n){n({type:e.UPDATE_CAMPAIGN_SEEN_STATUS,payload:{isCampaignSeen:t}})}},K=function(){return function(t){return r.get(o.priorityBoardingCard).then(function(n){var r=n.data;t({type:e.GET_OFFERS_SUCCESS,payload:r})})["catch"](function(n){t({type:e.GET_OFFERS_FAIL,payload:n})})}},z=function(t){return function(n){n({type:e.SET_CONTINUE_BUTTON_AVAILABILITY,payload:{isEnabled:t}})}},W=function(){return function(t,a){var i={codes:"PRIOBRDNG",partialAvailability:!0,isPotential:n.isPotentialBooking(a().bookingModel),session:S.getSessionStorage("ryanair:token")};return r.get(o.extras+"?IsCheckInFlow=false",{params:i}).then(function(n){var r=n.data,o=R.pathOr([],["0","availableForSegments"],r),a=R.pathOr({},["0","minPrice"],r),i={value:R.pathOr(0,["0","dsc"],r),type:R.pathOr("RegularDiscount",["0","discountType"],r),originalPrice:R.pathOr(a,["0","details","0","originalPrice"],r)},u=o.reduce(function(e,t){return[].concat(babelHelpers.toConsumableArray(e),[babelHelpers["extends"]({},t,{minPrice:a,discount:i})])},[]);return t({type:e.GET_PRIORITY_AVAILABILITY,payload:u})})["catch"](function(n){t({type:e.GET_PRIORITY_AVAILABILITY_ERROR,payload:n.data})})}},$=function(){return function(t){return t({type:e.RESET_PRIORITY_AVAILABILITY})}},Q=function(){return function(t){return r.get(i.getBookingFlowCardsConfigUrl()).then(function(n){var r=n.data;t({type:e.FETCH_CARDS_CONFIG_SUCCESS,payload:r})})["catch"](function(n){t({type:e.FETCH_CARDS_CONFIG_ERROR,payload:n})})}},X=function(){return function(t){return t({type:e.UPDATE_BUTTON_TYPE_AND_STATUS})}};return{addAll:C,removeAll:k,getPrices:D,addToJourney:L,removeFromJourney:j,addAllLocal:M,removeAllLocal:x,updateLocal:G,resetPriorityBoardings:F,resetPriorityOffers:U,post:q,emptyStore:Y,addAllForSelectedJourneyAndPax:H,removeAllForSelectedJourney:V,setCampaignAvailability:w,updateCampaignStatus:J,getPriorityBoardingOffers:K,setContinueButtonAvailability:z,getPriorityAvailability:W,resetPriorityAvailability:$,getP2cbCardsConfig:Q,updateButtonTypeAndStatus:X}}]);


"use strict";angular.module("app.booking").service("SamsoniteActions",["$http","RezApiConfig","SAMSONITE_ACTION_TYPES","$state","Flatnmap","FlatmapMaps",function(e,t,n,o,a,r){var c=function(e){return R.pipe(R.keys,R.map(function(t){return{Code:t,Quantity:e[t].qty}}))(e)},i=function(e,t,o){var c=a.normalize(r.bookingModel,t);e({type:n.POST_SAMSONITE_SUCCESS,payload:{extras:a.normalize(r.postExtras,t).extras||[],info:c.info,passengers:c.passengers,serverTimeUTC:c.serverTimeUTC,codesToRemove:o}})},s=function(e,t){return R.filter(function(e){var n=e.model,o=n.code,a=n.qty;return R.contains(o,t)&&a},e)};return{getAvailableBags:function(){return function(o,a){o({type:n.GET_AVAILABLE_BAGS_START}),e.get(t.samsonite).then(function(e){var t=e.data,r={},c=R.pathOr("",["bags",0,"currency"],t),i=R.pathOr([],["bookingModel","extras"],a()),u=R.pathOr([],["samsonite","codes"],a());t.bags.forEach(function(e){r[e.code]={name:e.name,price:e.price,currency:e.currency,code:e.code,qty:0}}),s(i,u).forEach(function(e){r[e.model.code].qty+=e.model.qty}),o({type:n.GET_AVAILABLE_BAGS_SUCCESS,payload:{bagsInfo:r,currency:c}})})["catch"](function(e){o({action:n.GET_AVAILABLE_BAGS_ERROR,payload:{err:e}})})}},updateSelectedBags:function(e){var t=e.code,o=e.count;return function(e){return e({type:n.UPDATE_SELECTED_BAGS,payload:{code:t,qty:o}})}},postSamsonite:function(){return function(a,r){a({type:n.POST_SAMSONITE_START});var s=r().samsonite,u=c(s.bagsInfo);e.post(t.samsonite,u).then(function(e){var t=e.data;i(a,t,s.codes),o.go("samsonite.payment")})["catch"](function(e){return a({type:n.POST_SAMSONITE_SUCCESS,payload:{err:e}})})}},removeSamsonite:function(o){return function(a,r){a({type:n.REMOVE_SAMSONITE_START});var c=r(),s=c.bookingModel,u=c.samsonite,p=R.pipe(R.path(["extras"]),R.pluck("model"),R.filter(function(e){return u.codes.indexOf(e.code)>-1&&e.code!==o}))(s),S=u.codes.map(function(e){return{Code:e,Quantity:R.pipe(R.map(function(t){return t.code!==e?0:t.qty}),R.reduce(R.add,0))(p)}}),d=function(){a({type:n.REMOVE_SAMSONITE_SUCCESS,payload:{codesToRemove:u.codes}})},E=function(e){a({type:n.REMOVE_SAMSONITE_ERROR,payload:{err:e}})};p.length>0?e.post(t.samsonite,S).then(function(e){var t=e.data;return i(a,t,u.codes)})["catch"](E):e["delete"](t.samsonite).then(d)["catch"](E)}},clearAllSamsoniteBags:function(){return function(o,a){var r=R.pathOr([],["samsonite","codes"],a());o({type:n.REMOVE_SAMSONITE_START}),e["delete"](t.samsonite).then(function(){o({type:n.REMOVE_SAMSONITE_SUCCESS,payload:{codesToRemove:r}})})["catch"](function(e){o({type:n.REMOVE_SAMSONITE_ERROR,payload:{error:e}})})}}}}]);


"use strict";angular.module("app.booking").service("SpecialAssistanceActions",["SPECIAL_ASSISTANCE_ACTION_TYPES","ModelQuery","SpecialAssistanceUtils","SpecialAssistanceType","MANAGE_TRIPS_ACTION_TYPES","Flatnmap","FlatmapMaps","BookingRead",function(e,s,n,a,r,t,i,o){var c=R.addIndex(R.map),p=c(function(e,s){return e.map(function(e,n){return{model:e,key:{passengers:s,journeys:n}}})}),l=function(e,s,n,a){var r=o.getSegmentsFor(e.number,a);return"outbound"===e.type&&0===n&&s&&(r=r.concat(o.getSegmentsFor(e.number+1,a))),0!==n&&(r=r.filter(function(s){return s.key.journeys===e.number&&s.key.id===n})),r};return{mapBookingModelToSA:function(r,t){var i=r.areAllFlightsDepartureDatesNear,o=R.pipe(p,R.flatten)(r),c=R.map(function(e){return t.journeys.reduce(function(n,a){return n.concat(s.byKey({journeys:a.key.id})(t.segments).map(function(s){return{key:{passengers:e.key.id,journeys:a.key.id,segments:s.key.id},model:{}}}))},[])}),l=R.map(function(e){var r=angular.copy(e),i=s.byKey({passengers:e.key.passengers,journeys:e.key.journeys,segments:e.key.segments})(t.segPrm);if(i.length){var c=o.find(function(s){return s.key.passengers===e.key.passengers&&s.key.journeys===e.key.journeys}),p=i.map(function(e){return e.model.code}),l=n.getSpecialAssistanceFromModel(p,c),u=n.getWheelchairFromModel(p,c)||{code:""},y=p.length>=3,d=l&&y?n.getNestedSpecialAssistance(p,l):{code:""};r.model={assistanceType:l,wheelchairSelector:{wheelchairType:u,assistanceType:d},wheelchairRequired:!!u.code}}else{var g=R.pipe(s.byKey({passengers:e.key.passengers}),R.isEmpty(),R.not())(t.segPrm);r.model={assistanceType:g?babelHelpers["extends"]({},a.NotRequired):{code:""},wheelchairSelector:{assistanceType:{code:""},wheelchairType:{code:""}},wheelchairRequired:!1}}return r}),u=R.pipe(c,R.flatten,l)(t.passengers),y=R.map(function(e){return{key:{passengers:e.key.id},model:!!R.pipe(s.byKey({passengers:e.key.id}),R.path([0,"model","assistanceType","code"]))(u)}}),d=R.pipe(s.byIdentity("passengers"),y)(t);return{type:e.SET_SPECIAL_ASSISTANCE_STORE_VALUES,payload:{SARequired:d,prms:u,assistanceAvailability:o,areAllFlightsDepartureDatesNear:i}}},toggleIsRequired:function(s){return{type:e.TOGGLE_SA_REQUIRED_VALUE,payload:{pax:s}}},selectSpecialAssistance:function(a,r,t,i){return function(o,c){var p=c().specialAssistance.assistanceAvailability,u=s.byKey({passengers:r,journeys:t.number}),y=s.byKey({passengers:r,journeys:t.number+1}),d=R.path([0,"model"]),g=R.pipe(u,d)(p),m=R.pipe(y,d)(p),A=n.getSpecialAssistance([a],g),S=l(t,m,i,c().bookingModel);o({type:e.SELECT_SPECIAL_ASSISTANCE,payload:S.map(function(e){return{assistance:A,pax:r,flight:e.key.journeys,segment:e.key.id}})})}},selectWheelchair:function(n){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments[2],t=arguments[3],i=arguments[4];return function(o,c){var p=c().specialAssistance.assistanceAvailability,u=s.byKey({passengers:r,journeys:t.number+1}),y=R.path([0,"model","wheelchair"]),d=R.pipe(u,y)(p),g=a.wheelchairType,m=a.assistanceType,A=l(t,d,i,c().bookingModel);o({type:e.SELECT_WHEELCHAIR,payload:A.map(function(e){return{isRequired:n,wheelchairType:g,assistanceType:m,pax:r,flight:e.key.journeys,segment:e.key.id}})})}},handleSpecialAssistanceError:function(s){return function(n,a){if("PRMLimitBreached"===s.message){var r=a().specialAssistance.assistanceAvailability;s.details.forEach(function(s){var a=r.filter(function(e){return e.key.journeys===s.segment&&e.key.passengers>=s.remaining});n({type:e.SET_ASSISTANCE_AVAILABILITY_CODES,payload:{filteredAssistances:a,code:"PRMNotAvailable",isUnavailable:!0,assistanceCode:s.nest}})})}}},updateBookingModel:function(e){var s=t.normalize(i.bookingModel,e);return s.segPrm||(s.segPrm=[]),{type:r.SPECIAL_ASSISTANCE_UPDATE_SUCCESS,payload:s}}}}]);


"use strict";angular.module("app.booking").service("VoucherActions",["VOUCHER_ACTION_TYPES","$http","RezApiConfig","VoucherDetails","Currency","Flatnmap","FlatmapMaps",function(e,n,t,a,o,r,u){return{reset:function(){return{type:e.RESET}},createSession:function(n){return function(t){t({type:e.SELECT_VOUCHER_START}),a.createVoucherSession(n).then(function(n){var a=n.data;o.set("vmCurrency",R.path(["info","curr"],a)),t({type:e.SELECT_VOUCHER_SUCCESS,payload:r.normalize(u.bookingModel,a)})})["catch"](function(n){t({type:e.SELECT_VOUCHER_ERROR,payload:n})})}},redeem:function(a,o,c){return function(E){return E({type:e.REDEEM_VOUCHER_START}),n.put(t.voucher,{voucherRef:a,passengers:{passengers:o},customerId:c}).then(function(n){var t=n.data,a=t;return angular.isUndefined(a.accNum)&&Object.assign(a,{accNum:t.accountNumber,amt:t.amount}),E({type:e.REDEEM_VOUCHER_SUCCESS,payload:r.normalize(u.bookingModel,{payments:[a]})})})["catch"](function(n){E({type:e.REDEEM_VOUCHER_ERROR,payload:n.data})})}},useReward:function(a,o,c){return function(E){E({type:e.USE_REWARD_VOUCHER_START}),n.put(t.myryanairvoucher,{passengers:o,voucherId:a,customerId:c}).then(function(n){var t=n.data,a=t;angular.isUndefined(a.accNum)&&Object.assign(a,{accNum:t.accountNumber,amt:t.amount}),E({type:e.USE_REWARD_VOUCHER_SUCCESS,payload:r.normalize(u.bookingModel,{payments:[a]})})})["catch"](function(n){E({type:e.USE_REWARD_VOUCHER_ERROR,payload:n.data})})}},remove:function(a){return function(o){return o({type:e.REMOVE_VOUCHER_START}),n["delete"](t.voucher,{params:{voucherRef:a}}).then(function(){return o({type:e.REMOVE_VOUCHER_SUCCESS,payload:a})})["catch"](function(n){o({type:e.REMOVE_VOUCHER_ERROR,payload:n.data})})}}}}]);


"use strict";angular.module("app.booking").constant("BAGS_ACTION_TYPES",{FETCH_OFFERS_START:"[Bags] fetching offers start",FETCH_OFFERS_SUCCESS:"[Bags] fetch offers success",FETCH_OFFERS_ERROR:"[Bags] fetch offers error ",UPDATE_TO_BOOKING_MODEL_START:"[Bags] update booking model start",UPDATE_TO_BOOKING_MODEL_SUCCESS:"[Bags] update booking model success",UPDATE_TO_BOOKING_MODEL_ERROR:"[Bags] update booking model error",ADD_BAG:"[Bags] add selected bag",ADD_BAG_UPGRADE:"[Bags] add selected bag upgrade",REMOVE_BAG:"[Bags] remove selected bag",REMOVE_BAGS:"[Bags] remove selected bags",REMOVE_BAG_UPGRADE:"[Bags] remove selected bag upgrade",REMOVE_ALL_BAG_BY_CODE_START:"[Bags] remove all bags by code start",REMOVE_ALL_BAG_BY_CODE_SUCCESS:"[Bags] remove all bags by code success",REMOVE_ALL_BAG_BY_CODE_ERROR:"[Bags] remove all bags by code error",QUICK_ADD_START:"[Bags] quick add bags start",QUICK_ADD_SUCCESS:"[Bags] quick add bags success",QUICK_ADD_ERROR:"[Bags] quick add bags error",RESET_BAGS:"[Bags] reset bags state",ADD_DISCOUNT_TO_SMALLER:"[Bags] add discount to smaller bag",REMOVE_DISCOUNT_FROM_SMALLER:"[Bags] remove discount from smaller bag",SYNC_LOCAL_BAGS:"[Bags] sync local bags with bookingModel",FETCH_BAGS_INSURANCE_CONFIG_START:"[Bags] get bags insurance config start",FETCH_BAGS_INSURANCE_CONFIG_SUCCESS:"[Bags] get bags insurance config success",FETCH_BAGS_INSURANCE_CONFIG_ERROR:"[Bags] get bags insurance config error"});


"use strict";angular.module("app.booking").constant("BOOKING_MODEL_ACTION_TYPES",{RESET:"[Booking] reset model",CREATE_BOOKING_MODEL_START:"[Booking] create booking model started",CREATE_BOOKING_MODEL_SUCCESS:"[Booking] create booking model succedded",CREATE_BOOKING_MODEL_FAILED:"[Booking] create booking model failed",PAGE_REFRESH_START:"[Booking] page refresh started",PAGE_REFRESH_SUCCESS:"[Booking] page refresh succedded",PAGE_REFRESH_ERROR:"[Booking] page refresh failed",PAGE_REFRESH_AVOIDED:"[Booking] page refresh avoided",GET_BOOKING_MODEL_START:"[Booking] get model",GET_BOOKING_MODEL_FAILED:"[Booking] get model failed",SET_FARE_ERROR:"[Booking] error getting changed booking model",SET_FARE_WARNING:"[Booking] warning getting changed booking model",RESET_FARE_ERRORS:"[Booking] reset fare errors",RESET_FARE_WARNINGS:"[Booking] reset fare warnings",GET_BOOKING_MODEL_SUCCESS:"[Booking] get model success",GET_UNBALANCED_BOOKING_MODEL_START:"[Booking] get unbalanced booking model",GET_UNBALANCED_BOOKING_MODEL_FAILED:"[Booking] get unbalanced booking model failed",GET_UNBALANCED_BOOKING_MODEL_SUCCESS:"[Booking] get unbalanced booking model success",RESET_SARA_VALIDATION:"[Booking] reset sara validation",POST_SELECTED_FLIGHT_START:"[Booking] post selected flight start",POST_SELECTED_FLIGHT_SUCCESS:"[Booking] post selected flight success",POST_SELECTED_FLIGHT_ERROR:"[Booking] post selected flight error"});


"use strict";angular.module("app.booking").constant("BREAKFAST_ACTION_TYPES",{GET_OFFERS_START:"[Breakfast] Get prices started",GET_OFFERS_SUCCESS:"[Breakfast] Get prices succedded",GET_OFFERS_ERROR:"[Breakfast] Get prices error",ADD_SELECTED:"[Breakfast] Add selected breakfast",REMOVE_SELECTED:"[Breakfast] Remove selected breakfast",ADD_FOR_ALL_PAX_AND_ALL_JOURNEYS:"[Breakfast] Add breakfast for all pax in all journeys",REMOVE_FOR_ALL_PAX_AND_ALL_JOURNEYS:"[Breakfast] Remove breakfast for all pax in all journeys",POST_TO_BOOKING_MODEL_START:"[Breakfast] Post booking model start",POST_TO_BOOKING_MODEL_SUCCESS:"[Breakfast] Post booking model success",POST_TO_BOOKING_MODEL_ERROR:"[Breakfast] Post booking model error",REMOVE_ALL_FROM_BOOKING_MODEL_START:"[Breakfast] Remove all breakfast from bookingModel start",REMOVE_ALL_FROM_BOOKING_MODEL_SUCCESS:"[Breakfast] Remove all breakfast from bookingModel success",REMOVE_ALL_FROM_BOOKING_MODEL_ERROR:"[Breakfast] Remove all breakfast from bookingModel error",UPDATE_LOCAL:"[Breakfast] Update local breakfasts",RESET:"[Breakfast] Reset breakfast state to default"});


"use strict";angular.module("app.booking").constant("CABINBAG_ACTION_TYPES",{CABIN_BAGS_AVAILABLE:"[CabinBags] available",FETCH_META_START:"[CabinBags] fetching meta",FETCH_META_SUCCESS:"[CabinBags] fetch meta success",FETCH_META_ERROR:"[CabinBags] fetch meta error ",ADD_TO_BOOKING_MODEL_START:"[CabinBags] add to booking model start",ADD_TO_BOOKING_MODEL_SUCCESS:"[CabinBags] add to booking model success",ADD_TO_BOOKING_MODEL_ERROR:"[CabinBags] add to booking model error",REMOVE_FROM_BOOKING_MODEL_START:"[CabinBags] remove from booking model start",REMOVE_FROM_BOOKING_MODEL_SUCCESS:"[CabinBags] remove from booking model success",REMOVE_FROM_BOOKING_MODEL_ERROR:"[CabinBags] remove from booking model error",ADD_SELECTED_CABIN_BAGS:"[CabinBags] add selected cabin bags",REMOVE_SELECTED_CABIN_BAGS:"[CabinBags] remove selected cabin bags",REMOVE_ALL:"[CabinBags] remove all cabin bags",PREPARE_CABIN_BAGS_FOR_JOURNEYS:"[CabinBags] prepare cabin bags for journeys",UPDATE_CABIN_BAG_FOR_JOURNEY:"[CabinBags] update single cabin bag for journey",UPDATE_CABIN_BAGS_FOR_JOURNEYS:"[CabinBags] update cabin bags for journeys",UPDATE_CB_CTA_STATE:"[CabinBags] update CTA state",CLEAR_LOCAL_SELECTION:"[CabinBags] clear local selection",ADD_SELECTED_CABIN_BAGS_LOCALLY:"[CabinBags] add selected cabin bags locally",REMOVE_SELECTED_CABIN_BAGS_LOCALLY:"[CabinBags] remove selected cabin bags locally",REMOVE_CABIN_BAGS_FOR_SELECTED_PAX:"[CabinBags] remove cabin bags for selected pax",ADD_BUNDLE_TO_BOOKING_MODEL_SUCCESS:"[CabinBags] add bundle to booking model success",REMOVE_BUNDLE_FROM_BOOKING_MODEL_SUCCESS:"[CabinBags] remove bundle from booking model success"});


"use strict";angular.module("app.booking").constant("CARHIRE_ACTION_TYPES",{INIT_CAR_SEARCH:"[Carhire] initialize car search criteria",CAR_TRAWLER_READY:"[Carhire] car trawler ready",ADD_TO_BOOKING_MODEL_START:"[Carhire] add to booking model start",ADD_TO_BOOKING_MODEL_SUCCESS:"[Carhire] add to booking model success",ADD_TO_BOOKING_MODEL_FAILED:"[Carhire] add to booking model failed",REMOVE_FROM_BASKET:"[Carhire] remove from basket",REMOVE_FROM_BOOKING_MODEL_START:"[Carhire] remove from booking model start",REMOVE_FROM_BOOKING_MODEL_SUCCESS:"[Carhire] remove from booking model success",REMOVE_FROM_BOOKING_MODEL_FAILED:"[Carhire] remove from booking model failed",OPEN_MODAL:"[Carhire] modal opened",CLOSE_MODAL:"[Carhire] modal closed"});


"use strict";angular.module("app.booking").constant("CAR_RENTAL_ACTION_TYPES",{INIT_CAR_SEARCH:"[Car-Rental] initialize car search criteria",CAR_RENTAL_READY:"[Car-Rental] car rental ready",FETCH_BOOKING_TOKEN:"[Car-Rental] fetch booking token",FETCH_BOOKING_TOKEN_ERROR:"[Car-Rental] fetch booking token error"});


"use strict";angular.module("app.booking").constant("CHANGE_FLIGHT_ACTION_TYPES",{SET_CHANGE_FLIGHT_STATUS:"[Change flight] set status",SET_CHANGE_FLIGHT_MESSAGES:"[Change flight] set messages",ADD_CHANGE_FLIGHT_MESSAGE:"[Change flight] add message",SET_CHANGE_FLIGHT_WARNINGS:"[Change flight] set warnings",SET_CHANGE_FLIGHT_ERRORS:"[Change flight] set errors",SET_SHOW_AUTO_CORRECT_DATE_WARNING:"[Change flight] set showAutoCorrectDateWarning",SET_HIDE_FOOTER:"[Change flight] set hideFooter",SET_CHANGE_FLIGHT_SELECTED_PAX_MAP:"[Change flight] set selectedPaxMap",SET_CHANGE_FLIGHT_PAYMENT_NOT_REQUIRED:"[Change flight] set paymentNotRequired",SET_CHANGE_FLIGHT_IS_FREE_MOVE:"[Change flight] set isFreeMove",SET_CHANGE_FLIGHT_MODEL:"[Change flight] set flightModel",SET_CHANGE_FLIGHT_MODEL_DESTINATION:"[Change flight] set flightModel destination",SET_CHANGE_FLIGHT_MODEL_DEPARTURE:"[Change flight] set flightModel departure",SET_CHANGE_FLIGHT_MODEL_START_DATE:"[Change flight] set flightModel start date",SET_CHANGE_FLIGHT_MODEL_END_DATE:"[Change flight] set flightModel end date",SET_CHANGE_FLIGHT_MODEL_TYPE:"[Change flight] set flightModel type",SET_CHANGE_FLIGHT_MODEL_TRIP_TYPE:"[Change flight] set flightModel trip type",SET_CHANGE_FLIGHT_ORIGINAL_FLIGHT_MODEL:"[Change flight] set originalFlightModel",SET_CHANGE_FLIGHT_ORIGINAL_TO_ORIGINAL:"[Change flight] set change flight model to original",SET_SELECTED_FLIGHTS:"[Change flight] set selected flights",SET_AVAILABLE_FLIGHTS_START:"[Change flight] set available flights start",SET_AVAILABLE_FLIGHTS_SUCCESS:"[Change flight] set available flights success",SET_AVAILABLE_FLIGHTS_ERROR:"[Change flight] set available flights error",RESET_CHANGE_FLIGHT:"[Change flight] reset",SET_CHANGE_FLIGHT_ORIGINAL_FLIGHT_DATA:"[Change flight]  set original flight data",HAS_ERRORS_ON_SELECTED_FARES:"[Change flight] set has errors on selected fares"});


"use strict";angular.module("app.booking").constant("CHECKIN_MODEL_ACTION_TYPES",{START:"[Checkin] start checkin flow",GET_PRODUCTS_START:"[Checkin] get products started",GET_PRODUCTS_SUCCESS:"[Checkin] get products succeeded",GET_PRODUCTS_END:"[Checkin] get products ended",REMOVE_PRODUCT:"[Checkin] remove product",GET_CASES_START:"[Checkin] get cases start",GET_CASES_SUCCESS:"[Checkin] get cases success",GET_CASES_ERROR:"[Checkin] get cases error",SET_TRAVEL_DOCUMENTS:"[Checkin] set travel documents",CHECKIN_PAX_START:"[Checkin] check in pax start",CHECKIN_PAX_SUCCESS:"[Checkin] check pax succcess",CHECKIN_PAX_ERROR:"[Checkin] check pax error",SET_CTA:"[Checkin] Set CTA",RESET:"[Checkin] Reset",SET_SHOW_BACK_BTN:"[Checkin] Set back btn visibility",SET_OPTIONS:"[Checkin] Set options",SELECT_OPTION:"[Checkin] Select option",SET_FOOTER_VISIBILITY:"[Checkin] Set footer visibility",SELECT_PAX:"[Checkin] select passenger",UNSELECT_PAX:"[Checkin] unselect passenger",SELECT_PASSENGERS:"[Checkin] select given passengers",UPDATE_CHECKIN_STEPS:"[Checkin] update checkin steps",SET_MANDATORY_SEAT_MAP:"[Checkin], set mandatory seat map",SET_REGULAR_SEATS_STEP_PASSED:"[Checkin], set regular seats step passed flag value",SET_PRIORITY_POPUP_ACCEPTED_JOURNEY_NUMS:"[Checkin], set accepted priority boarding popup journeys",SET_PRIORITY_SELECTION:"[Checkin] set checkin priority selection",RESET_PRIORITY_SELECTION:"[Checkin] reset checkin priority selection",SET_PRIORITY_SELECTION_NEW_POLICY:"[Checkin] set checkin priority selection new policy",RESET_PRIORITY_SELECTION_NEW_POLICY:"[Checkin] reset checkin priority selection new policy",GET_PRIORITY_AVAILABILITY:"[Checkin] get availability for the priority boarding",GET_PRIORITY_AVAILABILITY_ERROR:"[Checkin] get availability for the priority boarding error",PRODUCTS_ENGAGED_FROM_BOARDING_PASS:"[Checkin] products engaged from boarding pass",PRODUCTS_ADDED_FROM_BOARDING_PASS:"[Checkin] products added from boarding pass",PRODUCT_TO_SHOW_ON_PAYMENT_PAGE:"[Checkin] set product to show on Payment page mgs",TOGGLE_SELECTED_JOURNEY:"[Checkin] toggle journey selection to checkin",VERIFIY_SELECTED_JOURNEYS:"[Checkin] verifies selected journeys",SHOW_ALLOCATION_OPTIONS:"[Checkin] show allocation options by journey",HIDE_ALLOCATION_OPTIONS:"[Checkin] hide allocation options by journey",GET_CHECKIN_EXTRAS_CONFIG_SUCCESS:"[Checkin] get checkin extras config",GET_CHECKIN_EXTRAS_CONFIG_ERROR:"[Checkin] get checkin extras config error",SHOW_SEATS_POPUP:"[Checkin] show seats popup",FETCH_DOCS_START:"[Checkin] fetch docs start",FETCH_DOCS_SUCCESS:"[Checkin] fetch docs success",FETCH_DOCS_ERROR:"[Checkin] fetch docs error",COMMIT_DOCS_START:"[Checkin] commit docs start",COMMIT_DOCS_SUCCESS:"[Checkin] commit docs success",COMMIT_DOCS_ERROR:"[Checkin] commit docs error",REMOVE_DOCS_START:"[Checkin] remove docs start",REMOVE_DOCS_SUCCESS:"[Checkin] remove docs success",REMOVE_DOCS_ERROR:"[Checkin] remove docs error",UPLOAD_START:"[Checkin] upload start",UPLOAD_PROGRESS:"[Checkin] upload progress",UPLOAD_SUCCESS:"[Checkin] upload success",UPLOAD_ERROR:"[Checkin] upload error"});


"use strict";angular.module("app.booking").constant("EQUIPMENT_ACTION_TYPES",{FETCH_OFFERS_START:"[Equipment] fetching offers",FETCH_OFFERS_SUCCESS:"[Equipment] fetch offers success",FETCH_OFFERS_ERROR:"[Equipment] fetch offers error ",ADD_TO_BOOKING_MODEL_START:"[Equipment] add to booking model start",ADD_TO_BOOKING_MODEL_SUCCESS:"[Equipment] add to booking model success",ADD_TO_BOOKING_MODEL_ERROR:"[Equipment] add to booking model error",UPDATE_TOTAL_PRICE:"[Equipment] update total price",RESET:"[Equipment] cleared all"});


"use strict";angular.module("app.booking").constant("FARE_UPGRADE_ACTION_TYPES",{SET_ELIGIBLE_FARE_TYPE_FOR_UPGRADE:"[FARE UPGRADE] set eligible fare type for upgarde",FETCH_UPGRADE_PRICES_START:"[FARE UPGRADE] Fetching upgrade prices start",FETCH_UPGRADE_PRICES_SUCCESS:"[FARE UPGRADE] Fetching upgrade prices success",FETCH_UPGRADE_PRICES_ERROR:"[FARE UPGRADE] Fetching upgrade prices failed",FARE_UPGRADE_ADD_START:"[FARE UPGRADE] PLUS upgrade add start",FARE_UPGRADE_ADD_SUCCESS:"[FARE UPGRADE] PLUS upgrade add success",FARE_UPGRADE_ADD_ERROR:"[FARE UPGRADE] PLUS upgrade add error",FARE_UPGRADE_REMOVE_START:"[FARE UPGRADE] PLUS upgrade remove start",FARE_UPGRADE_REMOVE_SUCCESS:"[FARE UPGRADE] PLUS upgrade remove success",FARE_UPGRADE_REMOVE_ERROR:"[FARE UPGRADE] PLUS upgrade remove error",RESET:"[FARE UPGRADE] Reset fare upgrade store"});


"use strict";angular.module("app.booking").constant("FAST_TRACK_ACTION_TYPES",{FETCH_OFFERS_START:"[FastTrack] get prices started",FETCH_OFFERS_SUCCESS:"[FastTrack] get prices succedded",FETCH_OFFERS_ERROR:"[FastTrack] get prices error",ADD_TO_BOOKING_MODEL_START:"[FastTrack] add to booking model start",ADD_TO_BOOKING_MODEL_SUCCESS:"[FastTrack] add to booking model success",ADD_TO_BOOKING_MODEL_ERROR:"[FastTrack] add to booking model error",REMOVE_FROM_BOOKING_MODEL_START:"[FastTrack] remove from booking model start",REMOVE_FROM_BOOKING_MODEL_SUCCESS:"[FastTrack] remove from booking model success",REMOVE_FROM_BOOKING_MODEL_ERROR:"[FastTrack] remove from booking model error",ADD_SELECTED_FAST_TRACKS:"[FastTrack] add selected journey FastTracks",ADD_SELECTED_FAST_TRACK:"[FastTrack] add selected passenger FastTrack",REMOVE_SELECTED_FAST_TRACK:"[FastTrack] remove selected passenger FastTrack",REMOVE_SELECTED_FAST_TRACKS:"[FastTrack] remove selected journey FastTrack",ADD_REST_FAST_TRACKS:"[FastTrack] add FastTracks to the rest of the passengers",OPEN_MODAL:"[FastTrack] modal opened",CLOSE_MODAL:"[FastTrack] modal closed",CLEAR_LOCAL_SELECTION:"[FastTrack] clear local selection"});


"use strict";angular.module("app.booking").constant("FLIGHT_EXTRAS_ACTION_TYPES",{GET_QUICK_ADD_START:"[Extras] get quick add start",GET_QUICK_ADD_SUCCESS:"[Extras] get quick add success",GET_QUICK_ADD_ERROR:"[Extras] get quick add error",GET_EXTRAS_START:"[Extras] get extras start",GET_EXTRAS_SUCCESS:"[Extras] get extras success",GET_EXTRAS_ERROR:"[Extras] get extras error",CLEAR_ALL:"[Extras] clear all"});


"use strict";angular.module("app.booking").constant("GROUND_TRANSFERS_ACTION_TYPES",{ADD_TO_BOOKING_MODEL_START:"[Ground-Transfers] add to booking model start",ADD_TO_BOOKING_MODEL_SUCCESS:"[Ground-Transfers] add to booking model success",ADD_TO_BOOKING_MODEL_FAILED:"[Ground-Transfers] add to booking model failed",REMOVE_FROM_BOOKING_MODEL_START:"[Ground-Transfers] remove from booking model start",REMOVE_FROM_BOOKING_MODEL_SUCCESS:"[Ground-Transfers] remove from booking model success",REMOVE_FROM_BOOKING_MODEL_FAILED:"[Ground-Transfers] remove from booking model failed"});


"use strict";angular.module("app.booking").constant("INFLIGHT_PRODUCTS_ACTION_TYPES",{SET_CHECKIN_PRODUCT_CARD_START:"[InflightProducts] Set checkin product card started",SET_CHECKIN_PRODUCT_CARD_SUCCESS:"[InflightProducts] Set checkin product card success",SET_CHECKIN_PRODUCT_CARD_FAILED:"[InflightProducts] Set checkin product card failed",UPDATE_CHECKIN_PRODUCT_CARD:"[InflightProducts] Update checkin product card",ADD_SELECTED:"[InflightProducts] Add selected product",REMOVE_SELECTED:"[InflightProducts] Remove selected product",UPDATE_SELECTED:"[InflightProducts] Update selected products",GET_OFFERS_START:"[InflightProducts] Get offers started",GET_OFFERS_SUCCESS:"[InflightProducts] Get offers success",GET_OFFERS_FAILED:"[InflightProducts] Get offers failed",ADD_TO_BOOKING_MODEL_START:"[InflightProducts] add to booking model start",ADD_TO_BOOKING_MODEL_SUCCESS:"[InflightProducts] add to booking model success",ADD_TO_BOOKING_MODEL_FAILED:"[InflightProducts] add to booking model failed",REMOVE_FROM_BOOKING_MODEL_START:"[InflightProducts] remove from booking model start",REMOVE_FROM_BOOKING_MODEL_SUCCESS:"[InflightProducts] remove from booking model success",REMOVE_FROM_BOOKING_MODEL_FAILED:"[InflightProducts] remove from booking model failed",RESET:"[InflightProducts] Reset store"});


"use strict";angular.module("app.booking").constant("INSURANCE_ACTION_TYPES",{FETCH_COUNTRIES_START:"[Insurance] fetching countries",FETCH_COUNTRIES_SUCCESS:"[Insurance] fetch countries success",FETCH_COUNTRIES_ERROR:"[Insurance] fetch countries error ",FETCH_OFFERS_FOR_PASSENGER_START:"[Insurance] fetching offers for passenger",FETCH_OFFERS_FOR_PASSENGER_SUCCESS:"[Insurance] fetch offers for passenger success",FETCH_OFFERS_FOR_PASSENGER_ERROR:"[Insurance] fetch offers for passenger error",FETCH_OFFERS_FOR_ALL_PASSENGERS_START:"[Insurance] fetching offers for all passengers",FETCH_OFFERS_FOR_ALL_PASSENGERS_SUCCESS:"[Insurance] fetch offers for all passengers success",FETCH_OFFERS_FOR_ALL_PASSENGERS_ERROR:"[Insurance] fetch offers for all passengers error",ADD_TO_BOOKING_MODEL_START:"[Insurance] add to booking model start",ADD_TO_BOOKING_MODEL_SUCCESS:"[Insurance] add to booking model success",ADD_TO_BOOKING_MODEL_ERROR:"[Insurance] add to booking model error",REMOVE_FROM_BOOKING_MODEL_START:"[Insurance] remove from booking model start",REMOVE_FROM_BOOKING_MODEL_SUCCESS:"[Insurance] remove from booking model success",REMOVE_FROM_BOOKING_MODEL_ERROR:"[Insurance] remove from booking model error",DRAWER_CLOSED:"[Insurance] drawer closed",CLEAR:"[Insurance] clear",ADD_INSURANCE:"[Insurance] add",ADD_INSURANCE_ALL_PAX:"[Insurance] add to all pax",REMOVE_INSURANCE:"[Insurance] remove",SAME_INSURANCE_COR:"[Insurance] set same insurance cor",SET_PAX_HAVE_PACKAGE:"[Insurance] set pax have package",ADD_COR_BY_FLIGHT_ORIGIN:"[Insurance] set pax COR by flight origin",ADD_SELECTED_INSURANCE:"[Insurance] add selected insurance",REMOVE_SELECTED_INSURANCE:"[Insurance] remove selected insurance",MAKE_CHOICE:"[Insurance] make choice",UNMAKE_CHOICE:"[Insurance] unmake choice"});


"use strict";angular.module("app.booking").constant("LOCK_FARE_ACTION_TYPES",{FETCH_PRICES_START:"[LockFare] get prices started",FETCH_PRICES_SUCCESS:"[LockFare] get prices succedded",FETCH_PRICES_ERROR:"[LockFare] get prices error",ADD_TO_BOOKING_MODEL_START:"[LockFare] add to booking model start",ADD_TO_BOOKING_MODEL_SUCCESS:"[LockFare] add to booking model success",ADD_TO_BOOKING_MODEL_ERROR:"[LockFare] add to booking model error"});


"use strict";angular.module("app.booking").constant("MANAGE_TRIPS_ACTION_TYPES",{CONTACT_UPDATE_START:"[BookingModel] Contacts update requested",CONTACT_UPDATE_SUCCESS:"[BookingModel] Contacts updated succesfully",SPECIAL_ASSISTANCE_UPDATE_START:"[BookingModel] Special assistance updated requested",SPECIAL_ASSISTANCE_UPDATE_SUCCESS:"[BookingModel] Special assistance updated succesfully"});


"use strict";angular.module("app.booking").constant("PARKING_ACTION_TYPES",{FETCH_OFFERS_START:"[Parking] fetching offers",FETCH_OFFERS_SUCCESS:"[Parking] fetch offers success",FETCH_OFFERS_FAILED:"[Parking] fetch offers failed",ADD_TO_BOOKING_MODEL_START:"[Parking] add to booking model start",ADD_TO_BOOKING_MODEL_SUCCESS:"[Parking] add to booking model success",ADD_TO_BOOKING_MODEL_FAILED:"[Parking] add to booking model failed",REMOVE_FROM_BOOKING_MODEL_START:"[Parking] remove from booking model start",REMOVE_FROM_BOOKING_MODEL_SUCCESS:"[Parking] remove from booking model success",REMOVE_FROM_BOOKING_MODEL_FAILED:"[Parking] remove from booking model failed",ADD_SELECTED_OFFERS:"[Parking] add selected provider and offer",OPEN_MODAL:"[Parking] modal opened",CLOSE_MODAL:"[Parking] modal closed",SET_SELECTED_OFFER:"[Parking] add selected offer",REMOVE_SELECTED_OFFER:"[Parking] remove selected offer",SET_REGISTRATION_NUMBER:"[Parking] set vehicle registration number",CLEAR_ALL:"[Parking] clear all"});


"use strict";angular.module("app.booking").constant("PRIORITY_BOARDING_ACTIONS_TYPES",{ADD_ALL_START:"[Priority boarding] Add all: Started",ADD_ALL_SUCCESS:"[Priority boarding] Add all: Success",ADD_ALL_ERROR:"[Priority boarding] Add all: Error",REMOVE_ALL_START:"[Priority boarding] Remove all: Started",REMOVE_ALL_SUCCESS:"[Priority boarding] Remove all: Success",REMOVE_ALL_ERROR:"[Priority boarding] Remove all: Error",GET_PRICES:"[Priority boarding] Get prices",GET_PRICES_START:"[Priority boarding] Get prices start",ADD_SELECTED:"[Priority boarding] Add selected priority boarding",ADD_ALL_LOCAL:"[Priority boarding] Add all local priority boarding",REMOVE_SELECTED:"[Priority boarding] Remove selected priority boarding",REMOVE_ALL_LOCAL:"[Priority boarding] Remove all local priority boarding",SET_CTA_STATUS:"[Priority boarding] set cta status of the journey",UPDATE_LOCAL:"[Priority boarding] Update local priority boarding",SET_CAMPAIGN_AVAILABILITY:"[Priority boarding] Set campaign availability",UPDATE_CAMPAIGN_SEEN_STATUS:"[Priority boarding] Update campaign seen status",RESET:"[Priority boarding] Reset priority boardings",RESET_OFFERS:"[Priority boarding] Reset priority offers",EMPTY:"[Priority boarding] Empty priority boardings",GET_OFFERS_SUCCESS:"[Priority boarding] Get offers success",GET_OFFERS_FAIL:"[Priority boarding] Get offers fail",SET_CONTINUE_BUTTON_AVAILABILITY:"[Priority boarding] Set continue availability",GET_PRIORITY_AVAILABILITY:"[Priority boarding] Get priority availability",GET_PRIORITY_AVAILABILITY_ERROR:"[Priority boarding] Get priority availability error",RESET_PRIORITY_AVAILABILITY:"[Priority boarding] Reset priority availability",FETCH_CARDS_CONFIG_START:"[Priority boarding] get p2cb cards start",FETCH_CARDS_CONFIG_SUCCESS:"[Priority boarding] get p2cb cards success",FETCH_CARDS_CONFIG_ERROR:"[Priority boarding] get p2cb cards error",UPDATE_BUTTON_TYPE_AND_STATUS:"[Priority boarding] update button type and PB&2CB status"});


"use strict";angular.module("app.booking").constant("REFUND_ACTION_TYPES",{INIT_REFUND:"[Refund] init live refund",FETCH_REFUNDABLE_START:"[Refund] fetch refundable start",FETCH_REFUNDABLE_SUCCESS:"[Refund] fetch refundable success",FETCH_REFUNDABLE_FAILED:"[Refund] fetch refundable failed",TOGGLE_SELECTED_FLIGHT:"[Refund] toggle selected flights",FETCH_BREAKDOWN_ITEM_START:"[Refund] fetch breakdown item start",FETCH_BREAKDOWN_ITEM_SUCCESS:"[Refund] fetch breakdown item success",FETCH_BREAKDOWN_ITEM_FAILED:"[Refund] fetch breakdown item failed",REFUND_START:"[Refund] refund start",REFUND_SUCCESS:"[Refund] refund success",REFUND_FAILED:"[Refund] refund failed",RESET_REFUND_ERRORS:"[Refund] reset errors",SET_CTA:"[Refund] set cta",SELECT_PAX:"[Refund] select passenger",DESELECT_PAX:"[Refund] deselect passenger"});


"use strict";angular.module("app.booking").constant("ROOMS_ACTION_TYPES",{ADD_TO_BOOKING_SUCCESS:"[Rooms Details] room selection confirmed",REMOVE_FROM_BOOKING_MODEL_SUCCESS:"[Rooms Details] room removed"});


"use strict";angular.module("app.booking").constant("SAMSONITE_ACTION_TYPES",{GET_AVAILABLE_BAGS_START:"[Samsonite] Get available bags start",GET_AVAILABLE_BAGS_SUCCESS:"[Samsonite] Get available bags success",GET_AVAILABLE_BAGS_ERROR:"[Samsonite] Get available bags error",UPDATE_SELECTED_BAGS:"[Samsonite] Update selected bags",POST_SAMSONITE_START:"[Samsonite] Post Samsonite start",POST_SAMSONITE_SUCCESS:"[Samsonite] Post Samsonite success",POST_SAMSONITE_ERROR:"[Samsonite] Post Samsonite error",REMOVE_SAMSONITE_START:"[Samsonite] Remove Samsonite start",REMOVE_SAMSONITE_SUCCESS:"[Samsonite] Remove Samsonite success",REMOVE_SAMSONITE_ERROR:"[Samsonite] Remove Samsonite error"});


"use strict";angular.module("app.booking").constant("SEATS_ACTION_TYPES",{CLEAR_ALL_SEATS_START:"[Seats] clear all seats start",CLEAR_ALL_SEATS_SUCCESS:"[Seats] clear all seats success",CLEAR_ALL_SEATS_ERROR:"[Seats] clear all seats error",CONFIRM_SEATS_ERROR:"[Seats] confirm seats error",CONFIRM_SEATS_START:"[Seats] confirm seats started",CONFIRM_SEATS_SUCCESS:"[Seats] confirm seats success",CONFIRM_SEATS_SUCCESS_ON_CHECKIN:"[Seats] success on check in",DRAWER_CLOSE_ERROR:"[Seats] drawer close error",FETCH_SEATS_ERROR:"[Seats] get seats error",FETCH_SEATS_START:"[Seats] get seats started",FETCH_SEATS_SUCCESS:"[Seats] get seats success",FETCH_SEAT_MAP_ERROR:"[Seats] get seat map error",FETCH_SEAT_MAP_START:"[Seats] get seat map started",FETCH_SEAT_MAP_SUCCESS:"[Seats] get seat map success",GET_AIRCRAFT_MAP_START:"[Seats] get aircraft map start",GET_AIRCRAFT_MAP_SUCCESS:"[Seats] get aircraft map success",GET_AIRCRAFT_MAP_ERROR:"[Seats] get aircraft map error",RESET_AIRCRAFT_SEAT_MAP:"[Seats] reset loaded seat map",IGNORE_PRIORITY_POPUP:"[Seats] ignore priority popup",NOTICE_PRIORITY_POPUP:"[Seats] notice priority popup",QUICK_ADD_ERROR:"[Seats] quick add error",QUICK_ADD_START:"[Seats] quick add started",QUICK_ADD_SUCCESS:"[Seats] quick add success",REMOVE_SEATS_ERROR:"[Seats] remove seats error",REMOVE_SEATS_START:"[Seats] remove seats started",REMOVE_SEATS_SUCCESS:"[Seats] remove seats success",RESET:"[Seats] reset",SELECT_SEAT:"[Seats] select seat",SET_DISPLAY_PRICE:"[Seats] select display price",SET_DRAWER_TO_CLOSEABLE:"[Seats] set drawer closeable",SET_DRAWER_TO_UNCLOSEABLE:"[Seats] set drawer uncloseable",SET_MONEY_SAVED_ON_CHILD_SEATS:"[Seats] set money saved on child seats",SET_STEPS:"[Seats] set steps",SET_STEP:"[Seats] set step",UNSELECT_SEAT:"[Seats] unselect seat",SET_CHANGE_SEATS_MODE:"[Seats] set the change seats mode on the seat map",CHANGE_SEAT_OPEN_MODAL:"[Seats] open change seat modal",SET_CHANGE_SEATS_ENGAGED_FROM_CHECKIN:"[Seats] set the change seats engaged from checkin",SET_SEAT_SELECTED_FOR_CHANGE:"[Seats] set the seat with specific designator selected for change",CHANGE_SEATS_CHANGE_CONFIRMED:"[Seats] seat change confirmed",RESET_AFTER_CHANGE_SEAT:"[Seats] reset after change seat",CHANGED_SEAT_ADDED_PRIORITY_SUCCESS:"[Seats] change seat added priority",CLEAR_UNCONFIRMED_SEAT_CHANGE:"[Seats] clear unconfirmed seat change",CHANGED_SEAT_RESET_PRIORITY_SUCCESS:"[Seats] reset changed seats priority",RESET_CHANGE_SEAT_STATE:"[Seats] reset change seats state",SEATS_CHANGED:"[Seats] seats changed",SELECT_PREVIOUS_SEAT:"[Seats] re-select previous seat",SET_CHANGE_SEATS_INFO_PROMPT:"[Seats] set change seats info prompt seen",RESET_TO_CHANGED_STATE:"[Seats] reset to changed state",CHANGE_CHILD_SEAT_PROMPT:"[Seats] change child seat prompt",SET_MANDATORY_SEATS_PROMPT_SEEN_STATE:"[Seats] set mandatory-seats-prompt seen state",ADD_SUGGESTED_SEATS_ERROR:"[Seats] add suggested seats error",ADD_SUGGESTED_SEATS_START:"[Seats] add suggested seats started",ADD_SUGGESTED_SEATS_SUCCESS:"[Seats] add suggested seats success"});


"use strict";angular.module("app.booking").constant("SPECIAL_ASSISTANCE_ACTION_TYPES",{SET_SPECIAL_ASSISTANCE_STORE_VALUES:"[SpecialAssistance] set special assistance store values",TOGGLE_SA_REQUIRED_VALUE:"[SpecialAssistance] toggle special assistance is required value",SELECT_SPECIAL_ASSISTANCE:"[SpecialAssistance] select special assistance",SELECT_WHEELCHAIR:"[SpecialAssistance] select wheelchair",SET_ASSISTANCE_AVAILABILITY_CODES:"[SpecialAssistance] set assistance availability codes after"});


"use strict";angular.module("app.booking").constant("TRANSFERS_ACTION_TYPES",{FETCH_OFFERS_START:"[Transfers] fetching offers",FETCH_OFFERS_SUCCESS:"[Transfers] fetch offers success",FETCH_OFFERS_FAILED:"[Transfers] fetch offers failed",ADD_TO_BOOKING_MODEL_START:"[Transfers] add to booking model start",ADD_TO_BOOKING_MODEL_SUCCESS:"[Transfers] add to booking model success",ADD_TO_BOOKING_MODEL_FAILED:"[Transfers] add to booking model failed",REMOVE_FROM_BOOKING_MODEL_START:"[Transfers] remove from booking model start",REMOVE_FROM_BOOKING_MODEL_SUCCESS:"[Transfers] remove from booking model success",REMOVE_FROM_BOOKING_MODEL_FAILED:"[Transfers] remove from booking model failed",FETCH_SELECTED_OFFERS_START:"[Transfers] fetching selected offers",FETCH_SELECTED_OFFERS_SUCCESS:"[Transfers] fetch selected offers success",FETCH_SELECTED_OFFERS_FAILED:"[Transfers] fetch selected offers failed",ADD_SELECTED_OFFERS:"[Transfers] add selected offers",REMOVE_SELECTED_OFFERS:"[Transfers] remove selected offers",OPEN_MODAL:"[Transfers] modal opened",CLOSE_MODAL:"[Transfers] modal closed",ADD_TRANSFERS_POST_MESSAGE:"[Transfers] add transfers postMessage",RESET_SELECTED_OFFERS:"[Transfers] reset selected offers",CLEAR:"[Transfers] clear"});


"use strict";angular.module("app.booking").constant("TRAVEL_DOCUMENTS_ACTIONS_TYPES",{ADD_TO_BOOKING_MODEL_START:"[Travel documents] add to booking model start",ADD_TO_BOOKING_MODEL_SUCCESS:"[Travel documents] add to booking model success",ADD_TO_BOOKING_MODEL_ERROR:"[Travel documents] add to booking model error",UPDATE_DOCUMENTS_IN_BOOKING_MODEL:"[Travel documents] update travel documents in booking model",GET_TRAVEL_DOCUMENTS_START:"[Travel documents] get travel documents start",GET_TRAVEL_DOCUMENTS_SUCCESS:"[Travel documents] get travel documents success",GET_TRAVEL_DOCUMENTS_ERROR:"[Travel documents] get travel documents error",SET_CURRENT_PASSENGER_DOCUMENT:"[Travel documents] set current selected passenger travel document",GET_NATIONALITIES_START:"[Travel documents] Get Nationalities start",GET_NATIONALITIES_SUCCESS:"[Travel documents] Get Nationalities success",GET_NATIONALITIES_FROM_CACHE:"[Travel documents] Get Nationalities from cache",GET_NATIONALITIES_ERROR:"[Travel documents] Get Nationalities error",GET_DOCUMENTS_RULES_START:"[Travel documents] Get Rules start",GET_DOCUMENTS_RULES_SUCCESS:"[Travel documents] Get Rules success",GET_DOCUMENTS_RULES_FROM_CACHE:"[Travel documents] Get Rules from cache",GET_DOCUMENTS_RULES_ERROR:"[Travel documents] Get Rules error",UPDATE_TRAVEL_DOCS_LIST:"[Travel documents] Update DOCS LIST",GET_CUSTOMER_DOCUMENTS_START:"[Travel documents] Fetch customer documents start",GET_CUSTOMER_DOCUMENTS_SUCCESS:"[Travel documents] Fetch customer documents success",GET_CUSTOMER_DOCUMENTS_ERROR:"[Travel documents] Fetch customer documents error",SELECT_CUSTOMER_DOCUMENT:"[Travel documents] Select Customer Document",SET_CURRENT_DOC_INDEX:"[Travel documents] Set Current doc index",UPDATE_CURRENT_DOC:"[Travel documents] Update Current Doc",SAVE_DOC_TO_MYRYANAIR_START:"[Travel documents] SaveRyanair start",SAVE_DOC_TO_MYRYANAIR_SUCCESS:"[Travel documents] SaveRyanair success",SAVE_DOC_TO_MYRYANAIR_ERROR:"[Travel documents] SaveRyanair error",SET_SHOW_ADDED_DOCUMENT:"[Travel documents] Set show added Document",UPDATE_PARENT_DOC:"[Travel documents] Update Previous Doc"});


"use strict";angular.module("app.booking").constant("VOUCHER_ACTION_TYPES",{RESET:"[Voucher] reset",SELECT_VOUCHER_START:"[Voucher] select voucher start",SELECT_VOUCHER_SUCCESS:"[Voucher] select voucher success",SELECT_VOUCHER_ERROR:"[Voucher] select voucher error",REDEEM_VOUCHER_START:"[Voucher] redeem voucher start",REDEEM_VOUCHER_ERROR:"[Voucher] redeem voucher error",REDEEM_VOUCHER_SUCCESS:"[Voucher] redeem voucher success",USE_REWARD_VOUCHER_START:"[Voucher] use reward start",USE_REWARD_VOUCHER_ERROR:"[Voucher] use reward error",USE_REWARD_VOUCHER_SUCCESS:"[Voucher] use reward success",REMOVE_VOUCHER_START:"[Voucher] remove voucher start",REMOVE_VOUCHER_ERROR:"[Voucher] remove voucher error",REMOVE_VOUCHER_SUCCESS:"[Voucher] remove voucher success"});


"use strict";angular.module("app.booking").controller("CheckinFlowCtrl",["$state","$scope","$ngRedux","$translate","$q","CHECKIN","CheckinModelActions","CheckinAllocationActions","SeatsActions","CheckinModelSelectors","newDialogEnabled","Device","CheckinFlow","BookingRead","DialogManager","FEATURE_CONFIG","SeatsService","$stateParams","ErrorHandler","$timeout","$element","PaymentActions","InsuranceActions","ParkingService","BookingReadCheckinJourney","MarketConfig","AllPlaces",function(e,n,t,o,i,a,s,c,r,l,u,p,h,g,d,k,S,f,C,m,y,b,v,A,$,M,O){var E=this,T=[],P=function(e){return k["open-seatmap-in-check-in"]&&R.propIs(Number,"journey",f)&&R.path(["checkin","showAllocationOptions",f.journey],e)&&!l.hasAllocationChoiceSegment(e,f.journey)&&!R.prop("isUpgrade",f)};T.push(p.onPhone(function(e){var n=e.matches;E.isMobile=n})),this.covidLinksTranlations=[];var I=function(e){return[O.findSingle("iataCode",e.orig),O.findSingle("iataCode",e.dest)]},w=function(e,n){var t="covidform-",o=e[0].countryCode.toUpperCase(),i=e[1].countryCode.toUpperCase(),a=e[0].iataCode,s=e[1].iataCode;return n?[""+t+a+s,""+t+o+i]:[""+t+a+s,""+t+s,""+t+o+i,""+t+i]},D=function(e,n,t,o){var i=o?1:2,a=i>t?"cityCode":"country";if(!e.includes("covidform-")){var s={dest:n[a],links:e.split(",")};E.covidLinksTranlations.push(s)}},F=function(){var e=t.getState(),n=e.bookingModel,a=n.segments,s=n.journeys;a.length>2&&s.map(function(e){return i.all(I(e.model)).then(function(e){return i.all(o(w(e,!0)).then(function(n){Object.keys(n).forEach(function(t,o){D(n[t],e[1],o,!0)})}))})}),a.map(function(e){return i.all(I(e.model)).then(function(e){return i.all(o(w(e,!1)).then(function(n){Object.keys(n).forEach(function(t,o){D(n[t],e[1],o,!1)})}))})})};F();var x=function(n){var t=l.getSelectedPassengers(n),o=n.launchDarkly["checkin-2-0-regulations-acknowledgement"];return{acknowledgeDangerousGoods:"dangerous-goods"===o,acknowledgeDangerousGoodsAndCovid:"dangerous-goods-and-covid-19"===o,showSpinner:n.checkin.isLoading||n.launchDarkly["boarding-pass-redirect-3-0"]&&"booking.active.checkin.checkin"===e.current.name&&!n.checkin.checkInProcessError,isProcessing:n.payment.isProcessing,bookingModel:n.bookingModel,insurance:n.insurance,checkin:l.getState(n),total:l.getCheckinTotalToPay(n),selectedOptions:h.getSelectedOptionForCarusel(n),selectedPassengers:t,changeSeatsAvailable:e.is("booking.active.checkin.boarding-pass")&&S.checkinChangeSeatAvailability(n.bookingModel,n.seats.availability,g.getFutureFlights(n.bookingModel).length?S.getNumberOfSeatsOnAircraft(n.bookingModel,n.seats):0),ctaState:l.getExtrasCtaText(n,E.isMobile),showInfoBanner:R.pathOr(!1,["checkin","showInfoBanner"],n),showWarningBanner:e.is("booking.active.checkin.boarding-pass")&&R.pathOr(!1,["launchDarkly","checkin-2-0-covid-warning-dark"],n),checkedInCount:g.getCheckedInPassengers(n.bookingModel).length,showAllocationOptions:P(n),checkInProcessError:n.checkin.checkInProcessError,isOta:"OTACheckinRestricted"===n.checkin.checkInErrorCode,currencyConversionOfferRequested:n.payment.currencyConversionOfferRequested,insuranceChoiceIsMade:R.path(["insurance","choiceIsMade"],n),isSelectionConfirmed:R.path(["insurance","isSelectionConfirmed"],n),isInsuranceStep:e.is("booking.active.checkin.insurance"),extras:R.path(["flightExtras","extras"],n),launchDarkly:n.launchDarkly,isSelectedParkingValid:!n.parking.selectedOffer||n.parking.selectedOffer&&(A.hasAddedParking(n.bookingModel)||n.parking.isAddingToBookingModelError),sca:n.sca}};f.paymentFailure&&400===f.paymentFailure.status&&C.handle("payment",f.paymentFailure.data.message,{skipWatchersDisabling:!0}),T.push(t.connect(x,[s,c,r])(function(e,n){var t=babelHelpers.slicedToArray(n,4),o=t[0],i=t[1],a=t[2],s=t[3];E.$state=e,E.$actions={checkin:o,allocations:i,seats:a,payment:s};var c=h.getPreviousCurrentNext({checkin:E.$state.checkin}),r=c.currentStep,l=c.nextStep;R.equals("seats",r)&&(E.buttonKey=R.equals("seats",l)?"trips.seats.seatmap_next-flight":"common.buttons.continue")}));var B=function(){var e=t.getState(),n=e.bookingModel.journeys.filter(function(n){return!g.allPaxHaveSeatsByJourney(n.key.journey,e.bookingModel)});h.setJourneys(n)};B();var U=a.getMilestones(this.$state.bookingModel,this.$state.extras,this.$state.insurance,this.$state.launchDarkly);this.milestonesStepsKeys=U.map(function(e){return e.key}),this.getMilestones=function(){return a.getMilestones(E.$state.bookingModel,E.$state.extras,E.$state.insurance,E.$state.launchDarkly)},k["priority-boarding-page-checkin-enabled"]&&this.$actions.checkin.getPriorityAvailability(),this.getCurrentStep=h.currentStep,this.getCurrentMilestone=function(){return h.getCurrentMilestone(t.getState(),U)},this.$actions.checkin.getCheckinExtrasConfig(),this.market=M.href();var N=function(e,n){return{isDialogEnabled:u,isSeatMapStep:function(){return h.isSeatMapStep(n.current)},modalReady:!0,isConnectingFlight:g.getBookingInfo(e.bookingModel).isConnectingFlight,isNewDesignAllocationStep:function(){return h.newDesignAllocation&&E.getCurrentStep(E.$state)===a.ROUTES.ALLOCATION}}};Object.assign(this,N(t.getState(),e)),this.isAllocationStep=function(){return E.getCurrentStep(E.$state)===a.ROUTES.ALLOCATION},this.isPaymentAvailable=function(){return!E.$state.sca.jwtDataCollectionToken||!E.$state.sca.dataCollectionProcessing},this.isInsuranceStep=function(){return E.getCurrentStep(E.$state)===a.ROUTES.INSURANCE},this.dangerousGoodsTermsAccepted=!1,this.dangerousGoodsShevronOpened=!1,this.openDangerousGoodsModal=function(){E.dangerousGoodsShevronOpened=!1,d.openConfirm("dangerousGoodsModal",{template:"/partials/booking/checkin/directives/dangerous-goods-policy-popup.html",className:"dangerous-goods-policy-popup__dialog",overlay:!1,closeByEscape:!1,closeByDocument:!1},!1).then(function(){E.dangerousGoodsTermsAccepted=!0})},this.shouldShowSeatsPopupForReturnFlight=function(){var e=g.getModel("serverTimeUTC",E.$state.bookingModel)[0];return R.pipe(R.allPass([R.pathEq(["launchDarkly","checkin-2.0-seats-popup-feature"],!0),R.pipe(h.currentStep,R.equals("allocation")),R.pipe(R.path(["bookingModel","journeys",0]),R.curry($.isCheckinFree)(e)),R.pipe(R.path(["bookingModel","journeys",1]),R.curry($.isCheckinFree)(e),R.not),R.pipe(R.prop("bookingModel"),R.curry(g.getSoldSeatByJourney)(1),R.length,R.not),R.pipe(R.path(["checkin","allocationForm"]),R.both(R.pipe(R.length,R.gt(R.__,1)),R.pipe(R.last,R.propEq("checkinLater",!0)))),R.pathEq(["checkin","seatsPopupShown"],!1)]))(E.$state)},this.nextStep=function(){E.shouldShowSeatsPopupForReturnFlight()?(E.seatsPopupPrice=R.pipe(R.propOr([],["extras"]),R.find(R.propEq("code","SEATS")),R.prop("minPrice"))(E.$state),d.openConfirm("checkin-seats-popup",{template:"/partials/booking/checkin/checkin-seats-popup/checkin-seats-popup.template.html",controller:function(){return E},controllerAs:"$ctrl",closeByEscape:!1,closeByDocument:!1,overlay:!0},!1).then(function(){return E.$actions.allocations.select(1,"manualChoice")})["finally"](function(){E.$actions.checkin.showSeatsPopup(),E.doNextStep()})):E.doNextStep()},this.doNextStep=function(){E.isAllocationStep()&&!E.dangerousGoodsTermsAccepted?(E.dangerousGoodsTermsAccepted=!0,m(function(){E.$actions.checkin.nextStep()},700,!1)):E.isInsuranceStep()&&R.not(E.$state.insuranceChoiceIsMade)?E.$actions.checkin.setCTA(!1):E.$actions.checkin.nextStep()},this.toggleDangerousGoodsShevron=function(){E.dangerousGoodsShevronOpened=!E.dangerousGoodsShevronOpened;var e=y.find(".core-modal-body")[0];e&&m(function(){e.scrollTop=e.scrollHeight},250)},this.isSeatMapState=!1,this.isMobileSeatInfoOpened=!1,this.changeSeatsEnabled=k["change-seats-enabled"],this.openChangeSeat=function(){E.$actions.seats.setChangeSeatsMode(!0),E.$actions.seats.openChangeSeatsModal(!0)},this.showBackButton=function(){return h.isBackStepAvailable(t.getState())},this.onClickBackBtn=function(){!f.isUpgrade&&h.newCheckinFlow&&h.currentStep(E.$state)===a.ROUTES.SEATS&&l.getAllocationChoiceSegment(E.$state,f.journey)===f.segment?d.openConfirm("checkinBackPopup",{template:"/partials/booking/checkin/directives/seat-go-back-popup.html",className:"seat-go-back-popup__dialog",overlay:!1},!1).then(function(){k["open-seatmap-in-check-in"]&&(E.$actions.allocations.resetJourneyAllocationForm(f.journey),1===f.journey&&E.$actions.seats.clearAllSeats(f.journey)),E.$actions.checkin.previousStep()}):E.$actions.checkin.previousStep()},this.toggleMobileSeatMapInfo=function(e){E.isMobileSeatInfoOpened=e,R.not(e)&&(E.seatConfirmation={isConfirmed:!1})},this.toggleSeatConfirmation=function(e){E.seatConfirmation={isConfirmed:e},e&&(E.isMobileSeatInfoOpened=!1)},this.removeInsurance=function(){t.dispatch(v.removeAllInsurance()).then(function(){return t.dispatch(b.updateCurrencyConversionOffer())})},n.$on("$stateChangeSuccess",function(e,n){E.isSeatMapState="booking.active.checkin.seats"===n.name,E.isCtaBlockClass="skip_to_boarding_pass"===E.ctaState||"skip_to_boarding_passes"===E.ctaState,E.showCarousel=R.any(function(e){return R.contains(e,n.name)},[a.ROUTES.PRIORITY,a.ROUTES.EXTRAS,a.ROUTES.PAYMENT]);var t=h.currentStep({checkin:E.$state.checkin});E.showTotalPrice=R.contains(t,[a.ROUTES.SEATS,a.ROUTES.INSURANCE,a.ROUTES.PRIORITY,a.ROUTES.EXTRAS]),"booking.active"===n.name&&d.closeAllDialogs()}),n.$on("$destroy",function(){T.forEach(function(e){return e()})})}]);


"use strict";angular.module("app.booking").controller("BookingCtrl",["$ngRedux","BookingModelActions","FlightSearch","Availability","Stations","Passengers","Dates","FlightListModel","Device","$state","$stateParams","$location","$scope","Session","PaymentOptionFees","DccService","CheckinModel","FlightSearchActions",function(e,t,a,n,i,o,s,l,r,d,h,u,c,g,p,b,f,D){var v=this;n.clearCache(),b.reset(),f.reset(),c.isLoading=!0;var m=[],y=function(e){c.$evalAsync(function(){var t=babelHelpers.slicedToArray(e,2);c.outboundFlightListModel=t[0],c.returnFlightListModel=t[1]})},C=function(){c.search=a.model,R.path(["search","outbound","flightDate"],c)&&(c.outboundFlightListModel=babelHelpers["extends"]({},c.outboundFlightListModel,{dayCarousel:babelHelpers["extends"]({},R.pathOr({},["outboundFlightListModel","dayCarousel"],c),{selectedDate:c.search.outbound.flightDate})})),R.path(["search","isReturn"],c)&&(c.returnFlightListModel=babelHelpers["extends"]({},c.returnFlightListModel,{dayCarousel:babelHelpers["extends"]({},R.pathOr({},["returnFlightListModel","dayCarousel"],c),{selectedDate:c.search.inbound.flightDate})})),R.path(["model","origin"],a)&&R.path(["model","dest"],a)&&!p.get("savedMethods")&&p.getMethods({origin:a.model.origin,destination:a.model.dest,discountPercentage:a.model.discount})},O=function(t){a.set(a.getSearchData(t)),e.dispatch(D.setFlightInfo(a.model)),g.set("flightSearch:interval",a.interval)},F=function(e,t){var n=d.current.name.match(/booking\.checkout/),i=R.clone(h);c.stateChanged=!0,c.activeState=t.name,c.isPotential="booking.extras"===t.name,c.hideBasket=!!n&&r.isPhone(),i.searchObj?O(i.searchObj):i.Origin&&i.Destination&&i.DateOut?(i.DateOut=s.parseISO(h.DateOut),i.DateIn=s.parseISO(h.DateIn),i.RoundTrip=!!h.DateIn,O(i)):R.keys(a.model).length?C():d.go("home")};a.subscribe(C,!0),c.hideBasket=!1,c.ctnBtnState=!0,c.popupOpened=!1,c.stateChanged=!1,c.showSummaryHeader=!1,c.searchEnabled=u.search()&&u.search().searchEnabled,c.goToExtrasPage=function(){d.go("booking.extras")},c.showPopup=function(){c.popupOpened=!0},this.onCarouselDateChanged=function(t,o,s){var r=a.model,d=void 0,h=parseInt(g.get("flightSearch:interval"),10);if(o.date.startOf("day"),!(r.isReturn&&!r.ChangeFlight&&n.preExecuteCallbacks.length<2)){var u=!r.ChangeFlight||"RoundTrip"===r.ChangeFlight;if("outbound"===o.type&&(r.outbound.flightDate=o.date,r.isReturn&&o.date.isAfter(r.inbound.flightDate)&&u))return r.inbound.flightDate=o.date.clone().add(h,"day"),a.set(r),void e.dispatch(D.setFlightInfo(r));if("inbound"===o.type&&(r.inbound.flightDate=o.date,o.date.isBefore(r.outbound.flightDate)&&u))return d=o.date.clone().add(-h,"day"),d<moment()&&(d=r.inbound.flightDate),r.outbound.flightDate=d,a.set(r),void e.dispatch(D.setFlightInfo(r));var p=function(e){n.subscribe("availabilityData",function(t){var a=t.trips,n=R.path(["fareOptions",0],t),i=R.path(["fareOptions",1],t);s([new l(r.outbound.flightDate,a[0],e,n),a.length>1&&a[1].dates.length?new l(r.inbound.flightDate,a[1],e,i):{}])}),n.unsubscribe("availabilityData")};n.deferred.promise.then(function(e){c.isLoading=!1,i.query(r.operatedBy).then(function(t){var a=e.availabilityData.trips;if(0===a[0].dates.length)p(t);else{var n=R.path(["availabilityData","fareOptions",0],e),i=R.path(["availabilityData","fareOptions",1],e);s([new l(r.outbound.flightDate,a[0],t,n),a.length>1&&a[1].dates.length?new l(r.inbound.flightDate,a[1],t,i):{}])}r.operatedBy&&p(t)})})}},m.push(c.$on("$stateChangeSuccess",F)),m.push(c.$on("core-generic-popup:close",function(){c.popupOpened=!1})),m.push(c.$on("booking:flights:carousel-date-changed",function(e,t){v.onCarouselDateChanged(e,t,y,angular.noop)})),c.$on("$stateChangeSuccess",function(a,n,i,s){d.is("booking.home")&&"booking.home.business-plus-info"!==s.name&&(e.dispatch(t.reset()),o.reset())}),c.$on("$destroy",function(){a.unsubscribe(C),m.forEach(function(e){e()})})}]);


"use strict";angular.module("app.booking").controller("ExternalPaymentProcessCtrl",["$log","$scope","$stateParams","ExternalPaymentProcessing","Session","$state","Booking","BookingRead","Currency","MasterpassPayment","$ngRedux","BOOKING_MODEL_ACTION_TYPES","Flatnmap","FlatmapMaps","CheckinModelActions","Dates","FEATURE_CONFIG","INGENICO_PAYMENT_CONFIG","BoxeverActions",function(e,a,n,o,t,i,c,s,r,l,p,m,g,y,d,u,k,h,v){e.debug("PaymentProcessCtrl loaded"),a.isProcessing=!0;var b="booking.active.payment"===n.isBookingActivePayment,f=function(e,a){if(i.is("paypal.create"))return void i.go("account.payment");var o=g.normalize(y.bookingModel,e);if(p.dispatch({type:m.GET_BOOKING_MODEL_SUCCESS,payload:o}),"booking.active.checkin.payment"===n.isBookingActivePayment){var c=R.compose(R.map(R.zipObj(["segmentNum","journeyNum","paxNum"])),R.map(R.split("|")),R.split(";"));return p.dispatch(d.checkinPassengers(c(n.checkinPayload))),void i.go("booking.active.checkin.boarding-pass")}var r="booking.active",l=!(s.getOperator(o)||s.getConnectingCity(o)||s.isHoldFare(o)||s.isSameDayReturnBooking(o));k["at-post-booking-rooms-deal"]&&!e.travelDocuments&&!b&&l&&(t.setSessionStorage("roomsDealAt",u.formatISOFull(u.now)),r="booking.rooms-deal"),t.removeBasketId(),i.go(r,{confirmation:!b,signedUp:a,displayTooltip:b,bookingModel:o})},P=function(e){e.paymentType&&(p.dispatch(v.pay(e.paymentType)),p.dispatch(v.confirm())),f(e)},C=function(a){var o=a;if(e.warn(a),400===a.status){if(a.data||(o=Object.assign(a,{data:{}})),o.data.paymentMethodCode=n.paymentMethodCode,b)return void i.go(n.isBookingActivePayment,{paymentFailure:o});if("booking.active.checkin.payment"===n.isBookingActivePayment)return void i.go("booking.active.checkin",{paymentFailure:o});i.go("booking.payment",{paymentFailure:o})}else i.go("home")},E=function(){t.remove("bookingRetrieved"),a.isProcessing=!1};e.debug("state params:",n);var S=function(){return r.set("vmCurrency",c.get("info").curr)},A=function(a){switch(a){case"ideal.callback":o.processIdeal().then(P)["catch"](C)["finally"](E);break;case"paypal.callback":o.processPaypal().then(P)["catch"](C)["finally"](E);break;case"paypal.create":o.processSavePaypalAccount().then(P)["catch"](C)["finally"](E);break;case h.SUCCESS_STATE:case h.FAILURE_STATE:o.processIngenico().then(P)["catch"](C)["finally"](E);break;case"masterpass.callback":c.refreshBooking().then(function(e){return c.updateModel(e.data)}).then(S).then(function(){l.processRedirectBack(n,null,null,c)});break;default:e.warn("Unknown payment type")}};A(i.current.name)}]);


"use strict";angular.module("app.booking").controller("ItineraryCtrl",["$ngRedux","$window","$element","Utilities","BookingRead","AEMConfig","HIDDEN_ITINERARY_ADDONS",function(e,o,t,i,n,s,r){var l=this;this.printItinerary=function(){i.printElement(t[0]),o.print()},this.bookingModel=e.getState().bookingModel,this.info=n.getBookingInfo(this.bookingModel),this.serverTimeUTC=n.getServerTimeUTC(this.bookingModel),this.isPartOfUpgrade=n.isPartOfUpgrade(!0)(this.bookingModel),this.staticFilePrefix=s.getStaticFilePrefix(),this.isErasmus=n.isErasmus(this.bookingModel),this.isFamilyPlus=n.hasFamilyPlus(this.bookingModel),this.isFareSeparateBundle=n.getShouldSeparateFareBundle(this.bookingModel),this.operatedBy=n.getOperator(this.bookingModel);var a=function(e){return[n.getInfSsrsFor(e.journeyNum,l.bookingModel).reduce(function(e,o){return babelHelpers["extends"]({},o,{amt:e.amt+o.amt,total:e.total+o.total})},{amt:0,total:0})]};this.journeys=R.pipe(R.pathOr([],["journeys"]),R.pluck("model"))(this.bookingModel).map(function(e){return babelHelpers["extends"]({},e,{fares:n.getFaresFor(e.journeyNum,l.bookingModel).map(function(o){return babelHelpers["extends"]({},o,{bundles:l.isFareSeparateBundle?[]:n.getBundlesForPassengerTypeByJourney(o.code,e.journeyNum,l.bookingModel)})}),infSsrs:a(e),zoneDiscount:n.getZoneDiscountFor(e.journeyNum,l.bookingModel),fats:n.getFatsFor(e.journeyNum,l.bookingModel),segments:n.getSegmentsFor(e.journeyNum,l.bookingModel)})}),this.passengers=R.pipe(R.pathOr([],["passengers"]),R.pluck("model"))(this.bookingModel),this.addons=R.pipe(R.pathOr([],["addons"]),R.pluck("model"),R.filter(function(e){return e.sold&&!R.contains(e.type,r)}))(this.bookingModel),this.payments=R.pipe(R.pathOr([],["payments"]),R.pluck("model"))(this.bookingModel),this.paymentFee=R.pipe(R.pathOr([],["fees"]),R.pluck("model"),R.filter(function(e){return"PaymentFee"===e.type&&e.sold}))(this.bookingModel),this.extras=R.pipe(R.pathOr([],["extras"]),R.pluck("model"),R.filter(function(e){return e.sold}))(this.bookingModel),this.fees=R.pipe(R.pathOr([],["fees"]),R.pluck("model"),R.filter(function(e){return e.sold}))(this.bookingModel),this.isLoading=!1,this.modalReady=!0}]);


"use strict";angular.module("app.booking").controller("ManageTripCtrl",["$scope","$http","$log","$ngRedux","BookingRead","BookingReadCheckin","Basket","Passengers","NameChangeActions","NameChangeUtils","$filter","AEMConfig","ChangeFlightUtil","ContactDetails","CHANGE_FLIGHT_THRESHOLD","CHANGE_DOCUMENT_THRESHOLD","NAME_CHANGE_THRESHOLD","ChangeFlightRules","RuleEngine","LEG_TYPE","ManageTripsActions","SpecialAssistanceActions","SpecialAssistanceUtils","PhoneNumber","$document","smoothScroll","$timeout","Dates",function(e,t,n,s,a,i,o,c,g,r,d,l,h,u,p,m,k,S,C,b,F,f,D,v,A,M,T,P){function I(){T(function(){var e=A[0].querySelector(".special-assistance-form .form-field.form-invalid");e&&M(e,{containerId:"dialog-body-slot",offset:210})},0)}var y=this;n.info("ManageTripCtrl: Activated"),this.isLoading=!1,this.modalReady=!0,this.bookingStates={},this.bookingModel={},this.specialAssistance={};var _=function(e){return y.specialAssistance!==e.specialAssistance&&I(),{bookingModel:e.bookingModel,passengers:e.bookingModel.passengers,specialAssistance:e.specialAssistance,nameChange:e.nameChange}},E=s.connect(_,F)(this),N=function(e){var t=e.bookingModel,n=e.launchDarkly;return{hasSpanishDiscount:a.hasSpanishDiscount(t),isReturnTrip:a.isReturnTrip(t),departedFlights:a.getDepartedFlights("segments",t),zoneDiscount:a.getZoneDiscountFor(t),someCheckedIn:a.isSomePaxCheckIn(t),isFlightOutDue:a.isFlightOutDue(t),freeMoveFlights:a.getFreeMoveFlights(t),isFlightChanged:a.anyFlightWasChanged(t),someFlightsDeparted:a.someFlightsDeparted(t),allFlightsDeparted:a.allFlightsDeparted(t),anyPassengerFullyCheckedIn:i.anyPassengerCheckedIn(t,!0),noPassengerDocuments:!i.anyPassengerCheckedIn(t),allPassengersCheckedIn:a.allPassengersCheckedIn(t,!1),allPassengersHaveSeats:a.allPaxHaveSeats(t),isFlightFlown:a.getFlightsFlownStates(t),paxFlownStatuses:a.getPaxFlownStatuses(t),flightsDue:a.getDueFlightStatuses(t,p),changeDocumentTimeEnded:a.getDueFlightStatuses(t,m)[0],isConnectingFlight:a.getBookingInfo(t).isConnectingFlight,isBuyOneGetOneDiscounted:a.getBookingInfo(t).isBuyOneGetOneDiscounted,paxBoardedStatus:a.getPaxBoardedStatus(t),checkinCount:h.checkInCount(R.pathOr([],["journeys"],t),a.getLegsCheckInStatus(t)),hasErasmusDiscount:a.isErasmus(t),isLMImported:"LM"===R.path(["payments",0,"model","code"],t),isAircraftModelChangeRestricted:a.someSegmentsWithMaxAircraftModel(t)&&!R.pathOr(!1,["change-flight-2.0-max-allowed-dark"],n)}};Object.assign(this.bookingStates,N(s.getState())),s.dispatch(g.setupChangeNameModel(!0)),this.states={changeFlight:{status:"active"},changeName:{status:"active"},changeDocument:{status:"active"},updateContact:{status:"active"},addAssistance:{status:"active"}};var O="mytrips.manage_your_trip.side_drawer.manage.",B=d("toUnderscore");this.contact=u.fromBookingModel(a.getBookingContact(this.bookingModel));var x=function(e,t,n){y.states[e].status=t,y.states[e].reasonCode=n},L=function(e,t){var n=y.states;Object.keys(n).forEach(function(s){var a=n[s];s&&(a.reasonCode=t,e&&e===s?a.status=t:a.status="inactive")})},w=function(){var e=R.pipe(a.getFlightsDeparturesTime,R.map(P.utc),R.head)(y.bookingModel),t=P.utc(a.getServerTimeUTC(y.bookingModel)),n=P.diffInHours(P.parseISOFull(e),P.parseISOFull(t));return n>=k&&!y.bookingStates.anyPassengerFullyCheckedIn&&x("changeName","info","available"),n>=k&&y.bookingStates.allPassengersCheckedIn&&x("changeName","inactive","checked_in"),k>n&&x("changeName","inactive","expired"),r.isChanged(y.bookingModel)?void L("changeName","pending"):void(!y.bookingStates.isFlightChanged&&y.bookingStates.someFlightsDeparted&&(y.bookingStates.allFlightsDeparted?(x("changeName","disabled","flights_departed"),x("changeDocument","disabled","flights_departed")):(x("changeName","inactive","outbound_departed"),x("changeDocument","inactive","outbound_departed"))))},U=function(){y.bookingStates.allPassengersCheckedIn&&x("changeName","inactive","checkins"),y.bookingStates.anyPassengerFullyCheckedIn?x("changeDocument","info","checkins"):y.bookingStates.noPassengerDocuments&&x("changeDocument","inactive","no_documents")},H=function(){(y.bookingStates.changeDocumentTimeEnded||y.bookingStates.isFlightFlown[0])&&x("changeDocument","inactive","no_time")},$=function(){y.bookingStates.hasSpanishDiscount&&(x("changeName","disabled","spanish_resident"),x("changeDocument","disabled","spanish_resident")),y.bookingStates.hasErasmusDiscount&&x("changeName","disabled","erasmus_student")},G=function(){var e=new C;e.register(S.rules);var t={isReturnTrip:y.bookingStates.isReturnTrip,isFlightDue:y.bookingStates.flightsDue,isCheckIn:0===y.bookingStates.checkinCount.withoutCheckIn,isCheckedInOneLeg:y.bookingStates.checkinCount.withCheckIn>0&&y.bookingStates.checkinCount.withoutCheckIn>0,hasSpanishDiscount:y.bookingStates.hasSpanishDiscount,isBasketNotEmpty:o.getTotal().amt>0,isFlightChanged:y.bookingStates.isFlightChanged,isFlightOutDeparted:y.bookingStates.departedFlights[b.outbound],isFlightInDeparted:y.bookingStates.isReturnTrip&&y.bookingStates.departedFlights[b.inbound],isFlightOutFreeMove:y.bookingStates.freeMoveFlights[b.outbound],isFlightInFreeMove:y.bookingStates.freeMoveFlights[b.inbound],isLegacyPlus:y.bookingStates.isLegacyPlus,isConnectingFlight:y.bookingStates.isConnectingFlight,isBuyOneGetOneDiscounted:y.bookingStates.isBuyOneGetOneDiscounted,isFlightFlown:y.bookingStates.isFlightFlown,somePaxFlown:y.bookingStates.paxFlownStatuses,isPaxBoardedOnFlightIn:y.bookingStates.paxBoardedStatus[b.inbound],hasErasmusDiscount:y.bookingStates.hasErasmusDiscount,isLMImported:y.bookingStates.isLMImported,isAircraftModelChangeRestricted:y.bookingStates.isAircraftModelChangeRestricted};e.execute(t).then(function(e){x("changeFlight",e.status,e.reason)})};t.get(l.getManageTripsConfigUrl()).then(function(e){y.manageItemList=e.data.items.map(function(t){if(!~e.data.disabled.indexOf(t.namespace)){var n=B(t.namespace);return{id:t.namespace,title:""+O+n,description:""+O+n+"_description",titleDisabled:""+O+n+"_disabled.title."+(y.states[t.namespace]||{}).reasonCode,descriptionDisabled:""+O+n+"_disabled."+(y.states[t.namespace]||{}).reasonCode,infoAlert:""+O+n+".alert."+(y.states[t.namespace]||{}).reasonCode,pendingAlert:""+O+n+".do_not_forget",url:t.url,icons:t.icons}}return{}})}),this.postNameChange=function(){"confirm"===y.nameChange.btnType?e.confirm():s.dispatch(g.saveChanges("check_price"))},this.updateContactValue=function(e){y.contact=u.getUpdatedContact(y.contact,e)};var j=function(){var e=function(e){var t=R.clone(e);return t.country=y.contact.phoneNumber.countryCode,t.email=y.contact.emailAddress,t.homePhone=v.getCountryPhoneCode(y.contact.phoneNumber)+"-"+y.contact.phoneNumber.number,t};return R.pipe(a.getModel("contacts"),R.head,e)(y.bookingModel)};this.updateContactDetails=function(t){t.$valid&&(y.requestForBookingModelUpdates("CONTACT_UPDATE_START"),u.update(u.getBookingPayload(y.contact)).then(function(){var t=j();y.updateBookingModel({contacts:t},"CONTACT_UPDATE_SUCCESS"),e.closeThisDialog()}))},this.saveSpecialAssistanceData=function(){if(y.specialAssistanceForm.$setSubmitted(),!y.specialAssistanceForm.$invalid){var t=D.getPassengersSpecialAssistancePayload(y.passengers,y.specialAssistance),n=a.getModel("passengers",y.bookingModel).map(D.renamePaxNum).map(function(e,n){return R.merge(t[n],e)}),i={Passengers:n};y.requestForBookingModelUpdates("SPECIAL_ASSISTANCE_UPDATE_START"),c.add(i).then(function(t){s.dispatch(f.updateBookingModel({passengers:t})),c.set(t),e.closeThisDialog(),c.notify(["segPrmAdded"])})["catch"](function(e){s.dispatch(f.handleSpecialAssistanceError(e.data))})}},U(),H(),w(),$(),G(),this.$onDestroy=function(){E()}}]);


"use strict";angular.module("app.booking").filter("calculatePaymentMethodPrice",["$filter","Booking",function(e,t){var a=e("displayPrice"),r=function(e,r){var n=r*(e/100),i=0,u=t.get("journeys");return u&&u[0]&&u[0].vatRate&&(i=n*u[0].vatRate),0!==e?a(n+i,!1,!0):"Free"};return r.$stateful=!0,r}]);


"use strict";angular.module("app.booking").filter("filterCompanions",function(){return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=[],r=new RegExp("^"+n,"i"),u=(e||[]).filter(function(e){return e.selected||t.push(e),!e.selected&&e.name.first.match(r)});return u.length&&u||t}});


"use strict";angular.module("app.booking").filter("outputPassengerBreakdown",function(){return function(e){var n=void 0,r=void 0;return e&&e.passengers?(n=e.tripType,r=Object.keys(e.passengers).map(function(n){return e.passengers[n].amount+" "+e.passengers[n].label}).join(", "),n+", "+r):""}});


"use strict";angular.module("app.booking").filter("paxFormElementTitle",["MarketConfig",function(e){return function(n,r){var t=void 0,i=[];if(angular.isDefined(n))for(var a=0;a<n.length;a++)t=n[a],(t.value.indexOf("Mrs")<0||"TEEN"!==r)&&("DE"!==e.getCountry().toUpperCase()||t.key.indexOf("MS")<0)&&i.push(t);return i}}]);


"use strict";angular.module("app.booking").filter("iataToStationName",["Stations",function(t){var a=function(a){return t.get("stations")?t.getCityName(a):(t.init(),a)};return a.$stateful=!0,a}]);


"use strict";var MockBookingData=function(t){function e(a,i,s,n){babelHelpers.classCallCheck(this,e);var o=babelHelpers.possibleConstructorReturn(this,t.call(this));return Object.assign(o,{$stateParams:a,DateConfig:i,Utilities:s,$http:n}),o}return e.$inject=["$stateParams","DateConfig","Utilities","$http"],babelHelpers.inherits(e,t),e.prototype.getBookingData=function(t){return this.$http.get(t||"/booking-data/base.json")},babelHelpers.createClass(e,[{key:"mockSearchData",get:function(){var t={Origin:"DUB",Destination:"CIA",INF:0,CHD:0,ADT:1,TEEN:0,RoundTrip:!0};return angular.extend(t,this.Utilities.getQueryParams()),t}}]),e}(ObservableService);MockBookingData.$inject=["$stateParams","DateConfig","Utilities","$http"],angular.module("app.booking").service("MockBookingData",MockBookingData);


"use strict";angular.module("app.booking").directive("flightListCalendarView",["$translate",function(e){return{restrict:"EA",transclude:!0,templateUrl:"/partials/booking/directives/calendar-view.html",controller:["$scope","$element","MonthlyAvailability",function(t,n,a){t.endDate="",t.startDate="",t.valueDay={};var i=this;i.events=[],i.weekendIndexes=[5,6,12,13,19,20,26,27,33,34,40,41],t.isWeekend=function(e){return i.weekendIndexes.indexOf(e)>-1},t.getInfo=function(e){return null===e||void 0===e||"null"===e.id||0===i.events.length?{price:"",priceValue:"",priceDigits:"",currency:"",noFlight:!1,isSoldOut:!1}:i.events[e.value-1]},t.isActiveFare=function(e){var n=t.getInfo(e);return void 0===n?!1:!n.noFlight&&!n.isSoldOut},i.loadFares=function(e,t){var n=[],o={},r={year:e,month:t,isBusiness:!1};i.events=[],i.loadDates(e,t),a.get(r).then(function(a){angular.forEach(a.days,function(e){o={currency:a.currency,price:e.amount,priceValue:parseInt(e.amount,10),priceDigits:e.amount.toString().substr(e.amount.toString().indexOf("."),3),isSoldOut:e.soldOut,noFlight:e.noFlight},n.push(o)}),i.events=n,i.loadDates(e,t)})},i.loadDates=function(e,t){var a=new Date(e,t+1,0).getDate(),o=moment({y:e,M:t+1,d:1}),r=moment({y:e,M:t+1,d:a}),l=n.find("core-datepicker")[0],s=angular.element(l).isolateScope(),u=angular.element(l).controller("core-datepicker");s.endDate=r.format("DD-MM-YYYY"),s.startDate=o.format("DD-MM-YYYY"),void 0!==u&&(s.$watch(function(){return s.weekDays},function(){i.setWeekLabels(s)}),u._refresh())},i.setWeekLabels=function(t){var n="common.weekdays.long.";e([n+"0",n+"1",n+"2",n+"3",n+"4",n+"5",n+"6"]).then(function(e){if(void 0!==t.weekDays)for(var a=0;7>a;a++)t.weekDays[a].value=e[n+a]})},t.$on("booking:flights:carousel-date-changed",function(e,t){i.loadFares(t.date.year(),t.date.month()+1)})}]}}]);


"use strict";angular.module("app.booking").component("domesticModal",{bindings:{passengers:"<",isOpen:"<",bookingModel:"<",onDialogClose:"&",onValidate:"&",serverErrors:"&"},controller:["$scope","DialogManager","Passengers","PassengerFactory","$filter","DateConfig","BookingRead","$ngRedux","BookingModelActions",function(e,t,a,s,n,r,o,i,l){var c=this,u=n("translate"),d=function(e){var t="trips.pax.domestic.prompt.",a=null;switch(e){case"success":case"failed":case"final":a=t+e;break;default:a=t+"default"}c.promptMessage=u(a),c.state=e,"final"===e&&c.passengers.forEach(function(e){"success"!==e.status&&(e.status="final")})},p=0,g=function(){d(),c.serverErrors({$event:{value:null}}),t.openConfirm("modalDialog",{template:"/partials/booking/directives/domestic-modal.html",scope:e,className:"scrollable"})["catch"](function(){c.onDialogClose({$event:{value:!1}})})};this.formatDate=function(e){return moment(e).format(r.specials.richDateInput.format)},this.validate=function(){c.loading=!0;var e=s.getSaraValidationPayload(c.passengers);a.validateSARA(e).then(function(e){var t=e.data,a="success";i.dispatch(l.resetSaraValidation()),t.map(function(e){var t="001"===e.validationCode;return c.passengers.find(function(t){return t.number===e.paxNum}).status=t?"success":"failed",t||(a="failed"),c.passengers}),d(a)},function(e){if(d("MaxAttemptsReach"===e.data.message?"final":"failed"),e.data.details){c.serverErrors({$event:{value:[]}});for(var t in e.data.details)c.serverErrors({$event:{value:c.serverErrors.concat(e.data.details[t].errors.map(function(e){return e.errorMessage}))}})}})["finally"](function(){c.loading=!1,"success"!==c.state&&("final"===c.state?c.currentAttempt=c.maxAttempt:c.currentAttempt<c.maxAttempt?c.currentAttempt++:(d("final"),c.currentAttempt=c.maxAttempt)),c.onValidate({$event:{value:c.state}})})},d(),this.loading=!1,this.currentAttempt=1,this.maxAttempt=3;var m=o.getModel("zoneDiscount",this.bookingModel),f=R.path(["0","code"],m);f&&(this.discountType=f.toLowerCase());var v=function(){var e=o.getBagItems(!1,c.bookingModel).length;e!==p&&(p=e,c.currentAttempt=1)};v(),this.$onChanges=function(e){e.isOpen&&e.isOpen.currentValue&&g(),e.passengers&&e.passengers.currentValue&&(c.passengers=e.passengers.currentValue)}}]});


"use strict";angular.module("app.booking").directive("flightFaresCarousel",["carouselDirective",function(e){var t="CarouselController"!==e[0].controller?angular.copy(e[0]):angular.copy(e[1]),a=t.controller instanceof Function?t.controller:t.controller[t.controller.length-1];return angular.extend({},t,{scope:{selectedDate:"=",type:"@",viewType:"@",faresSsr:"=",isLauda:"<",carouselArrowsConfig:"<",onPaneChange:"&"},controller:["$scope","$element","$timeout","Device","$window","$document","FlightSearch","Booking","Availability","Dates","FlightSearchConfig","$ngRedux","Session","AIRLINE_CONFIG",function(e,t,i,o,n,r,s,l,d,c,u,f,g,p){function y(e,t){return T&&T.clone().add(t,"days").isAfter(e[m].flightDate)}function h(t,a){return"inbound"===m&&!t.isReturn||t.ChangeFlight?void 0:t.isErasmus&&y(t,2)?void(t[m].flightDate=T):void(a?(A=!0,i(function(){e.scrollEnd()})):t.operatedBy||(t[m].flightDate=e.firstVisibleDate?e.firstVisibleDate:c.now))}var m=e.type,v=e.viewType||"daily",b=g.get("serverTimeUTC")||c.now,T=R.pathOr(null,["erasmus","config","startDate"],f.getState()),w=void 0,S={daily:"/partials/booking/directives/flight-fares-carousel-daily-pane.html",monthly:"/partials/booking/directives/flight-fares-carousel-monthly-pane.html"},x=[],A=!0,D={};for(e.disabledArrowTooltip=[!1,!1],a.apply(D,[e,t,i,o,n,r]),e.infiniteScroll=!0,e.panes=[],w=0;w<3*e.slidesToShow;w+=1)e.panes.push({date:c.utc(b).startOf("day").add(w,"day"),index:+w});e.getFarePrice=function(){return R.pathOr(0,["faresSsr","total"],e)},e.itemTemplate=S[v]||S.daily,e.fareType="regular",l.link("fareType",e,"fareType"),e.setSlidesToShow=function(){return e.slidesToShow=o.isPhone()||o.isTablet()?3:5,e.slidesToShow},e.setSlidesToShow(),e.moveTo=function(e,t){t.goToPage(e,0,1e3)},e.onPrev=function(t){e.carouselArrowsConfig.prev.disabled?e.disabledArrowTooltip[0]=!0:e.moveTo(Math.max(0,t.currentPage.pageX-e.slidesToShow),t)},e.onNext=function(t){e.carouselArrowsConfig.next.disabled?e.disabledArrowTooltip[1]=s.model.operatedBy!==p.AIRMALTA.airline:e.moveTo(t.currentPage.pageX+e.slidesToShow,t)},e.stateUpdated=function(t){e.$emit("booking:flights:carousel-date-changed",{type:m,date:c.utc(b).startOf("day").add(t,"day")})},e.postInit=function(){e.postInitCalled=!0,e.$watch("activePane",function(t,a){t!==a&&e.stateUpdated(e.activePane)}),e.$watch("selectedDate",function(t,a){if(e.selectedDate&&!D.iscroll.isAnimating&&(!t.isSame(a)||A)){var i=c.utc(c.formatISO(e.selectedDate)),o=c.utc(b).startOf("day"),n=moment.duration(i-o).asDays(),r=void 0;A?(r=Math.max(0,n-Math.floor(e.slidesToShow/2)),D.iscroll.goToPage(r,0,1e3),e.firstVisibleDate=c.utc(b).startOf("day").add(r,"day"),A=!1):n>=D.iscroll.currentPage.pageX&&n<D.iscroll.currentPage.pageX+e.slidesToShow||(D.iscroll.goToPage(n,0,1e3),e.firstVisibleDate=c.utc(b).startOf("day").add(n,"day")),e.activePane=n}}),d.registerPreExecuteCallback(h)},e.scrollEnd=function(){var t=R.path(["iscroll","currentPage","pageX"],D),a=c.utc(b).startOf("day").add(t,"day"),i=angular.copy(s.model),o=void 0;if(e.firstVisibleDate=a,i.operatedBy){var n={prevPane:{first:a.clone().subtract(e.slidesToShow,"days"),last:a.clone().subtract(1,"days")},nextPane:{first:a.clone().add(e.slidesToShow,"days"),last:a.clone().add(2*e.slidesToShow-1,"days")}};e.onPaneChange({type:m,visibleDates:n})}else i[m].flightDate=i[m].flightDate,i[m].flexibleDays=e.slidesToShow-1;i[m].firstVisibleDate=a,i.requestCount=i.requestCount?i.requestCount+1:0,s.execute(i,{saveModel:!1}).then(function(t){t.length&&t["outbound"===m?0:1].dayCarousel?(x=t["outbound"===m?0:1].dayCarousel.panes,e.slideElements.forEach(function(t){var i=t.dataset?t.dataset.index:t.getAttribute("data-index")||t.getAttribute("index"),n=e.panes.find(function(e){return e.index===+i}),r=a.clone().add(e.slidesToShow,"day").subtract(1,"second");n&&n.date&&(n.date.isBetween(a,r)||n.date.isSame(a))&&(o=x.find(function(e){return n.date.isSame(e.date)}),angular.extend(n,o))})):setTimeout(function(){e.scrollEnd()},100)})},e.requestData=function(e,t){setTimeout(function(){e=e||0,t=Math.min(t||100,2e3);var a=Array.apply(void 0,babelHelpers.toConsumableArray(new Array(t))).map(function(t,a){return{index:e+a,item:{date:c.utc(b).startOf("day").add(e+a,"day")}}});D.iscroll.updateCache(e,a)})},e.updateContent=function(t,a){if(a){var i=t.dataset?t.dataset.index:t.getAttribute("data-index")||t.getAttribute("index"),o=e.panes.find(function(e){return e.index===+i}),n=x.find(function(e){return moment(e.date).isSame(a.item.date)})||{fare:void 0,isSoldOut:!1,isNotAvailable:!1,date:a.item.date};n.index=a.index,o&&angular.extend(o,n)}e.$evalAsync()};var C=f.subscribe(function(){s.model.operatedBy&&s.model.operatedBy!==p.AIRMALTA.airline&&e.scrollEnd()});this.$onDestroy=function(){d.deregisterPreExecuteCallback(h),C()}}]})}]);


"use strict";angular.module("app.booking").component("flightList",{bindings:{isDefaultState:"<",selectedFareOption:"<",title:"@",type:"@",model:"<",selection:"<",onSelect:"&",bookingError:"<",allFlightsSelected:"<",originalFlight:"<?",outboundDate:"<",inboundDate:"<",isLauda:"<",carouselArrowsConfig:"<",onCarouselPositionChange:"&",onNewDateSelected:"&",onAirMaltaFlightChange:"&",is20PercentDiscountEnabled:"<"},templateUrl:"/partials/booking/directives/flight-list.html",controller:["Configuration","Session","Dates","ChangeFlightActions","AEMConfig","MorphPopupManager","$filter","$ngRedux","FlightSearchActions","FlightSearchUtil","BookingRead","FEATURE_CONFIG","PRODUCT_FARE_TYPES","CARD_CODES","AIRLINE_CONFIG",function(e,t,i,n,r,a,o,l,s,u,c,g,f,d,h){var p=this,m=[],b=void 0,y=[],F=function(e,t,i){return e||t?"outbound"===i?"inboundFareType":"outboundFareType":"outbound"===i?"outboundFareType":"inboundFareType"},v=function(e){if(!p.isChangeFlight)return!1;var t=i.utc(p.oldJourney.startDateUTC).isSame(i.utc(e.departTimeUTC))&&p.oldJourney.flightOutKey===e.number,n=i.utc(p.oldJourney.endDateUTC).isSame(i.utc(e.departTimeUTC))&&p.oldJourney.flightInKey===e.number;return t||n},_=function(e,t){return e.number===t.number&&0===i.utc(t.departTime).diff(i.utc(e.departTime))},O=function(e){return p.disabledFlights.some(function(t){return _(e,t)})},D=function(e){return p.flightsWithWarnings.some(function(t){return _(e,t)})},S=function(e,t){return p.selection.flights.some(function(n){if(!n)return!1;var r=0===i.utc(e.departTime).diff(i.utc(n.depart))&&n.number===e.number;if(r){if("Error"===t&&n.availabilityError)return e.availabilityError=n.availabilityError,!0;if("Warning"===t&&!R.isEmpty(R.propOr([],"warnings",n)))return e.warnings=n.warnings,!0}return!1})},T=function(e,t){var i="Error"===t?O(e,p.disabledFlights):D(e,p.flightsWithWarnings),n=S(e,t);return i||n},C=function(e){angular.isObject(e.ADT)&&(e.ADT.discountInPercent>0||e.ADT.hasDiscount)?e.discountKey=e.type.charAt(0):e.discountKey=""},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[];return e.forEach(function(e){C(e),e.discountKey&&t.push(e.discountKey)}),t.sort().join("")},I=function(e,t){var i=R.pathOr(!1,["currentValue"].concat(babelHelpers.toConsumableArray(t)),e),n=R.pathOr(!1,["previousValue"].concat(babelHelpers.toConsumableArray(t)),e);return R.not(R.equals(i,n))},A=function(e){var t=o("translate");p.popupId=e,p.selectedOption={name:t("trips.flight_list_header.sort_by"),value:"default"},p.options=[{name:t("trips.flight_list_header.price"),value:"fares[0].ADT.amount"},{name:t("trips.flight_list_header.departure_time"),value:"departTime"},{name:t("trips.flight_list_header.arrival_time"),value:"arrivalTime"},{name:t("trips.flight_list_header.journey_duration"),value:"duration"}]},j=function(t){p.departureLimit=e.get("minimumDepartTime"),p.connectionLimit=e.get("minimumConnectionTime"),p.longSellLimit=e.get("longSellLimit"),p.infantsRequired=R.pathOr(!1,["flightPassengers","INF"],p),p.alertFlights(t)},M=function(e,t){var i=R.pathOr({},["currentValue"],e),n=R.pathOr({},["previousValue"],e),r=R.prop(b,i),a=R.prop(b,n);if(p.selectedFlightInfo.selectedFareType=r,p.selectedFlightInfo.fareUpdateDisabled=r&&t===i.disabledDirection,R.not(R.contains(void 0,[r,a]))&&p.selectedFlightObject){if(p.selectedFareObject.fareType=r,p.selectedFareObject.type=r,i.operatedBy!==h.AIRMALTA.airline)switch(r){case f.LEISURE:p.selectedFareObject.fareOption=d.SURE;break;case f.BUSINESS:p.selectedFareObject.fareOption=d.PLUS;break;case f.FAMILY:p.selectedFareObject.fareOption=d.FAMI;break;default:p.selectedFareObject.fareOption=""}p.onFlightSelected(p.selectedFlightObject,p.selectedFareObject,!0)}};this.togglePopup=function(){a.isOpen(p.popupId)?a.closeAllPopup():a.openPopup(p.popupId)},this.resetLeg=function(){p.selectedFlightInfo={flight:null,fare:null,selectedFareType:null}},this.selecedtOption=function(e){p.selectedOption=e,p.closePopup()},this.closePopup=function(){a.isOpen(p.popupId)&&a.closePopup(p.popupId)},this.onPaneChange=function(e,t){p.onCarouselPositionChange({type:e,visibleDates:t})},this.onChangeFare=function(){p.resetLeg(),p.onSelect(),p.selectedFlightInfo.flight=null,p.selectedFlightInfo.fare=null,p.selectedFlightObject=null,p.selectedFareObject=null;var e="outbound"===p.type?0:1;l.dispatch(s.removeSelectedJourney(e)),l.dispatch(s.setDisabledDirection("inbound")),p.selectedFlightInfo.fareUpdateDisabled="inbound"===p.type},this.alertFlights=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=p.selection.flights[0],n=p.selection.flights[1];if("outbound"===p.type){var r=e.find(function(e){return 0!==e.faresLeft});r&&(p.selection.outboundFlight={flightKey:r.flightKey,fareKey:r.fares[0].fareKey})}e.forEach(function(e){e.infoMsg=[];var r=!1,a=function(t){e.infoMsg=[].concat(babelHelpers.toConsumableArray(e.infoMsg),[t])},o=moment.utc(t.get("serverTimeUTC")||new Date),l=e.departTimeUTC,s=l.diff(o,"minutes")-p.departureLimit,u=24*p.longSellLimit*60,c=~p.longSellLimit?l.diff(o,"minutes")-u:1;if(p.bookingError){var g=(((p.bookingError.flightData||{}).config||{}).data||{}).flights||[];if(g.find(function(t){return t.flightKey===e.flightKey}))return a({message:"trips.notifications.messages.http_error",error:!0}),void(e.selectionDisabled=!0)}if(0>c)return r=!0,a({message:"trips.notifications.messages.long_sell_limit",error:!0}),void(e.selectionDisabled=!0);if(p.infantsRequired&&e.infantsLeft<p.infantsRequired&&!p.flightInfo.operatedBy)return r=!0,a({message:"trips.notifications.messages.max_infants_limit",error:!0}),void(e.selectionDisabled=!0);if(0>s)return r=!0,a({message:"trips.flight_list_table.min_departure_time_breached",error:!0}),void(e.selectionDisabled=!0);if(v(e))return r=!0,a({message:"trips.flight_list_table.original_flight_is_unselectable",error:!0}),void(e.selectionDisabled=!0);if(T(e,"Error"))return r=!0,O(e)?e.availabilityError=p.disabledFlights.filter(function(t){return _(e,t)})[0].availabilityError:p.disabledFlights.push(angular.copy(e,{})),a({message:"trips.flight_list_table."+e.availabilityError.key,error:!0}),void(e.selectionDisabled=!0);if(T(e,"Warning"))return D(e)?e.warnings=p.flightsWithWarnings.filter(function(t){return _(e,t)})[0].warnings:p.flightsWithWarnings.push(angular.copy(e,{})),R.propOr([],"warnings",e).forEach(function(e){a({message:"trips.flight_list_table."+e.key,alert:!0})}),void(e.selectionDisabled=!1);switch(p.type){case"outbound":R.path(["depart"],n)&&n.depart.diff(e.arrivalTime,"minutes")-p.connectionLimit<0&&(r=!0,a({message:"trips.flight_list_table.min_connection_time_breached.outbound",alert:!0}));break;case"inbound":R.path(["depart"],i)&&e.departTime.diff(moment(i.arrive),"minutes")-p.connectionLimit<0&&(r=!0,a({message:"trips.flight_list_table.min_connection_time_breached.inbound",alert:!0}));break;default:return}return r?void(e.selectionDisabled=!0):(e.faresLeft||(e.selectionDisabled=!0),void(e.discountTypes=E(e.fares)))})},this.onFlightSelected=function(e,t,i){p.selectedFlightInfo.flight=e.flightKey,p.selectedFlightInfo.fare=t.fareKey,p.selectedFlightObject=e,p.selectedFareObject=R.clone(t),p.onSelect({flight:{number:e.number,flightKey:e.flightKey,depart:e.departTime,arrive:e.arrivalTime,freeMoveRange:e.freeMoveRange,fareType:t.type,fareKey:t.fareKey,fareAmount:t.amount,farePromoDiscount:t.ADT.hasPromoDiscount,fares:e.fares,fareOption:t.fareOption,duration:e.duration,segments:e.segments},automaticallySelected:i})},this.$onInit=function(){p.journeyNum="outbound"===p.type?0:1,p.resetLeg(),p.disabledFlights=[],p.flightsWithWarnings=[],p.selectedFlightObject=null,p.selectedFareObject=null,p.popupId=p.title;var e=function(e){var t=e.bookingModel,i=e.flightSearch,n=e.changeFlight;return{fareErrors:t.fareErrors,fareWarnings:t.fareWarnings,isErasmus:u.isErasmusSearch(i),flightInfo:i.info,hasSpanishDiscount:!!i.info.discount,flightPassengers:i.passengers,bookingModel:t,freeMoveFlights:c.getFreeMoveFlights(t),isReturnTrip:c.isReturnTrip(t),changeFlightState:n,isConnectingFlight:R.pathOr(!1,["info",0,"model","isConnectingFlight"],t),connectingAirport:R.pathOr(!1,["info","connectingAirport"],i),purchasedFareType:c.getPurchasedFareName(t,p.journeyNum),oldJourney:R.pathOr({},["originalFlightModel"],n),isMandatorySeatNeeded:u.isMandatorySeatNeeded(i)}};y.push(l.connect(e)(function(e){var t=e.bookingModel;t.fareErrors.length>0&&(t.fareErrors.forEach(function(e){p.selection.flights[e.journeyNum].availabilityError=e}),l.dispatch(n.resetChangeFlightFareErrors())),t.fareWarnings.length>0&&(t.fareWarnings.forEach(function(e){var t=p.selection.flights[e.journeyNum].warnings;p.selection.flights[e.journeyNum].warnings=t?[].concat(babelHelpers.toConsumableArray(t),[e]):[e]}),l.dispatch(n.resetChangeFlightFareWarnings())),Object.assign(p,e),b=F(!g["mixed-fare-types"],p.isConnectingFlight,p.type)})),p.isChangeFlight=!R.isEmpty(p.oldJourney),p.flightBannerImageDesktop=r.getStaticFilePrefix()+"/resources/ui/img/family_seats/FamilySeats_Desktop",p.flightBannerImageMobile=r.getStaticFilePrefix()+"/resources/ui/img/family_seats/FamilySeats_Mobile",p.flightBannerImageSmallMobile=r.getStaticFilePrefix()+"/resources/ui/img/family_seats/FamilySeats_Mobile_Alt"};var P=function(e){e&&e.currentValue&&I(e,[])&&p.onChangeFare()};this.$onChanges=function(e){var t=e.title,i=e.model,n=e.selection,r=e.isDefaultState;t&&I(t,[])&&A(t.currentValue),i&&I(i,["flights"])&&(p.selectedFareOption&&p.onAirMaltaFlightChange({index:p.journeyNum}),j(i.currentValue.flights)),i&&I(i,["dayCarousel","selectedDate"])&&(p.selectedFareOption&&p.onNewDateSelected({index:p.journeyNum}),p.onChangeFare()),n&&I(n,[b])&&M(n,p.type),P(r)},this.$doCheck=function(){if(R.path(["selection","flights"],p)!==m){var e=R.pipe(R.pathOr([],["flights"]),R.reject(R.equals(null)),R.length)(p.selection),t=R.pipe(R.reject(R.equals(null)),R.length)(m);R.not(R.equals(e,t))&&p.model.flights&&(p.alertFlights(p.model.flights),m=R.clone(p.selection.flights))}},this.$onDestroy=function(){y.forEach(function(e){return e()})}}]});


"use strict";angular.module("app.booking").directive("flightSelector",function(){return{restrict:"A",templateUrl:"/partials/booking/directives/flight-selector.html",controller:"flightSelectorCtrl",controllerAs:"vm",bindToController:!0,bindings:{originalFlights:"<?",inChangeFlight:"<?"}}}).controller("flightSelectorCtrl",["$attrs","$document","$ngRedux","$scope","$timeout","$q","$window","AEMConfig","AllPlaces","BasketMessageQueue","BookingModelActions","BookingRead","ChangeFlightActions","Device","DialogManager","FARES_CONFIG","FareOptions","FEATURE_CONFIG","FlightSearchActions","FlightSearchUtil","RuleEngine","smoothScroll","UpgradeFareRules","Availability","TargetService","Basket","FlightSearchModals","$state","PriorityBoardingActions","PriorityBoardingUtil","MarketConfig","AirMaltaFlightSelect","AIRLINE_CONFIG","LaunchDarklyService",function(e,i,t,n,a,o,r,s,l,g,d,u,f,c,h,p,b,y,F,m,v,C,D,M,k,O,S,A,P,E,B,x,I,U){var L=this,T=void 0,_=!1,w=void 0,N=void 0,$={};this.isOutboundDefualtState=!1,this.isInboundDefaultState=!1,this.selectedFareOption=null,this.fareUpgrade=!1,this.isLoading=!1,this.availabilityRequested=!1,this.faresConfig=p,this.familyPlusPricePP=y["fare-select-family-plus-upgrade-price-pp"],this.isLaudaCheckinMsgEnabled=y["lauda-airport-checkin-message-enabled"],this.carouselArrowsConfig={outbound:{prev:{disabled:!1,reason:""},next:{disabled:!1,reason:""}},inbound:{prev:{disabled:!1,reason:""},next:{disabled:!1,reason:""}}},this.isMixedFareMessageHidden=!1,this.isLauda=B.isLaudaMotion();var K=function(e){if(!L.inChangeFlight){var i="JOURNEY_UPDATED";e&&(i="FARE_REMOVED"),g.enqueue({code:i})}},H=function(e){return e.CHD+e.ADT+e.TEEN},q=function(){return L.faresUpgraded||!L.getVisibleLegs().find(function(e,i){return e?"regular"!==R.path([i,"fareType"],L.info.flights):!1})};M.subscribe("running",function(e){L.availabilityRequested=e,n.$digest()}),this.isLoaderVisible=function(){return L.getOperator()&&n.isLoading||L.availabilityRequested||L.getOperator()&&L.bookingRequested},this.openDetails=function(){h.open("flightDetailsPopup",{template:"/partials/booking/templates/flight-search.trip-details.html",className:"flight-details-popup dialog",data:Object.assign({},{flights:L.info.flights,fromCity:n.outboundFlightListModel.fromCity,toCity:n.outboundFlightListModel.toCity})})},this.getOperator=function(){return L.info.operatedBy},this.getImage=function(e,i){return""+s.getStaticFilePrefix()+e+(i?"@2x":"")+".png"},this.getMobileImage=function(e){return"family"===L.fareUpgrade?""+s.getStaticFilePrefix()+e+"-mobile@3x.png":""+s.getStaticFilePrefix()+e+"@2x.png"},this.is20PercentDiscountEnabled=y["20-percent-plus-discount-enabled"];var V=function(e,i){w=N,"family"===L.fareUpgrade&&L.familyPlusPricePP&&!i&&(w=e/L.faresAdded),"family"!==L.fareUpgrade&&i&&(w=e*L.faresAdded),L.fareUpgradePrice=w},j=function(){L.fareUpgrade=!1,L.benefits=[],q()&&o.all([l.findOne("category","airport",L.info.dest),l.findOne("category","airport",L.info.origin)]).then(function(e){var i=new v;i.register(D.rules);var t={legsEnabled:L.getVisibleLegs(),flights:L.info.flights,passengers:L.passengers,airports:e,familyPlusEnabled:y["family-plus-upgrade-card"],is20PercentDiscountEnabled:L.is20PercentDiscountEnabled};i.execute(t).then(function(e){if(L.fareUpgrade=e.offeredType,L.fareUpgrade&&(L.benefits=L.faresConfig[L.fareUpgrade].benefits,U.changeContext({Culture:B.getCutureLDFormat(),IsMobile:c.isMobile()}).then(function(){!L.isConnectingFlight&&R.pathOr(!1,["plus-fare-new-ssrs-enabled"],L.launchDarkly)&&L.benefits.splice(1,1)}),O.hasFareFootnote()&&(L.benefits=[].concat(babelHelpers.toConsumableArray(L.benefits),[{code:"REFUND_NOTE",desc:b.fareRefundFootnote(L.fareUpgrade)}]))),L.display20PercentDiscountBanner=L.is20PercentDiscountEnabled&&"business"===L.fareUpgrade,L.faresAdded=0,e.offeredType){var i=void 0;switch(e.offeredType){case"leisure":i="SURE";break;case"family":i="FAMI";break;default:i="PLUS"}var t=[];L.faresAdded=H(L.passengers),e.flights.forEach(function(e,i){t.push(b.getFareOptions({flightKey:e.flightKey,fareKey:e.fares[0].fareKey,type:0===i?"outbound":"inbound",operatedBy:L.info.operatedBy,passengers:L.passengers},L.info.outboundFlight,!0))}),o.all(t).then(function(e){N||V(N=e.reduce(function(e,t){return e+t.filter(function(e){return e.code===i}).reduce(function(e,i){return e+Number.parseFloat(i.total)},0)},0),!1);var t=e[0].find(function(e){return e.code===i});t&&(L.includedSsrs=t.includedSsrs),L.fareDiscount=Math.max.apply(Math,babelHelpers.toConsumableArray(R.flatten(e.map(function(e){return e.filter(function(e){return e.code===i})})).map(function(e){return e.percentageDiscount}))),L.discountKey="trips.flight_selector_fare_upgrade.discount_"+L.fareUpgrade+(L.fareDiscount>0?"":"_static")})}})})};this.includesSsr=function(e){return L.includedSsrs?L.includedSsrs.indexOf(e)>-1:!0},this.changeFare=function(e){return L.info.outboundFareType===e&&L.info.inboundFareType===e?(_=!0,L.faresUpgraded=!1,L.changeFareType("regular"),void V(N,!1)):(V(N,!0),L.faresUpgraded=!0,L.changeFareType(e),void(r._satellite&&r._satellite.track("FlightSelectFareUpsell")))};var G=function(e){return R.pipe(R.pathOr([],["originalFlightData","checkin"]),R.any(R.pathEq(["model","status"],"reprint")))(e)},J=function(){(L.inChangeFlight||!L.info.flights[1]||L.info.flights[0])&&("RoundTrip"!==L.info.changeFlight||L.info.flights[0]&&L.info.flights[1])&&(T&&a.cancel(T),T=a(function(){if(L.inChangeFlight){var e=function(e){return R.pathOr(null,["info",e],L)},i={PromoCode:e("promoCode"),DISC:e("discount"),FareOption:m.getFareOption({info:L.info}),OperatedBy:e("operatedBy"),OutboundDate:e("outbound").flightDate,InboundDate:e("isReturn")?e("inbound").flightDate:null,flights:e("flights").map(function(e){var i={flightKey:e.flightKey,fareKey:e.fareKey,freeMoveRange:e.freeMoveRange,promoDiscount:e.farePromoDiscount};return i})};if(i.Origin=e("origin"),i.Destination=e("dest"),i.isChangeFlight=!0,i.ChangeFlight=e("changeFlight"),"Inbound"===i.ChangeFlight){var n=i.Destination;i.Destination=i.Origin,i.Origin=n}i.flights[0]||(i.flights=[i.flights[1]]);G(L.changeFlight);R.pathOr(!1,["uncheck-passengers-on-flight-change-enabled"],L.launchDarkly)&&G(L.changeFlight)?h.openConfirm("uncheckWarningModal",{template:"/partials/booking/directives/change-flight/change-flight-uncheck-msg.html",className:"uncheck-passanger-msg-popup__dialog",overlay:!0,closeByEscape:!1,closeByDocument:!1,showClose:!1,hasModalBanner:!0},!1).then(function(){t.dispatch(f.postSelectedFlight(i))}):t.dispatch(f.postSelectedFlight(i))}else t.dispatch(d.postSelectedFlight()).then(function(){K(_),_=!1,j()})},300))};this.getVisibleLegs=function(){var e=[!0,!0];if(L.info)switch(L.info.changeFlight){case"RoundTrip":e=[!0,!0];break;case"Inbound":e=[!1,!0];break;case"Outbound":e=[!0,!1];break;default:e=[!0,L.info.isReturn]}return e};var Q=function(){var e=x.hasSelectedFlight(L.info);e&&["returnFlightListModel","outboundFlightListModel"].forEach(function(e){var i=R.pathOr([],[e,"flights"],n);n[e].flights=i.map(x.resetMixedFare)})},W=function(e,i){var t=x.getFlightModelKey(i),a=x.disableMixedFares(R.pathOr([],[t,"flights"],n),e);n[t].flights=a},Y=function(e,i){i?L.isInboundDefaultState=e:L.isOutboundDefualtState=e},z=function(e){var i=L.journeys.length>1;if(i){var t=x.getOpositeLegIndex(e);L.removeSelectedJourney(t),Y(!0,t)}};this.changeDate=function(e){L.selectedFareOption=null,Q(),Y(!0,x.getOpositeLegIndex(e))},this.updateAirMaltaFlights=function(e){W(L.selectedFareOption,e)},this.selectFlight=function(e,t,o){var r=["outbound","inbound"],s=R.pathOr(null,["search","operatedBy"],n);if(!t){L.faresUpgraded=!1,L.fareUpgrade=!1,L.benefits=[];var l=L.journeys.find(function(i){return R.path(["key","id"],i)===e});return s===I.AIRMALTA.airline&&(L.selectedFareOption=null,Q(),z(e)),void(l&&!L.inChangeFlight&&(K(!0),L.removeSelectedJourney(e)))}if(s===I.AIRMALTA.airline&&(L.selectedFareOption=x.getFareOption(t),W(x.getFareOption(t),e),Y(!1,e)),L.addSelectedFlight(t,e),L.info.disabledDirection||L.setDisabledDirection(r[1-e]),J(),!o){var g=void 0;if(!L.info.flights[0]||L.info.isReturn&&!L.info.flights[1])g=L.inChangeFlight?i[0].getElementById(r[1-e]):i[0].getElementById("outbound");else if(L.info.isReturn&&r[e]!==L.info.disabledDirection)g=L.inChangeFlight?i[0].getElementsByClassName("flight selected")[1-e]:i[0].getElementById("outbound"),g||(g=i[0].getElementById(r[1-e]));else{var d=i[0].getElementsByClassName("fare-upgrade__header"),u=babelHelpers.slicedToArray(d,1);g=u[0]}g&&a(function(){var e=c.isMobile()?10:100;C(g,{containerId:L.inChangeFlight?"dialog-body-slot":void 0,offset:e})},400,!1)}},this.onCarouselPositionChange=function(e,i){var t=R.path(["info","outbound","flightDate"],L),n=R.path(["info","inbound","flightDate"],L);$=babelHelpers["extends"]({},$,babelHelpers.defineProperty({},e,babelHelpers["extends"]({},i)));var a=R.pathOr(!1,["outbound","nextPane","first"],$),o=R.pathOr(!1,["inbound","prevPane","last"],$);L.carouselArrowsConfig.outbound.next.disabled=a&&a.isAfter(n),L.carouselArrowsConfig.outbound.next.reason="flight_after_inbound",L.carouselArrowsConfig.inbound.prev.disabled=o&&o.isBefore(t),L.carouselArrowsConfig.inbound.prev.reason="flight_before_outbound"};var X=function(e){var i=e.bookingModel,t=e.flightSearch,n=void 0===t?{}:t,a=e.expressBooking,o=void 0===a?{}:a,r=e.priorityBoarding,s=e.launchDarkly,l=e.changeFlight;L.inChangeFlight&&K(!1);var g={bundle:o.expressActive?o.selectedBundle:null,startDate:R.path(["info","outbound","flightDate"],n),operatedBy:R.path(["info","operatedBy"],n)},d=babelHelpers["extends"]({flightSearchModalParams:g,bookingError:i.errors,journeys:i.journeys},n,{hasSpanishDiscount:n.info.discount,hasErasmusDiscount:u.isErasmus(i),showPromoBanner:!m.isErasmusSearch(n),priorityBoarding:r,bookingModel:i,launchDarkly:s,changeFlight:l,isConnectingFlight:u.isConnectingFlight(i)});return L.bookingRequested=i.isLoading,n.info.operatedBy&&(d.isLoading=i.isLoading),d},Z=t.connect(X,F)(this),ee=S.checkModalOpen(this.flightSearchModalParams);ee&&S.openModal({modal:ee,scope:{}}),this.postFlight=function(){return y["cabin-bag-standalone-page-enabled"]?void t.dispatch(d.createBooking("")).then(function(){return t.dispatch(P.getPriorityAvailability())}).then(function(e){!E.isPriorityViewAvailable(L.bookingModel)||E.allLegsPriorityBoardingSoldOutAndLauda(L.bookingModel,e.payload)&&!L.bookingModel.journeys.some(function(e){return!E.isCabinBagLaudaRulesDisabled(e)})?A.go("booking.extras",{openSeatMapInfo:y["open-seat-map-for-all-on-pt"]||y["open-seat-map-for-all-on-cabin-bag-page"]}):A.go("booking.priority-boarding",{openSeatMapInfo:y["open-seat-map-for-all-on-cabin-bag-page"]})},function(){A.go("booking.priority-boarding",{openSeatMapInfo:y["open-seat-map-for-all-on-cabin-bag-page"]})}):void t.dispatch(d.createBooking("booking.extras",{openSeatMapInfo:y["open-seat-map-for-all-on-pt"]}))},this.postFlightAndGoToPayments=function(){t.dispatch(d.createBooking("booking.payment"))},this.staticFilePrefix=s.getStaticFilePrefix(),this.displayMixedFareInfo=k.isMixedFareMessageVisible()&&this.info.isReturn&&y["fare-selector-mixed-fare-message-visible"],e.$observe("inChangeFlight",function(e){e&&(L.inChangeFlight="true"===e)}),n.$on("$destroy",function(){b.clearCache(),Z()})}]);


"use strict";angular.module("app.booking").directive("tripFlightSummary",function(){return{restrict:"EA",templateUrl:"/partials/booking/directives/flight-summary.html",controllerAs:"vm",scope:{model:"=","for":"@"},controller:["$scope","smoothScroll",function(t,o){var r=this;this["for"]=t["for"],this.onFlightCardSelected=function(){var t=document.getElementById(r["for"]);t&&o(t,{offset:200,stopOnUserScroll:!0})}}]}});


"use strict";angular.module("app.booking").directive("flightListFilter",function(){return{restrict:"EA",scope:!0,templateUrl:"/partials/booking/directives/flights-filter.html",transclude:!0,controller:["$scope",function(e){e.filterOptions={allDay:"All day",morning:"Morning",afternoon:"Afternoon",evening:"Evening"},e.orderDropdown=[{label:"Select",value:""},{label:"Lowest Price",value:"lowPrice"},{label:"Airport",value:"airport"},{label:"Time",value:"time"}],e.myOrder=e.orderDropdown[0],e.selected=Object.keys(e.filterOptions)[0],e.checkFilter=function(l){e.selected=l}}]}});


"use strict";angular.module("app.booking").directive("loadingSpinner",function(){return{restrict:"A",templateUrl:"/partials/booking/directives/loading-spinner.html"}});


"use strict";angular.module("app.booking").component("mandatorySeatSavings",{templateUrl:"/partials/booking/directives/mandatory-seat-savings.html",controller:["BookingRead","$ngRedux",function(e,t){e.isMandatorySeatNeeded(t.getState().bookingModel)&&(this.moneySaved=R.pathOr(0,["seats","moneySavedOnChildSeats"],t.getState()))}]});


"use strict";angular.module("app.booking").directive("myTrips",function(){return{restrict:"A",scope:{unbalanced:"<",titleKey:"<"},templateUrl:function(t,e){return e.templateUrl||"/partials/booking/directives/my-trips.html"},controllerAs:"myTrips",controller:["$scope","$filter","$state","$q","FilterChain","AllPlaces","MyTripsFactory","Dates","Session","Deeplinking","BookingModelActions","$ngRedux","BookingRead","$window","CUSTOMER_FORMS",function(t,e,i,n,r,o,a,s,c,l,u,d,p,f,m){var h=this,g=void 0,k=void 0,v=void 0,y=void 0,A=1,b=14,B=function(t){return o.get(t||{})};this.isOTAButtonVisible=R.pathOr(!1,["launchDarkly","ota-link-enabled"],d.getState()),this.otaLink=m.customerVerification,this.unbalancedPnr=!1;var L=function(t){t?(h.allAirportsList=r.create(v).applyFilter("placesByNameOrCode",t,"all",t,"airport").value,h.nearbyAirportsList=r.create(y).applyFilter("placesByNameOrCode",t,"all",t,"airport").value):(h.allAirportsList=[].concat(v),h.nearbyAirportsList=[].concat(y))},N=function(t){t?h.toAirportsList=r.create(k).applyFilter("placesByNameOrCode",t,"all",t,"airport").value:h.toAirportsList=[].concat(v)},T=function(t){if(R.pathEq(["data","errors",0,"message"],"DotRez: BalanceDue",t)){var e={EmailAddress:h.info.email,ReservationNumber:h.info.reservationNum};d.dispatch(u.retrieveUnbalancedBooking(e)).then(function(){return 0===R.path(["bookingModel","errors"],d.getState()).length?n.resolve():n.reject()})}else R.pathEq(["data","errors",0,"message"],"DotRez: BookingRestricted",t)?f.location.href=m.customerVerification+"?state-from="+i.current.name:R.pathEq(["data","errors",0,"message"],"DotRez: BookingNotValidated",t)?f.location.href=m.openOnlineVerification+"?state-from="+i.current.name:h.retrieveBookingError=!0};this.getTitle=function(){return t.titleKey||"trips.my_trips.title"},this.valueListFilter=function(e,i){var n=t.selectedValueDeparture;return r.create(i).applyFilter("placesByNameOrCode","all","airport").applyFilter("airportsByDeparture",n)},this.retrieveBooking=function(){var t={EmailAddress:h.info.email,ReservationNumber:h.info.reservationNum};i.is("unbalanced-account")&&d.dispatch(u.retrieveUnbalancedBooking(t)).then(function(){return 0===R.path(["bookingModel","errors"],d.getState()).length?n.resolve():n.reject()})["catch"](function(){d.dispatch(u.retrieveBooking(t)).then(function(){return 0===R.path(["bookingModel","errors"],d.getState()).length?(h.linkBooking(),n.resolve()):n.reject()})["catch"](T)}),"check-in"!==i.params.stateName||l.isRedirected||h.unbalancedAccount?h.unbalancedAccount||d.dispatch(u.retrieveBooking(t)).then(h.linkBooking)["catch"](T):(l.isRedirected=!0,d.dispatch(u.retrieveBooking(t)).then(function(){return h.linkBooking()}).then(function(){return i.go(l.getStateName())})["catch"](T))},this.linkBooking=function(){if(c.isAuthenticated)if(h.addToAccount){c.set("bookingLinked",!0),c.remove("notLinked");var t=d.getState().bookingModel,e=t.journeys[0].model.departUTC;a.linkBooking(p.getBookingInfo(t).bookingId,e,h.info.reservationNum).then(function(){return c.set("bookingLinked",!0)})}else c.remove("bookingLinked"),c.set("notLinked",!0)},this.addToAccount=!0,this.isAuthenticated=c.isAuthenticated,this.reservation=null,this.popupId="my-trips-date-picker",this.defaultDate=s.format(moment()),this.startDateMin=s.format(moment().subtract(A,"years")),this.startDateMax=s.format(moment().add(b,"month")),this.info={email:l.emailAddress||null,cardNum:null,reservationNum:null,from:null,to:null,date:null},this.unbalancedAccount=i.is("unbalanced-account"),B().then(function(t){g=k=t.allPlaces,v=g.filter(function(t){return"airport"===t.category}),v=e("orderBy")(v,"name"),y=t.nearbyAirports,h.allAirportsList=[].concat(v),h.toAirportsList=[].concat(v),h.nearbyAirportsList=[].concat(y)}),t.$watch("myTrips.partialValueFrom",function(t){L(t)}),t.$watch("myTrips.partialValueTo",function(t){N(t)}),t.$watch("myTrips.info.from",function(t,e){e!==!1&&t?(k=t.routes.map(function(t){return v.find(function(e){return e.id===t})}).filter(function(t){return t}).sort(function(t,e){return t.name>e.name?1:-1}),h.toAirportsList=k,h.toAirportsList.find(function(t){return h.info.from.code===t.code})||(h.info.to=null)):h.toAirportsList=[].concat(v)}),t.$watch(function(){return c.isAuthenticated},function(t){h.isAuthenticated=t})}]}});


"use strict";angular.module("app.booking").directive("progressLoader",["$interval",function(i){return{restrict:"A",templateUrl:"/partials/booking/directives/progress-loader.html",scope:{loading:"="},link:function(n,r){var t=r.find(".progress-indicator"),o=0,e=100,c=null,a=function(){o=0,c=i(function(){t.css("width",o+"%"),o++,o>=100&&i.cancel(c)},e)};n.$watch("loading",function(){n.loading?a():(i.cancel(c),t.css("width",0))})}}}]);


"use strict";angular.module("app.booking").directive("svgLoader",function(){return{restrict:"EA",replace:!0,scope:{},template:'<svg class="{{svgClass}}"><use xlink:href="{{svgUrl}}"></use></svg>',link:function(s,e,r){s.svgUrl="/resources/svg/spritesheet.svg#"+r.svgLoader,s.svgClass=r.svgClass}}});


"use strict";angular.module("app.booking").factory("BagsReducer",["BAGS_ACTION_TYPES","ModelQuery",function(e,s){var r={initCompleted:!1,offers:[],quickAddLoading:!1,ssrs:[],bagsModified:!1,bagsInsuranceConfig:{}},n=function(e,r){return R.pipe(s.byModel({code:r.code,sold:!1}),s.byKey({journeys:r.journeyNum,passengers:r.passengerNum}),R.sortWith([R.descend(R.path(["model","total"]))]))(e)};return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,a=arguments[1],o=a.type,d=a.payload;switch(o){case e.SYNC_LOCAL_BAGS:return babelHelpers["extends"]({},t,{ssrs:d.ssrs||[],bagsModified:!1});case e.FETCH_OFFERS_START:return babelHelpers["extends"]({},t,{initCompleted:!1});case e.FETCH_OFFERS_SUCCESS:return babelHelpers["extends"]({},t,{offers:d.offers,initCompleted:!0,bagsModified:!1});case e.FETCH_OFFERS_FAILED:return babelHelpers["extends"]({},t);case e.QUICK_ADD_START:return babelHelpers["extends"]({},t,{quickAddLoading:!0});case e.QUICK_ADD_ERROR:case e.QUICK_ADD_SUCCESS:return babelHelpers["extends"]({},t,{quickAddLoading:!1});case e.ADD_BAG:return babelHelpers["extends"]({},t,{ssrs:t.ssrs.concat(d.bagModel),bagsModified:!0});case e.ADD_BAG_UPGRADE:return babelHelpers["extends"]({},t,{ssrs:t.ssrs.concat(d.upgradeModel),bagsModified:!0});case e.REMOVE_BAG_UPGRADE:case e.REMOVE_BAG:var l=n(t.ssrs,d)[0];return l?babelHelpers["extends"]({},t,{ssrs:t.ssrs.filter(function(e){return e!==l}),bagsModified:!0}):t;case e.RESET_BAGS:return babelHelpers["extends"]({},t,{ssrs:R.pipe(s.byModel({type:"BAGS",sold:!1,isPartOfBundle:!1}),s.byLocal(!0),s.complement(t.ssrs))(t.ssrs).map(function(e){return"BAGS"===e.model.type&&e.removed?babelHelpers["extends"]({},e,{removed:!1}):e}),bagsModified:!1});case e.ADD_DISCOUNT_TO_SMALLER:var u=R.pipe(s.byModel({code:"BAG",sold:!1}),s.byKey({journeys:d.journeyNum,passengers:d.passengerNum}),s.byRemoved(!1),R.sort(function(e,s){return s.model.total-e.model.total}))(t.ssrs),b=u.map(function(e,s){return 0===s?babelHelpers["extends"]({},e,{model:babelHelpers["extends"]({},e.model,{total:d.price,amt:d.price})}):babelHelpers["extends"]({},e)});return babelHelpers["extends"]({},t,{ssrs:b.concat(s.complement(t.ssrs)(u))});case e.REMOVE_DISCOUNT_FROM_SMALLER:var c=R.pipe(s.byModel({code:"BAG",sold:!1}),s.byKey({journeys:d.journeyNum,passengers:d.passengerNum}),s.byRemoved(!1),R.sort(function(e,s){return s.model.total-e.model.total}))(t.ssrs),p=c.map(function(e){return babelHelpers["extends"]({},e,{model:babelHelpers["extends"]({},e.model,{total:d.price,amt:d.price})})});return babelHelpers["extends"]({},t,{ssrs:p.concat(s.complement(t.ssrs)(c))});case e.FETCH_BAGS_INSURANCE_CONFIG_SUCCESS:return babelHelpers["extends"]({},t,{bagsInsuranceConfig:d});default:return t}}}]);


"use strict";angular.module("app.booking").factory("BreakfastReducer",["BREAKFAST_ACTION_TYPES",function(e){var r={isLoading:!1,isModalOpen:!1};return function(){var s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,t=arguments[1],n=t.type,a=t.payload;switch(n){case e.POST_TO_BOOKING_MODEL_START:case e.REMOVE_ALL_FROM_BOOKING_MODEL_START:case e.GET_OFFERS_START:return babelHelpers["extends"]({},s,{isLoading:!0});case e.REMOVE_ALL_FROM_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},s,{isLoading:!1});case e.POST_TO_BOOKING_MODEL_SUCCESS:return R.pipe(R.assoc("isLoading",!1))(s);case e.GET_OFFERS_SUCCESS:return babelHelpers["extends"]({},s,{isLoading:!1,prices:a.prices,items:a.items});case e.POST_TO_BOOKING_MODEL_ERROR:case e.REMOVE_ALL_FROM_BOOKING_MODEL_ERROR:case e.GET_OFFERS_ERROR:return babelHelpers["extends"]({},s,{isLoading:!1,errors:a});case e.ADD_SELECTED:return babelHelpers["extends"]({},s,{items:R.append(a.item,R.propOr([],"items",s)),prices:s.prices.map(function(e){return a.item.key.journeys===e.journeyNum?babelHelpers["extends"]({},e,{ctaState:a.state}):e})});case e.REMOVE_SELECTED:return babelHelpers["extends"]({},s,{items:R.reject(function(e){return e.key.passengers===a.paxNum&&e.key.journeys===a.journeyNum},s.items),prices:s.prices.map(function(e){return a.journeyNum===e.journeyNum?babelHelpers["extends"]({},e,{ctaState:a.state}):e})});case e.ADD_FOR_ALL_PAX_AND_ALL_JOURNEYS:return babelHelpers["extends"]({},s,{items:R.union(a.items,R.propOr([],"items",s)),prices:s.prices.map(function(e){return R.contains(e.journeyNum,a.journeysNum)?babelHelpers["extends"]({},e,{ctaState:a.state}):e})});case e.UPDATE_LOCAL:return babelHelpers["extends"]({},s,{items:R.pipe(R.propOr([],"items"),R.reject(function(e){return e.key.journeys===a.journeyNum}),R.concat(a.items))(s),prices:s.prices.map(function(e){return a.journeyNum===e.journeyNum?babelHelpers["extends"]({},e,{ctaState:a.state}):e})});case e.REMOVE_FOR_ALL_PAX_AND_ALL_JOURNEYS:return R.pipe(R.evolve({prices:R.map(function(e){return babelHelpers["extends"]({},e,{ctaState:a.state})})}),R.dissoc("items"))(s);case e.RESET:return r;default:return s}}}]);


"use strict";angular.module("app.booking").factory("CabinBagReducer",["CABINBAG_ACTION_TYPES","ModelQuery",function(e,d){var n={isLoading:!1,available:!1,meta:{},originalOffers:[],cabinBagFor:[],CODE:"CBAG",priceBreakdown:void 0,added:[],removed:[],bundleAdded:[],bundleRemoved:[]},r=function(e,n){return R.pipe(d.byKey(e),d.complement(n))(n)},a=function(e,d){var n=d.basketItems,a=d.keyQuery;return{removed:R.pipe(R.concat(e.removed),R.uniqWith(R.eqProps("key")))(n),added:r(a,e.added)}},t=function(e,d){var n=d.basketItems,a=d.keyQuery;return{bundleRemoved:R.pipe(R.concat(e.bundleRemoved),R.uniqWith(R.eqProps("key")))(n),bundleAdded:r(a,e.bundleAdded)}},s=function(e,n){return e.filter(function(e){return!d.findByKey(e.key)(n)})};return function(){var d=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,r=arguments[1],u=r.type,i=r.payload,o=void 0===i?{}:i;switch(u){case e.CABIN_BAGS_AVAILABLE:return babelHelpers["extends"]({},d,{available:!0});case e.FETCH_META_START:return babelHelpers["extends"]({},d,{isLoading:!0});case e.FETCH_META_SUCCESS:case e.FETCH_META_ERROR:return babelHelpers["extends"]({},d,{isLoading:!1,meta:o.meta,originalOffers:o.originalOffers});case e.PREPARE_CABIN_BAGS_FOR_JOURNEYS:case e.UPDATE_CABIN_BAGS_FOR_JOURNEYS:case e.UPDATE_CABIN_BAG_FOR_JOURNEY:return babelHelpers["extends"]({},d,{cabinBagFor:o.cabinBagsFor});case e.ADD_SELECTED_CABIN_BAGS_LOCALLY:if(o.addForBundle){var l=R.pipe(s,R.concat(d.bundleAdded))(o.items,o.basketItems.concat(d.bundleAdded));return babelHelpers["extends"]({},d,{bundleAdded:l,bundleRemoved:R.differenceWith(function(e,d){return R.equals(e.key,d.key)},d.bundleRemoved,o.items)})}var b=R.pipe(s,R.concat(d.added))(o.items,o.basketItems.concat(d.added));return babelHelpers["extends"]({},d,{added:b,removed:R.differenceWith(function(e,d){return R.equals(e.key,d.key)},d.removed,o.items)});case e.REMOVE_SELECTED_CABIN_BAGS_LOCALLY:if(o.removedForBundle){var _=o.items.reduce(t,d),c=_.bundleAdded,E=_.bundleRemoved;return babelHelpers["extends"]({},d,{bundleAdded:c,bundleRemoved:E})}var A=o.items.reduce(a,d),m=A.added,O=A.removed;return babelHelpers["extends"]({},d,{added:m,removed:O});case e.ADD_TO_BOOKING_MODEL_SUCCESS:case e.REMOVE_FROM_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},d,{isLoading:!1,added:[],removed:[]});case e.ADD_BUNDLE_TO_BOOKING_MODEL_SUCCESS:case e.REMOVE_BUNDLE_FROM_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},d,{isLoading:!1,bundleAdded:[],bundleRemoved:[]});case e.CLEAR_LOCAL_SELECTION:return babelHelpers["extends"]({},d,{added:[],removed:[]});default:return d}}}]);


"use strict";angular.module("app.booking").factory("ChekinModelReducer",["CHECKIN_MODEL_ACTION_TYPES","TRAVEL_DOCUMENTS_ACTIONS_TYPES","CHECKIN_ALLOCATION_ACTION_TYPES","FEATURE_CONFIG",function(e,a,r,n){var o={products:[],isLoading:!1,cases:void 0,ctaEnabled:!1,ctaBackEnabled:!1,ctaCancel:!0,selectedPassengersIds:[],selectedOptions:[!1,!1],showBackBtn:!1,selectedJourneys:[],options:[],currentPassengerDocument:null,hideFooter:!1,isRegularCheckinSeatsStepPassed:!1,showInfoBanner:!1,checkinSteps:[],prioritySelection:[[!1,!1],[!1,!1]],prioritySelectionNewPolicy:["",""],currentDocIndex:0,travelDocumentsList:[],nationalities:[],traveldocumentRules:{},allocationState:void 0,mandatorySeatMap:!1,hasLas:!1,allocationForm:void 0,documentError:!1,priorityAvailability:[],errors:[],isProductEngagedFromBoardingPass:!1,productsAdeddFromBoardingPass:void 0,productCodePassedFromBoardingPass:void 0,checkinExtrasConfig:{},showAllocationOptions:[!1,!1],seatsPopupShown:!1,upload:[],uploadErrors:[],uploadFetchPending:!1,uploadCommitPending:!1};return function(){var s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,t=arguments[1];switch(t.type){case e.START:return babelHelpers["extends"]({},s,t.payload);case e.RESET:return babelHelpers["extends"]({},o,{nationalities:s.nationalities,traveldocumentRules:s.traveldocumentRules,cases:s.cases,isProductEngagedFromBoardingPass:s.isProductEngagedFromBoardingPass,productCodePassedFromBoardingPass:s.productCodePassedFromBoardingPass,productsAdeddFromBoardingPass:s.productsAdeddFromBoardingPass});case e.GET_PRODUCTS_START:return babelHelpers["extends"]({},s,{isLoading:t.payload.reload});case e.SELECT_PAX:return babelHelpers["extends"]({},s,{selectedPassengersIds:[].concat(babelHelpers.toConsumableArray(s.selectedPassengersIds),[t.payload])});case e.UNSELECT_PAX:return babelHelpers["extends"]({},s,{selectedPassengersIds:s.selectedPassengersIds.filter(function(e){return e!==t.payload})});case e.SELECT_PASSENGERS:return babelHelpers["extends"]({},s,{selectedPassengersIds:[].concat(babelHelpers.toConsumableArray(s.selectedPassengersIds),babelHelpers.toConsumableArray(t.payload))});case e.GET_PRODUCTS_SUCCESS:return babelHelpers["extends"]({},s,{products:t.products});case e.GET_PRODUCTS_END:return babelHelpers["extends"]({},s,{isLoading:!1});case e.REMOVE_PRODUCT:return babelHelpers["extends"]({},s,{products:s.products.filter(function(e){return e.code!==t.code})});case e.GET_CASES_START:case e.GET_CASES_ERROR:return babelHelpers["extends"]({},s,{cases:[]});case e.GET_CASES_SUCCESS:return babelHelpers["extends"]({},s,{cases:t.payload.cases});case e.SET_CTA:return babelHelpers["extends"]({},s,{ctaEnabled:t.payload.ctaEnabled});case e.SET_SHOW_BACK_BTN:return babelHelpers["extends"]({},s,{showBackBtn:t.payload});case e.SET_OPTIONS:return babelHelpers["extends"]({},s,{options:t.payload});case e.SELECT_OPTION:return babelHelpers["extends"]({},s,{selectedOptions:R.update(t.payload.legIndex,t.payload.value,s.selectedOptions)});case e.SET_FOOTER_VISIBILITY:return babelHelpers["extends"]({},s,{hideFooter:t.payload});case a.ADD_TO_BOOKING_MODEL_START:case a.GET_TRAVEL_DOCUMENTS_START:return babelHelpers["extends"]({},s,{isLoading:!0});case a.ADD_TO_BOOKING_MODEL_ERROR:case a.ADD_TO_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},s,{isLoading:!1});case a.GET_TRAVEL_DOCUMENTS_SUCCESS:return babelHelpers["extends"]({},s,{sessionTravelDocuments:t.payload,isLoading:!1});case a.SET_CURRENT_PASSENGER_DOCUMENT:return babelHelpers["extends"]({},s,{currentPassengerDocument:t.payload});case a.UPDATE_TRAVEL_DOCS_LIST:return babelHelpers["extends"]({},s,{travelDocumentsList:t.payload.travelDocumentsList});case a.GET_NATIONALITIES_SUCCESS:return babelHelpers["extends"]({},s,{nationalities:t.payload.nationalities});case a.GET_DOCUMENTS_RULES_SUCCESS:return babelHelpers["extends"]({},s,{traveldocumentRules:t.payload.traveldocumentRules});case a.GET_CUSTOMER_DOCUMENTS_SUCCESS:var l=R.clone(s.travelDocumentsList[s.currentDocIndex]);return l.customerDocuments=t.payload.customerDocuments,l.birthDate=t.payload.birthDate,l.nationality=t.payload.nationality,l.isCompanion=t.payload.isCompanion,l.passengerId=t.payload.passengerId,l.documentsLoaded=!0,babelHelpers["extends"]({},s,{travelDocumentsList:[].concat(babelHelpers.toConsumableArray(s.travelDocumentsList.slice(0,s.currentDocIndex)),[l],babelHelpers.toConsumableArray(s.travelDocumentsList.slice(s.currentDocIndex+1))),documentError:!1});case a.GET_TRAVEL_DOCUMENTS_ERROR:return babelHelpers["extends"]({},s,{documentError:!0});case a.SELECT_CUSTOMER_DOCUMENT:var d=R.clone(s.travelDocumentsList[s.currentDocIndex]);return d.model=t.payload.doc,d.model.dob=s.travelDocumentsList[s.currentDocIndex].model.dob,babelHelpers["extends"]({},s,{loaded:!0,travelDocumentsList:[].concat(babelHelpers.toConsumableArray(s.travelDocumentsList.slice(0,s.currentDocIndex)),[d],babelHelpers.toConsumableArray(s.travelDocumentsList.slice(s.currentDocIndex+1)))});case a.SET_CURRENT_DOC_INDEX:return babelHelpers["extends"]({},s,{currentDocIndex:t.payload.index});case a.UPDATE_CURRENT_DOC:if(s.currentDocIndex<0)return s;var c=s.travelDocumentsList,u=c[s.currentDocIndex].model;return c[s.currentDocIndex].model=babelHelpers["extends"]({},u,t.payload.doc),babelHelpers["extends"]({},s,{travelDocumentsList:c});case a.UPDATE_PARENT_DOC:if(s.currentDocIndex<1)return s;var p=s.travelDocumentsList,i=p[s.currentDocIndex-1].model;return p[s.currentDocIndex-1].model=babelHelpers["extends"]({},i,t.payload.doc),babelHelpers["extends"]({},s,{travelDocumentsList:p});case a.SET_SHOW_ADDED_DOCUMENT:var b=s.travelDocumentsList,E=s.travelDocumentsList[s.currentDocIndex];return E.showAddedDocument=t.payload.showAddedDocument,babelHelpers["extends"]({},s,{travelDocumentsList:[].concat(babelHelpers.toConsumableArray(b.slice(0,s.currentDocIndex)),[E],babelHelpers.toConsumableArray(b.slice(s.currentDocIndex+1)))});case r.INIT_ALLOCATION_FORM:return babelHelpers["extends"]({},s,{allocationForm:t.payload.allocationForm,allocationState:t.payload.allocationState,showAccordion:!0,ctaEnabled:R.when(R.identity,R.all(R.pipe(R.values,R.all(R.identity))))(t.payload.allocationForm)});case r.SELECT:var S=s.allocationForm,_=s.allocationState,y=s.allocationChoiceSegment,m=void 0===y?[]:y;S[t.payload.journeyIndex]=t.payload.model,m[t.payload.journeyIndex]=t.payload.segmentIndex;var T=s.ctaEnabled;if(!n["open-seatmap-in-check-in"]){var C=function(){return R.any(R.pipe(R.props(["cancelled","flown","notOpen","allCheckedIn","blocked","onlineCheckinNotOpen"]),R.any(R.identity)))(_)},O=R.either(R.pipe(R.values,R.any(R.identity)),C);T=R.when(R.identity,R.all(O))(S)}return babelHelpers["extends"]({},s,{allocationForm:S,allocationChoiceSegment:m,ctaEnabled:T});case r.RESET_JOURNEY_ALLOCATION_FORM:var x=s.allocationChoiceSegment,N=void 0===x?[]:x;return N[t.payload.journeyIndex]=void 0,babelHelpers["extends"]({},s,{allocationChoiceSegment:N,allocationForm:R.update(t.payload.journeyIndex,t.payload.allocationForm,s.allocationForm)});case r.FETCH_LAST_TEN_STATUS_START:return babelHelpers["extends"]({},s,{ctaEnabled:!1});case r.NOTIFY_LAST_TEN_COMPLETE:return babelHelpers["extends"]({},s,{hasLas:t.payload,ctaEnabled:!0});case e.UPDATE_CHECKIN_STEPS:return babelHelpers["extends"]({},s,{checkinSteps:t.payload.checkinSteps});case r.INIT_BAG_PRICES_SUCCESS:return babelHelpers["extends"]({},s,{minimumSeatPrice:t.payload});case e.SET_MANDATORY_SEAT_MAP:return babelHelpers["extends"]({},s,{mandatorySeatMap:t.payload});case e.SET_REGULAR_SEATS_STEP_PASSED:return babelHelpers["extends"]({},s,{isRegularCheckinSeatsStepPassed:t.payload});case e.SET_PRIORITY_POPUP_ACCEPTED_JOURNEY_NUMS:return babelHelpers["extends"]({},s,{priorityPopupAcceptedJourneyNums:t.payload});case e.RESET_PRIORITY_SELECTION:return babelHelpers["extends"]({},s,{prioritySelection:[].concat(babelHelpers.toConsumableArray(o.prioritySelection))});case e.SET_PRIORITY_SELECTION:var A=t.payload,H=A.journeyNum,I=A.selection;return babelHelpers["extends"]({},s,{prioritySelection:Object.assign([],s.prioritySelection,babelHelpers.defineProperty({},H,I))});case e.RESET_PRIORITY_SELECTION_NEW_POLICY:return babelHelpers["extends"]({},s,{prioritySelectionNewPolicy:[].concat(babelHelpers.toConsumableArray(o.prioritySelectionNewPolicy))});case e.SET_PRIORITY_SELECTION_NEW_POLICY:var D=t.payload,P=D.journeyNum,L=D.selection;return babelHelpers["extends"]({},s,{prioritySelectionNewPolicy:Object.assign([],s.prioritySelectionNewPolicy,babelHelpers.defineProperty({},P,L))});case e.GET_PRIORITY_AVAILABILITY:return babelHelpers["extends"]({},s,{priorityAvailability:t.payload});case e.CHECKIN_PAX_SUCCESS:return babelHelpers["extends"]({},s,{showInfoBanner:!0});case e.CHECKIN_PAX_ERROR:return babelHelpers["extends"]({},s,{checkInProcessError:!0,checkInErrorCode:R.path(["payload","err","data","code"],t)});case e.GET_PRIORITY_AVAILABILITY_ERROR:var g=[].concat(babelHelpers.toConsumableArray(s.errors),[t.payload]);return babelHelpers["extends"]({},s,{errors:g});case e.PRODUCTS_ENGAGED_FROM_BOARDING_PASS:return babelHelpers["extends"]({},s,{isProductEngagedFromBoardingPass:t.payload});case e.PRODUCTS_ADDED_FROM_BOARDING_PASS:return babelHelpers["extends"]({},s,{productsAdeddFromBoardingPass:t.payload});case e.PRODUCT_TO_SHOW_ON_PAYMENT_PAGE:return babelHelpers["extends"]({},s,{productCodePassedFromBoardingPass:t.payload});case e.GET_CHECKIN_EXTRAS_CONFIG_SUCCESS:return babelHelpers["extends"]({},s,{checkinExtrasConfig:t.payload});case e.GET_CHECKIN_EXTRAS_CONFIG_ERROR:var v=[].concat(babelHelpers.toConsumableArray(s.errors),[t.payload]);return babelHelpers["extends"]({},s,{errors:v});case e.TOGGLE_SELECTED_JOURNEY:var U=t.payload,h=R.contains(U),f=R.ifElse(h,R.reject(R.equals(U)),R.append(U)),F=function(e){return e.sort()},M=R.pipe(f,F)(s.selectedJourneys),G=n["open-seatmap-in-check-in"]?M.length>0:s.ctaEnabled;return babelHelpers["extends"]({},s,{selectedJourneys:M,ctaEnabled:G});case e.VERIFIY_SELECTED_JOURNEYS:var j=n["open-seatmap-in-check-in"]&&s.selectedJourneys.length>0;return babelHelpers["extends"]({},s,{ctaEnabled:j});case e.SHOW_ALLOCATION_OPTIONS:return babelHelpers["extends"]({},s,{showAllocationOptions:R.update(t.payload,!0,s.showAllocationOptions)});case e.HIDE_ALLOCATION_OPTIONS:return babelHelpers["extends"]({},s,{showAllocationOptions:R.update(t.payload,!1,s.showAllocationOptions)});case e.SHOW_SEATS_POPUP:return babelHelpers["extends"]({},s,{seatsPopupShown:!0});case e.COMMIT_DOCS_START:return babelHelpers["extends"]({},s,{uploadCommitPending:!0});case e.COMMIT_DOCS_SUCCESS:case e.COMMIT_DOCS_ERROR:return babelHelpers["extends"]({},s,{uploadCommitPending:!1});case e.FETCH_DOCS_START:return babelHelpers["extends"]({},s,{uploadFetchPending:!0});case e.FETCH_DOCS_SUCCESS:return babelHelpers["extends"]({},s,{uploadFetchPending:!1,upload:t.payload});case e.FETCH_DOCS_ERROR:return babelHelpers["extends"]({},s,{uploadFetchPending:!1});case e.REMOVE_DOCS_START:return babelHelpers["extends"]({},s,{upload:s.upload.map(function(e){return e.journeyNum===t.payload.journeyNum&&e.paxNum===t.payload.paxNum&&e.key===t.payload.fileKey?babelHelpers["extends"]({},e,{removing:!0}):e}),uploadErrors:s.uploadErrors.filter(function(e){return e.journeyNum!==t.payload.journeyNum||e.paxNum!==t.payload.paxNum})});case e.REMOVE_DOCS_SUCCESS:return babelHelpers["extends"]({},s,{upload:[].concat(babelHelpers.toConsumableArray(s.upload.filter(function(e){return e.journeyNum!==t.payload.journeyNum||e.paxNum!==t.payload.paxNum})),babelHelpers.toConsumableArray(t.payload.files))});case e.REMOVE_DOCS_ERROR:return babelHelpers["extends"]({},s,{upload:s.upload.map(function(e){return e.journeyNum===t.payload.journeyNum&&e.paxNum===t.payload.paxNum&&e.key===t.payload.fileKey?babelHelpers["extends"]({},e,{removing:!1}):e}),uploadErrors:R.append({message:t.payload.error,journeyNum:t.payload.journeyNum,paxNum:t.payload.paxNum},s.uploadErrors)});case e.UPLOAD_START:return babelHelpers["extends"]({},s,{upload:[].concat(babelHelpers.toConsumableArray(s.upload),babelHelpers.toConsumableArray(t.payload.files.map(function(e){return{name:e.name,journeyNum:t.payload.journeyNum,paxNum:t.payload.paxNum,pending:!0,percent:0}}))),uploadErrors:s.uploadErrors.filter(function(e){return e.journeyNum!==t.payload.journeyNum||e.paxNum!==t.payload.paxNum})});case e.UPLOAD_PROGRESS:return babelHelpers["extends"]({},s,{upload:s.upload.map(function(e){return e.pending&&e.journeyNum===t.payload.journeyNum&&e.paxNum===t.payload.paxNum&&t.payload.files.some(function(a){return a.name===e.name})?babelHelpers["extends"]({},e,{percent:t.payload.percent}):e})});case e.UPLOAD_SUCCESS:return babelHelpers["extends"]({},s,{upload:[].concat(babelHelpers.toConsumableArray(s.upload.filter(function(e){return e.journeyNum!==t.payload.journeyNum||e.paxNum!==t.payload.paxNum})),babelHelpers.toConsumableArray(t.payload.files))});case e.UPLOAD_ERROR:return babelHelpers["extends"]({},s,{upload:s.upload.filter(function(e){return!(e.pending&&e.journeyNum===t.payload.journeyNum&&e.paxNum===t.payload.paxNum&&t.payload.files.some(function(a){return a.name===e.name}))}),uploadErrors:R.append({message:t.payload.error,journeyNum:t.payload.journeyNum,paxNum:t.payload.paxNum},s.uploadErrors)});default:return s}}}]);


"use strict";angular.module("app.booking").service("CheckinModelSelectors",["ModelQuery","BookingRead","PriorityBoardingUtil","BreakfastUtil","FastTrackUtils","BagsUtils","InflightProductsUtils","Dates","FEATURE_CONFIG","ParkingService",function(e,t,n,o,i,r,a,c,s,u){var l=this,p=R.prop("bookingModel"),d=R.prop("checkin"),m=R.compose(R.prop("products"),d),g=R.compose(R.prop("options"),d),f=R.compose(R.prop("selectedPassengersIds"),d),h=function(t,n){return R.compose(R.filter(function(e){return R.contains(e.key.id,n)}),e.byIdentity("passengers"),p)(t)},k=function(e){return h(e,f(e))},y=R.compose(R.prop("selectedOptions"),d),v=function(e){return function(t){return R.pipe(R.pathOr([],["checkin","allocationForm"]),R.addIndex(R.map)(function(n,o){return R.when(function(){return R.any(R.propEq(R.__,!0,n),e)},function(){return t.bookingModel.journeys[o]})(!1)}),R.filter(R.identity))(t)}},T=function(e,t){return R.path(["checkin","allocationChoiceSegment",t],e)},D=function(e,t){return R.is(Number,T(e,t))},b=function(e){return R.any(R.propEq(R.__,!0,e),["manualChoice","manualEarly"])},I=function(e){return function(t){if(!s["open-seatmap-in-check-in"])return!0;var n=T(e,t.key.journeys);return b(R.path(["checkin","allocationForm",t.key.journeys],e))||!R.is(Number,n)||n===t.key.id}},F=function(e){return R.pipe(R.pathOr([],["checkin","allocationForm"]),R.addIndex(R.map)(function(t,n){return R.when(function(){return b(t)||s["open-seatmap-in-check-in"]&&R.pipe(R.path(["checkin","selectedJourneys"]),R.contains(n))(e)},function(){return e.bookingModel.journeys[n]})(!1)}),R.filter(R.identity))(e)},C=v(["autoFree","manualChoice","manualEarly","manualNow"]),S=R.compose(R.prop("travelDocumentsList"),d),B=R.compose(R.prop("currentDocIndex"),d),M=R.compose(R.prop("nationalities"),d),N=R.compose(R.prop("traveldocumentRules"),d),P=function(e,t){return R.pipe(R.path(["bookingModel","travelDocuments"]),R.find(function(e){return e.key.passengers===t}),R.pathOr({},["model"]))(e)},x=function(e,t,n){var o={key:{id:t.key.id},model:{},customerDocuments:[],showAddedDocument:!0},i=P(e,t.key.id),r=i.infantTravelDocument,a=i.travelDocument,c=n?r:a;return c&&(o.model=c),o},O=function(e){var t=k(e),n=t.reduce(function(t,n){if(t=t.concat([x(e,n)]),n.model.inf){var o=x(e,n,!0);o.key.INF=!0,t=t.concat([o])}return t},[]);return n},_=function(e){return l.getTravelDocumentsList(e)[B(e)]},E=function(e,t){var n=R.pipe(R.path(["checkin","travelDocumentsList"]),R.filter(function(e){return e.key.id===t}))(e),o=n.find(function(e){return e.key.INF===!0}),i=n.find(function(e){return e.key.INF!==!0}),r={travelDocument:R.path(["model"],i)};return n.length>1&&(r.infantTravelDocument=R.path(["model"],o)),r},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];return!t||R.isEmpty(t)?!1:e.countryOfIssue===t.countryOfIssue&&0===c.utc(e.dob).diff(c.utc(t.dob))&&e.docNumber===t.docNumber&&e.docType===t.docType&&0===c.utc(e.expiryDate).diff(c.utc(t.expiryDate))&&e.nationality===t.nationality?!0:!1},A=function(e){var n=_(e);if(n){var o=t.getPassengerById(n.key.id,p(e)),i=o;return n.key.INF&&o&&(i={identity:"passengers",key:{id:o.key.id},model:{dob:o.model.inf.dob,name:R.pick(["title","first","middle","last"],o.model.inf),type:"INF",adultNum:o.model.num}}),babelHelpers["extends"]({},i,{isCompanion:n.isCompanion,passengerId:n.passengerId})}},U=function(e){return R.sum([t.getLeisureTotal(e.bookingModel),t.getFamilyTotal(e.bookingModel),t.getInsuranceTotal(e.bookingModel),t.getCabinBagTotal(e.bookingModel),n.getTotalBalance(e.priorityBoarding),o.getTotalBalance(e.breakfast),i.getTotalBalance(e.bookingModel,e.fastTrack),r.getTotalUnsoldData(e.bags).totalBalance,t.getSeatsTotalBalance(e.bookingModel),a.getTotalBalance(e.inflightProducts),u.getParkingTotal(e.bookingModel),R.pathOr(0,["transfers","totalPrice"],e)])},w=function(e,t){var n=[f(e),C(e)].map(R.length).reduce(R.multiply,1),o=R.pipe(R.pathOr(0,["checkin","products"]),R.flip(R.gt)(0)),i=U(e)>0;return o?i?"continue":n&&!t?"skip_to_boarding_passes":t?"continue":"skip_to_boarding_pass":"confirm"},j=R.pipe(R.path(["checkin"]),R.props(["selectedJourneys","allocationState","allocationForm"]),function(e){var t=babelHelpers.toArray(e),n=t[0],o=t.slice(1);return R.pipe(R.transpose,R.pick(n),R.values)(o)},R.map(R.pipe(R.reduce(R.merge,{}),R.pick(["flown","cancelled","checkinLater","allCheckedIn"]),R.values,R.any(R.identity))),R.all(R.identity),R.not);this.getState=d,this.getOptions=g,this.getSelectedOptions=y,this.getProducts=m,this.getSelectedPassengers=k,this.getSelectedJourneysToCheckin=C,this.getSelectedJourneysForSeats=F,this.isSegmentForSeats=I,this.getAllocationChoiceSegment=T,this.hasAllocationChoiceSegment=D,this.isAllocationFormElementForSeats=b,this.getTravelDocumentsList=S,this.getCurrentTravelDocument=_,this.isLastDoc=function(e){return B(e)===S(e).length-1},this.getCurrentDocIndex=B,this.getNationalities=M,this.getTraveldocumentRules=N,this.generateTravelDocumentsList=O,this.getExtrasCtaText=w,this.hasFlightsToCheckin=j,this.getCurrentPax=A,this.isDocInBookingModel=function(e){var t=A(e);if(!t)return!1;var n=E(e,t.key.id),o=P(e,t.key.id),i=!0;n.infantTravelDocument&&(i=L(n.infantTravelDocument,o.infantTravelDocument));var r=L(n.travelDocument,o.travelDocument)&&i;return r},this.getCheckinTotalToPay=U,this.getDocumentInBookingModel=function(e){var n=A(e);if(n){var o=t.getTravelDocumentForPax(e,n.key.id);return o?"INF"===R.path(["model","type"],n)?o.infantTravelDocument:o.travelDocument:void 0}},this.getDefaultAdditionalVisitInfo=function(n){return R.pipe(p,e.byIdentity("passengers"),function(e){return e.reduce(function(e,o){if(!e){var i=R.path(["travelDocument","additionalVisitInfo"],t.getTravelDocumentForPax(n,o.key.id));if(R.path(["contactEmail"],i))return i}return e},null)})(n)}}]);


"use strict";angular.module("app.booking").factory("EquipmentReducer",["EQUIPMENT_ACTION_TYPES",function(e){var r={isLoadingOffers:!1,isAddingToBookingModel:!1,addToBookingModelError:!1,isLoadingOffersError:!1,equipmentNotAvailable:!1,SPORTS:{dialog:null,totalPrice:0,offers:null},BABY:{dialogId:null,totalPrice:0,offers:null},MUSIC:{dialogId:null,totalPrice:0,offers:null}},n=function(e,r){return function(n){var t,o=["flightOutPrice","flightBackPrice"],a=["flightOutAvailableItems","flightBackAvailableItems"],l=n.prices.find(function(r){return r.paxType===e});return l?(t={code:n.code,type:n.type,maxPerPassenger:n.maxPerPassenger},babelHelpers.defineProperty(t,o[r],l&&l.total),babelHelpers.defineProperty(t,a[r],n.availableItems),t):void 0}},t=function(e,r){var t=e.codes,o=e.info,a=e.paxTypes;return a.map(function(e){return o.map(function(o,a){return o.offers.filter(function(e){return!!~t[r].indexOf(e.code)}).map(n(e,a)).filter(function(e){return!!e}).sort(function(e,r){return e>r})}).reduce(function(e,r){return r.map(function(r,n){return Object.assign(r,e[n])})},[])}).reduce(function(e,r,n){var t={};return t[a[n]]=r.length?r:null,babelHelpers["extends"]({},e,t)},{})};return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,o=arguments[1];switch(o.type){case e.FETCH_OFFERS_START:return babelHelpers["extends"]({},n,{isLoadingOffers:!0});case e.FETCH_OFFERS_SUCCESS:return babelHelpers["extends"]({},n,{isLoadingOffers:!1,SPORTS:babelHelpers["extends"]({},n.SPORTS,{offers:t(o.payload,"SPORTS")}),BABY:babelHelpers["extends"]({},n.BABY,{offers:t(o.payload,"BABY")}),MUSIC:babelHelpers["extends"]({},n.MUSIC,{offers:t(o.payload,"MUSIC")})});case e.FETCH_OFFERS_ERROR:return babelHelpers["extends"]({},n,{isLoadingOffers:!1,isLoadingOffersError:!0});case e.ADD_TO_BOOKING_MODEL_START:return babelHelpers["extends"]({},n,{isAddingToBookingModel:!0});case e.ADD_TO_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},n,{isAddingToBookingModel:!1,addToBookingModelError:void 0});case e.ADD_TO_BOOKING_MODEL_ERROR:return babelHelpers["extends"]({},n,{isAddingToBookingModel:!1,addToBookingModelError:o.payload});case e.UPDATE_TOTAL_PRICE:var a=babelHelpers["extends"]({},n),l=o.payload,i=l.equipmentType,s=l.value;return a[i]=babelHelpers["extends"]({},a[i],{totalPrice:a[i].totalPrice+=s}),a;case e.RESET:return r;default:return n}}}]);


"use strict";angular.module("app.booking").factory("FastTrackReducer",["FAST_TRACK_ACTION_TYPES","ModelQuery",function(e,r){var n={isLoading:!1,isModalOpen:!1,priceBreakdown:void 0,added:[],removed:[]},d=function(e,n){return R.pipe(r.byKey(e),r.complement(n))(n)},a=function(e,r){var n=r.basketItems,a=r.keyQuery;return{removed:R.pipe(R.concat(e.removed),R.uniqWith(function(e,r){return e.key===r.key}))(n),added:d(a,e.added)}},t=function(e,n){return e.filter(function(e){return!r.findByKey(e.key)(n)})},s=function(e){return R.map(function(e){return R.reduce(function(e,r){return e+r.unitTotal},0)(e)})(e)};return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,d=arguments[1],u=d.type,i=d.payload;switch(u){case e.ADD_TO_BOOKING_MODEL_START:case e.REMOVE_FROM_BOOKING_MODEL_START:case e.FETCH_OFFERS_START:return babelHelpers["extends"]({},r,{isLoading:!0});case e.FETCH_OFFERS_SUCCESS:var o=s(i.priceBreakdown);return babelHelpers["extends"]({},r,{isLoading:!1,priceBreakdown:i.priceBreakdown,journeyPrices:o});case e.FETCH_OFFERS_ERROR:return babelHelpers["extends"]({},r,{isLoading:!1});case e.OPEN_MODAL:return babelHelpers["extends"]({},r,{isModalOpen:!0});case e.CLOSE_MODAL:return babelHelpers["extends"]({},r,{isModalOpen:!1});case e.ADD_SELECTED_FAST_TRACKS:var c=R.pipe(t,R.concat(r.added))(i.items,i.basketItems.concat(r.added));return babelHelpers["extends"]({},r,{added:c,removed:R.differenceWith(function(e,r){return R.equals(e.key,r.key)},r.removed,i.items)});case e.REMOVE_SELECTED_FAST_TRACKS:var _=i.reduce(a,r),O=_.added,E=_.removed;return babelHelpers["extends"]({},r,{added:O,removed:E});case e.CLEAR_LOCAL_SELECTION:return babelHelpers["extends"]({},r,{added:[],removed:[]});case e.ADD_TO_BOOKING_MODEL_SUCCESS:case e.REMOVE_FROM_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},r,{isLoading:!1,added:[],removed:[]});default:return r}}}]);


"use strict";angular.module("app.booking").factory("FlightExtrasReducer",["FLIGHT_EXTRAS_ACTION_TYPES",function(e){var r={extras:void 0,quickAddAbility:void 0,extrasCodes:void 0};return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,a=arguments[1],s=a.type,n=a.payload;switch(s){case e.GET_QUICK_ADD_START:case e.GET_QUICK_ADD_ERROR:return babelHelpers["extends"]({},t,{quickAddAbility:void 0});case e.GET_QUICK_ADD_SUCCESS:return babelHelpers["extends"]({},t,{quickAddAbility:n.quickAddAbility});case e.GET_EXTRAS_START:case e.GET_EXTRAS_ERROR:return babelHelpers["extends"]({},t,{extras:void 0});case e.GET_EXTRAS_SUCCESS:var d=function(e){var r=e.code;return R.not(R.find(R.whereEq({code:r}))(R.propOr([],"extras",n)))},i=R.filter(d)(R.pathOr([],["extras"],t)),o=[].concat(babelHelpers.toConsumableArray(i),babelHelpers.toConsumableArray(n.extras)),u=R.map(R.prop("code"))(o);return babelHelpers["extends"]({},t,{extras:o,extrasCodes:u});case e.CLEAR_ALL:return r;default:return t}}}]);


"use strict";angular.module("app.booking").factory("InsuranceReducer",["INSURANCE_ACTION_TYPES",function(e){var a={isLoading:!1,isSelectionConfirmed:!1,countries:[],offersForPax:[],paxCORs:[],sameCORandPackageForAll:!1,paxHavePackage:[],confirmedPackages:0,selectedOffers:[],selectionTotal:0,choiceIsMade:!1};return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,s=arguments[1];switch(s.type){case e.ADD_TO_BOOKING_MODEL_START:case e.FETCH_COUNTRIES_START:return babelHelpers["extends"]({},r,{isLoading:!0});case e.FETCH_COUNTRIES_SUCCESS:return babelHelpers["extends"]({},r,{isLoading:!1,countries:s.countries});case e.FETCH_COUNTRIES_ERROR:return babelHelpers["extends"]({},r,{isLoading:!1,countries:[]});case e.FETCH_OFFERS_FOR_PASSENGER_START:var n=r.offersForPax.slice(),t=r.paxCORs.slice();return n[s.paxnum]=[],s.updateCORs&&(t[s.paxnum]=s.country),babelHelpers["extends"]({},r,{isLoading:!0,offersForPax:n,paxCORs:t});case e.FETCH_OFFERS_FOR_PASSENGER_SUCCESS:var l=r.offersForPax.slice();return l[s.paxnum]=s.offer,babelHelpers["extends"]({},r,{isLoading:!1,offersForPax:l});case e.FETCH_OFFERS_FOR_ALL_PASSENGERS_START:return babelHelpers["extends"]({},r,{isLoading:!0});case e.FETCH_OFFERS_FOR_ALL_PASSENGERS_SUCCESS:var o=s.payload,c=o.offersForPax,E=o.countryCode,p=o.updateCORs,_=p?R.repeat(E,R.propOr(0,"length",c)):[].concat(babelHelpers.toConsumableArray(r.paxCORs));return babelHelpers["extends"]({},r,{isLoading:!1,offersForPax:c,paxCORs:_});case e.ADD_TO_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},r,{isLoading:!1,confirmedPackages:R.pathOr(0,["payload","length"],s),isSelectionConfirmed:!0});case e.REMOVE_FROM_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},r,{isSelectionConfirmed:!1});case e.FETCH_OFFERS_FOR_PASSENGER_ERROR:case e.FETCH_OFFERS_FOR_ALL_PASSENGERS_ERROR:case e.ADD_TO_BOOKING_MODEL_ERROR:return babelHelpers["extends"]({},r,{isLoading:!1});case e.CLEAR:return babelHelpers["extends"]({},a,{countries:r.countries});case e.SAME_INSURANCE_COR:var O=[],d=R.pathOr([],["offersForPax"],r);return s.passengers.forEach(function(e){R.pathOr("",["paxCORs",e.model.num],r)!==s.cor&&(d[e.model.num]=[]),O[e.model.num]=s.cor}),babelHelpers["extends"]({},r,{paxCORs:O,offersForPax:d,sameCORandPackageForAll:!0,paxHavePackage:s.paxHavePackage});case e.SET_PAX_HAVE_PACKAGE:var u=r.paxHavePackage.slice();return u[s.forPax]=!0,babelHelpers["extends"]({},r,{sameCORandPackageForAll:!R.all(R.equals(!0))(u),paxHavePackage:u});case e.ADD_COR_BY_FLIGHT_ORIGIN:return babelHelpers["extends"]({},r,{paxCORs:[s.payload]});case e.ADD_SELECTED_INSURANCE:var i=R.pipe(R.filter(R.complement(R.whereEq({paxNum:s.payload.paxNum}))),R.append(s.payload.insurance))(r.selectedOffers),C=R.sum(R.pluck("price",i));return babelHelpers["extends"]({},r,{selectedOffers:i,selectionTotal:C});case e.REMOVE_SELECTED_INSURANCE:var S=R.filter(R.complement(R.whereEq({paxNum:s.payload.paxNum})))(r.selectedOffers),x=R.sum(R.pluck("price",S));return babelHelpers["extends"]({},r,{selectedOffers:S,selectionTotal:x});case e.MAKE_CHOICE:return babelHelpers["extends"]({},r,{choiceIsMade:!0});case e.UNMAKE_CHOICE:return babelHelpers["extends"]({},r,{choiceIsMade:!1});case e.DRAWER_CLOSED:return a;default:return r}}}]);


"use strict";angular.module("app.booking").factory("LockFareReducer",["LOCK_FARE_ACTION_TYPES",function(e){var r={isLoading:!1,lockInfo:{},totalPrice:0,errors:[]};return function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,t=arguments[1],n=t.type,o=t.payload;switch(n){case e.FETCH_PRICES_START:return babelHelpers["extends"]({},a,{isLoading:!0});case e.FETCH_PRICES_SUCCESS:return babelHelpers["extends"]({},a,{isLoading:!1,lockInfo:o.lockInfo,totalPrice:o.totalPrice});case e.FETCH_PRICES_ERROR:return babelHelpers["extends"]({},a,{isLoading:!1,errors:a.errors.concat(o)});default:return a}}}]);


"use strict";angular.module("app.booking").factory("PriorityBoardingReducer",["PRIORITY_BOARDING_ACTIONS_TYPES","PAYMENT_ACTION_TYPES","BookingWrite","ModelQuery","PB_BUTTON_TYPES",function(e,s,r,n,a){var t={prices:[],ssrs:[],offers:[],isLoading:!1,isCampaignAvailable:!1,isCampaignSeen:!1,priorityAvailability:null,continueEnabled:!1,p2cbCardsConfig:{}},l=function(e,s,r){return R.pipe(n.byModel(e),n.byKey(s),n.complement(r))(r)},i=function(e,s){return e.passengers.map(function(r){var n=R.find(function(s){return s.key.journeys===e.journeyNum&&s.key.passengers===r.num})(s),t=Boolean(n);return babelHelpers["extends"]({},r,{buttonType:t?a.REMOVE:a.ADD,sold:R.pathOr(!1,["model","sold"],n),included:R.pathOr(!1,["model","isPartOfBundle"],n)})})},u=function(e){var s=e.prices,r=e.ssrs;return s.map(function(e){var s=i(e,r),n=R.any(function(e){return e.buttonType===a.ADD})(s);return babelHelpers["extends"]({},e,{passengers:s,allBtnType:n?a.ADD_ALL:a.REMOVE_ALL})})};return function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,i=arguments[1],o=i.type,p=i.payload;switch(o){case e.GET_PRICES_START:return babelHelpers["extends"]({},a,{isLoading:!0});case e.GET_PRICES:return babelHelpers["extends"]({},a,{prices:p.prices,ssrs:p.items,isLoading:!1});case e.SET_CTA_STATUS:return babelHelpers["extends"]({},a,{prices:a.prices.map(function(e){return R.contains(e.journeyNum,p.legs)?babelHelpers["extends"]({},e,{ctaState:p.state}):e})});case e.ADD_SELECTED:return babelHelpers["extends"]({},a,{ssrs:r.add([p.item],l({code:"PS",sold:!1},{journeys:p.leg,passengers:p.paxNum},a.ssrs))});case e.REMOVE_SELECTED:return babelHelpers["extends"]({},a,{ssrs:l({code:"PS",sold:!1},{journeys:p.leg,passengers:p.paxNum},a.ssrs)});case e.ADD_ALL_LOCAL:return babelHelpers["extends"]({},a,{ssrs:R.concat(p.items)(a.ssrs)});case e.REMOVE_ALL_LOCAL:var b={};return null!==p.journeyNum&&(b=babelHelpers["extends"]({},b,{journeys:p.journeyNum})),babelHelpers["extends"]({},a,{ssrs:l({code:"PS",sold:!1},b,a.ssrs)});case e.UPDATE_LOCAL:return babelHelpers["extends"]({},a,{ssrs:R.pipe(n.byKey({journeys:p.journeyNum}),n.byModel({type:"PRIOBRDNG",sold:!1,isPartOfBundle:!1}),n.complement(a.ssrs),R.concat(p.items))(a.ssrs)});case e.RESET:return babelHelpers["extends"]({},a,{ssrs:R.pipe(n.byModel({type:"PRIOBRDNG",sold:!1}),n.complement(a.ssrs))(a.ssrs)});case e.RESET_OFFERS:return babelHelpers["extends"]({},a,{offers:null});case s.PROCESS_PAYMENT_SUCCESS:case e.EMPTY:return t;case e.ADD_ALL_START:return babelHelpers["extends"]({},a,{isLoading:!0});case e.ADD_ALL_ERROR:case e.ADD_ALL_SUCCESS:return babelHelpers["extends"]({},a,{isLoading:!1});case e.SET_CAMPAIGN_AVAILABILITY:return babelHelpers["extends"]({},a,{isCampaignAvailable:p.isCampaignAvailable});case e.UPDATE_CAMPAIGN_SEEN_STATUS:return babelHelpers["extends"]({},a,{isCampaignSeen:p.isCampaignSeen});case e.GET_OFFERS_SUCCESS:return babelHelpers["extends"]({},a,{offers:p});case e.SET_CONTINUE_BUTTON_AVAILABILITY:return babelHelpers["extends"]({},a,{continueEnabled:p.isEnabled});case e.GET_PRIORITY_AVAILABILITY:return babelHelpers["extends"]({},a,{priorityAvailability:p});case e.GET_PRIORITY_AVAILABILITY_ERROR:var c=[].concat(babelHelpers.toConsumableArray(a.errors),[p]);return babelHelpers["extends"]({},a,{errors:c});case e.RESET_PRIORITY_AVAILABILITY:return babelHelpers["extends"]({},a,{priorityAvailability:null});case e.FETCH_CARDS_CONFIG_SUCCESS:return babelHelpers["extends"]({},a,{p2cbCardsConfig:p});case e.UPDATE_BUTTON_TYPE_AND_STATUS:return babelHelpers["extends"]({},a,{prices:u(a)});default:return a}}}]);


"use strict";angular.module("app.booking").factory("SamsoniteReducer",["SAMSONITE_ACTION_TYPES",function(e){var a={codes:["SAM","SAMU","SAMSS"],bagsInfo:{},currency:"",limitPerPerson:5};return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,n=arguments[1];switch(n.type){case e.GET_AVAILABLE_BAGS_SUCCESS:return babelHelpers["extends"]({},r,{bagsInfo:n.payload.bagsInfo,currency:n.payload.currency});case e.GET_AVAILABLE_BAGS_START:case e.GET_AVAILABLE_BAGS_ERROR:return babelHelpers["extends"]({},r,{bagsInfo:{},currency:""});case e.UPDATE_SELECTED_BAGS:var s=r.bagsInfo;return s[n.payload.code].qty=n.payload.qty,babelHelpers["extends"]({},r,{bagsInfo:s});case e.POST_SAMSONITE_SUCCESS:var t=r.bagsInfo;return r.codes.forEach(function(e){t[e].qty=R.pipe(R.pluck("model"),R.filter(function(a){return a.code===e}),R.map(function(e){return e.qty}),R.sum)(n.payload.extras)}),babelHelpers["extends"]({},r,{bagsInfo:t});case e.REMOVE_SAMSONITE_SUCCESS:var o=r.bagsInfo;return r.codes.forEach(function(e){o[e].qty=0}),babelHelpers["extends"]({},r,{bagsInfo:o});default:return r}}}]);


"use strict";angular.module("app.booking").factory("TransfersReducer",["TRANSFERS_ACTION_TYPES",function(e){var r={isLoadingOffers:!1,isLoadingOffersError:!1,hasLoadedOffers:!1,isAddingToBookingModel:!1,isAddingToBookingModelError:!1,isRemovingFromBookingModel:!1,isRemovingFromBookingModelError:!1,bannerPrice:0,totalPrice:0,providers:[],prices:{orig:0,dest:0},selectedOffers:{orig:{},dest:{}},resetSelectedOffers:!1},s=function(e){return e.map(function(e){var r=Math.min.apply(Math,babelHelpers.toConsumableArray(e.offers.map(function(e){return e.pricePerPerson})));return babelHelpers["extends"]({},e,{lowestPrice:r})})},o=function(e){var r=void 0;return e.forEach(function(e){var s=Math.min.apply(Math,babelHelpers.toConsumableArray(e.offers.map(function(e){return e.pricePerPerson})));r=s>r?r:s}),r},n=function(e,r,s){var o=r.journey===s?r.data:e;return babelHelpers["extends"]({},o)},t=function(e,r){var s=function(s){return r[s].pricePerPerson&&r[s].paxCount?R.multiply(r[s].pricePerPerson,r[s].paxCount):e[s]};return Object.assign({},e,{orig:s("orig"),dest:s("dest")})},a=function(e){return Object.keys(e).reduce(function(r,s){return r+e[s]},0)},i=function(e,r,s){var o=r.journey===s?{}:e;return babelHelpers["extends"]({},o)};return function(){var d=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,l=arguments[1];switch(l.type){case e.FETCH_OFFERS_START:return babelHelpers["extends"]({},d,{isLoadingOffers:!0});case e.FETCH_OFFERS_SUCCESS:return babelHelpers["extends"]({},d,{isLoadingOffers:!1,hasLoadedOffers:!0,providers:s(l.payload),bannerPrice:o(l.payload)});case e.FETCH_OFFERS_FAILED:return babelHelpers["extends"]({},d,{isLoadingOffers:!1,hasLoadedOffers:!0,isLoadingOffersError:!0});case e.ADD_TO_BOOKING_MODEL_START:return babelHelpers["extends"]({},d,{isAddingToBookingModel:!0});case e.ADD_TO_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},d,{isAddingToBookingModel:!1});case e.ADD_TO_BOOKING_MODEL_FAILED:return babelHelpers["extends"]({},d,{isAddingToBookingModel:!1,isAddingToBookingModelError:!0});case e.REMOVE_FROM_BOOKING_MODEL_START:return babelHelpers["extends"]({},d,{isRemovingFromBookingModel:!0});case e.REMOVE_FROM_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},d,{isRemovingFromBookingModel:!1});case e.REMOVE_FROM_BOOKING_MODEL_FAILED:return babelHelpers["extends"]({},d,{isRemovingFromBookingModel:!1,isRemovingFromBookingModelError:!0});case e.ADD_SELECTED_OFFERS:var c={orig:n(d.selectedOffers.orig,l.payload,"orig"),dest:n(d.selectedOffers.dest,l.payload,"dest")},u=t(d.prices,c);return babelHelpers["extends"]({},d,{selectedOffers:c,totalPrice:a(u)});case e.REMOVE_SELECTED_OFFERS:var O={orig:i(d.selectedOffers.orig,l.payload,"orig"),dest:i(d.selectedOffers.dest,l.payload,"dest")},f=t(d.prices,O);return babelHelpers["extends"]({},d,{selectedOffers:O,totalPrice:a(f)});case e.OPEN_MODAL:return r;case e.CLOSE_MODAL:return r;case e.ADD_TRANSFERS_POST_MESSAGE:return babelHelpers["extends"]({},d,{isAddingToBookingModel:!0});case e.RESET_SELECTED_OFFERS:return babelHelpers["extends"]({},d,{resetSelectedOffers:l.payload});case e.CLEAR:return r;default:return d}}}]);


"use strict";angular.module("app.booking").controller("RefundCtrl",["$ngRedux","$scope","$state","$timeout","Session","Utilities","BookingRead","BookingModelActions","RefundActions","FEATURE_CONFIG","MarketConfig",function(e,n,t,r,o,s,i,a,u,c,d){var f=this,l={SELECT_PASSENGERS:"refund:select-pax",SELECT_FLIGHTS:"refund:select-flights",SUMMARY:"refund:summary",CONFIRMATION:"refund:confirmation"},h=Object.keys(l),p=function(e){return e.map(function(e){var n=e.accountNumber.slice(0,-4).split("").map(function(e,n){return(n+1)%4?"*":"* "}).join("")+e.accountNumber.slice(e.accountNumber.length-4,e.accountNumber.length);return babelHelpers["extends"]({},e,{accountNumber:n})})},g=function(e){var n=e.launchDarkly,t=e.refund,r=e.bookingModel,o=R.any(R.equals(!0),[R.path(["isLoadingRefundableError"],t),R.path(["isLoadingBreakdownItemsError"],t),R.path(["isLoadingRefundError"],t)]),s=R.pathOr([],["journeys"],t);o&&(f.showSpinner=!1);var a=p(R.pathOr([],["paymentBreakdown"],t));return{bookingModel:r,passengers:R.pathOr([],["passengers"],t),isChildAloneWarn:R.path(["isChildAloneWarn"],t),isPaidByCash:"CA"===R.path(["payments",0,"model","type"],r),selectedPassengers:R.pathOr([],["selectedPassengers"],t),lockedPassengers:R.pathOr([],["lockedPassengers"],t),selectedJourneys:R.pathOr([],["selectedJourneys"],t),journeys:s,refundableJourneys:R.pathOr([],["refundableJourneys"],t),totalRefund:R.pathOr([],["totalRefund"],t),itemBreakdown:R.pathOr([],["itemBreakdown"],t),cta:R.path(["cta"],t),showError:o,showInsuranceWarning:R.any(R.path(["isCancelled"]),s)&&!R.isEmpty(i.getAllAddonsByCode("INS",r)),dividedBooking:R.pathOr({},["dividedBooking"],t),paymentBreakdown:a,voucherRefunds:n["voucher-live-refunds-enabled"]}},m=e.connect(g,u)(this);this.addCTA=function(e){var n=e.name,t=e.fn;f.setCta(n,t)},this.refundSteps=s.createStepIterator([l.SELECT_PASSENGERS,l.SELECT_FLIGHTS,l.SUMMARY,l.CONFIRMATION]),this.refundConfirmationLink="/gb/en/useful-info/help-centre/faq-overview/flight-cancellations/what-happens-with-the-other-products-that-i-have-purchased",this.milestones=s.createStepIterator(h),this.refundSteps.onChange(function(e){f.milestones.current=h.find(function(n){return l[n]===e}),f.showSpinner=!1}),this.showBackButton=function(){return f.cta.backEnabled&&!f.refundSteps.isFirst&&!f.refundSteps.isLast&&!f.showError},this.getStepTitle=function(){return"trips.refund.milestone-title."+f.milestones.current},this.confirm=function(){f.refundSteps.isLast&&n.closeThisDialog(),f.showError?f.showError=!1:f.cta.confirm&&"function"==typeof f.cta.confirm?(f.showSpinner=!0,f.cta.confirm(f.refundSteps.next)):f.refundSteps.next()},this.buttonText=function(){if(f.showError)return"trips.refund.error.button";switch(f.refundSteps.current){case"refund:confirmation":return"common.buttons.DONE";case"refund:summary":return"common.buttons.refund";default:return"common.buttons.continue"}},this.back=function(){f.cta.back&&"function"==typeof f.cta.back?(f.showSpinner=!0,f.cta.back(f.refundSteps.previous)):f.refundSteps.previous()},this.redirectLink=c.REFUND_MICROSITE+"/?lg="+d.getLanguage(),this.onPaxToggle=function(e){R.contains(e,f.selectedPassengers)?f.deselectPassenger(e):f.selectPassenger(e)},this.onGetRefundable=function(e){var n=e.next;f.getRefundable(n)},this.onGetRefundBreakdown=function(e){var n=e.next;f.getRefundBreakdown(n,f.selectedJourneys,f.selectedPassengers)},this.onToggleSelection=function(e){var n=e.journey;f.toggleSelection(n)},this.onRefund=function(e){var n=e.next;f.refund(n,f.selectedJourneys,f.selectedPassengers)},this.onRefundFinished=function(){f.journeys.length===f.selectedJourneys.length?r(function(){o.removeSessionStorage("ryanair:token"),t.go("home",{},{reload:!0})},0,!1):e.dispatch(a.refresh("booking.active",!1,!0)).then(function(){t.go("booking.active",{},{reload:!0})})},this.initRefund(),n.$on("$destroy",function(){m()})}]);


"use strict";angular.module("app.booking").factory("BookingReadAddons",["ModelQuery",function(r){var n=function(n){return R.pipe(R.pathOr([],["addons"]),r.byModel({src:"CARHIRE"}),R.map(function(r){return R.pathOr([],["model","status"],r)}),R.map(function(r){return JSON.parse(r)}))(n)},e=function(n){return R.pipe(R.pathOr([],["addons"]),r.byModel({src:"CARHIRE"}),R.map(function(r){return r.model}),R.head,R.pathOr(0,["amtNow"]))(n)},t=function(r){return R.pipe(R.pathOr({},["0"]),R.mergeWith(R.concat,{total:e(r)}))(n(r))},o=function(n){return R.pipe(r.byIdentity("addons"),r.byModel({type:"TRANSFER",sold:n}))},a=function(r){return R.pipe(o(!1),R.pathOr([],["model","price"]))(r)},u=function(r){var n=a(r);return n.reduce(function(r,n){var e=0;return n.config.mor||(e=n.price.total.amount),r+e},0)},d=function(n){return R.pipe(o(!1),r.hasAny)(n)},i=R.pipe(o(!0),r.hasAny),p=function(n){return r.byIdentity("groundTransfer")(n)};return{addedCarHire:n,totalCarHire:e,carBasketModel:t,getGroundTransfersItems:o,getSoldGroundTransfers:p,getGroundTransferCTCharge:u,addedTransfer:a,hasGroundTransfer:d,hasGroundTransferSold:i}}]);


"use strict";angular.module("app.booking").factory("BookingReadInfo",["ModelQuery",function(e){var t=R.pipe(e.byIdentity("info"),e.byModel({status:"Default"}),e.hasAny),i=R.pipe(e.byIdentity("serverTimeUTC"),R.head,R.path(["model"])),o=function(e){return!R.isNil(R.path(["info","0","model","domestic"],e))},n=R.pipe(e.byIdentity("info"),R.pluck("model"),R.pathOr({},[0])),r=R.pipe(n,R.prop("curr")),p=R.pipe(n,R.whereEq({status:"Hold"})),a=R.pipe(n,R.whereEq({status:"Confirmed"}),R.not),s=R.compose(R.prop("isConnectingFlight"),n),d=R.compose(R.prop("createdUtcDate"),n);return{getBookingInfo:n,getBookingCurrency:r,isConnectingFlight:s,isDomestic:o,isHoldFare:p,isPotentialBooking:t,getCurrentServerTime:i,getCreatedUtcDate:d,isAirMaltaTicketCreationFaild:a}}]);


"use strict";angular.module("app.booking").factory("BookingReadJourneys",["ModelQuery","Stations","BookingReadInfo","BookingReadSegments","Dates","BookingReadUtils","FLT_CODES","$ngRedux",function(e,t,n,r,i,o,u,a){var y=R.path(["journeys","0","model","origCountry"]),s=R.path(["journeys","0","model","destCountry"]),p=R.pipe(R.pathOr([],["journeys"]),R.map(R.pathOr({},["model"]))),d=function(n){return R.pipe(e.byIdentity("journeys"),R.head,R.path(["model",n]),t.getCityName.bind(t))},g=d("orig"),c=R.path(["journeys","0","model","orig"]),l=d("dest"),m=R.path(["journeys","0","model","dest"]),f=function(r){return n.isConnectingFlight(r)?R.pipe(e.byIdentity("segments"),R.head,R.path(["model","dest"]),t.getCityName.bind(t))(r):!1},h=function(e){return n.isConnectingFlight(e)?R.path(["segments","0","model","dest"],e):!1},C=function(e){return[g(e),l(e)]},b=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"depart";return R.pipe(e.byIdentity("journeys"),R.map(R.path(["model",n])))(t)},j=function(t){return R.pipe(e.byIdentity("journeys"),e.byKey({journey:0}),R.head,R.path(["model","arriveUTC"]))(t)},I=function(t){return R.pipe(e.byIdentity("journeys"),e.byKey({journey:1}),R.head,R.path(["model","departUTC"]))(t)},F=function(e){return 0===i.diffInDays(i.utc(I(e)).startOf("day"),i.utc(j(e)).startOf("day"))},v=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:120,r=o.getServerTimeUTC(t),u=function(e){return i.diffInMinutes(i.utc(e),i.utc(r))<n};return R.pipe(e.byIdentity("journeys"),R.map(R.path(["model","departUTC"])),R.map(u))(t)},D=R.pipe(p,function(e){return{start:e[0].depart.split("T")[0],end:e[e.length-1].arrive.split("T")[0]}}),A=R.pipe(e.byIdentity("journeys"),function(e){return e.length>1}),k=function(t){var n=R.path(["model","isCancelled"]),i=R.path(["model","journeyNum"]),o=function(e){return r.getSegmentsFor(e)(t)},u=R.map(R.pipe(i,o,R.map(n))),a=R.contains(!0);return R.pipe(e.byIdentity("journeys"),u,R.map(a))(t)},T=function(e){return R.head(v(e))},O=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=v(e),r=t.length?t:e.journeys;return r.filter(function(e,t){return!n[t]})},B=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=k(e),r=T(e),i=t.length?t:e.journeys;return i.reduce(function(e,t,i){return n[i]||(0===i?r:0)||e.push(t),e},[])},J=function(e){var t=i.utc(R.path(["departUTC"],e)),n=i.utc(R.path(["arriveUTC"],e));return i.duration(t,n)},U=function(t){return R.pipe(e.byIdentity("segments"),e.byBelongsToAny([t]))},S=function(t){return R.pipe(e.byIdentity("journeys"),R.filter(R.pathEq(["key","id"],t)))},L=function(t){return R.pipe(e.byIdentity("segments"),e.byKey(t))},E=function(e){return R.pipe(R.pathOr([],["journeys"]),R.map(R.path(["model","flt"])),R.filter(R.contains(u.RYANAIR)),R.isEmpty,R.not)(e)},N=function(e){return R.pipe(R.pathOr([],["journeys"]),R.map(R.path(["model","flt"])),R.filter(R.contains(u.LAUDA)),R.isEmpty,R.not)(e)},w=function(e,t){return R.pipe(R.pathOr([],["journeys"]),R.filter(function(t){var n=t.key,r=t.model;return n.journey===e&&R.contains(u.RYANAIR,r.flt)}),R.isEmpty,R.not)(t)},K=function(e,t){return R.pipe(R.pathOr([],["journeys"]),R.filter(function(t){var n=t.key,r=t.model;return n.journey===e&&R.contains(u.LAUDA,r.flt)}),R.isEmpty,R.not)(t)},G=function(t){return R.pipe(e.byIdentity("journeys"),R.map(function(n){return R.pipe(e.byIdentity("segments"),e.byKey({journeys:n.key.id}),e.byModel({flown:!0}),e.hasAny)(t)}))(t)},M=function(e){var t=G(e),n=k(e);return t[0]||n[0]||n[1]},P=function(n,r){return R.pipe(e.byIdentity("segments"),e.byBelongsToAny([n]),R.head(),R.path(["model","orig"]),t.getCityName.bind(t))(r)},Y=function(n,r){return R.pipe(e.byIdentity("segments"),e.byBelongsToAny([n]),R.last(),R.path(["model","dest"]),t.getCityName.bind(t))(r)},x=R.curry(function(t,n){return R.pipe(e.byIdentity("segments"),e.byBelongsToAny([t]),R.head(),R.path(["model","dest"]))(n)}),q=function(e,n){return R.pipe(x(e),t.getCityName.bind(t))(n)},H=function(e){return e.journeys.reduce(function(t,n){var r=e.segments.some(function(e){return R.path(["key","journeys"],e)===n.key.id&&R.path(["model","flown"],e)});return t[n.key.id]=r,t},[])},Q=function(e,t){return R.pipe(R.path(["model","flt"]),R.contains(e))(t)},$=R.curry(Q)(u.RYANAIR),_=R.curry(Q)(u.LAUDA),z=function(t){return R.pipe(e.byIdentity("journeys"),R.map(function(e){return i.utc(e.model.departUTC).diff(i.utc(e.model.checkInFreeAllocateOpenUtcDate))<=864e5}))(t)},V=function(e,t){return t.some(function(t){return t.code===e&&t.iseu})&&"GB"!==e},W=function(e,t){var n=y(e),r=s(e);return V(n,t)&&"GB"===r?"EU":"GB"===n&&V(r,t)?"GB":null},X=function(e){return R.path(["launchDarkly","spanish-domestic-enabled"],a.getState())&&n.isDomestic(e)&&"ES"===y(e)},Z=function(e){return R.flatten(R.map(function(e){return[R.path(["model","origCountry"],e),R.path(["model","destCountry"],e)]},e))},ee=function(t,n){return R.pipe(e.byIdentity("journeys"),Z,R.any(function(e){return n.includes(e)}))(t)};return{filterPastJourneys:O,filterUnavailableJourneys:B,getFlightDuration:J,getCancelledFlights:k,getCities:C,getCity:d,getOriginCityForJourney:P,getOrigCountryCode:y,getDestCountryCode:s,getDestinationCityForJourney:Y,getConnectingIataForJourney:x,getConnectingCityForJourney:q,getConnectingCity:f,getConnectingCityCode:h,getDestCity:l,getDestCityCode:m,getDueFlightStatuses:v,getFlightsDeparturesTime:b,getOutboundArrivalTime:j,getInboundDepartureTime:I,getOriginCity:g,getOriginCityCode:c,isFlightOutDue:T,isReturnTrip:A,getSegmentsForJourney:U,getJourneyFromId:S,getSegmentsByKey:L,hasEitherLegFlown:G,hasFlownOrCancelledLegs:M,getFlightFlownStatusesPerLeg:H,hasRyanairFlight:E,hasLaudaFlight:N,isRyanairFlight:w,isLaudaFlight:K,isLaudaJourney:_,isRyanairJourney:$,isSameDayReturnBooking:F,isSpanishDomestic:X,getBookingJourneys:p,getBookingDates:D,getFreeCheckin24HourPerJourney:z,brexitAffectedJourneyFrom:W,checkCountriesInJourney:ee}}]);


"use strict";angular.module("app.booking").factory("BookingReadSegments",["ModelQuery","Dates","MAX_AIRCRAFT_MODELS",function(e,t,n){var r=R.curry(function(t,n){return R.pipe(e.byIdentity("segments"),e.byKey({journeys:t}))(n)}),o=r(1),i=r(0),u=R.allPass([R.pathEq(["model","flown"],!1),R.pathEq(["model","isCancelled"],!1)]),l=function(e){return R.pipe(e,R.filter(u),R.length)},a=function(e){return{inboundCount:l(o)(e),outboundCount:l(i)(e)}},s=R.pipe(e.byIdentity("segments"),R.filter(function(e){return!e.model.flown&&!e.model.isCancelled})),p=function(e,n){return t.utc(e).diff(t.utc(R.path(["model","departUTC"],n)))>0},d=function(t,n){var r=R.curry(p)(R.path(["serverTimeUTC","0","model"],n));return R.pipe(e.byIdentity(t),R.map(r))(n)},m=function(t){var n=R.curry(p)(R.path(["serverTimeUTC","0","model"],t));return R.pipe(e.byIdentity("segments"),R.filter(R.complement(n)))(t)},y=function(e,t){return R.pipe(r(e),R.map(R.path(["model","flt"])))(t)},g=R.pipe(e.byIdentity("segments"),e.byModel({flown:!0}),e.hasAny),c=R.pipe(e.byIdentity("segments"),R.map(R.path(["model","flown"])),R.all(R.equals(!0))),f=R.pipe(e.byIdentity("segments"),R.map(R.path(["model","flown"]))),b=function(e){return R.flatten(R.map(function(e){return[R.path(["model","orig"],e),R.path(["model","dest"],e)]},e))},h=function(t,n,r){return R.pipe(e.byIdentity("segments"),b,R.map(function(e){return r.find(R.propEq("iataCode",e)).countryCode.toLocaleUpperCase()}),R.any(function(e){var t=n.find(R.propEq("code",e));return!t.iseu&&"GB"===!t.code}),R.not)(t)},C=function(t,n,r){var o=R.pipe(e.byIdentity("segments"),e.byKey({id:t,journeys:n}),R.head)(r),i=R.pipe(e.byIdentity("serverTimeUTC"),R.head,R.pick(["model"]))(r);return p(i,o)},I=R.pipe(e.byIdentity("segments"),e.byKeyValueAny(["model","aircraft"],n),e.hasAny);return{getDepartedFlights:d,getFutureFlights:m,getFutureSegmentsNotCancelled:s,getInboundSegments:o,getOutboundSegments:i,getFlightNumbers:y,someFlightsDeparted:g,allFlightsDeparted:c,getFlightsFlownStates:f,getSegmentsFor:r,isSegmentInPast:p,euSegmentsOnly:h,isSegmentFlown:C,getAvailableSegmentsCountForAllLegs:a,someSegmentsWithMaxAircraftModel:I}}]);


"use strict";angular.module("app.booking").factory("BookingReadSsrs",["ModelQuery",function(e){var t=function(t,n){return R.pipe(e.byIdentity("ssrs"),e.byModel({type:t,sold:n}))},n=function(t){return R.pipe(e.byIdentity("ssrs"),e.byKey({journeys:t.key.id}))},r=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!1;return R.pipe(e.byIdentity("ssrs"),e.byModel({code:t,sold:n}),e.byRemoved(r))},s=R.curry(function(t,n){return R.pipe(e.byIdentity("ssrs"),e.byModel({code:n}))}),o=function(n,r){return R.pipe(t(n,r),e.sumUpTotal)},y=function(t){return R.pipe(e.byIdentity("ssrs"),e.byModel({type:t}))},d=function(t){return R.pipe(e.byIdentity("ssrs"),e.byModel({type:"PRIOBRDNG"}),R.groupBy(function(e){return e.key.passengers}),R.keys,R.length)(t)},i=R.pipe(e.byIdentity("ssrs"),e.byKeyValueAny(["model","code"],["PS","PF"]),e.byModel({isPartOfBundle:!0})),u=R.pipe(e.byIdentity("ssrs"),e.byKeyValue(["model","code"],"RVOU"),e.byModel({isPartOfBundle:!0})),a=R.pipe(e.byIdentity("ssrs"),e.byKeyValue(["model","code"],"RVOU")),l=R.pipe(e.byIdentity("ssrs"),e.hasAnyModel([{code:"PS",isPartOfBundle:!0},{code:"PB",isPartOfBundle:!0}])),p=R.pipe(e.byIdentity("ssrs"),e.byModel({code:"PS"})),c=R.pipe(e.byIdentity("ssrs"),e.byModel({type:"HOLDFARE",sold:!1}),e.hasAny),b=R.pipe(t("PRIOBRDNG",!0),e.byModel({code:"PS",isPartOfBundle:!1})),g=R.pipe(e.byIdentity("ssrs"),e.byModel({sold:!1,type:"PRIOBRDNG",code:"PS"})),I=function(e){return t("PRIOBRDNG",e)},B=function(t){return R.pipe(e.byIdentity("segPrm"),e.byModel({sold:t}))},f=function(t){return!!R.pipe(e.byIdentity("ssrs"),e.findByModel({code:"SURE",sold:!0}))(t)},m=R.pipe(e.byIdentity("ssrs"),e.byModel({code:"BUND",sold:!1}),e.hasAny),P=function(t){return!!R.pipe(e.byIdentity("ssrs"),e.findByModel({code:"FAMI",sold:!0}))(t)},A=y("FAST"),h=R.pipe(e.byIdentity("ssrs"),e.byModel({type:"PRIOBRDNG"})),S=function(t,n){return R.pipe(e.byIdentity("ssrs"),e.byKey({passengers:t,journeys:n}))},M=function(e){return e.model.sold&&"FAST"===e.model.code},F=function(t,n){return!!R.pipe(e.byIdentity("ssrs"),e.byKey({journeys:t}),e.findByModel({type:"FAST",sold:!0}))(n)},T=function(t){var n=t.journeys.map(function(n){var r=n.key.journey;return t.passengers.map(function(n){var s=n.key.id;return R.pipe(e.byIdentity("ssrs"),e.byKey({passengers:s,journeys:r}),e.byModel({type:"BAGS",sold:!0}),R.length,R.lte(3))(t)})});return R.pipe(R.flatten,R.all(R.equals(!1)))(n)},O=function(t){return!!R.pipe(e.byIdentity("ssrs"),e.findByModel({code:"ERAS"}))(t)},U=function(t,n,r){var s=R.pipe(e.byIdentity("ssrs"),e.byKey({journeys:t}),e.byModel({sold:!1,type:"BAGS"}),e.byRemoved(!1))(r);return R.pipe(e.byIdentity("passengers"),e.byModel({type:"ADT"}),e.byHasAny(s))(n)},G=function(e){return t("BAGS",e)},K=function(e){return t("FAST",e)},v=function(e){return t("BAGUPGRADES",e)},E=function(t){return R.pipe(e.byIdentity("ssrs"),e.byKeyValueAny(["model","type"],["BAGS","BAGUPGRADES"]),e.byModel({sold:t}))},k=function(e,t){return r(e,t)},j=s("BAGS"),C=function(e,t){return r("BREK",e,t)},D=function(t){return R.pipe(e.byIdentity("ssrs"),e.byPredicate(function(e){return R.contains(e.type,["INFLIGHT","BREK"])&&e.sold===t}))},N=function(t){return R.pipe(e.byIdentity("ssrs"),e.byPredicate(function(e){return R.contains(e.type,["INFLIGHT","BREK","PRES"])&&e.sold===t}))},L=function(t){return R.pipe(e.byIdentity("ssrs"),e.byPredicate(function(e){return R.contains(e.type,["PRIOBRDNG","CBAG"])&&e.sold===t}))},V=function(t){return R.pipe(e.byIdentity("ssrs"),e.byModel({code:"CBAG",sold:t}))},J=function(t){return R.compose(e.byModel({code:"INS",sold:t}),e.byIdentity("addons"))},x=function(t,n){return R.pipe(J(t),e.byModel({paxNum:n}))},H=R.pipe(V(!1),e.byRemoved(!1),e.sumUpTotal),q=R.pipe(J(!1),e.byRemoved(!1),e.sumUpTotal),W=function(t){var n=R.pipe(e.byIdentity("seats"),e.byLocal(!0))(t);if(n.length){var r=e.byIdentity("ssrs")(t);return n.reduce(function(t,n){var s=R.contains(R.pathOr("",["model","groupType"],n),["PRIORITY","EXTRALEG"]),o=R.pipe(e.byKey(n.key),e.byModel({type:"PRIOBRDNG"}),R.head,R.path(["model","isPartOfBundle"]))(r);return s&&o||!s&&!o},!1)}return!0},w=function(t,n){return R.pipe(e.byIdentity("ssrs"),e.byModel({type:t}))(n)},Q=R.pipe(e.byIdentity("ssrs"),e.byModel({code:"SURE",sold:!1}),e.sumUpTotal),X=R.pipe(e.byIdentity("ssrs"),e.byModel({code:"FAMI",sold:!1}),e.sumUpTotal),Y=function(t){return R.pipe(G(!1),e.byModel({isPartOfBundle:!1}),e.hasAny)(t)},z=function(t){return R.pipe(R.converge(R.concat,[G(!0),G(!1)]),e.byModel({isPartOfBundle:!0}),e.hasAny)(t)},Z=function(t){return R.pipe(R.converge(R.concat,[K(!0),K(!1)]),e.byModel({isPartOfBundle:!0}),e.hasAny)(t)},$=function(t,n){return R.pipe(e.byIdentity("ssrs"),e.byKeyValueAny(["model","code"],["SURE","PLUS","FAMI"]),e.byKey({journeys:t}),R.head,R.pathOr(0,["model","total"]))(n)},_=function(t,n){return R.pipe(e.byIdentity("ssrs"),e.byKey({journeys:n.key.id}),e.byModel({code:"BBG"}),R.length)(t)},ee=function(t,n){return R.pipe(e.byIdentity("ssrs"),e.byKey({journeys:n}),e.byPredicate(function(e){return R.contains(e.code,["SURE","FAMI","BBG"])}),e.hasAny)(t)},te=function(e,t){var n=R.pathOr([],["codes"],t),r=function(e){return n.indexOf(e.model.code)>-1};return R.pipe(R.path(["extras"]),R.filter(r),R.map(R.path(["model","total"])),R.sum)(e)},ne=function(t){return R.equals(R.multiply(R.length(e.byIdentity("journeys")(t)),R.length(e.byIdentity("passengers")(t))),R.pipe(e.byIdentity("ssrs"),e.byKeyValueAny(["model","code"],["SURE","PLUS","FAMI"]),R.length)(t))},re=function(t,n){return R.pipe(e.byIdentity("ssrs"),e.byKey({journeys:t}),e.byModel({code:"SETA"}),e.hasAny)(n)},se=function(e){return 0!==w("CBAG",e).length},oe=function(n,r,s){return R.pipe(t(r,!0),e.byKey({passengers:n,journeys:s}))};return{getSsrsByType:w,getSsrPrice:o,getAllFastTrackItems:A,getPriorityBoardingPaxCount:d,getAllpriorityBoardingItems:h,getIncludedPriorityBoardingItems:i,getPriorityBoardingItems:I,getPrmItems:B,getSoldSsrsForPaxAndJourneyByType:oe,isPotentialHoldFare:c,isPlusUpgradeAdded:m,isPlusUpgradePurchased:f,isFamilyUpgradePurchased:P,hasSoldFasttrack:M,isFastTrackSoldForJourney:F,hasAllPaxSomeBagAllowance:T,isErasmus:O,getAdultsWhoAddedBagInJourney:U,getFastTrackItems:K,getBagItems:G,getBagUpgradeItems:v,getBagAndBagUpgradeItems:E,getBagItemsByCodeRemoved:k,getBreakfastItems:C,getPassengerSsrForJourney:S,getBagItemsByCode:j,getCabinBagItems:V,getInflightProductItems:D,getInflightAndPresellProductItems:N,getPriorityBoardingAndCabinBagItems:L,getInsuranceItems:J,getInsuranceItemsForPax:x,getCabinBagTotal:H,getInsuranceTotal:q,getSsrsByCode:s,getSsrsByJourney:n,getStandardPriorityBoardingItems:p,getStandardAndSoldPriorityBoardingItems:b,getStandardAndUnsoldPriorityBoardingItems:g,allLocalSeatHasPriority:W,getLeisureTotal:Q,getFamilyTotal:X,hasUnpaidBags:Y,hasIncludedBagsInBundle:z,hasIncludedFastTrackInBundle:Z,getBundleCostPerLeg:$,hasAddedOrPurchasedBagsForJourney:_,hasBagsForJourney:ee,getSamsoniteCharge:te,hasIncludedPriorityBoardingItemsWithoutMigratedData:l,hasUpgradeForAllPaxAndJourneys:ne,hasMandatorySeatsForJourney:re,hasCabinBagItems:se,getIncludedRegularVoucherItems:u,getRegularVoucherItems:a}}]);


"use strict";angular.module("app.booking").factory("BookingReadUtils",["ModelQuery","STAFF_PASSENGER_TYPES","PASSENGER_TYPES",function(e,n,t){var a=R.pipe(e.byIdentity("serverTimeUTC"),R.pluck("model"),R.head),o=function(e){return R.contains(e,R.values(n))?t.Adult:e},r=function(e){return R.contains(R.path(["0","model","code"],e.fares),R.values(n))};return{getServerTimeUTC:a,changeStaffPaxType:o,isStaffBooking:r}}]);


"use strict";angular.module("app.booking").factory("BookingReadCheckinJourney",["ModelQuery","Dates","FEATURE_CONFIG",function(e,n,t){var r=t.CHECKIN_TIME_LIMIT.EARLY,o=t["open-seatmap-in-check-in"],a=function(n,t){return R.pipe(e.byIdentity("segments"),e.byBelongsToAny([t]),e.byModel({isCancelled:!0}),e.hasAny)(n)},s=function(n,t){return R.pipe(e.byIdentity("segments"),e.byBelongsToAny([t]),e.byModel({flown:!0}),e.hasAny)(n)},l=function(e,t){var r=R.path(["serverTimeUTC","model"],e),a=R.path(["model","departUTC"],t),s=function(){return[r,a]},l=R.ifElse(function(){return o},function(e){var n=babelHelpers.slicedToArray(e,2),t=n[0],r=n[1];return r.isBefore(t)},function(e){var n=babelHelpers.slicedToArray(e,2),t=n[0],r=n[1];return r.subtract(2,"hours").isBefore(t)});return R.pipe(s,R.map(n.utc),l)()},i=function(e,t){return R.pipe(R.map(n.utc),function(){return R.both(function(e){var n=babelHelpers.slicedToArray(e,2),t=n[0],r=n[1];return t.isBefore(R.clone(r).subtract(2,"hours"))},function(e){var n=babelHelpers.slicedToArray(e,2),t=n[0],o=n[1];return t.isAfter(angular.copy(o).subtract(r,"days"))}).apply(void 0,arguments)})([e,R.path(["model","departUTC"],t)])},c=function(e,t){return R.pipe(R.map(n.utc),function(e){var n=babelHelpers.slicedToArray(e,2),t=n[0],o=n[1];return t.isBefore(angular.copy(o).subtract(r,"days"))})([e,R.path(["model","departUTC"],t)])},u=function(e,t){return R.pipe(R.map(n.utc),function(e){var n=babelHelpers.slicedToArray(e,2),t=n[0],r=n[1];return t.isAfter(r)||angular.copy(t).add(2,"hours").isBefore(r)})([e,R.path(["model","departUTC"],t)])},y=function(e,t){return R.pipe(R.map(n.utc),function(){return R.both(function(e){var n=babelHelpers.slicedToArray(e,2),t=n[0],r=n[1];return R.clone(t).add(2,"hours").isBefore(r)},function(e){var n=babelHelpers.slicedToArray(e,3),t=n[0],r=(n[1],n[2]);return t.isAfter(r)}).apply(void 0,arguments)})([e,R.path(["model","departUTC"],t),R.path(["model","checkInFreeAllocateOpenUtcDate"],t)])},p=function(e,t){return R.pipe(R.map(n.utc),R.both(function(e){var n=babelHelpers.slicedToArray(e,2),t=n[0],o=n[1];return t.isAfter(angular.copy(o).subtract(r,"days"))},function(e){var n=babelHelpers.slicedToArray(e,3),t=n[0],r=(n[1],n[2]);return t.isBefore(r)}))([e,R.path(["model","departUTC"],t),R.path(["model","checkInFreeAllocateOpenUtcDate"],t)])},d=R.T,b=function(n,t,r){return R.pipe(e.byIdentity("seats"),e.byBelongsToAny(n),e.byBelongsToAny([].concat(r)),R.length,R.equals(R.multiply(n.length,e.byBelongsToAny([].concat(r))(t.segments).length)))(t)},f=function(n,t,r,o){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:!1;return R.pipe(e.byIdentity("seats"),e.byBelongsToAny(n),e.byBelongsToAny([].concat(r)),e.byBelongsToAny([].concat(o)),e.byModel({sold:a}),R.length,R.equals(n.length))(t)},g=function(n,t,r){return R.pipe(e.byIdentity("seats"),e.byBelongsToAny(n),e.byBelongsToAny([].concat(r)),R.length,R.gt(R.multiply(n.length,e.byBelongsToAny([].concat(r))(t.segments).length)))(t)},h=function(n,t,r){return R.pipe(e.byHasAny(R.pipe(e.byIdentity("seats"),e.byBelongsToAny([].concat(r)))(t)),R.isEmpty)(n)},A=function(n,t,r){return R.pipe(e.byIdentity("checkin"),e.byBelongsToAny([r]),e.byKeyValueAny(["model","status"],["nocheckin","documentsadded"]),e.byBelongsToAny(n),R.isEmpty)(t)};return{isJourneyCancelled:a,isJourneyFlown:s,isCheckinNotOpen:c,isOnlineCheckinOpen:u,isCheckinFree:y,isCheckinEarly:p,isCheckinOpen:i,isCheckinClosed:l,someSeated:d,someSeatless:g,noneSeated:h,allSeated:b,allSeatedForSegmentPerJourney:f,areAllCheckedInForJourney:A}}]);


"use strict";angular.module("app.booking").service("BookingReadCheckin",["ModelQuery",function(e){var n=function(n){return R.pipe(e.byIdentity("checkin"),e.byKeyValue(["model"],"reprint"),e.hasAny)(n)},r=e.byKeyValueAny(["model","status"],["nocheckin","documentsadded"]),i=R.curry(function(n,r){return e.byKey({passengers:n.key.id})(r)}),t=R.curry(function(n,i){return R.pipe(r,e.byKey({passengers:n.key.id}),e.hasAny)(i.checkin)}),c=R.compose(R.equals("ADT"),R.pathOr(!1,["model","type"])),s=R.curry(function(n,t){var c=e.byModel({type:"ADT"})(t.passengers),s=R.pipe(e.byBelongsToAny(c),e.byModel({status:"reprint"}))(t.checkin);return R.pipe(r,i(n),e.byAssociation(["journeys"],s),e.hasAny)(t.checkin)}),y=R.curry(function(n,t){var c=R.pipe(e.byModel({type:"ADT"}))(t.selectedPassengers),s=R.pipe(r,e.byBelongsToAny(c))(t.checkin);return R.pipe(r,i(n),e.byAssociation(["journeys"],s),e.hasAny)(t.checkin)}),u=R.curry(function(e,n){return R.and(t(R.__,n.checkin),R.either(c,R.either(s(R.__,n),y(R.__,n))))(e)}),o=R.curry(function(n,r){return R.pipe(e.byKey({passengers:n.key.id}),e.byPredicate(R.where({status:R.complement(R.either(R.equals("reprint"),R.equals("flown")))})),R.isEmpty)(r.checkin)}),a=R.curry(function(n,r){return R.pipe(e.byKey({passengers:n.key.id}),e.byPredicate(R.where({status:R.either(R.equals("reprint"),R.equals("flown"))})),e.hasAny)(r.checkin)}),p=R.curry(function(n,i,t){return R.pipe(r,e.byKey({passengers:i.key.id,journeys:n}),e.hasAny)(t.checkin)}),h=function(n,r){var i=e.byIdentity("checkin")(n),t=e.byIdentity("journeys")(n),c=function(e){return R.equals(t.length,R.length(e))};return R.pipe(e.byModel({status:"reprint"}),R.groupBy(function(e){return e.key.passengers}),function(e){return r?R.filter(c)(e):e},R.keys,R.length,Boolean)(i)};return{isPaxCheckedIn:o,isPaxCheckedInForAnyJourney:a,isSomePaxCheckIn:n,isPaxCheckinActive:t,getActiveCheckins:r,canPaxSelectCheckin:u,canPaxSelectCheckinForJourney:p,anyPassengerCheckedIn:h}}]);


"use strict";angular.module("app.booking").factory("BookingRead",["$state","$stateParams","Dates","ModelQuery","FEATURE_CONFIG","BookingReadInfo","BookingReadJourneys","BookingReadSegments","BookingReadUtils","CheckinAvailability","BookingReadSsrs","BookingReadAddons","HIDDEN_ITINERARY_SSRS","BOOKING_STATES","MarketConfig","TRAVEL_CREDIT","FLIGHT_TYPES","FEE_CODES",function(e,t,n,r,s,o,i,y,a,u,d,l,p,c,g,b,f,h){function m(e){return R.reduce(function(t,n){return t+R.path(e,n)},0)}function I(e,t){return r.byIdentity(e)(t)}function A(e){return"approved"===(""+R.path(["model","status"],e)).toLowerCase()}function S(e){return R.pipe(r.joinAll,r.byModel({sold:!0}),r.byLocal(!1),r.byRemoved(!1))(e)}function P(e){return R.pipe(r.joinAll,r.byModel({sold:!0}),r.byLocal(!1),r.byRemoved(!1),R.map(R.path(["model","total"])),R.reduce(R.add,0))(e)}function M(e){return R.pipe(r.joinAll,r.byModel({sold:!1}),r.byLocal(!1),r.byRemoved(!1),R.map(R.path(["model","total"])),R.sum)(e)}function B(e){return R.pipe(z,r.byModel({sold:!1}),r.byLocal(!1),r.byRemoved(!1))(e)}function v(e){return M(e)>0}function F(e,t){return R.pipe(r.byIdentity("ssrs"),r.byModel({type:e,sold:t}))}function T(e,t){return R.pipe(r.byIdentity("ssrs"),r.byModel({code:e,sold:t}))}function k(e,t){return R.pipe(r.byIdentity("addons"),r.byModel({src:e,sold:t}))}function C(e,t){return R.pipe(r.byIdentity("addons"),r.byModel({src:e,sold:t}),R.isEmpty(),R.not())}function E(e,t,n){return R.pipe(r.byIdentity("addons"),r.byModel({paxNum:e,code:t}),r.byLocal(!0),R.isEmpty(),R.not())(n)}function O(e){return!!R.pipe(r.byIdentity("ssrs"),r.byModel({code:e}))}function D(e,t,n){return function(s){if(t&&!O(t)(s))return[];var o=babelHelpers["extends"]({},e,{isPartOfBundle:!0});return R.pipe(r.byIdentity(n),r.byModel(o))(s)}}function j(e,t){return D(e,t,"ssrs")}function U(e){return D({type:"SEAT"},e,"seats")}function H(e){return function(t){return R.pipe(r.byIdentity("ssrs"),r.byModel({code:"BUND",sold:e}))(t)}}function L(e){return function(t){return R.pipe(r.byIdentity("ssrs"),r.byKey({journeys:e}),r.findByModel({code:"BUND"}))(t)}}function K(e){return R.pipe(r.byIdentity("ssrs"),r.byModel({code:"SURE"}),r.hasAny)(e)}function N(e,t,n){return R.pipe(r.byIdentity("seats"),r.byKey(t),r.byBelongsToAny(e),r.byRemoved(!1),R.length,R.equals(e.length))(n)}function x(e,t,n){return R.pipe(r.byIdentity("seats"),r.byKey({journeys:t}),r.byLocal(!1),r.byBelongsToAny(e),R.length,R.equals(R.multiply(e.length,R.pipe(r.byIdentity("segments"),r.byKey({journeys:t}))(n).length)))(n)}function V(e){return R.pipe(r.byIdentity("seats"),R.length,R.equals(R.multiply(r.byIdentity("passengers")(e).length,r.byIdentity("segments")(e).length)))(e)}function J(e,t){return x(I("passengers",t),e,t)}function w(e,t){var n=function(e){return void 0!==t&&R.path(["removed"],e)?e.removed===t:e};return R.pipe(r.byIdentity("seats"),r.byModel({sold:e}),R.filter(n))}function q(e){var t=this,n=r.byIdentity("checkin")(e),s=r.byIdentity("journeys")(e),o=r.byIdentity("passengers")(e);return s.map(function(s,i){return t.getFreeMoveFlights(e)[i]?!1:o.some(function(e){var t=r.byKey({passengers:e.key.id,journeys:s.key.id})(n);return"reprint"===R.pathOr("",[0,"model","status"],t)})})}function G(e){var t=this.isJourneyFlown(0,e);return R.pipe(w(!0),R.filter(function(e){return!(t&&0===e.key.journeys)}),R.length,R.lte(R.multiply(r.byIdentity("passengers")(e).length,y.getFutureFlights(e).length)))(e)}function W(e){return R.pipe(w(!0),R.concat(r.byKeyValueAny(["model","seatType"],["Priority","XL"])(w(!1)(e))),R.length,R.equals(R.multiply(r.byIdentity("passengers")(e).length,y.getFutureFlights(e).length)))(e)}function _(e,t,n){return R.pipe(r.byIdentity("seats"),r.byKey({journeys:e}),r.byBelongsToAny(R.pipe(r.byIdentity("passengers"),r.byModel({type:t}))(n)))(n)}function Y(e,t){return R.pipe(r.byIdentity("seats"),r.byModel({isPartOfBundle:!1}),r.byBelongsToAny(R.pipe(r.byIdentity("passengers"),r.byModel({type:e}))(t)))(t)}var z=R.pipe(r.joinAll,r.byHasProperty([],"model"),r.byHasProperty(["model"],"sold"),r.byRemoved(!1)),Q=function(e){return R.path(["tripId","0","model"],e)},Z=function(e){return R.filter(function(t){return!R.contains(t.model.code,e)})},$=function(e,t){return R.pipe(r.byIdentity("addons"),r.byModel({code:e}))(t)},X=function(e,t,n){return R.pipe($,r.byLocal(t))(e,n)},ee=R.curry(function(e,t){return R.pipe(r.byIdentity(e),R.pluck("model"))(t)}),te=R.pipe(r.byIdentity("ssrs"),r.byModel({code:"HOLD",sold:!1})),ne=R.pipe(r.byIdentity("extras"),r.byModel({code:h.SMS}),r.hasAny),re=function(e){return R.pipe(r.byIdentity("checkin"),r.byModel({status:"reprint"}))(e)},se=function(e){return r.hasAny(re(e))},oe=function(e){return se(e)&&R.or(R.pipe(r.byIdentity("ssrs"),r.byModel({sold:!1}),r.hasAny)(e),R.pipe(r.byIdentity("seats"),r.byModel({sold:!1}),r.hasAny)(e))},ie=R.pipe(r.byIdentity("zoneDiscount"),R.either(R.compose(R.head,R.pluck("model")),function(){return!1})),ye=R.pipe(R.pathOr(0,["info","0","model","pnr","length"]),R.lt(0)),ae=R.curry(function(e,t){return r.byModel({type:t})(e)}),ue=function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"--";return R.pipe(r.byIdentity("seats"),r.byKey(t),R.map(R.path(["model","code"])),R.either(R.head,function(){return n}))(e)}},de=R.pipe(R.path(["model","type"]),R.equals("ADT")),le=function(e,t){return R.pipe(r.byIdentity("segments"),r.byKey({journeys:e}),r.hasAnyModel({flown:!0}))(t)},pe=function(e){return R.pipe(r.byIdentity("journeys"),R.map(function(t){return R.pipe(r.byIdentity("checkin"),r.byKey({journeys:t.key.id}),r.byModel({status:"flown"}),r.hasAny)(e)}))(e)},ce=function(e){return R.pipe(r.byIdentity("journeys"),R.map(function(t){return R.pipe(r.byIdentity("checkin"),r.byKey({journeys:t.key.id}),r.byModel({status:"boarded"}),r.hasAny)(e)}))(e)},Re=function(e){return R.pipe(r.byIdentity("checkin"),R.filter(function(e){return"flown"!==R.path(["model","status"],e)}))(e)},ge=function(e,t){var n=R.ifElse(function(){return R.equals(t,!0)},Re,r.byIdentity("checkin"))(e);return R.pipe(r.byModel({status:"reprint"}),R.length,R.equals(n.length))(n)},be=function(e,t,s){var o=function(e){var r=n.utc(R.path(["0","model","arriveUTC"],e)),o=n.utc(n.now),i=void 0,y=void 0;return i=o.year()>=r.year()&&o.dayOfYear()>r.dayOfYear()?o:r,e.length>1?(y=n.utc(R.path(["1","model","departUTC"],e)),i.isSame(y,"day")&&(y=n.addDays(y,1,t))):y=n.addDays(i,s,t),{checkinDate:i,checkoutDate:y}};return R.pipe(r.byIdentity("journeys"),o)(e)},fe=function(e){var t=function(e){var t=n.utc(e[0].model.departUTC),r=n.utc(e[1].model.departUTC);return r.diff(t,"days")};return R.ifElse(i.isReturnTrip,R.pipe(r.byIdentity("journeys"),t),function(){return 0})(e)},he=function(e){return R.pipe(R.head,R.pathOr({},["model","maxPaxSeatRowDistance"]),R.head,R.pathOr(0,["rowDistance"]))(i.filterUnavailableJourneys(e))},me=function(e,t){return R.pipe(r.byIdentity("seats"),r.byKey({journeys:e}),r.byModel({sold:!0}))(t)},Ie=function(e){return R.pipe(r.byIdentity("ssrs"),r.byModel({code:"PLUS",sold:!0}),r.hasAny)(e)},Ae=function(e){return R.pipe(r.byIdentity("ssrs"),r.byModel({code:"SURE",sold:!0}),r.hasAny)(e)},Se=function(e){return R.pipe(r.byIdentity("ssrs"),r.byModel({code:"REGU",sold:!0}),r.hasAny)(e)},Pe=function(e){return R.pipe(r.byIdentity("ssrs"),r.byModel({code:"FAMI",sold:!0}),r.hasAny)(e)},Me=function(e,t){return R.pipe(r.byIdentity("ssrs"),r.byKey({journeys:t}),r.byModel({code:"PLUS"}),r.hasAny)(e)},Be=function(e){return R.pipe(r.byIdentity("ssrs"),r.byModel({code:"PLUS"}),r.hasAny)(e)},ve=function(e,t){return R.pipe(r.byIdentity("ssrs"),r.byKey({journeys:t}),r.byModel({code:"SURE"}),r.hasAny)(e)},Fe=function(e){return R.pipe(r.byIdentity("ssrs"),r.byModel({code:"SURE"}),r.hasAny)(e)},Te=function(e,t){return R.pipe(r.byIdentity("ssrs"),r.byKey({journeys:t}),r.byModel({code:"FAMI"}),r.hasAny)(e)},ke=function(e){return R.pipe(r.byIdentity("ssrs"),r.byModel({code:"FAMI"}),r.hasAny)(e)},Ce=function(e){return R.pipe(r.byIdentity("journeys"),R.filter(R.pathEq(["model","fareOption"],void 0)))(e)},Ee=function(e){return R.pipe(Ce,R.length,Boolean)(e)},Oe=function(e){return R.pipe(r.byIdentity("journeys"),R.all(R.pathEq(["model","fareOption"],void 0)))(e)},De=function(e,t,n){return R.pipe(r.byIdentity("ssrs"),r.byModel({code:t}),R.map(function(e){return e.key.journeys}),R.uniq,R.length,R.equals(n))(e)},je=function(e,t){var n=void 0;return ye(e)&&(n=Me(e,t)?"business":ve(e,t)?"leisure":Te(e,t)?"family":"regular"),n},Ue=function(e){return Fe(e)&&Be(e)},He=function(e){return Fe(e)&&ke(e)},Le=function(e){return De(e,"SURE",1)||De(e,"PLUS",1)||De(e,"FAMI",1)},Ke=function(e){return De(e,"SURE",2)||De(e,"PLUS",2)||De(e,"FAMI",2)||Ue(e)||He(e)||d.isErasmus(e)},Ne=function(e){return e.journeys.every(function(t){return ve(e,t.key.id)||Me(e,t.key.id)?J(t.key.id,e):!0})},xe=function(e){return!!H(!0)(e).length},Ve=function(e){return!!R.pipe(r.byIdentity("ssrs"),r.findByModel({code:"FAMI"}))(e)&&xe(e)},Je=function(e){return!!R.pipe(r.byIdentity("ssrs"),r.findByModel({code:"SURE"}))(e)&&xe(e)},we=function(e){return R.pipe(r.byIdentity("ssrs"),r.findByModel({code:"BUND",sold:e}))},qe=function(e){return R.pipe(r.byIdentity("ssrs"),r.byModel({code:"BUND"}),r.hasAny)(e)},Ge=function(e){return Fe(e)||Be(e)},We=function(e){return Fe(e)||Be(e)||ke(e)},_e=function(e){var t=w(!0)(e);return!Ge(e)&&R.length(R.filter(function(e){return 0===R.path(["model","total"],e)},t))===R.length(t)},Ye=R.pipe(r.byIdentity("payments"),r.byModel({code:"VO"})),ze=R.pipe(Ye,m(["model","amt"])),Qe=R.pipe(Ye,m(["model","discount"])),Ze=function(e,t,n){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return!!R.pipe(r.byModel({type:n}),r.findByKey({journeys:e,passengers:t}))(s)},$e=function(e,t){return R.pipe(r.byIdentity("zoneDiscount"),r.byKey({journeys:e}),R.pluck("model"),R.head)(t)},Xe=function(e){var t=$e(0,e);return"ES"===R.path(["zone"],t)&&t.pct>0},et=function(e){function t(e){return function(t){return e?"Approved"===R.path(["model","status"],t):"Approved"!==R.path(["model","status"],t)}}var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1;return R.pipe(r.byIdentity("payments"),r.byModel({code:"VO"}),R.filter(t(n)),R.reduce(function(e,t){var n=t.model;return e+R.pathOr(0,["amt"],n)+R.pathOr(0,["discount"],n)},0))(e)},tt=R.pipe(r.byIdentity("payments"),r.byModel({code:b.CODE})),nt=R.pipe(tt,m(["model","discount"])),rt=function(e){function t(e){return function(t){return e?"Approved"===R.path(["model","status"],t):"Approved"!==R.path(["model","status"],t)}}var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1;return R.pipe(r.byIdentity("payments"),r.byModel({code:b.CODE}),R.filter(t(n)),R.reduce(function(e,t){var n=t.model;return e+R.pathOr(0,["amt"],n)+R.pathOr(0,["discount"],n)},0))(e)},st=function(e){var t=e.state,n=e.includeApproved;return function(e){var r=et(t,n)+rt(t,n),s=e-r;return s>0?s:0}},ot=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1,n=o.getBookingInfo(e),s=function(e){var t="Confirmed"!==R.pathOr("",["status"],n)?"CARHIRE"===e.src||"HOTEL"===e.src:"HOTEL"===e.src,r="SPOIL"===e.code;return!t&&!r},i=t?r.byLocal(!1):R.identity;return R.pipe(z,r.byModel({sold:!1}),i,R.pluck("model"),R.filter(s),m(["total"]),st({state:e,includeApproved:!1}))(e)},it=function(e){return R.pipe(r.byIdentity("passengers"),r.byHasAny(R.pipe(r.byIdentity("seats"),r.byBelongsToAny(e.journeys),r.byModel({sold:!0}))(e),!0))(e)},yt=function(e){return k("EVENTS",e)},at=function(e){return C("EVENTS",e)},ut=function(e){return R.pipe(r.byIdentity("seats"),r.byModel({sold:!1}),r.byRemoved(!1),r.sumUpTotal)(e)},dt=function(e){return R.pipe(r.byIdentity("seats"),r.byModel({sold:!1}),r.byRemoved(!1),r.sumUpQty)(e)},lt=R.pipe(r.byIdentity("seats"),r.byModel({sold:!1}),r.hasAny),pt=R.pipe(r.byIdentity("seats"),r.byModel({isPartOfBundle:!1,sold:!1}),r.hasAny),ct=R.compose(R.flatten,R.map(function(e){return e.map(function(e,t){return R.assocPath(["model","enum"],t+1,e)})}),R.groupWith(function(e,t){return e.model.type===t.model.type})),Rt=function(e){return R.pipe(r.byIdentity("fares"),R.pluck("model"),R.pluck("total"),R.sum)(e)},gt=function(e){return R.pipe(r.byIdentity("ssrs"),r.byKeyValueAny(["model","code"],["SURE","PLUS"]),m(["model","total"]))(e)},bt=function(e){return R.pipe(r.byIdentity("ssrs"),r.byModel({code:"FAMI"}),m(["model","total"]))(e)},ft=function(e){return R.pipe(r.byIdentity("payments"),R.filter(A),m(["model","dccAmt"]))(e)},ht=function(e){return R.add(Rt(e),gt(e))},mt=function(e){return R.pipe(r.byIdentity("passengers"),R.length)(e)},It=function(e){return R.pipe(r.byIdentity("ssrs"),r.byKey({passengers:0,journeys:0}),r.byModel({type:"BAGS",sold:!0}),R.length,R.lte(2))(e)},At=function(e,t){var n=[f.OUT,f.BACK],s=R.pipe(r.byIdentity("ssrs"),r.byModel({code:t}),R.head,R.path(["model","journeyNum"]))(e);return n[s]},St=function(e){var t=At(e,"PLUS"),n=At(e,"SURE"),r=At(e,"FAMI");return t||n||r},Pt=function(e,t){return R.pipe(r.byIdentity("ssrs"),r.byKey(e),r.byModel({code:"SETA"}),R.reduce(function(e,t){return e+t.model.total},0))(t)},Mt=function(e){function t(t){return R.pipe(r.byIdentity("passengers"),r.byModel({type:t}),R.length)(e)}return{ADT:t("ADT"),CHD:t("CHD"),TEEN:t("TEEN"),INF:R.pipe(r.byIdentity("inf"),R.length)(e)}},Bt=function(e){var n=Mt(e),r=i.getBookingDates(e),s=o.getBookingInfo(e),y=Q(e)||t.tripId,a=i.isReturnTrip(e),u="tpAdults="+n.ADT+"&tpIsConnectedFlight="+s.isConnectingFlight+"&tpStartDate="+r.start+"&tpChildren="+n.CHD+(a?"&tpEndDate="+r.end:"")+"&tpInfants="+n.INF+"&tpOriginIata="+i.getOriginCityCode(e)+"&tpTeens="+n.TEEN+"&tpDestinationIata="+i.getDestCityCode(e)+"&tripId="+y;return u};return babelHelpers["extends"]({},a,o,i,y,d,l,{get:I,getModel:ee,hasAddon:function(e,t){return R.pipe(r.byIdentity("addons"),r.byModel({src:e}),r.hasAny)(t)},hasUnpaidAddons:function(e){return R.pipe(r.byIdentity("addons"),r.byModel({sold:!1}),r.hasAny)(e)},isSaraValidated:function(t){return!e.includes("booking.extras")&&R.pipe(r.byIdentity("passengers"),r.byModel({code:"BAPV"}),r.hasAny)(t)},getOperator:function(e){return R.pipe(r.byIdentity("segments"),R.head,R.path(["model","operatedBy"]))(e)},isOperatedBy:function(e,t){return R.equals(t,this.getOperator(e))},isPendingBooking:function(e){return!!R.pipe(r.byIdentity("payments"),r.findByModel({status:c.PENDING}))(e)},isAvailableBooking:function(e){return!!R.pipe(r.byIdentity("payments"),r.findByModel({status:c.AVAILABLE}))(e)},hasVoucher:function(e){return!!R.pipe(r.byIdentity("payments"),r.findByModel({code:"VO"}))(e)},isBooked:ye,getHoldFareObjects:te,hasSms:ne,isSoldHeldFareFlight:function(e){return R.pipe(r.byIdentity("ssrs"),r.byModel({code:"HOLD",sold:!0}),r.hasAny)(e)},getZoneDiscount:ie,isPaymentFeesApplied:function(e){return R.pipe(r.byIdentity("fees"),r.byModel({type:"PaymentFee",sold:!0}),r.hasAny)(e)},getAmountPaidByUser:function(e){function t(e){return"VO"!==R.path(["model","code"],e)}function n(e){return"prepaid"!==(""+R.path(["model","type"],e)).toLowerCase()}return R.pipe(r.byIdentity("payments"),R.filter(A),R.filter(t),R.filter(n),m(["model","total"]))(e)},getAggregatedObjects:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments[1],n=arguments[2];return R.pipe(r.byIdentity("ssrs"),r.join(r.byIdentity("seats")(n)),r.byKey({journeys:e}),r.byBelongsToAny(R.pipe(r.byIdentity("passengers"),r.byModel({type:t}))(n)),r.byPredicate(R.where({code:R.complement(R.equals("HOLD"))})))(n)},getChildPassengers:function(e){return R.pipe(r.byIdentity("passengers"),r.byModel({type:"CHD"}))(e)},getAdultPassengers:function(e){return R.pipe(r.byIdentity("passengers"),r.byModel({type:"ADT"}))(e)},getFirstAdultPassenger:function(e){return R.pipe(r.byIdentity("passengers"),r.byModel({type:"ADT"}),R.pluck("model"),R.head)(e)},getMinorPassengers:function(e){return R.pipe(r.byKeyValueAny(["model","type"],["CHD","TEEN"]),r.byIdentity("passengers"))(e)},hasMinor:function(e){return R.pipe(r.byIdentity("passengers"),r.byKeyValueAny(["model","type"],["CHD","TEEN"]),r.hasAny)(e)},getCountMandatorySeatRequired:function(e){var t=Math.ceil(this.getChildPassengers(e).length/4);return i.isSpanishDomestic(e)?0:Math.min(t,this.getAdultPassengers(e).length)},getShouldSeparateFareBundle:function(e){return i.isSpanishDomestic(e)||ke(e)},isMandatorySeatNeeded:function(t,n){return[s["mandatory-seats-enabled"],this.isPotentialBooking(t)||e.is("booking.active.itinerary")||n,this.getChildPassengers(t).length,!Xe(t),!i.isSpanishDomestic(t)].every(R.identity)},isMandatorySeatNeededPerLeg:function(e,t,n){return[this.isMandatorySeatNeeded(e,n),!Me(e,t),!ve(e,t)].every(R.identity)},getPaxWhoNeedMandatorySeats:function(e,t){var n=this.isMandatorySeatNeeded(e,t),s=n?this.getCountMandatorySeatRequired(e):0,o=n?this.getChildPassengers(e):[];return R.pipe(r.byIdentity("passengers"),r.byModel({type:"ADT"}),R.slice(0,s),R.concat(o))(e)},getNonMandatorySeatsForPassengerForJourney:function(e,t,n,r){var s=R.pipe(R.pluck("model"),R.pluck("num"))(this.getPaxWhoNeedMandatorySeats(r)),o=R.contains(t,s);return o?[]:this.getSoldSeatForPassengerByJourney(e,t,n,r)},getNonMandatorySeats:function(e){var t=function(t){return R.pipe(r.byIdentity("seats"),r.byKey({passengers:t.num}),r.byModel({sold:!1}),r.byRemoved(!1))(e)},n=R.pipe(R.pluck("model"),R.pluck("num"))(this.getPaxWhoNeedMandatorySeats(e)),s=function(t){return Me(e,t.key.journeys)||ve(e,t.key.journeys)};return R.pipe(r.byIdentity("passengers"),R.pluck("model"),R.filter(function(e){return n.indexOf(e.num)<0}),R.reduce(function(e,n){return e.concat(t(n))},[]),R.reject(s))(e)},getUnsoldMandatorySeats:function(e){return R.pipe(r.byIdentity("seats"),r.byModel({sold:!1}),r.byRemove(!1),r.byBelongsToAny(this.getPaxWhoNeedMandatorySeats(e)))(e)},isSeatMapDrawerOpeningRequired:function(e){return this.isMandatorySeatNeeded(e)&&!this.areAllMandatorySeatsAssigned(e)||We(e)&&!V(e)},getSeatsForPassengerByJourney:function(e,t,n){return R.pipe(r.byIdentity("seats"),r.byKey({journeys:e,passengers:t}))(n)},getMandatorySeatForAdultPessengerByJourney:function(e,t,n){return R.pipe(r.byIdentity("ssrs"),r.byKey({journeys:e,passengers:t}),r.byKeyValueAny(["model","code"],["SETA"]))(n)},getMandatorySeatsForAdultPassengerByJourneySegmentAndPaxIndex:function(e,t){return R.pipe(r.byIdentity("ssrs"),r.byKey(e),r.byKeyValueAny(["model","code"],["SETA"]))(t)},isSetaPerPaxPerJourney:function(e,t,n){return R.pipe(r.byIdentity("ssrs"),r.byKey({journeys:e,passengers:t}),r.byModel({code:"SETA"}),r.hasAny)(n)},hasMandatorySeatForAdultPessengerByJourney:function(e,t,n){var s=this.getMandatorySeatForAdultPessengerByJourney(e,t,n);return R.pipe(s,r.hasAny)(n)},getSoldPaxFeesByPassenger:function(e,t,n){return R.pipe(r.byIdentity("paxFees"),r.byKey({passengers:t}),r.byModel({sold:e}))(n)},getSoldSeatByPassenger:function(e,t,n){return R.pipe(r.byIdentity("seats"),r.byKey({passengers:t}),r.byModel({sold:e}))(n)},getSoldSeatByJourney:me,hasAnySoldSeatByPassenger:function(e,t,n){return this.getSoldSeatByPassenger(e,t,n).length>0},getSoldSeatForPassengerByJourney:function(e,t,n,s){return R.pipe(r.byIdentity("seats"),r.byKey({passengers:t,journeys:n}),r.byModel({sold:e}))(s)},hasAnySoldSeatForPassengerByJourney:function(e,t,n,r){return this.getSoldSeatForPassengerByJourney(e,t,n,r).length>0},getSoldSsrsByPassenger:function(e,t,n,s){return R.pipe(r.byIdentity("ssrs"),r.join(r.byIdentity("segPrm")(n)),r.byKey({passengers:t}),r.byModel({sold:e}),Z(s?R.without(["FAMI","REGU"],p):p))(n)},hasAnySoldSsrsByPassenger:function(e,t,n){return this.getSoldSsrsByPassenger(e,t,n,!1).length>0},hasUnsoldSpecialAssistance:function(e){return R.pipe(r.byIdentity("segPrm"),r.byModel({sold:!1}),R.isEmpty(),R.not())(e)},getSoldSsrsForPassengerByJourney:function(e,t,n,s){return R.pipe(r.byIdentity("ssrs"),r.join(r.byIdentity("segPrm")(s)),r.byKey({passengers:t,journeys:n}),r.byModel({sold:e}),Z(p))(s)},hasAnySoldSsrsForPassengerByJourney:function(e,t,n,r){return this.getSoldSsrsForPassengerByJourney(e,t,n,r).length>0},areAllMandatorySeatsAssigned:function(e){return R.pipe(r.byHasAny(r.byIdentity("seats")(e)),r.hasAny)(this.getPaxWhoNeedMandatorySeats(e))},areAllMandatorySeatsAssignedForAllJourneys:function(e){var t=this.getPaxWhoNeedMandatorySeats(e);return e.journeys.reduce(function(n,r){return n&&x(t,r.key.journey,e)},!0)},isSaraValidationEnabled:function(e){return Xe(e)&&this.isBooked(e)&&this.getBagItems(!1)(e).length},hasSpanishDiscount:Xe,isFamilyDiscountEligible:function(e){return this.isPotentialBooking(e)&&this.hasMinor(e)},hasPurchasedDomestic:function(e,t){return R.pipe(r.byIdentity("payments"),r.byModel({code:e}),r.hasAny)(t)},getVatRate:function(e){return R.pipe(r.byIdentity("segments"),R.head,R.path(["model","vatRate"]))(e)},getDomesticFee:function(e,t,n){var r=e*(t/100);return r+r*this.getVatRate(n)},getPaymentDiscount:function(e){return R.pipe(r.byIdentity("zoneDiscount"),r.byBelongsToAny(R.ifElse(ye,function(){return[]},r.byIdentity("journeys"))(e)),m(["model","total"]))(e)},getFaresCostWithIncludedPaymentFee:function(e,t){return R.path(["perc"],e)&&"INC"===g.getCCFeeDisplayType()?Rt(t)+(Rt(t)-this.getPaymentDiscount(t))*(e.perc/100):Rt(t)},isBusinessPlusPurchased:Ie,isLeisurePlusPurchased:Ae,isRegularPurchased:Se,isFamilyPlusPurchased:Pe,isBusinessPlusLeg:Me,hasBusinessPlus:Be,isLeisurePlusLeg:ve,hasLeisurePlus:Fe,hasFamilyPlus:ke,isFamilyPlusLeg:Te,isBusinessBundle:qe,isPlusBundle:K,isFamilyBundlePurchased:Ve,isPlusBundlePurchased:Je,isFareOnLegs:De,getPurchasedFareName:je,isUpgradedBusinessBundle:function(e){return R.pipe(r.byIdentity("ssrs"),r.byModel({code:"BUND",sold:!1}),r.hasAny)(e)},hasBusinessOrLeisurePlus:Ge,hasBusinessOrLeisureOrFamilyPlus:We,hasIncludedSeats:function(e){return Ge(e)},hasIncludedBags:function(e){return Ge(e)},hasCarHire:function(e){return R.pipe(r.byIdentity("addons"),r.byModel({src:"CARHIRE"}),r.hasAny)(e)},hasCarHireSold:function(e){return R.pipe(r.byIdentity("carHire"),R.filter(function(e){return R.path(["model","confirmationId"],e)}),r.hasAny)(e)},getCarhireObject:function(e){return R.pipe(r.byIdentity("addons"),r.byModel({type:"CARHIRE"}),R.head)(e)},hasAccommodation:function(e){return R.pipe(r.byIdentity("addons"),r.byModel({src:"HOTEL"}),r.hasAny)(e)},hasSomeAdultWithCode:function(e,t){return R.pipe(r.byIdentity("ssrs"),r.byBelongsToAny(R.pipe(r.byIdentity("passengers"),r.byModel({type:"ADT"}))(t)),r.byKeyValueAny(["model","code"],[e]),r.hasAny)(t)},getPaxCount:mt,leadPaxHasTwoBagAllowance:It,getPaxType:function(e,t){return R.pipe(r.byIdentity("passengers"),r.byModel({type:e}))(t)},getVatSumForJourneys:function(e){return R.pipe(r.byIdentity("fares"),R.reduce(function(e,t){return R.path(["model","vat"],t)+e},0))(e)},getBundlesForPassengerTypeByJourney:function(e,t,n){return R.pipe(r.byIdentity("ssrs"),r.byKey({journeys:t}),r.byKeyValueAny(["model","code"],["SURE","PLUS","REGU"]),r.byBelongsToAny(R.pipe(r.byIdentity("passengers"),r.byModel({type:e}))(n)),R.pluck("model"))(n)},getBundlePriceForPassengerTypeByJourney:function(e,t,n){return R.pipe(this.getBundlesForPassengerTypeByJourney,R.reduce(function(e,t){return e+t.total},0))(e,t,n)},getCheckinAvailability:function(e){return u(R.path(["0","model"],r.byIdentity("serverTimeUTC")(e)),r.byIdentity("journeys")(e))},isCheckin:function(e){return this.getCheckinAvailability(e).isCheckin()},isPaxCheckinReady:function(e,t,n){return this.getCheckinAvailability(n).isPaxCheckinReady({paxNum:e,leg:t,checkins:n.checkin,seats:n.seats})},getCheckedInPassengers:re,isSomePaxCheckIn:se,getLegsCheckInStatus:q,getFareDiscountsTotal:function(e){return R.pipe(r.byIdentity("fats"),m(["model","amt"]))(e)},getVoucherApplicableAmount:et,getTravelCreditAmount:rt,getSaleableProducts:z,getSoldProducts:S,getUnsoldProducts:B,getTotalUnsold:M,getSsrsByCodeAndSold:T,getTotalSold:P,hasTotalBalanceUnsold:v,isPaxAdult:de,getSeatsByPassengerTypeByJourney:_,getSeatsByPassengerType:Y,getTotalUnsoldByCode:function(e){return R.pipe(r.byIdentity("ssrs"),r.byModel({code:e,sold:!1}),r.byRemoved(!1),m(["model","total"]))},getFaresByModel:function(e,t){return R.pipe(r.byIdentity("fares"),R.pluck("model"))(t)},getFaresFor:function(e,t){return R.pipe(r.byIdentity("fares"),r.byKey({journeys:e}),R.pluck("model"))(t)},getFaresCostFor:Rt,getInfSsrsFor:function(e,t){return R.pipe(r.byIdentity("infSsrs"),r.byKey({journeys:e}),R.pluck("model"))(t)},getFatsFor:function(e,t){return R.pipe(r.byIdentity("fats"),r.byKey({journeys:e}),R.pluck("model"))(t)},getZoneDiscountFor:$e,getBabyItems:function(e){return F("BABY",e)},getMusicItems:function(e){return F("MUSIC",e)},getSportItems:function(e){return F("SPORTS",e)},getParkingItems:function(e){return k("PARKING",e)},getBundledSsrs:j,getBundledSeats:U,getBundle:H,getBundleByLeg:L,getCarHireItems:function(e){return e?R.pipe(r.byIdentity("carHire"),r.byModel({status:"NOT_FOUND"},!0)):k("CARHIRE",e)},hasCarHireItems:function(e){return C("CARHIRE",e)},getTransferItems:function(e){return k("TRANS",e)},getHotelItems:function(e){return k("HOTEL",e)},hasHotelItems:function(e){return C("HOTEL",e)},getEventItems:yt,hasEventItems:at,getSeatByKey:function(e){return R.compose(R.head,r.byKey(e),r.byIdentity("seats"))},getPriorityProducts:function(e,t){return R.pipe(r.byIdentity("ssrs"),r.byModel({type:"PRIOBRDNG",code:t}))(e)},getSeatsDistance:he,getExtraItemsByType:function(e,t){return R.pipe(r.byIdentity("extras"),r.byModel({code:e,sold:!1}),R.pluck("model"))(t)},hasUnsoldExtraItemsByCode:function(e,t){return R.pipe(r.byIdentity("extras"),r.byModel({code:e,sold:!1}),r.hasAny)(t)},getBookingTotal:ot,getBookingSoldTotal:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!1,s=o.getBookingInfo(e),i=function(e){return"Confirmed"!==R.pathOr("",["status"],s)?"CARHIRE"!==e.src&&"HOTEL"!==e.src:"HOTEL"!==e.src},y=function(e){return R.path(["serviceProvider"],e)?"PENDING"!==R.pathOr("PENDING",["status"],e):!0},a=R.converge(R.multiply,[R.either(R.pathOr(0,["total"]),R.pathOr(0,["totalPrice"])),R.ifElse(R.propEq("isHandlingFeeApplicable",!0),R.always(t),R.always(1))]);return R.pipe(z,r.byModel({sold:!0}),R.pluck("model"),R.ifElse(R.always(n),R.filter(y),R.identity),R.filter(i),R.reduce(function(e,t){return e+a(t)},0),st({state:e,includeApproved:!0}))(e)},getBookingContact:function(e){return R.pipe(r.byIdentity("contacts"),R.pluck("model"),R.head)(e)},allPaxHaveSeats:V,allPaxHaveRequiredSeats:Ne,allPaxHaveSeatsByJourney:J,allSelectedPassengersHaveSeatsOnJourney:x,allSelectedPassengersHaveSeatsOnSegment:N,checkIfAtLeastOnePassengerHasSsr:function(e,t,n){var s=r.byPredicate(R.where({code:R.equals(R.__,e),total:R.either(R.gte(R.__,0),function(){return!t})}))(n.ssrs);return R.pipe(r.byIdentity("passengers"),r.byHasAny(s))(n)},getSortedPassengerObject:function(e){var t=this.getPassengerBreakdownAsObject(e)||{},n=function(e){return{type:e,num:t[e],age:{ADT:3,TEEN:2,CHD:1,INF:0}[e]||-1}};return R.pipe(R.keys,R.map(n))(t)},hasAnyStandardSeat:function(e,t){var n=R.pipe(r.byIdentity("seats"),r.byKey({passengers:e}),R.filter(function(e){return!e.model.sold}),R.length)(t),s=R.pipe(r.byIdentity("ssrs"),r.byKey({passengers:e}),R.filter(function(e){return"PS"===e.model.code&&e.model.isPartOfBundle}),R.length)(t);return n!==s},getPaxWithStandardSeats:function(e){var t=this;return R.pipe(r.byIdentity("passengers"),R.filter(function(n){return t.hasAnyStandardSeat(n.key.id,e)}))(e)},isSomeAdultCheckedIn:function(e){var t=function(e){return R.pipe(r.byIdentity("checkin"),r.byKey({journeys:e}),r.byModel({status:"reprint"}))},n=function(n){var s=!1,o=n.key.id;return n.model.flown||(s=R.pipe(r.byIdentity("passengers"),r.byModel({type:"ADT"}),r.byHasAny(t(o)(e)),r.hasAny)(e)),s};return R.pipe(r.byIdentity("journeys"),R.map(n))(e)},getFreeMoveFlights:function(e){return R.pipe(r.byIdentity("journeys"),R.map(R.pathOr(!1,["model","changeInfo","freeMove"])))(e)},getChangedFlights:function(e){return R.pipe(r.byIdentity("journeys"),R.map(R.pathOr(!1,["model","changeInfo","isChanged"])))(e)},anyFlightWasChanged:function(e){return R.pipe(r.byIdentity("journeys"),r.byKeyValue(["model","changeInfo","isChanged"],!0),r.hasAny)(e)},allPassengersCheckedIn:ge,getPaxFlownStatuses:pe,getPaxBoardedStatus:ce,showReprintMessage:oe,enumPassengersByType:ct,isEligibleForPlusUpgrade:function(e){var t=i.hasFlownOrCancelledLegs(e),n=0!==F("PRIOBRDNG",!0)(e).length,r=0!==F("CBAG",!0)(e).length,s=n||r,o=0!==w(!0)(e).length,y=Xe(e),a=d.hasAllPaxSomeBagAllowance(e);return!(o||s||y||t)&&a},isEligibleForFamilyUpgrade:function(e){var t=i.hasFlownOrCancelledLegs(e),n=0!==F("PRIOBRDNG",!0)(e).length,r=0!==F("CBAG",!0)(e).length,s=n||r,y=dt(e),a=W(e)||!!y,u=!It(e),d=Xe(e),l=o.isConnectingFlight(e),p=Fe(e),c=Be(e);return!(a&&s&&u||!a&&s&&!u||a&&!s&&!u||a&&s&&!u||d||t||l||p||c)},getPassengerById:function(e,t){return R.pipe(r.byIdentity("passengers"),r.byKey({id:e}),R.head)(t)},getPassengersByIds:function(e,t){return R.pipe(r.byIdentity("passengers"),R.filter(function(t){return R.contains(R.path(["key","id"],t),e)}))(t)},getAllUnpaidBreakfast:function(e,t){return R.pipe(this.getBreakfastItems(!1,!1),r.byBelongToAny(e))(t)},isAnySeatFreeAllocatedByJourney:function(e,t,n){return!Ge(n)&&R.pipe(r.byIdentity("seats"),r.byKey({journeys:t}),r.byBelongsToAny(R.pipe(r.byIdentity("passengers"),r.byModel({type:e}))(n)),r.byKeyValueAny(["model","total"],[0]),r.hasAny)(n)},getAllSoldBreakfast:function(e,t){return R.pipe(this.getBreakfastItems(!0,!1),r.byBelongToAny(e))(t)},getTravelDocumentForPax:function(e,t){return R.pipe(R.pathOr([],["bookingModel","travelDocuments"]),R.find(function(e){return e.key.passengers===t}),R.path(["model"]))(e)},hasPlusProduct:function(e){return e.journeys.every(function(t){var n=t.model.journeyNum;return Me(e,n)||ve(e,n)||Te(e,n)})},isFlightProductsOnly:function(e){var t=R.pipe(R.prop("ssrs"),R.length)(e),n=R.pipe(R.prop("seats"),R.length)(e),r=R.pipe(R.prop("addons"),R.length)(e),s=this.hasUnsoldSpecialAssistance(e);return!(t||n||r||s)},isRyanairFlight:function(e){return!R.path(["operatedBy"],e)},isInternationalFlight:function(e){return!R.path(["info","0","model","domestic"],e)},hasNonRyanairProductsBySold:function(e,t){return R.anyPass([this.hasCarHireItems(t),this.hasHotelItems(t),at(t)])(e)},getPassengersByType:ae,getSeatDesignator:ue,isJourneyFlown:le,getDepartingsDayDiff:fe,getIsAllSeatFreeAllocated:_e,getStandardLegs:Ce,isAllStandardLegs:Oe,getVouchers:Ye,getVouchersTotal:ze,getVouchersDiscount:Qe,getTravelCredits:tt,getTravelCreditsDiscount:nt,isInBasketForPaxOnLeg:Ze,getSeatItems:w,allPaxHaveBoughtSeats:G,getPassengersWithoutSeat:it,getSeatsTotalBalance:ut,hasUnsoldSeats:lt,isPartOfUpgrade:we,getTotalTicketCost:ht,paxHasAddonByCode:E,getFamilyCost:bt,getAllAddonsByCode:$,hasIncludedOneLeg:Le,hasIncludedBothLegs:Ke,hasUnpaidSeats:pt,isPlusAndFlexiPlus:Ue,isPlusAndFamilyPlus:He,getFlightTypeOfUpgrade:At,getFlightWithHighestUpgrade:St,getSsrsByTypeAndSold:F,getRoomsCheckinCheckoutDates:be,getMandatorySeatIncludedTotal:Pt,getDccTotalCost:ft,getAddonsByCodeAndLocal:X,getTripId:Q,hasStandardFare:Ee,getTpParams:Bt,getPassengerBreakdownAsObject:Mt})}]);


"use strict";angular.module("app.booking").factory("BookingWrite",["ModelQuery","Utilities",function(e,r){function a(e){return babelHelpers["extends"]({uuid:r.uuid()},e)}function o(r,o){var t=[].concat(r),n=R.pipe(e.bySameKey(o),e.bySameModel(o),e.byRemoved(!0))(t),u=e.subtract(n)(o),b=e.complement(t)(n),l=n.map(function(e){return e.removed=void 0,e});return[].concat(babelHelpers.toConsumableArray(u),babelHelpers.toConsumableArray(l),babelHelpers.toConsumableArray(b.map(a)))}function t(r,o){var t=[].concat(r),n=R.pipe(e.bySameModel(t),e.bySameKey(t))(o);return[].concat(babelHelpers.toConsumableArray(n),babelHelpers.toConsumableArray(t.map(a)))}function n(e){return[].concat(babelHelpers.toConsumableArray(e))}function u(r,a){function o(e){return babelHelpers["extends"]({},e,{removed:!0})}var t=[].concat(r).filter(e.isMemberOf(a)),n=e.byLocal(!0)(t),u=e.complement(t)(n),b=R.pipe(e.subtract(u),e.subtract(n))(a);return[].concat(babelHelpers.toConsumableArray(b),babelHelpers.toConsumableArray(u.map(o)))}return{add:o,remove:u,hardAdd:t,hardRemove:n,removeByUuid:function(e){return{uuid:e}}}}]);


"use strict";angular.module("common.home").service("BaggageAllowance",["$http","AirEuropaApiConfig",function(e,i){this.getBagsAllowance=function(t){var n=i.ssrsIncluded,o={"Routes[0].Origin":t.origin,"Routes[0].Destination":t.dest};return t.isReturn&&(o["Routes[1].Origin"]=t.dest,o["Routes[1].Destination"]=t.origin),e.get(n,{cache:!0,params:o})}}]);


"use strict";!function(e){var t=function(e){function t(s){babelHelpers.classCallCheck(this,t);var i=babelHelpers.possibleConstructorReturn(this,e.call(this));return i.set("basket",[]),i.set("priority",[]),i.set("fastTrack",[]),Object.assign(i,{$timeout:s}),i}return t.$inject=["$timeout"],babelHelpers.inherits(t,e),t.prototype.dequeue=function(e){this.get(e).pop(),this.notify([e])},t.prototype.enqueue=function(e){var t=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"basket";this.get(s).unshift(e),this.$timeout(function(){return t.dequeue(s)},4e3,!1),this.notify([s])},t}(ObservableService);t.$inject=["$timeout"],e.module("app.booking").service("BasketMessageQueue",t)}(angular);


"use strict";angular.module("app.booking").service("BookingUtil",["Dates",function(e){return{adultsNeedMandatorySeat:0,allCheckedIn:!1,allPaxHaveSeats:!1,amountPaidByUser:0,cancelledFlights:[!1],carhirePurchased:!1,cities:["",""],departedFlights:[!1],destCity:"",destCityCode:"",freeMoveFlights:[!1],getLegsCheckInStatus:[!1],hasAccommodation:!1,hasCarHire:!1,hasDiscountableBags:!1,hasIncludedBags:!1,hasIncludedSeats:!1,hasPaymentFeesApplied:!1,hasPurchasedSpanishDomestic:!1,hasSpanishDiscount:!1,heldFareObjects:[],inboundDepartureDate:null,insurancePurchased:!1,isAllPaxSeated:!1,isBooked:!1,isBusinessBundle:!1,isBusinessPlus:!1,isCheckin:{open:[!1],available:[!1],unavailable:[!1],due:[!1],closed:[!1]},isDomestic:!1,isFamilyDiscountEligible:!1,isFlightOutDue:!1,isHoldFare:!1,isLegacyPlus:!1,isLeisurePlus:!1,isMandatorySeatNeeded:!1,isPendingBooking:!1,isPotentialBooking:!0,isReturnTrip:!1,isSaraValidated:!1,isSoldHeldFareFlight:!1,lengthOfTrip:0,mandatoryAdults:[],mandatoryAdultsNeeded:[],originCity:"",originCityCode:"",outboundArriveDate:e.utc(),outboundDestinationIATA:"",parkingPurchased:!1,passengerBreakdownAsObject:{ADT:0,INF:0,CHD:0,TEEN:0},paxCount:0,paxTakenMandatorySeats:!1,paxWhoNeedMandatorySeats:[],paymentDiscount:0,someCheckedIn:!1,transfersPurchased:!1,vatRate:0,vatSumForJourneys:0,zoneDiscount:{}}}]);


"use strict";!function(e){e.module("app.booking").service("Booking",["$q","$state",function(t,s){var o={info:{pnr:"",status:"",curr:"",currPrecision:0,isHoldable:!1,holdDateTime:"9999-12-31T00:00:00.000Z",bookingId:0,modifiedUtcDate:"2017-02-16T17:41:24.930Z",balanceDue:0},journeys:[{flt:"",aircraft:"",vatRate:0,flown:!1,orig:"",dest:"",depart:"2017-03-31T06:50:00.000",departUTC:"2017-03-31T05:50:00.000Z",arrive:"2017-03-31T09:30:00.000",arriveUTC:"2017-03-31T07:30:00.000Z",seatsLeft:0,fares:[{disc:0,fat:0,sold:!0,total:0,code:"ADT",qty:1,vat:0,amt:0}],infSsrs:[],fats:[],isBusiness:!1,isLeisure:!1,fareType:"R",fareClass:"H",checkInOpenUtcDate:"2017-03-01T05:50:00.000Z",checkInCloseUtcDate:"2017-03-31T03:50:00.000Z",changeInfo:{isChangeable:!1,freeMove:!1,isChanged:!1},isCancelled:!1,mobilebp:!0}],passengers:[{type:"ADT",num:0,name:{title:"",first:"",middle:"",last:"",suffix:""},nationality:"",segPrm:[[]],segCheckin:["nocheckin"],segSsrs:[[]],segFees:[[]],paxFees:[],segSeats:[null]}],extras:[],addons:[],fees:[{sold:!0,type:"PaymentFee",code:"CCC",qty:1,vat:0,amt:0,total:0}],serverTimeUTC:"2017-02-16T17:41:32.489Z",status:"",errors:[],warnings:[],contacts:[{type:"P",email:"",homePhone:"",workPhone:"",otherPhone:"",fax:"",addresss:["","",""],city:"",provinceState:"",postalCode:"",country:"",name:{title:"",first:"",middle:"",last:"",suffix:""},cultureCode:""}],payments:[{type:"",code:"",accNum:"",accName:"",amt:0,currency:"",status:"",dccRate:0,dccAmt:0,dccCurrency:"",dccApplicable:!1,isReward:!1}]},n={info:{pnr:"",status:"",curr:"",currPrecision:0,isHoldable:!0,bookingId:0,modifiedUtcDate:"9999-12-31T00:00:00.000Z",balanceDue:0},journeys:[{flt:"",aircraft:"",vatRate:0,flown:!1,orig:"",dest:"",depart:"2017-03-31T06:50:00.000",departUTC:"2017-03-31T05:50:00.000Z",arrive:"2017-03-31T09:30:00.000",arriveUTC:"2017-03-31T07:30:00.000Z",seatsLeft:0,fares:[{disc:0,fat:0,sold:!1,total:0,code:"ADT",qty:1,vat:0,amt:0}],infSsrs:[],fats:[],isBusiness:!1,isLeisure:!1,fareType:"R",fareClass:"C",checkInOpenUtcDate:"2017-03-01T05:50:00.000Z",checkInCloseUtcDate:"2017-03-31T03:50:00.000Z",changeInfo:{isChangeable:!1,freeMove:!1,isChanged:!1},isCancelled:!1,mobilebp:!0}],passengers:[{type:"ADT",num:0,name:{title:"",first:"",middle:"",last:"",suffix:""},nationality:"",segPrm:[[]],segSsrs:[[]],segFees:[[]],paxFees:[],segSeats:[null]}],extras:[],addons:[],fees:[],serverTimeUTC:"2017-02-20T13:37:40.825Z",status:"",errors:[],warnings:[]};this.model=/active/.test((s.current||{}).name)?o:n,this.get=function(e){return(/active/.test((s.current||{}).name)?o:n)[e]},this.set=e.noop,this.subscribe=e.noop,this.unsubscribe=e.noop,this.updateModel=e.noop,this.getVoucherApplicableAmount=e.noop,this.postFlight=function(){return t.defer().promise},this.create=function(){return t.defer().promise},this.retrieveBookings=function(){return t.defer().promise},this.refreshBooking=function(){return t.defer().promise},this.revertBooking=function(){return t.defer().promise},this.retrieveBooking=function(){return t.defer().promise},this.retrieveUnbalancedBooking=function(){return t.defer().promise},this.removeExtra=e.noop,this.getExtra=e.noop,this.addExtra=e.noop,this.getContact=e.noop,this.removeContact=e.noop,this.addContact=e.noop,this.removePayment=e.noop,this.getPayment=e.noop,this.addPayment=e.noop,this.removeAddon=e.noop,this.getAddon=e.noop,this.addAddon=e.noop,this.removeItem=e.noop,this.getItem=e.noop,this.addItem=e.noop,this.getEmptyObject=e.noop,this.equalByDefinedKeys=e.noop,this.removeObjectFromModel=e.noop,this.getObjectFromModel=e.noop,this.addObjectToModel=e.noop,this.updateModel=e.noop,this.reset=e.noop,this.link=e.noop,this.unlink=e.noop,this.totals={sold:{},unsold:{}},this.total=1}])}(angular);


"use strict";!function(e){var t=function(e){function t(o,n,a){"ngInject";babelHelpers.classCallCheck(this,t);var r=babelHelpers.possibleConstructorReturn(this,e.call(this,n));return r.name="changeFlightDataStorage",r.$ngRedux=o,r.BookingRead=a,r}return t.$inject=["$ngRedux","localStorageService","BookingRead"],babelHelpers.inherits(t,e),t.prototype.update=function(){var e=this,t=this.$ngRedux.getState().bookingModel,o=this.BookingRead.getBookingInfo(t).pnr,n=this.BookingRead.getModel("journeys",t).map(function(o){return babelHelpers["extends"]({},o,{fares:e.BookingRead.getFaresFor(o.journeyNum,t),infSsrs:e.BookingRead.getInfSsrsFor(o.journeyNum,t),zoneDiscount:e.BookingRead.getZoneDiscountFor(o.journeyNum,t),fats:e.BookingRead.getFatsFor(o.journeyNum,t),segments:e.BookingRead.getSegmentsFor(o.journeyNum,t).map(function(e){return e.model}),isCancelled:e.BookingRead.getCancelledFlights(t)[o.journeyNum]})});this.dataStorage={pnr:o,journeys:n}},babelHelpers.createClass(t,[{key:"originalFlightInfo",get:function(){var e=this.$ngRedux.getState().bookingModel;return this.dataStorage&&this.dataStorage.pnr===this.BookingRead.getBookingInfo(e).pnr||this.update(),this.dataStorage}}]),t}(DataStorage);e.module("app.booking").service("ChangeFlightDataStorage",t)}(angular);


"use strict";angular.module("app.booking").service("ChangeFlightPriceInfoService",["$http","AEMConfig",function(e,r){this.getAll=function(){return e.get(r.getChangeflightConfigUrl()).then(function(e){var r=e.data,n=r.seasons,t=r.prices,a=R.pipe(R.toPairs,R.reduce(function(e,r){var n=babelHelpers.slicedToArray(r,1),t=n[0],a=r[1].map(function(e){return babelHelpers["extends"]({},e,{type:t})});return[].concat(babelHelpers.toConsumableArray(e),babelHelpers.toConsumableArray(a))},[]),R.sortWith([R.ascend(R.prop("from"))]))(n);return{seasons:a,prices:t}})["catch"](function(e){return e})}}]);


"use strict";!function(i){var t=function s(){babelHelpers.classCallCheck(this,s),this.rules=[{condition:function(i){i.when(this.isFlightChanged)},consequence:function(i){this.status="pending",this.reason="",i.stop()}},{condition:function(i){i.when(!(this.isFlightOutFreeMove||this.isFlightInFreeMove)&&!(this.isFlightFlown[0]||this.isFlightFlown[1])&&this.isReturnTrip&&this.isFlightDue[0]&&!this.isFlightDue[1])},consequence:function(i){this.status="info",this.reason="no_time_outbound_leg",i.stop()}},{condition:function(i){i.when(!(this.isFlightOutFreeMove||this.isFlightInFreeMove)&&!this.isFlightFlown[0]&&!this.isReturnTrip&&this.isFlightDue[0])},consequence:function(i){this.status="inactive",this.reason="no_time",i.stop()}},{condition:function(i){i.when(!(this.isFlightOutFreeMove||this.isFlightInFreeMove)&&!this.isFlightFlown[1]&&this.isReturnTrip&&this.isFlightDue[1])},consequence:function(i){this.status="inactive",this.reason="no_time",i.stop()}},{condition:function(i){i.when(this.isLegacyPlus)},consequence:function(i){this.status="disabled",this.reason="flights_legacy_plus",i.stop()}},{condition:function(i){i.when(this.isConnectingFlight)},consequence:function(i){this.status="disabled",this.reason="connecting_flight",i.stop()}},{condition:function(i){i.when(!(this.isFlightOutFreeMove||this.isFlightInFreeMove)&&this.isFlightOutDeparted&&(!this.isReturnTrip||this.isFlightFlown[1]&&this.isFlightInDeparted))},consequence:function(i){this.status="disabled",this.reason="flights_departed",i.stop()}},{condition:function(i){i.when(this.isReturnTrip&&this.somePaxFlown[1])},consequence:function(i){this.status="disabled",this.reason="flights_departed",i.stop()}},{condition:function(i){i.when(this.isBasketNotEmpty)},consequence:function(i){this.status="disabled",this.reason="basket_not_empty",i.stop()}},{condition:function(i){i.when(this.hasSpanishDiscount)},consequence:function(i){this.status="disabled",this.reason="spanish_resident",i.stop()}},{condition:function(i){i.when(this.isReturnTrip&&this.isFlightOutFreeMove&&!this.isFlightInFreeMove&&this.isPaxBoardedOnFlightIn)},consequence:function(i){this.status="disabled",this.reason="flights_departed",i.stop()}},{condition:function(i){i.when(!(this.isFlightOutFreeMove||this.isFlightInFreeMove)&&(this.isCheckIn||this.isCheckedInOneLeg))},consequence:function(i){this.status="info",this.reason="checkin",i.stop()}},{condition:function(i){i.when(this.hasErasmusDiscount)},consequence:function(i){this.status="disabled",this.reason="erasmus_student",i.stop()}},{condition:function(i){i.when(this.isLMImported)},consequence:function(i){this.status="disabled",this.reason="connecting_flight",i.stop()}},{condition:function(i){i.when(this.isBuyOneGetOneDiscounted)},consequence:function(i){this.status="disabled",this.reason="bogof_flight",i.stop()}},{condition:function(i){i.when(this.isAircraftModelChangeRestricted)},consequence:function(i){this.status="disabled",this.reason="model_change_restricted",i.stop()}},{condition:function(i){i.when(!0)},consequence:function(i){this.status="active",this.reason="",i.stop()}}]};t.$inject=[],i.module("app.booking").service("ChangeFlightRules",t)}(angular);


"use strict";angular.module("common").factory("ChangeFlightUtil",["ModelQuery","$http","$ngRedux","RezApiConfig","CHANGE_FLIGHT_THRESHOLD","CHANGE_FLIGHT_PAST_THRESHOLD","Dates","BookingRead",function(e,t,n,r,a,i,s,o){return{minDate:function(e){return s.startOfDay(R.pathOr({},[0,"depart"],e))},maxDate:function(e){return s.startOfDay(R.pathOr({},[1,"depart"],e))},checkMinimumThreshold:function(e,t){var n=s.diffInMinutes(s.utc(R.pathOr({},["model","departUTC"],e)),s.utc(t));return a>n},isFlightDue:function u(e,t,n,r){var a=(e||[])[t],u=!1;return a&&(this.checkMinimumThreshold(a,r)||a.model.flown)&&(u=n[t]?!1:!0),u},isFlightDisabled:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments[1],n=(arguments[2],arguments[3]),r=arguments[4],a=arguments[5],o=R.path(["model","departUTC"],t[e]),u=s.duration(s.utc(n),s.utc(o)).asHours(),l=R.path(["journey","model","isCancelled"],a[e]);if(-i>u||0>u&&!l)return!0;var d=this.checkMinimumThreshold(t[e],n);return!r[e]&&d},checkInCount:function(e,t){var n=this;return t.reduce(function(t,r,a){return n.checkMinimumThreshold(e[a])||(r?t.withCheckIn+=1:t.withoutCheckIn+=1),t},{withCheckIn:0,withoutCheckIn:0})},confirmNoPayment:function(){return t.post(r.commit)},getPropertyForRequest:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=void 0,r=babelHelpers.slicedToArray(t,2),a=r[0],i=r[1];switch(e){case 1:a&&(n="Outbound");break;default:n=a&&i?"RoundTrip":a&&!i?"Outbound":"Inbound"}return n},getChangedFlightType:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=t.map(function(t){return e.byKey(t.key)(n).every(function(e){return!e.sold})});return r.every(function(e){return e})?r.length>1?"RoundTrip":"Outbound":r[0]?"Outbound":"Inbound"},getPriceBreakdownItemModel:function(e,t){switch(e){case"new-price":return{id:e,display:"trips.changeflight.drawer.confirm.panel.right.new",translate:!0,breakdown:t.str,total:t.total,highlighted:!0};case"original-price":return{id:e,display:"trips.changeflight.drawer.confirm.panel.right.original",translate:!0,breakdown:t.str,total:t.total,highlighted:!0};case"change-fee":return{id:e,display:"trips.changeflight.drawer.confirm.panel.right.changefee",translate:!0,breakdown:t.str,total:t.total};case"spoilage-fee":return{id:e,display:"trips.changeflight.drawer.confirm.panel.right.spoilagefee",translate:!0,total:t.total,withBorder:!0};case"difference":return{id:e,display:"trips.changeflight.drawer.confirm.panel.right.difference",translate:!0,total:t.total,withBorder:!0};default:return{id:e,display:"trips.changeflight.drawer.confirm.panel.right."+e+".changeFee",translate:!0,qty:t.qty,total:t.fee,highlighted:0===t.fee}}},calculateFeeDifference:function(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:!0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:!1,s=R.path(["ssrs","length"],r),o={qty:0,fee:0};return"FLTCHG"===t?(o.qty+=R.pipe(e.byIdentity("segFees"),e.sumUpQty)(r),o.fee+=R.pipe(e.byIdentity("segFees"),e.byKeyValue(["model","sold"],!1),e.sumUpTotal)(r),o):("SEATS"===t&&n.map(function(t){var n=t.key.journey;return o.qty+=R.pipe(e.byIdentity("seats"),e.byKey({journeys:n}),e.sumUpQty)(r),o.fee+=R.pipe(e.byIdentity("seats"),e.byKey({journeys:n}),e.byKeyValue(["model","sold"],!1),e.sumUpTotal)(r),o}),"SEATS"!==t&&s>0&&n.map(function(n){var s=n.key.journey;return o.qty+=R.pipe(e.byIdentity("ssrs"),e.byKey({journeys:s}),e.byModel(a?{code:t}:{type:t}),e.sumUpQty)(r),o.fee+=R.pipe(e.byIdentity("ssrs"),e.byKey({journeys:s}),e.byModel(a?{code:t,sold:i}:{type:t,sold:i}),e.sumUpTotal)(r),o}),o)},isPRMOnChangedFlights:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments[1],r=["BDGR","BLND","DPNA","PETC","WCHC","WCHS","WCAP","WCHR"],a=R.pipe(e.byIdentity("segPrm"),e.byKeyValueAny(["model","code"],r))(t);return R.pipe(e.byHasAny(a))([n]).length>0},isFlightChanged:function(e){return e.some(function(e){return R.pathOr(!1,["model","changeInfo","isChanged"],e)})},seatsNotChanged:function(e,t){var n=o.getSeatItems(!0,!1)(e),r=[].concat(babelHelpers.toConsumableArray(o.getSeatItems(!1,!1)(t)),babelHelpers.toConsumableArray(o.getSeatItems(!0,!1)(t))),a=R.eqBy(function(e){return R.path(["model","code"],e)+R.path(["key","journeys"],e)});return R.isEmpty(R.symmetricDifferenceWith(a,n,r))},hideFarePrice:function(t,n){var r=o.getFreeMoveFlights(n),a=o.getCancelledFlights(t),i=o.getChangedFlights(n),s=R.pipe(e.byIdentity("fees"),e.byModel({code:"SPOIL"}),R.length)(n),u=a.reduce(function(e,t,n){return t&&r[n]&&i[n]?babelHelpers["extends"]({},e,{cancelledIsFree:!0}):t||r[n]||!i[n]?e:babelHelpers["extends"]({},e,{notCancelledNotFree:!0})},{cancelledIsFree:!1,notCancelledNotFree:!1});return R.all(R.identity,R.values(u))||!!s},seatsAutoAllocated:function(t,n){var r=void 0,a=o.getModel("passengers")(n);return t.some(function(e){return e})?t.some(function(e){return!e})?r:a.some(function(t){return r=R.pipe(e.byIdentity("seats"),e.byKey({passengers:t.num}),e.byModel({type:"SEAT"}),e.hasAny)(n)}):!1}}}]);


"use strict";!function(t){var e=function(t){function e(n,r,o,i,s,u){"ngInject";babelHelpers.classCallCheck(this,e);var g=babelHelpers.possibleConstructorReturn(this,t.call(this));return Object.assign(g,{Booking:n,BookingUtil:r,$http:o,RezApiConfig:i,CHANGE_FLIGHT_THRESHOLD:s,Dates:u}),g.reset(),g}return e.$inject=["Booking","BookingUtil","$http","RezApiConfig","CHANGE_FLIGHT_THRESHOLD","Dates"],babelHelpers.inherits(e,t),e.prototype.checkMinimumThreshold=function(t){var e=this.Dates.diffInMinutes(this.Dates.utc((t||{}).departUTC),this.Dates.utc(this.Booking.get("serverTimeUTC")));return e<this.CHANGE_FLIGHT_THRESHOLD},e.prototype.isFlightDue=function n(t,e){var r=(t||[])[e],n=!1;return r&&(this.checkMinimumThreshold(r)||r.flown)&&(n=this.BookingUtil.departedFlights[e]?!1:!0),n},e.prototype.isFlightDisabled=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.Booking.get("journeys")||[],n=this.checkMinimumThreshold(e[t])||this.BookingUtil.departedFlights[t],r=this.Booking.get("passengers").some(function(e){return"reprint"===e.segCheckin[t]});return!this.BookingUtil.freeMoveFlights[t]&&(n||r)},e.prototype.removeChanges=function(){return this.$http.get(this.RezApiConfig.revertBooking)},e.prototype.confirmNoPayment=function(){return this.$http.post(this.RezApiConfig.commit)},e.prototype.getPropertyForRequest=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=void 0,r=babelHelpers.slicedToArray(e,2),o=r[0],i=r[1];switch(t){case 1:o&&(n="Outbound");break;default:n=o&&i?"RoundTrip":o&&!i?"Outbound":"Inbound"}return n},e.prototype.getChangedFlightType=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=t.map(function(t){return(t.fares||[]).every(function(t){return!t.sold})});return e.every(function(t){return t})?e.length>1?"RoundTrip":"Outbound":e[0]?"Outbound":"Inbound"},e.prototype.calculateFeeDifference=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!0,r=arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:!1,i=r||this.Booking.get("passengers"),s={qty:0,fee:0};return"SEATS"===t?i.reduce(function(t,n){return n.segSeats&&n.segSeats.forEach(function(n,r){null!==n&&(0===r&&"Inbound"===e||1===r&&"Outbound"===e||(t.qty+=n.qty,n.sold||(t.fee+=n.total)))}),t},s):i.reduce(function(r,i){return i.segSsrs&&i.segSsrs.forEach(function(i,s){0===s&&"Inbound"===e||1===s&&"Outbound"===e||i.forEach(function(e){(e.type===t&&n||e.code===t&&!n)&&(r.qty+=e.qty,!e.sold|o&&(r.fee+=e.total))})}),r},s)},e.prototype.isPRMOnChangedFlights=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments[1];return t.some(function(t){return"Inbound"!==e&&t.segPrm[0].length||"Outbound"!==e&&t.segPrm[1].length})},e.prototype.reset=function(){t.prototype.reset.call(this),this.messages=[],this.warnings=[],this.originalFlightModel={},this.showAutoCorrectDateWarning=!1,this.set("hideFooter",!1),this.set("selectedPaxMap",{}),this.set("paymentNotRequired",!1),this.set("isFreeMove",!1)},e.prototype.seatsAutoAllocated=function(t){return t.some(function(t){return t})?t.some(function(t){return!t})?this.Booking.get("passengers").some(function(e){return e.segSeats&&!!e.segSeats[t.indexOf(!0)]}):this.Booking.get("passengers").some(function(t){return t.segSeats&&t.segSeats.some(function(t){return t})}):!1},babelHelpers.createClass(e,[{key:"totalNewFares",get:function(){return(this.Booking.get("journeys")||[]).map(function(t){return t.fares.reduce(function(t,e){return t+(e.sold?0:e.total)},0)}).reduce(function(t,e){return t+e},0)}},{key:"minDate",get:function(){return this.Dates.startOfDay(((this.Booking.get("journeys")||[])[0]||{}).depart)}},{key:"maxDate",get:function(){return this.Dates.startOfDay(((this.Booking.get("journeys")||[])[1]||{}).depart)}},{key:"checkInCount",get:function(){var t=this,e=this.Booking.get("journeys")||[];return this.BookingUtil.getLegsCheckInStatus.reduce(function(n,r,o){return t.checkMinimumThreshold(e[o])||(r?n.withCheckIn++:n.withoutCheckIn++),n},{withCheckIn:0,withoutCheckIn:0})}},{key:"isFlightChanged",get:function(){return(this.Booking.get("journeys")||[]).some(function(t){return((t||{}).changeInfo||{}).isChanged})}},{key:"isReturnFlight",get:function(){return this.BookingUtil.isReturnTrip}}]),e}(ObservableService);t.module("app.booking").service("ChangeFlight",e)}(angular);


"use strict";angular.module("app.booking").factory("CHECKIN",["FEATURE_CONFIG","InsuranceUtil",function(e,n){var a={SELECT_PAX:"select",DOCUMENTS:"documents",ALLOCATION:"allocation",SEATS:"seats",PRIORITY:"priority",EXTRAS:"extras",PAYMENT:"payment",CHECKIN:"checkin",BOARDING:"boarding-pass",INSURANCE:"insurance"},t=[{key:"select-pax",values:[a.SELECT_PAX]},{key:"documents",values:[a.DOCUMENTS]},{key:"insurance",values:[a.INSURANCE]},{key:"checkin-extras",values:[a.ALLOCATION,a.SEATS,a.PRIORITY,a.EXTRAS,a.PAYMENT]},{key:"boarding",values:[a.CHECKIN,a.BOARDING]}],i=function(e,a,i,s){return R.pipe(R.when(function(){var t=n.isInsuranceActiveChoiceEnabledOnCheckin(s),c=R.not(R.isNil(a))&&t?n.isInsuranceActiveChoiceAvailableOnCheckin(e,a,i):!1;return R.not(c)},R.remove(2,1)),R.when(function(){return R.path(["passengers","length"],e)<=1},R.tail))(t)};return{ROUTES:a,MILESTONES:t,getMilestones:i}}]);


"use strict";angular.module("app.booking").service("CheckinFlow",["CHECKIN","CheckinModelSelectors","BookingReadCheckinJourney","BookingRead","$q","$state","$stateParams","ModelQuery","SeatsService","PriorityBoardingUtil","FEATURE_CONFIG","InsuranceUtil","CARD_CODES","ParkingService",function(e,n,t,r,a,i,o,u,s,c,l,p,y,d){var g=this,k=function(e){return R.isEmpty(R.path(["checkin","checkinSteps"],e))};this.myJourneys=[];var h=function(e){g.myJourneys=e},f=function(e,n,t){var r=R.findIndex(function(t){return e.name.match(t.state+"$")&&R.whereEq(R.pathOr({},["params"],t),n)},t);return 0>r?0:r},S={state:e.ROUTES.ALLOCATION,params:{}},m={state:e.ROUTES.PRIORITY,params:{}},b={state:e.ROUTES.EXTRAS,params:{}},A=R.ifElse(R.flip(R.gt)(0),function(){return[{state:e.ROUTES.PAYMENT,params:{}}]},function(){return[]}),P={state:e.ROUTES.CHECKIN,params:{}},E={state:e.ROUTES.BOARDING,params:{}},v=function(t){var r=n.generateTravelDocumentsList(t);return r.map(function(n){return{state:e.ROUTES.DOCUMENTS,params:{passenger:n.key.id.toString(),infant:n.key.INF?n.key.id.toString():""}}})},C=function(n){var t=n.flightExtras.extras,r=n.bookingModel,a=n.launchDarkly,i=n.insurance,o=p.isInsuranceActiveChoiceEnabledOnCheckin(a),u=o&&R.not(R.isNil(t))?p.isInsuranceActiveChoiceAvailableOnCheckin(r,t,i):!1;return u?[{state:e.ROUTES.INSURANCE,params:{}}]:[]},O=function(a){var i=a.bookingModel,o=n.getSelectedJourneysForSeats(a),u=n.getSelectedPassengers(a),s=function(e){return function(n){return t.allSeatedForSegmentPerJourney(u,i,e,n,!0)}},c=function(e){return r.getSegmentsForJourney(e)(i)},l=function(n){return function(t){return{state:e.ROUTES.SEATS,params:{journey:n.key.id,segment:t.key.id,isUpgrade:!1}}}},p=R.chain(function(e){return R.pipe(c,R.reject(s(e)),R.filter(n.isSegmentForSeats(a)),R.map(l(e)))(e)}),y=p(o);return y},T=function(n){var t=R.pathOr([],["bookingModel","passengers"],n).length,r=t>1?[{state:e.ROUTES.SELECT_PAX}]:[];return[].concat(r)},I=function(e){return{route:"booking.active.checkin."+e.state,state:e.state,params:e.params}},M=function(e){var n=e.checkin.checkinSteps;return I(n[f(i.current,o,n)+1])},B=function(e){var n=e.checkin.checkinSteps;return I(n[f(i.current,o,n)-1])},N=function(e){var n=e.checkin.checkinSteps;return I(n[f(i.current,o,n)])},_=function(e,n,t){var r=R.path(["checkin","travelDocumentsList"],t);return R.findIndex(function(t){return""===n&&t.key.id===parseInt(e,10)||t.key.INF&&t.key.id===parseInt(e,10)})(r)},F=R.pipe(R.path(["bookingModel","passengers"]),R.length,R.equals(1)),U=function(n){var a=t.allSeated(n.bookingModel.passengers,n.bookingModel,n.bookingModel.journeys),i=!!(n.bookingModel.journeys.length-g.myJourneys.length),o=(i?g.myJourneys:n.bookingModel.journeys).filter(function(e){return!l["open-seatmap-in-check-in"]&&R.path(["checkin","isRegularCheckinSeatsStepPassed"],n)?!t.allSeated(n.bookingModel.passengers,n.bookingModel,e):!0}),u=function(n){return function(t){return{state:e.ROUTES.SEATS,params:{journey:n.key.id,segment:t.key.id,isUpgrade:!0}}}},s=R.chain(function(e){return R.map(u(e),r.getSegmentsForJourney(e)(n.bookingModel))})(o);return s.length&&r.isPlusUpgradeAdded(n.bookingModel)&&!a?[].concat(babelHelpers.toConsumableArray(s),[b]):[]},j=function(e){var t=e.bookingModel,a=R.pipe(R.reduce(function(e,n){return[].concat(babelHelpers.toConsumableArray(e),[R.path(["key","journey"],n)])},[]),R.uniq)(n.getSelectedJourneysToCheckin(e)),i=R.pipe(R.pathOr([],["passengers"]),R.length)(t);return a.reduce(function(e,n){var a=R.pipe(r.getPriorityBoardingItems(!0),u.byKey({journeys:n}),R.length)(t);return a===i&&(e[n]=!0),e},[!1,!1])},L=function(e){var t=e.checkin,a=e.bookingModel,i=R.pipe(R.reduce(function(e,n){return[].concat(babelHelpers.toConsumableArray(e),[R.path(["key","journey"],n)])},[]),R.uniq)(n.getSelectedJourneysToCheckin(e)),o=R.pipe(u.byKeyValueAny(["key","journeys"],i),R.length)(R.concat(r.getOutboundSegments(a),r.getInboundSegments(a))),s=R.pathOr([],["selectedPassengersIds"],t),c=R.pipe(r.getPriorityBoardingItems(!0),u.byKeyValueAny(["key","journeys"],i))(a);return R.pipe(u.byKeyValueAny(["key","passengers"],s),R.length,R.equals(R.multiply(o,R.length(s))))(c)},H=function(e){return e.priorityAvailability.reduce(function(e,n){return[].concat(babelHelpers.toConsumableArray(e),[!n.isAvailable])},[])},J=function(e){if(!l["priority-boarding-page-checkin-enabled"])return!1;var n=H(e.checkin),t=j(e),r=n.reduce(function(n,r,a){var i=R.pathOr(!1,["allocationForm",a,"checkinLater"],e.checkin);return[].concat(babelHelpers.toConsumableArray(n),[!r&&!i&&!t[a]])},[]);return r.some(function(e){return e})},D=function(e){var n=e.checkin,t=n.allocationForm,r=void 0===t?[]:t,a=n.allocationState,i=void 0===a?[]:a,o=e.bookingModel.journeys,u=c.getPriorityBoardingJourneys(r,i,o);return!L(e)&&!c.isPriorityMaxedOutNewPolicy(u,e)&&(J(e)||c.isPriorityAndCabinBagsCampaignLaunched(u))&&!e.checkin.priorityPopupAcceptedJourneyNums},x=function(e,n){var t=[].concat(babelHelpers.toConsumableArray(T(e)),babelHelpers.toConsumableArray(v(e)),babelHelpers.toConsumableArray(C(e)),[S],babelHelpers.toConsumableArray(O(e)));return D(e)&&(t=[].concat(babelHelpers.toConsumableArray(t),[m])),[].concat(babelHelpers.toConsumableArray(t),[b],babelHelpers.toConsumableArray(U(e)),babelHelpers.toConsumableArray(A(n)),[P,E])},G=function(e){var n=f(i.current,o,e.checkin.checkinSteps);return R.path(["checkin","checkinSteps",n,"state"],e)},q=function(e){var n=f(i.current,o,e.checkin.checkinSteps);return R.path(["checkin","checkinSteps",n-1,"state"],e)},K=function(e,n){var t=G(e),r=n.find(function(e){return e.values.indexOf(t)>-1});return R.pathOr(n[0].key,["key"],r)},w=function(e){var n=e.checkin.checkinSteps,t=f(i.current,o,n);return{previousStep:R.path([t-1,"state"],n),currentStep:R.path([t,"state"],n),nextStep:R.path([t+1,"state"],n)}},X=function(e,n,t){return t.map(function(t){return n.reduce(function(n,a){if(r.isPaxCheckinReady(a.key.id,t.key.id,e)){var i=r.getSegmentsFor(t.key.id,e);return[].concat(babelHelpers.toConsumableArray(n),babelHelpers.toConsumableArray(i.map(function(e){return{paxNum:a.model.num,journeyNum:t.key.id,segmentNum:e.key.id}})))}return n},[])}).reduce(function(e,n){return e.concat(n||[])},[])},V=function(e,n){if(R.contains(n,r.filterUnavailableJourneys(e))){var t=R.path(["key","id"],n),a=R.pipe(R.find(R.pipe(R.path(["key"]),R.propEq("journeys",t))),R.path(["key","passengers"]))(e.seats),i=R.pipe(R.head,R.path(["model","code"]))(r.getSeatsForPassengerByJourney(t,a,e));return i?R.path(["columnName"],s.getSeatsPosition(i)):""}return""},$=function(e,n){return e.journeys.reduce(function(t,a){if(1===n.length){var i=R.pipe(u.byIdentity("seats"),u.byModel({code:"11A"}),R.length)(e),o="reprint"===R.path(["0","journeys",a.key.id],n),s=R.path(["0","seats",a.key.id,"0"],n),c=R.path(["0","las",a.key.id],n);return o||s?o&&!s&&c?t[a.key.id]="BP_MESSAGE_LAS":o&&s&&0===s.total&&!s.isPartOfBundle&&!i?t[a.key.id]="BP_MESSAGE_SEAT_POSITION":t[a.key.id]="BP_MESSAGE_DEFAULT":t[a.key.id]=null,t}var l=R.filter(function(e){return"reprint"===e.journeys[a.key.id]},n);if(!l.length){var p=R.pipe(R.map(function(e){return e.seats[a.key.id]}),R.filter(R.identity))(n);return p.length?1===p.length?t[a.key.id]="BP_MESSAGE_SEAT_POSITION":t[a.key.id]="BP_MESSAGE_DEFAULT":t[a.key.id]=null,t}if(1===l.length){var y=R.path(["0","seats",a.key.id,"0"],l);return t[a.key.id]=y.total||y.isPartOfBundle?"BP_MESSAGE_DEFAULT":"BP_MESSAGE_SEAT_POSITION",t}var d=r.hasMandatorySeatsForJourney(a.key.id,e),g=R.pipe(R.map(function(e){return R.path(["seats",a.key.id,"0"],e)}),R.any(function(e){return!e.total&&!e.isPartOfBundle}))(l)&&!a.model.fareOption;return t[a.key.id]=g&&!d?"BP_MESSAGE_SITTING_APART":"BP_MESSAGE_DEFAULT",t},[])},Y=function(e,n){var t=n.filter(function(e){return"CHD"!==e.type});return e.journeys.reduce(function(a,i){if(1===n.length)return a[i.key.id]="SINGLE_PAX",a;var o=r.getSeatItems(!0)(e),u=o.filter(function(e){return R.path(["key","journeys"],e)===i.key.id}).reduce(function(n,a){return t.find(function(e){return e.num===R.path(["key","passengers"],a)})?((R.path(["model","total"],a)||R.path(["model","isPartOfBundle"],a)||R.length(r.getMandatorySeatForAdultPessengerByJourney(i.key.id,R.path(["key","passengers"],a),e)))&&(n+=1),n):n},0);return a[i.key.id]=u>=t.length?"MULTI_PAX_SITTING_TOGETHER":"MULTI_PAX_RANDOMLY_ALLOCATED",a},[])},W=R.ifElse(R.path(["checkin","allocationForm"]),R.pipe(R.path(["checkin","allocationForm"]),R.map(function(e){return R.keys(e).find(function(n){return e[n]})})),R.F),Q=function(e,n,t){return e.map(function(e){if("PRIOBRDNG"===e.code){var r=c.getMinPrice(e.details,n,t);return babelHelpers["extends"]({},e,{minPrice:r})}return e})},z=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!1,r=c.getPriorityBoardingJourneys(n.allocationForm,n.allocationState,e.journeys,t),a=c.getPaxWithPriorityByLeg(e,e.passengers,e.journeys,n.selectedPassengersIds);return{selectedJourneys:r,paxWithPriorityByLegs:a,selectedPassengers:u.byKeyValueAny(["key","id"],n.selectedPassengersIds)(e.passengers),selectedJourneyNums:R.map(R.path(["key","journey"]),r),maxedOutLegs:a.reduce(function(e,t){return[].concat(babelHelpers.toConsumableArray(e),[t.length===n.selectedPassengersIds.length])},[]),soldout:H(n),minPrice:R.pathOr(0,["0","minPrice"],n.priorityAvailability),isPriorityAvailableForSelectedLegs:J({bookingModel:e,checkin:n}),discount:R.pathOr({},["priorityAvailability",0,"discount"],n)}},Z=function(e,n){var t=n.bookingModel,r=n.launchDarkly,a=p.isInsuranceActiveChoiceEnabledOnCheckin(r);return R.pipe(R.when(function(){return a&&R.prop("length",e)},R.reject(R.propEq("code",y.INSURANCE))),R.when(function(){return d.hasSoldParking(t)},R.reject(R.propEq("code",y.PARKING))))(e)},ee={areStepsDefined:k,completeCurrentTask:function(){return a.resolve()},completeBackTask:function(){return a.resolve()},getCurrentDocIndex:_,getCurrentMilestone:K,getNextRoute:M,getPreviousRoute:B,getRouteObj:I,matchRouteIndex:f,skipSelect:F,setCurrentTask:function(e){ee.completeCurrentTask=e},setBackTask:function(e){ee.completeBackTask=e},currentStep:G,previousStep:q,updateCheckinSteps:x,getPreviousCurrentNext:w,getCheckinPayload:X,getChangeSeatsMessageState:$,getSeatFeatureKeyForSinglePax:V,getSelectedOptionForCarusel:W,setJourneys:h,generateMinPrice:Q,getCurrentRoute:N,getPriorityBoardingSoldoutPerLeg:H,getBoardingPassChangeSeatsIconStatePerLeg:Y,getAvailablePriorityBoardingConfig:z,filterProducts:Z,newDesignAllocation:(l["check-in-seats-images-design"]||l["check-in-seats-icons-design"])&&!l["open-seatmap-in-check-in"],newCheckinFlow:l["open-seatmap-in-check-in"]};return ee}]);


"use strict";angular.module("app.booking").factory("ClearHttpCache",["$cacheFactory","$rootScope",function(t,e){function n(t,e){r.hasOwnProperty(e)?-1===r[e].indexOf(t)&&r[e].push(t):r[e]=[t]}function o(t,e){r[e]&&-1!==r[e].indexOf(t)&&r[e].splice(r[e].indexOf,1)}function a(e){t.get("$http").remove(e)}var r={};return e.$on("$stateChangeStart",function(t,e){(r[e.name]||[]).forEach(function(t){a(t)})}),{addUrlToState:n,removeUrlFromState:o,clearCache:a}}]);


"use strict";angular.module("app.booking").factory("countDown",["Booking","Dates",function(t,r){function e(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,u=r.utc(R.path(["journeys",e,"model","departUTC"],t)),n=r.utc(R.path(["serverTimeUTC","0","model"],t)),o={days:null,hours:null,minutes:null},a=u.startOf("day").diff(n.startOf("day"),"days"),s=u.diff(n,"hours"),i=u.diff(n,"minutes");return 0>i?!1:(o.days=a,o.hours=s-24*a,o.minutes=i-60*s,o)}function u(t,r){return t.days?{text:"trips.active.countdown.days_"+r,value:t.days}:t.hours?{text:"trips.active.countdown.hours_"+r,value:t.hours}:{text:"trips.active.countdown.minutes_"+r,value:t.minutes}}return{timeLeft:function(t){var r=t.journeys,n=e(t,0),o=void 0;return!n&&r[1]&&(o=e(t,1)),n?u(n,"to_trip"):o?u(o,"to_return"):{text:"trips.countdown.active.in_progress",value:null}},getInboundDepartTime:function(t){var e=R.path(["journeys","1","model","depart"],t);return e?r.parseISOFull(e).format("Do MMM YY, HH:mm"):""},getInboundArrivalTime:function(t){var e=R.path(["journeys","1","model","arrive"],t);return e?r.parseISOFull(e).format("HH:mm"):""},getOutboundDepartTime:function(t){var e=R.path(["journeys","0","model","depart"],t);return e?r.parseISOFull(e).format("Do MMM YY, HH:mm"):""},getOutboundArrivalTime:function(t){var e=R.path(["journeys","0","model","arrive"],t);return e?r.parseISOFull(e).format("HH:mm"):""}}}]);


"use strict";angular.module("app.booking").service("ExternalPaymentProcessing",["Session","$http","Booking","RezApiConfig","AirMaltaApiConfig","Utilities","$state","$stateParams","AuthorizationService","PAYMENT_TYPES",function(e,t,n,a,r,i,o,u,c,s){var p=a.idealProcess,l=a.paypalCheckout,g=r.ingenicoCheckout,d=function(){var a={customerid:e.getClientId()||"",voucherid:""};return t.get(p+"?"+i.serialize(a)).then(function(e){return n.updateModel(e.data),babelHelpers["extends"]({},e.data,{paymentType:s.IDEAL})})},h=function(){return t.get(l+"?"+i.serialize(u)).then(function(e){return babelHelpers["extends"]({},e.data,{paymentType:s.PAYPAL})})},f=function(){return t.get(a.paypalCreate+"?"+i.serialize(u)).then(function(e){return e.data})},y=function(){return t({method:"GET",url:g+"?"+i.serialize(u)+"&SUCCESS="+o.is("ingenico.callback"),headers:{"X-Session-Token":u.COMPLUS}}).then(function(e){return babelHelpers["extends"]({},e.data,{paymentType:s.INGENICO})})["catch"](angular.noop)};return{processIdeal:function(){return o.is("booking.payment")&&!e.getAuthenticated()?c.getUserData().then(function(){return d()}):d()},processPaypal:function(){return o.is("paypal.callback")&&!e.getAuthenticated()?c.getUserData().then(function(){return h()}):h()},processSavePaypalAccount:function(){return o.is("paypal.create")&&!e.getAuthenticated()?c.getUserData().then(function(){return f()}):f()},processIngenico:function(){return o.is("booking.payment")&&!e.getAuthenticated()?c.getUserData().then(function(){return y()}):y()}}}]);


"use strict";!function(e){var t=function(e){function t(n,r,i,o,a,s){"ngInject";babelHelpers.classCallCheck(this,t);var u=babelHelpers.possibleConstructorReturn(this,e.call(this));return Object.assign(u,{$http:n,$q:r,FlightSearch:o,$ngRedux:a,BookingRead:s}),u.apiUri=i.fees,u}return t.$inject=["$http","$q","RezApiConfig","FlightSearch","$ngRedux","BookingRead"],babelHelpers.inherits(t,e),t.prototype.init=function(){var e=this;return this.retrieve().then(function(t){return e.set("fees",t.data),t.data})},t.prototype.retrieve=function(){return this.BookingRead.getOperator(this.$ngRedux.getState().bookingModel)?this.$q.when({data:[]}):this.$http.get(this.apiUri,{cache:!1})},t.prototype.getPriorityFee=function(){var e=function(e){return e.find(function(e){return"PS"===e.code})};return this.retrieve().then(function(t){return e(t.data)})},t}(ObservableService);e.module("app.booking").service("Fees",t)}(angular);


"use strict";!function(t){var e=function(e){function r(t,a,i,n,s,o,c,h,u,d){babelHelpers.classCallCheck(this,r);var l=babelHelpers.possibleConstructorReturn(this,e.call(this));return Object.assign(l,{$ngRedux:t,$q:a,$http:i,$log:n,$cacheFactory:o,Session:c,ParkingService:h,BookingRead:u,FlightSearch:d}),l.MODEL_KEY="extras",l.apiUrl=s.extras,l.quickAddUrl=s.quickAdd,l.stateCheckers={},l.lastCacheId=void 0,l}return r.$inject=["$ngRedux","$q","$http","$log","RezApiConfig","$cacheFactory","Session","ParkingService","BookingRead","FlightSearch"],babelHelpers.inherits(r,e),r.prototype.update=function(t,e){var r=this.get(t);e.forEach(function(t){if(r){var e=r.findIndex(function(e){return e.code===t.code});e&&e>0&&(r[e]=t)}}),this.set(t,r)},r.prototype.getExtras=function(e){var r=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=i.isCheckInFlow,s=void 0===n?!1:n;a.showUpgrade=!0,a.session=this.Session.getSessionStorage("ryanair:token");var o=this.apiUrl+"?IsCheckInFlow="+s,c=this.FlightSearch.model.operatedBy?this.$q.when({data:[]}):this.$http.get(o,{params:t.extend({codes:e},a)});return c.then(function(t){return e?r.update(r.MODEL_KEY,t.data):r.set(r.MODEL_KEY,t.data),t.data})["catch"](function(){return r.$log.error("Unable to retrieve Extras"),[]})},r.prototype.getQuickAddAbility=function(){return this.FlightSearch.model.operatedBy?this.$q.when([]):this.$http.get(this.quickAddUrl)},r.prototype.addStateChecker=function(t,e){this.stateCheckers[t]=e},r.prototype.checkActiveState=function(t){var e={data:{}};return this.stateCheckers[t]?this.stateCheckers[t](t).then(function(t){return e.data=t,t.qty===t.max&&0===t.unpaid?e.state="MAX":t.unpaid>0?e.state="ADD":t.qty>0?e.state="ACT":e.state="DEF",e}):this.$q.when(e)},babelHelpers.createClass(r,[{key:"extraParameters",get:function(){var t={};return t[this.ParkingService.code]=this.ParkingService.minParkingDays(),t}}]),r}(ObservableService);t.module("app.booking").service("FlightExtras",e)}(angular);


"use strict";angular.module("app.booking").service("InfantDiscountService",function(){this.getInfantFeePrice=R.ifElse(R.pathEq(["totalDiscount"],0),R.pathOr(0,["total"]),R.pathOr(0,["totalWithoutDiscount"])),this.getInfantTranslationKey=R.ifElse(R.pathEq(["zoneDiscount","code"],"DSC1"),function(){return"spanishSubsidy"},function(){return"familySubsidy"}),this.isSpanishInfant=function(t){var n=t.code,i=t.qty,e=t.totalDiscount,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1,s=a.zone;return R.equals(s,"ES")&&R.equals("INF",n)&&e>0&&i>0}});


"use strict";angular.module("app.booking").service("InsurancePolicyLink",function(){var E={AT:"cult=DE-DE&p=DE-AT",BE:"cult=FR-FR&p=FR-BE",CZ:"cult=EN-US&p=CS-CZ",DE:"cult=DE-DE&p=DE-DE",DK:"cult=EN-US&p=DA-DK",ES:"cult=ES-ES&p=ES-ES",FI:"cult=EN-US&p=SE-FI",FR:"cult=FR-FR&p=FR-FR",GB:"cult=EN-US&p=EN-US",GR:"cult=EL-GR&p=EL-GR",HU:"cult=EN-US&p=HU-HU",IE:"cult=EN-US&p=EN-IE",IT:"cult=IT-IT&p=IT-IT",LT:"cult=EN-US&p=LT-LT",LV:"cult=EN-US&p=LV-LV",MT:"cult=EN-US&p=MT-MT",NL:"cult=NL-NL&p=NL-NL",NO:"cult=NB-NO&p=NB-NO",PL:"cult=EN-US&p=PL-PL",PT:"cult=PT-PT&p=PT-PT",RO:"cult=EN-US&p=EN-IE",SE:"cult=SV-SE&p=SV-SE",SK:"cult=EN-US&p=SK-SK"};this.getQueryParams=function(t){return"?"+(E[t.toUpperCase()]||"")}});


"use strict";!function(e){var t=function(){function e(t,n){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new PassengerName,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;babelHelpers.classCallCheck(this,e),Object.assign(this,{typeNumber:n,name:s,dob:a}),this._type=t}return e.prototype.toPayload=function(){var e=this.name.clone();return e.title=null,e.dob=this.dob,e},babelHelpers.createClass(e,[{key:"type",get:function(){return this._type}}]),e}(),n=function(){function e(t,n,s){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new PassengerName,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:void 0,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:void 0,l=arguments[9],m=arguments[10],g=arguments[11];babelHelpers.classCallCheck(this,e),Object.assign(this,{typeNumber:s,name:a,infant:i,residentInfo:r,bedTypes:o,selectedBed:u,roomType:d,isSoldHeldFareFlight:l,voucherLocked:m,dob:g}),this._number=t,this._type=n,this._bedTypes=o,this._selectedBed=u,this._roomType=d}return e.prototype.isNameEmpty=function(){return this.name.isEmpty()},babelHelpers.createClass(e,[{key:"number",get:function(){return this._number}},{key:"type",get:function(){return this._type}},{key:"bedTypes",get:function(){return this._bedTypes},set:function(e){this._bedTypes=e}},{key:"selectedBed",get:function(){return this._selectedBed},set:function(e){this._selectedBed=e}},{key:"roomType",get:function(){return this._roomType},set:function(e){this._roomType=e}},{key:"locked",get:function(){return"success"===this.status||"final"===this.status||this.voucherLocked||this.isSoldHeldFareFlight}}]),e}(),s=function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0;babelHelpers.classCallCheck(this,i),Object.assign(this,{docType:e,docNum:t,municipality:n,community:s,largeFamilyCert:a,dob:r})},a=function(){function e(t,n,s,a,i,r,o,u,d){"ngInject";babelHelpers.classCallCheck(this,e),this.PassengerTypes=t,this.Passengers=n,this.PassengerSpecialAssistance=s,this.$ngRedux=i,this.BookingRead=o,this.ModelQuery=r,this.Dates=u,this.PassengerAgeService=d,this.capitalizeFilter=a("capitalize")}return e.$inject=["PASSENGER_TYPES","Passengers","PassengerSpecialAssistance","$filter","$ngRedux","ModelQuery","BookingRead","Dates","PassengerAgeService"],e.prototype.getPassengersFromBookingModel=function(e){var a=this,i=[this.PassengerTypes.Adult,this.PassengerTypes.Teen,this.PassengerTypes.Child],r={},o=this.BookingRead.isSoldHeldFareFlight(e),u=R.path(["payment","voucherLocked"],this.$ngRedux.getState()),d=function(e){var i=new PassengerName(e.name?e.name.first:"",e.name?e.name.last:"",e.name?e.name.middle:"",e.name?e.name.suffix:"",e.name?e.name.title:""),d=void 0;if(e.inf){r[a.PassengerTypes.Infant]=(r[a.PassengerTypes.Infant]||0)+1;var l=r[a.PassengerTypes.Infant];d=new t(a.PassengerTypes.Infant,l,new PassengerName(e.inf.first,e.inf.last,e.inf.middle,e.inf.suffix,""),e.inf.dob)}var m=void 0;e.residentInfo&&(m=new s(e.residentInfo.docType,e.residentInfo.docNum&&"U"!==e.residentInfo.docType?e.residentInfo.docNum:void 0,e.residentInfo.municipality,e.residentInfo.community,e.residentInfo.largeFamilyCert,e.residentInfo.dob&&"U"===e.residentInfo.docType?e.residentInfo.dob:void 0)),r[e.type]=(r[e.type]||0)+1;var g=r[e.type],c=new n(e.num,e.type,g,i,d,m,[],void 0,void 0,o,u,e.dob);return c},l=function(e){var t=a.$ngRedux.getState().bookingModel,n=R.pipe(a.ModelQuery.byIdentity("ssrs"),a.ModelQuery.byKey({passengers:e.number}),a.ModelQuery.byModel({type:"SARA"}),R.pathOr([],["0","model","code"]))(t);return"BAFV"===n&&(e.status="failed"),"BAPV"===n&&(e.status="success"),e},m=function(t){var n=R.pipe(a.ModelQuery.byIdentity("segPrm"),a.ModelQuery.byKey({passengers:t.length}))(a.BookingRead.getModel("passengers")(e));if(n.length){var s=R.filter(R.pathEq(["key","journeys"],0),n),i=R.path(["model"],s[0]),r=R.isNil(s[1])?!1:R.path(["model"],s[1]),o=R.filter(R.pathEq(["key","journeys"],1),n),u=R.path(["model"],o[0]),d=R.isNil(o[1])?!1:R.path(["model"],o[1]),l={isRequired:!0,outbound:{assistanceTypeCode:i,wheelchairAssistance:{isRequired:!R.isNil(s[1]),wheelchairTypeCode:r}}};o.length&&(l.inbound={assistanceTypeCode:u,wheelchairAssistance:{isRequired:!R.isNil(d[1]),wheelchairTypeCode:d}}),t.specialAssistance=new a.PassengerSpecialAssistance(l.isRequired,l.outbound,l.inbound)}else t.specialAssistance=new a.PassengerSpecialAssistance;return t},g=function(e){var t=R.pathOr({},["erasmus","membership"],a.$ngRedux.getState());return e.name.first=t.firstName,e.name.last=t.lastName,e},c=this.BookingRead.isErasmus(e),p=R.into([],R.compose(R.map(d),R.map(l),R.map(m),R.when(function(){return c},R.map(g))),this.BookingRead.getModel("passengers")(e)),y=[].concat(babelHelpers.toConsumableArray(p)).sort(function(e,t){return i.indexOf(e.type)-i.indexOf(t.type)||e.typeNumber-t.typeNumber});return y},e.prototype.getPaymentFormPayload=function(e){var t=this,n=this.$ngRedux.getState(),s=n.bookingModel;return e.map(function(e){var n={type:e.type,num:e.number,name:babelHelpers["extends"]({},e.name,{title:e.type===t.PassengerTypes.Child?t.PassengerTypes.Child:e.name.title}),inf:e.infant?e.infant.toPayload():void 0,residentInfo:e.residentInfo};return t.Dates.isValidISO(e.dob)&&e.type!==t.PassengerTypes.Adult&&(n=babelHelpers["extends"]({},n,{dob:e.dob})),t.BookingRead.getOperator(s)&&(n.travelDocuments={travelDocument:e.travelDocuments.travelDocument},e.infant&&(n.travelDocuments.infantTravelDocument=e.travelDocuments.infantTravelDocument,n.inf.dob=e.travelDocuments.infantTravelDocument.dob)),n})},e.prototype.getSaraValidationPayload=function(e){var t=this,n=function(e){return{Type:e.type,Num:e.number,Name:babelHelpers["extends"]({},e.name,{title:e.type===t.PassengerTypes.Child?t.PassengerTypes.Child:e.name.title}),ResidentInfo:e.residentInfo}},s=function(e){return{First:e.name.first,Middle:e.name.middle,Last:e.name.last,Dob:e.dob}},a=e.reduce(function(e,t){var a=n(t);return t.infant&&(a.Inf=s(t.infant)),[].concat(babelHelpers.toConsumableArray(e),[a])},[]);return{passengers:a}},e.prototype.isPassengersListValid=function(e,t){var n=this;return e&&e.length&&e.every(function(e){return e.name.isValid()&&(e.name.title||e.type===n.PassengerTypes.Child)&&(!e.infant||e.infant.name.isValid()&&n.PassengerAgeService.isValidPaxDob(t,"INF",e.infant.dob,"inbound"))})},e.prototype.getPassengersFromRoomsModel=function(e){var t=this,s=((e||{}).roomSelection||{}).items||[],a=0;return s.reduce(function(e,s){for(var i=0;i<s.qty;i+=1)e.push(new n(i,t.PassengerTypes.Adult,a+1,void 0,void 0,void 0,s.item.bedTypes,s.item.selectedBed,t.capitalizeFilter(s.item.name.toLowerCase())));return e},[])},e}();e.module("app.booking").service("PassengerFactory",a)}(angular);


"use strict";!function(){var t=function(t){function e(i,o,n,r,s,a,c,u,p){"ngInject";babelHelpers.classCallCheck(this,e);var l=babelHelpers.possibleConstructorReturn(this,t.call(this));return Object.assign(l,{$http:i,$q:o,RezApiConfig:n,AirlineService:r,$log:s,$translate:a,$ngRedux:c,BookingRead:u,FlightSearch:p}),l.priorityTotalPrice={totalPrice:0,totalNum:0,totalType:"priority"},l.set("priorityTotal",l.priorityTotalPrice),l}return e.$inject=["$http","$q","RezApiConfig","AirlineService","$log","$translate","$ngRedux","BookingRead","FlightSearch"],babelHelpers.inherits(e,t),e.prototype.calculatePriorityTotalPrice=function(){var t=this,e=this.BookingRead.getModel("passengers",this.$ngRedux.getState().bookingModel);this.priorityTotalPrice={totalPrice:0,totalNum:0,totalType:"priority"},e.forEach(function(e){e.segSsrs&&e.segSsrs.forEach(function(e){e.forEach(function(e){"PS"===e.code&&(e.sold||(t.priorityTotalPrice.totalPrice+=e.total,e.total&&(t.priorityTotalPrice.totalNum+=1)))})})}),this.set("priorityTotal",this.priorityTotalPrice),this.notify(["priorityTotal"])},e.prototype.getTitles=function(){var t=this;return this.$q(function(e){var i=t.BookingRead.getOperator(t.$ngRedux.getState().bookingModel),o=R.prop("titles",t.AirlineService.getAirlineApiConfig(i));t.$http.get(o,{cache:!0}).then(function(i){t.titles=i.data,e(i)})})},e.prototype.getDefaultTitleCode=function(t){var e=this.titles.filter(function(e){return e.paxType===t});return 1===e.length?e[0].code:""},e.prototype.getMunicipalities=function(){return this.$http.get(this.RezApiConfig.sara.municipalities)},e.prototype.getCommunities=function(){return this.$http.get(this.RezApiConfig.sara.communities,{cache:!0})},e.prototype.validateSARA=function(t){return this.$http.post(this.RezApiConfig.sara.home,t)},e.prototype.getPassengersArray=function(t){t||(t=this.BookingRead.getModel("passengers",this.$ngRedux.getState().bookingModel)||[]);var e={ADT:1,TEEN:1,CHD:1,INF:1},i=[],o=[],n=[],r=[];return t.forEach(function(t){switch(t.indx=e[t.type]++,t.inf&&(t.inf.indx=e.INF++),t.type){case"ADT":i.push(t);break;case"TEEN":n.push(t);break;case"CHD":r.push(t);break;case"INF":o.push(t)}}),[].concat(i).concat(o).concat(n).concat(r)},e.prototype.passengerBreakdownAsString=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:",",i=this.BookingRead.getPassengerBreakdownAsObject(this.$ngRedux.getState().bookingModel),o=[],n=Object.keys(i).reduce(function(t,e){return i[e]>0&&t.push({key:e,txKey:"trips.pax.summary."+e}),t},[]);return n.forEach(function(e){o.push(t.$translate(e.txKey,{count:i[e.key]},"messageformat"))}),this.$q.all(o).then(function(t){return"("+t.join(e)+")"})},e.prototype.add=function(t){var e=this;return t||(t=this.model),t.Passengers.map(function(t){t.residentInfo&&(t.residentInfo.dob=null)}),this.$q(function(i,o){e.$http.post(e.RezApiConfig.passengers,t).then(function(t){i(t.data)},function(t){o(t)})})},e.prototype.isPrm=function i(t){var e=["BDGR","BLND","DPNA","PETC","WCHC","WCHS"],i=!1;return i=((t.segPrm||[])[0]||[]).some(function(t){return~e.indexOf(t)}),i?!0:((t.segPrm||[])[1]||[]).some(function(t){return~e.indexOf(t)})},e}(ObservableService);angular.module("app.booking").service("Passengers",t)}();


"use strict";angular.module("app.booking").factory("profileDetails",["$http","$q","Session","API_PATH",function(e,t,r,n){function o(){var o=t.defer();return e.get(n+"/secure/users/"+r.getCurrentUser().surrogateId+"/profile/contactDetails").then(function(e){o.resolve(e)},function(e){o.reject(e)}),o.promise}function i(e){s=e}function u(){return s}var s=!1;return{getProfileDetails:o,setEditMode:i,getEditModeStatus:u}}]);


"use strict";angular.module("app.booking").service("UpgradeCardRules",function(){this.rules=[{condition:function(s){s.when(this.isFamilyPlusPurchased)},consequence:function(s){this.offeredType="family",s.stop()}},{condition:function(s){s.when(this.isPlusPurchased)},consequence:function(s){this.offeredType="leisure",s.stop()}},{condition:function(s){var e=this.passengers.CHD+this.passengers.TEEN,i=this.passengers.ADT+this.passengers.CHD+this.passengers.TEEN;s.when(!this.isSomePaxCheckedIn&&this.passengers.ADT>=1&&this.passengers.ADT<=5&&e>=1&&5>=e&&6>=i&&this.isFamilyPlusEnabled&&this.isEligableForFamilyUpgrade&&this.flightDepartInMoreThanTwoHours)},consequence:function(s){this.offeredType="family",s.stop()}},{condition:function(s){s.when((this.passengers.TEEN>0||this.passengers.CHD>0||this.passengers.INF>0)&&this.isPlusEnabled&&this.isEligibleForPlusUpgrade&&this.flightDepartInMoreThanTwoHours)},consequence:function(s){this.offeredType="leisure",s.stop()}},{condition:function(s){var e=this.flights[0].depart.isoWeekday();s.when((6===e||7===e)&&this.isPlusEnabled&&this.isEligibleForPlusUpgrade&&this.flightDepartInMoreThanTwoHours)},consequence:function(s){this.offeredType="leisure",s.stop()}},{condition:function(s){var e=this.legsEnabled[1]?this.flights[1].depart.isoWeekday():0;s.when((6===e||7===e)&&this.isPlusEnabled&&this.isEligibleForPlusUpgrade&&this.flightDepartInMoreThanTwoHours)},consequence:function(s){this.offeredType="leisure",s.stop()}},{condition:function(s){s.when(this.flights[0].depart.startOf("day").diff(moment().startOf("day"),"weeks")>3&&this.isPlusEnabled&&this.isEligibleForPlusUpgrade&&this.flightDepartInMoreThanTwoHours)},consequence:function(s){this.offeredType="leisure",s.stop()}},{condition:function(s){s.when(this.legsEnabled[1]&&this.flights[1].depart.startOf("day").diff(this.flights[0].depart.startOf("day"),"days")>3&&this.isPlusEnabled&&this.isEligibleForPlusUpgrade&&this.flightDepartInMoreThanTwoHours)},consequence:function(s){this.offeredType="leisure",s.stop()}},{condition:function(s){s.when(this.isPlusEnabled&&this.isEligibleForPlusUpgrade&&this.flightDepartInMoreThanTwoHours)},consequence:function(s){this.offeredType="leisure",s.stop()}}]});


"use strict";angular.module("app.booking").service("UpgradeFareRules",function(){function e(e,s){return s.categories.find(function(s){return s===e})}this.rules=[{condition:function(e){e.when(this.familyPlusEnabled&&(this.passengers.TEEN>0||this.passengers.CHD>0)&&this.passengers.ADT+this.passengers.TEEN+this.passengers.CHD<=6)},consequence:function(e){this.offeredType="family",e.stop()}},{condition:function(e){e.when(this.passengers.TEEN>0||this.passengers.CHD>0||this.passengers.INF>0)},consequence:function(e){this.offeredType="leisure",e.stop()}},{condition:function(e){var s=this.flights[0].depart.isoWeekday();e.when(6===s||7===s)},consequence:function(e){this.offeredType="leisure",e.stop()}},{condition:function(e){var s=this.legsEnabled[1]?this.flights[1].depart.isoWeekday():0;e.when(6===s||7===s)},consequence:function(e){this.offeredType="leisure",e.stop()}},{condition:function(e){e.when(this.flights[0].depart.startOf("day").diff(moment().startOf("day"),"weeks")>3)},consequence:function(e){this.offeredType="leisure",e.stop()}},{condition:function(e){e.when(this.legsEnabled[1]&&this.flights[1].depart.startOf("day").diff(this.flights[0].depart.startOf("day"),"days")>3)},consequence:function(e){this.offeredType="leisure",e.stop()}},{condition:function(e){e.when(this.airports[0].countryCode===this.airports[1].countryCode)},consequence:function(e){this.offeredType="business",e.stop()}},{condition:function(e){e.when("gb"===this.airports[0].countryCode&&"ie"===this.airports[1].countryCode||"gb"===this.airports[1].countryCode&&"ie"===this.airports[0].countryCode)},consequence:function(e){this.offeredType="business",e.stop()}},{condition:function(s){s.when(e("CTY",this.airports[0])&&e("CTY",this.airports[1]))},consequence:function(e){this.offeredType="business",e.stop()}},{condition:function(e){e.when(!0)},consequence:function(e){this.offeredType="leisure",e.stop()}}]});


"use strict";angular.module("app.booking").service("CarhireActions",["$ngRedux","$http","$window","$cookies","BookingRead","BasketMessageQueue","DialogManager","MarketConfig","CARHIRE_ACTION_TYPES","SMARTBLOCK_STATES","RezApiConfig","Session","TotalHeaderActions","CARD_CODES","$injector",function(t,e,r,n,a,o,i,u,p,s,c,d,l,g,h){var O=function(){o.enqueue({code:"CAR_UPDATED"})},f=function(e){var o=t.getState(),i=o.bookingModel,p=R.pathOr(!1,["journeys"]),s=R.pluck("model")(p(i)),c=R.pathOr(!1,["passengers"]),l=R.pluck("model")(c(i)),h=R.pipe(R.pathOr([],["contacts"]),R.map(function(t){return t.model}),R.head)(i),O=R.pipe(R.pathOr([],["carHire"]),R.map(function(t){return t.model}),R.head)(i),f=function(t,e){return R.pipe(R.filter(function(e){return R.pathOr("",["type"],e)===t}),R.length)(e)},E=R.pipe(R.pathOr([],["addons"]),R.map(function(t){return t.model}),R.filter(R.propEq("src",g.CARHIRE)),R.map(function(t){return R.pathOr({},["status"],t)}),R.map(function(t){return JSON.parse(t)}),R.head)(i),A=a.getBookingInfo(i),C=a.getServerTimeUTC(i),_=R.pathOr(!1,["0"],s),m=R.pathOr(!1,["1"],s),T=f("ADT",l),y=f("TEEN",l),D=f("CHD",l),v=function(t){return t&&t.inf&&void 0!==t.inf?R.pipe(R.filter(function(t){return t.inf}),R.length)(t):0},I=function(t){return t?{flightNo:t.flt,arrival:{iata:t.dest,time:t.arrive},departure:{iata:t.orig,time:t.depart}}:void 0},S=R.sum([T,y,D,v(l)]),M=void 0,k=void 0;e&&/cross-sell/i.test(e)?d.get("bookingRetrieved")?(M=648739,k=103):(M=643333,k=102):(M=r.SERVER_CFG_CARTRAWLER.partnerId,k=101);var N=1===s.length,L=void 0,b=void 0,B=void 0;N?(L=R.pathOr(!1,["orig"],_),b=R.pathOr(!1,["depart"],_),B=R.pathOr(!1,["flt"],_)):(L=R.pathOr(!1,["orig"],m),b=R.pathOr(!1,["depart"],m),B=R.pathOr(!1,["flt"],m));var F=void 0;_&&(F=a.hasBusinessPlus(i)?"business":a.hasLeisurePlus(i)?"leisure":"regular");var H=n.get("ctr")&&n.get("ctr").toUpperCase()||u.getCountry().toUpperCase(),P=a.getBookingTotal(i);return P=0===P?P.toString():P,{language:u.getLanguage().toUpperCase(),partner:r.SERVER_CFG_CARTRAWLER.partnerName,partnerId:M,taggingId:k,pnrRef:A&&A.pnr,reservationId:R.path(["confirmationId"],O),sourceCountry:H,bookingDateTime:C,originIATA:R.pathOr(!1,["orig"],_),destinationIATA:R.pathOr(!1,["dest"],_),inboundIATA:R.pathOr(!1,["dest"],_),inboundDateTime:R.pathOr(!1,["arrive"],_),inboundFlightNo:R.pathOr(!1,["flt"],_),outboundIATA:L,outboundDateTime:b,outboundFlightNo:B,noPassengers:S,noAdults:T,noTeens:y,noChildren:D,noInfants:v(l),currency:A&&A.curr,serviceClass:F,oneway:N,vehicle:E,flightFare:P,firstname:R.path(["0","name","first"],l),surname:R.path(["0","name","last"],l),phoneNumber:h&&h.homePhone,email:h&&h.email,manageBooking:d.get("bookingRetrieved"),flightJourney:I(_),flightReturnJourney:I(m)}},E={initCarSearch:function(t){return{type:p.INIT_CAR_SEARCH,payload:{model:f(t)}}},confirmCarSelection:function(t){return function(r){r({type:p.ADD_TO_BOOKING_MODEL_START});var n={ota:R.path(["book","msg"],t),amt:R.path(["product","price","totalPayNow","amount"],t),description:JSON.stringify(angular.extend({},R.path(["product"],t),R.path(["product","search"],t)))};return e.post(c.carhire,n).then(function(t){O(),r(l.showExtrasInfo({totalCount:t.data.reduce(function(t,e){return t+e.qty},0),text:"trips.header.title.extras_CARHIRE"})),r({type:p.ADD_TO_BOOKING_MODEL_SUCCESS,payload:t.data,meta:{analytics:{event:"rynProductTrack",action:"ADD",type:g.CARHIRE,identity:"addons"}}});var e=h.get("PromotionActions");r(e.productAddedNotification({productAdded:g.CARHIRE})),r(E.closeDialog())})["catch"](function(t,e){r({type:p.ADD_TO_BOOKING_MODEL_FAILED,payload:{error:t,statusCode:e}})})}},confirmCarRemoval:function(){return function(t){return t({type:p.REMOVE_FROM_BOOKING_MODEL_START}),e["delete"](c.carhire).then(function(e){t({type:p.REMOVE_FROM_BOOKING_MODEL_SUCCESS,payload:e.data,meta:{analytics:{event:"rynProductTrack",action:"REMOVE",type:g.CARHIRE,identity:"addons"}}}),t(E.closeDialog())})["catch"](function(e,r){t({type:p.REMOVE_FROM_BOOKING_MODEL_FAILED,payload:{error:e,statusCode:r}})})}},removeFromBasket:function(){return r.SERVER_CFG_CARTRAWLER.settings.events.changeState(s.REMOVE,{tag:"bskt"}),{type:p.REMOVE_FROM_BASKET}},closeDialog:function(){return function(t){i.close("extrasCarRental"),t({type:p.CLOSE_MODAL})}},carTrawlerReady:function(){return{type:p.CAR_TRAWLER_READY}}};return E}]);


"use strict";angular.module("app.booking").service("CarRentalActions",["$ngRedux","$http","$window","$cookies","BookingRead","MarketConfig","CAR_RENTAL_ACTION_TYPES","Session","PASSENGER_TYPES","FEATURE_CONFIG",function(t,e,n,r,o,a,i,u,p,g){var l=R.pathOr("",["Origin"],g.RENTAL_CARS_AEM)+"/api/in-path-booking/tokenise",d=function(){var e=t.getState(),i=e.bookingModel,g=R.pathOr(!1,["journeys"]),l=R.pluck("model")(g(i)),d=R.pathOr(!1,["passengers"]),h=R.pluck("model")(d(i)),s=R.pipe(R.pathOr([],["contacts"]),R.map(function(t){return t.model}),R.head)(i),c=function(t,e){return R.pipe(R.filter(function(e){return R.pathOr("",["type"],e)===t}),R.length)(e)},f=o.getBookingInfo(i),A=o.getServerTimeUTC(i),T=R.pathOr(!1,["0"],l),O=R.pathOr(!1,["1"],l),C=c(p.Adult,h),m=c(p.Teen,h),E=c(p.Child,h),_=function(t){return t&&t.inf&&void 0!==t.inf?R.pipe(R.filter(function(t){return t.inf}),R.length)(t):0},k=function(t){return t?{flightNo:t.flt,arrival:{iata:t.dest,time:t.arrive},departure:{iata:t.orig,time:t.depart}}:void 0},y=R.sum([C,m,E,_(h)]),N=1===l.length,I=N?T:O,S=R.pathOr(!1,["orig"],I),b=R.pathOr(!1,["depart"],I),v=R.pathOr(!1,["flt"],I),F=r.get("ctr")&&r.get("ctr").toUpperCase()||a.getCountry().toUpperCase(),B=o.getBookingTotal(i);return B=0===B?B.toString():B,{language:a.getLanguage().toUpperCase(),partner:n.SERVER_CFG_CARTRAWLER.partnerName,pnrRef:f&&f.pnr,sourceCountry:F,bookingDateTime:A,originIATA:R.pathOr(!1,["orig"],T),destinationIATA:R.pathOr(!1,["dest"],T),inboundIATA:R.pathOr(!1,["dest"],T),inboundDateTime:R.pathOr(!1,["arrive"],T),inboundFlightNo:R.pathOr(!1,["flt"],T),outboundIATA:S,outboundDateTime:b,outboundFlightNo:v,noPassengers:y,noAdults:C,noTeens:m,noChildren:E,noInfants:_(h),currency:f&&f.curr,oneway:N,flightFare:B,firstname:R.path(["0","name","first"],h),surname:R.path(["0","name","last"],h),email:s&&s.email,manageBooking:u.get("bookingRetrieved"),flightJourney:k(T),flightReturnJourney:k(O)}},h={initCarSearch:function(t){return{type:i.INIT_CAR_SEARCH,payload:{model:d(t)}}},carRentalReady:function(){return{type:i.CAR_RENTAL_READY}},getBookingToken:function(t){return function(n){return e.post(l,t).then(function(t){var e=t.data;return n({type:i.FETCH_BOOKING_TOKEN,payload:e.token}),e})["catch"](function(t){n({type:i.FETCH_BOOKING_TOKEN_ERROR,payload:t})})}}};return h}]);


"use strict";angular.module("app.booking").service("ChangeFlightActions",["CHANGE_FLIGHT_ACTION_TYPES","BOOKING_MODEL_ACTION_TYPES","RezApiConfig","$http","Flatnmap","FlatmapMaps","Stations","$q","BookingRead","ChangeFlightUtil","ModelQuery",function(e,t,n,a,_,E,o,r,i,l,T){var g={setChangeFlightStatus:function(t){return{type:e.SET_CHANGE_FLIGHT_STATUS,payload:t}},setChangeFlightMessages:function(t){return{type:e.SET_CHANGE_FLIGHT_MESSAGES,payload:t}},addChangeFlightMessage:function(t){return{type:e.ADD_CHANGE_FLIGHT_MESSAGE,payload:t}},setChangeFlightWarnings:function(t){return{type:e.SET_CHANGE_FLIGHT_WARNINGS,payload:t}},setChangeFlightErrors:function(t){return{type:e.SET_CHANGE_FLIGHT_ERRORS,payload:t}},setShowAutoCorrectDateWarning:function(t){return{type:e.SET_SHOW_AUTO_CORRECT_DATE_WARNING,payload:t}},setHideFooter:function(t){return{type:e.SET_HIDE_FOOTER,payload:t}},setChangeFlightSelectedPaxMap:function(t){return{type:e.SET_CHANGE_FLIGHT_SELECTED_PAX_MAP,payload:t}},setChangeFlightPaymentNotRequired:function(t){return{type:e.SET_CHANGE_FLIGHT_PAYMENT_NOT_REQUIRED,payload:t}},setChangeFlightIsFreeMove:function(t){return{type:e.SET_CHANGE_FLIGHT_IS_FREE_MOVE,payload:t}},setChangeFlightModelDeparture:function(t){return{type:e.SET_CHANGE_FLIGHT_MODEL_DEPARTURE,payload:t}},setChangeFlightModelDestination:function(t){return{type:e.SET_CHANGE_FLIGHT_MODEL_DESTINATION,payload:t}},setChangeFlightModelStartDate:function(t){return{type:e.SET_CHANGE_FLIGHT_MODEL_START_DATE,payload:t}},setChangeFlightModelEndDate:function(t){return{type:e.SET_CHANGE_FLIGHT_MODEL_END_DATE,payload:t}},setChangeFlightModelType:function(t){return{type:e.SET_CHANGE_FLIGHT_MODEL_TYPE,payload:t}},setChangeFlightModelFlag:function(t){return{type:e.SET_CHANGE_FLIGHT_MODEL_CF,payload:t}},setChangeFlightModel:function(t){return{type:e.SET_CHANGE_FLIGHT_MODEL,payload:t}},setChangeFlightModelToOriginal:function(t){return{type:e.SET_CHANGE_FLIGHT_ORIGINAL_TO_ORIGINAL,payload:t}},setChangeFlightOriginalFlightModel:function(t){return{type:e.SET_CHANGE_FLIGHT_ORIGINAL_FLIGHT_MODEL,payload:t}},resetChangeFlight:function(){return{type:e.RESET_CHANGE_FLIGHT}},postSelectedFlight:function(o){return function(r){r({type:t.POST_SELECTED_FLIGHT_START}),a.post(n.changeFlight,o).then(function(n){var a=_.normalize(E.bookingModel,n.data.bookingModel);r({type:e.SET_CHANGE_FLIGHT_STATUS,payload:!0}),r({type:t.POST_SELECTED_FLIGHT_SUCCESS,payload:a,meta:{analytics:{event:"rynFlightSelect"}}}),r({type:e.SET_CHANGE_FLIGHT_IS_FREE_MOVE,payload:R.any(R.identity,i.getFreeMoveFlights(a))}),n.data.errors.length?(r({type:t.SET_FARE_ERROR,payload:n.data.errors}),r({type:e.HAS_ERRORS_ON_SELECTED_FARES,payload:!0})):r({type:e.HAS_ERRORS_ON_SELECTED_FARES,payload:!1}),n.data.warnings.length&&r({type:t.SET_FARE_WARNING,payload:n.data.warnings})})["catch"](function(e){r({type:t.POST_SELECTED_FLIGHT_ERROR,payload:e.data})})}},resetChangeFlightFareErrors:function(){return function(e){e({type:t.RESET_FARE_ERRORS})}},resetChangeFlightFareWarnings:function(){return{type:t.RESET_FARE_WARNINGS}},setChangeFlightModelTripType:function(){return function(t,n){var a=n(),_=a.changeFlight,E=_.availableFlights,o=_.selectedFlights;t({type:e.SET_CHANGE_FLIGHT_MODEL_TRIP_TYPE,payload:l.getPropertyForRequest(E.length,o)})}},setSelectedFlights:function(t,n){return function(a,_){var E=_(),o=E.changeFlight.selectedFlights;o[t]!==n&&(a({type:e.SET_SELECTED_FLIGHTS,payload:{index:t,value:n}}),a(g.setChangeFlightModelTripType()))}},setAvailableFlights:function(t){return function(n){n({type:e.SET_AVAILABLE_FLIGHTS_START});var a=o.getAirportName(i.getOriginCityCode(t)),_=o.getAirportName(i.getDestCityCode(t));r.all([a,_]).then(function(a){var _=t.journeys.map(function(e){var n=R.pipe(T.byIdentity("fares"),T.byKey({journeys:e.key.id}),R.map(R.pathOr(0,["model","total"])),R.sum)(t);return{route:i.getOriginCityCode(t)===e.model.orig?a:[].concat(a).reverse(),journey:e,isSelectable:!0,total:n,bundlePrice:i.getBundleCostPerLeg(e.key.id,t)}});n({type:e.SET_AVAILABLE_FLIGHTS_SUCCESS,payload:_})})["catch"](function(t){n({type:e.SET_AVAILABLE_FLIGHTS_ERROR,payload:t.data})})}},setChangeFlightOriginalFlightData:function(t){return{type:e.SET_CHANGE_FLIGHT_ORIGINAL_FLIGHT_DATA,payload:{journeys:t.journeys,fares:t.fares,segments:t.segments,passengers:t.passengers,ssrs:t.ssrs,seats:t.seats,checkin:t.checkin}}},confirmNoPaymentChangeFlight:function(){return function(o){return o({type:t.CREATE_BOOKING_MODEL_START}),a.post(n.commit).then(function(n){o({type:e.SET_CHANGE_FLIGHT_STATUS,payload:!1});var a=_.normalize(E.bookingModel,n.data);o({type:t.CREATE_BOOKING_MODEL_SUCCESS,payload:a}),o({type:e.SET_CHANGE_FLIGHT_ORIGINAL_FLIGHT_DATA,payload:a})})["catch"](function(e){o({type:t.CREATE_BOOKING_MODEL_FAILED,payload:e.data})})}}};return g}]);


"use strict";angular.module("app.booking").service("FareUpgradeActions",["$http","$q","RezApiConfig","FARE_UPGRADE_ACTION_TYPES","BasketMessageQueue","Flatnmap","FlatmapMaps","BookingRead","BagsUtils","ModelQuery","$state","UpgradeCardUtils",function(e,t,a,n,r,s,o,i,p,u,E,d){var c={leisure:"SURE",business:"PLUS",family:"FAMI"},g=function(e){r.enqueue({code:"UPGRADE_ADDED",passengerCount:e.passengers.length,isReturn:i.isReturnTrip(e)})},_=function(e,t,a){return a.passengers.reduce(function(n,r){var s={journeys:e.key.id,passengers:r.key.id},o=R.pipe(u.byIdentity("ssrs"),u.byModel({type:"BAGS"}),u.byKey(s))(a);return o.length>=t?n.concat([s]):n},[])},l=function(r){return function(u,E){var d=E(),c=d.bookingModel,l=d.bags,y=i.isPotentialBooking(c);if(y)return t.reject();u({type:n.FARE_UPGRADE_ADD_START});var A={FareOption:r};return e.post(a.fareUpgrade,A).then(function(e){var t=e.data,a=c.journeys,r=a.reduce(function(e,t){var a=p.getMaxSumBagsPerPassenger(t,l);return e.concat(_(t,a,c))},[]);u({type:n.FARE_UPGRADE_ADD_SUCCESS,payload:{ssrs:R.pathOr([],["ssrs"],s.normalize(o.segSsr,t.ssrs)),passengersWithBagsLimit:r,paxesToUpdate:R.pluck("paxNum",t.ssrs),seats:R.pathOr([],["seats"],s.normalize(o.postSeats,t.seats))}}),g(c)})["catch"](function(e){u({type:n.FARE_UPGRADE_ADD_ERROR,payload:e})})}},y=function(t){return function(r,i){return r({type:n.FARE_UPGRADE_REMOVE_START}),e["delete"](a.fareUpgrade).then(function(e){var a=e.data;r({type:n.FARE_UPGRADE_REMOVE_SUCCESS,payload:{ssrs:R.pathOr([],["ssrs"],s.normalize(o.postSsr,a.ssrs)),seats:R.pathOr([],["seats"],s.normalize(o.postSeats,a.seats))}});var p=R.pipe(u.byIdentity("ssrs"),u.byModel({sold:!1}),R.length)(i().bookingModel);t&&0===p&&E.go("booking.active")})["catch"](function(e){r({type:n.FARE_UPGRADE_REMOVE_ERROR,payload:e})})}},A=function(){return function(r,s){var o=s(),p=o.bookingModel,u=i.isPotentialBooking(p);return u?t.reject():(r({type:n.FETCH_UPGRADE_PRICES_START}),e.get(a.fareUpgrade).then(function(e){var t=e.data;r({type:n.FETCH_UPGRADE_PRICES_SUCCESS,payload:t})})["catch"](function(e){r({type:n.FETCH_UPGRADE_PRICES_ERROR,payload:e})}))}},U=function(){return function(e,a){var r=a(),s=r.bookingModel,o=i.isPotentialBooking(s);return o?t.reject():d.determinePlusCardType(s).then(function(t){var a=t.showUpgradeCard,r=c[a];e({type:n.SET_ELIGIBLE_FARE_TYPE_FOR_UPGRADE,payload:{type:r}}),r&&e(A())},function(){e({type:n.SET_ELIGIBLE_FARE_TYPE_FOR_UPGRADE,payload:{type:void 0}})})}},f=function(){return{type:n.RESET}};return{getEligibleFareTypeForUpgrade:U,fetchUpgradePrices:A,addUpgrade:l,removeUpgrade:y,reset:f}}]);


"use strict";angular.module("app.booking").service("GroundTransfersActions",["$http","$state","RezApiConfig","GROUND_TRANSFERS_ACTION_TYPES","BasketMessageQueue","TotalHeaderActions","DialogManager","CARD_CODES","$injector",function(t,a,e,o,n,r,i,c,s){var d=function(t,a){n.enqueue({code:"TRANSFER_UPDATED",paxNum:t,price:a})},u={postGroundTransfers:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(u,p){u({type:o.ADD_TO_BOOKING_MODEL_START});var l={ota:R.path(["book","msg"],n),amt:R.path(["product","price","total","amount"],n),description:JSON.stringify(angular.extend({},R.path(["product"],n),R.path(["product","search"],n))),isMor:R.pathOr(!1,["product","config","mor"],n),ChargeAmountValidation:R.path(["verifyPrice","msg"],n)};return t.post(e.groundTransfer,l).then(function(t){var e=R.path(["isProductEngagedFromBoardingPass"],p().checkin);d(),u(r.showExtrasInfo({totalCount:t.data.reduce(function(t,a){return t+a.qty},0),text:"trips.header.title.extras_GROUNDTRANSFERS"})),u({type:o.ADD_TO_BOOKING_MODEL_SUCCESS,payload:t.data,meta:{analytics:{event:"rynProductTrack",action:"ADD",type:c.GRTANSFER,identity:"addons"}}});var n=s.get("PromotionActions");if(u(n.productAddedNotification({productAdded:c.GRTANSFER})),e){var l=s.get("CheckinModelActions");return u(l.passProductToPaymentPage(c.GRTANSFER)),void a.go("booking.active.boarding-pass-payment",{productCode:c.GRTANSFER})}i.closeAllDialogs()})["catch"](function(t){u({type:o.ADD_TO_BOOKING_MODEL_FAILED,payload:t}),i.closeAllDialogs()})}},confirmGroundTransferRemoval:function(){return function(a){return a({type:o.REMOVE_FROM_BOOKING_MODEL_START}),t["delete"](e.groundTransfer).then(function(t){a({type:o.REMOVE_FROM_BOOKING_MODEL_SUCCESS,payload:t.data,meta:{analytics:{event:"rynProductTrack",action:"REMOVE",type:c.GRTANSFER,identity:"addons"}}}),i.closeAllDialogs()})["catch"](function(t){a({type:o.REMOVE_FROM_BOOKING_MODEL_FAILED,payload:t}),i.closeAllDialogs()})}}};return u}]);


"use strict";angular.module("app.booking").service("InflightProductsActions",["BookingRead","CARD_CODES","$http","FlatmapMaps","Flatnmap","INFLIGHT_PRODUCTS_ACTION_TYPES","InflightProductsUtils","$injector","$q","RezApiConfig",function(e,t,r,n,o,i,a,u,s,p){var c=function(e){return{model:{sold:!1,type:t.INFLIGHT,code:R.prop("code",e),qty:1,vat:0,amt:R.prop("total",e),total:R.prop("total",e)},key:{passengers:R.prop("paxNum",e),journeys:R.prop("journeyNum",e),segments:0},identity:"ssrs",local:R.propOr(!0,"local",e)}},d=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments[4],a=e.getCities(i),u=e.getInflightProductItems(!1)(i),s=e.getInflightProductItems(!0)(i),p=function(e,r){return R.not(R.isEmpty(R.filter(R.whereEq({code:e}),R.pathOr([],[r,"offers"],t))))},c=R.any(function(e){var t=e.model;return R.propOr(!1,"isOver18",t)},n),d=function(e){return c&&e||!e},l=function(e,t,r){return R.pipe(R.map(function(n){var o=R.not(R.isEmpty(R.filter(function(e){return e.key.passengers===R.path(["key","id"],n)},t))),i=R.filter(function(e){return e.key.passengers===R.path(["key","id"],n)},r),a=R.not(R.isEmpty(i)),u=R.path(["model","isOver18"],n)&&R.prop("adultOnly",e)||R.not(R.prop("adultOnly",e));return{paxNum:R.path(["key","id"],n),name:R.path(["model","name"],n),type:R.path(["model","type"],n),isOver18:R.path(["model","isOver18"],n),isSelected:o,isEligible:u,isPurchased:a}}),R.reject(R.whereEq({isPurchased:!0})))(n)},f=function(e,t,r){return R.map(function(o){var i="add",u=R.not(R.isEmpty(t)),s=R.not(R.isEmpty(r)),c=u?R.filter(function(e){return e.key.journeys===R.path(["key","journeys"],o)},t):[],f=s?R.filter(function(e){return e.key.journeys===R.path(["key","journeys"],o)},r):[],h=l(e,c,f),m=R.pipe(R.filter(R.propEq("isEligible",!0)),R.all(R.propEq("isSelected",!0)))(h);return R.not(R.isEmpty(c))&&(i=R.equals(1,R.length(n))?"remove":"modify"),{ctaState:i,airport:a[R.path(["key","journeys"],o)],journeyNum:R.path(["key","journeys"],o),isCancelled:R.path(["model","isCancelled"],o),isPaxListOpen:!1,isAddedToAllPax:m,flown:R.path(["model","flown"],o),isAvailable:p(R.prop("code",e),R.path(["key","journeys"],o))&&R.not(R.path(["model","flown"],o))&&R.not(R.path(["model","isCancelled"],o))&&d(R.prop("adultOnly",e))&&R.not(R.isEmpty(h)),passengers:h}},o)},h=R.map(function(e){var t=R.not(R.isEmpty(u)),n=R.not(R.isEmpty(s)),o=t?R.filter(function(t){return t.model.code===e.code},u):[],i=n?R.filter(function(t){return t.model.code===e.code},s):[];return babelHelpers["extends"]({},e,{index:R.findIndex(R.whereEq({code:e.code}),r),price:R.pathOr(0,["prices",0,"total"],e),numberOfAdded:R.length(o),journeys:f(e,o,i)})},r);return{checkinProductCard:h,items:u}},l=function(e,t){return function(r){var n=R.pathOr({},[0,"model"],e),o=n.orig,i=n.dest,u=t?o:i,s=R.map(function(e){return babelHelpers["extends"]({},e,{type:R.propOr("","type",e),upgrade:a.isUpgradeEligible(R.prop("code",e)),adultOnly:a.isAdultOnlyProduct(R.prop("code",e))})},r),p=function(e){return R.reject(R.whereEq({type:e}),s)};switch(u){case"DUB":return p("ENGLISH");case"STN":return p("IRISH");default:return s}}},f=function(e,t){return R.when(R.whereEq({journeyNum:e}),R.assoc("ctaState",t))},h=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return function(n){var o=R.length(R.filter(function(e){return e.model.code===n.code},r));return babelHelpers["extends"]({},n,{numberOfAdded:o,journeys:R.map(f(e,t))(R.propOr([],"journeys",n))})}},m=function(e){return{type:i.UPDATE_CHECKIN_PRODUCT_CARD,payload:{checkinProductCard:e}}},y=function(e,t,r){return function(n,o){var a=R.path(["inflightProducts","checkinProductCard"],o()),u=R.path(["inflightProducts","items"],o()),s=c({paxNum:e,journeyNum:t,code:r.code,total:r.price}),p=R.append(s,u);if(R.not(R.isEmpty(a))){var d=R.map(R.when(R.whereEq({code:r.code}),h(t,"remove",p)),a);n(m(d))}n({type:i.ADD_SELECTED,payload:{items:p}})}},E=function(e,t){return function(r,n){var o=R.path(["inflightProducts","checkinProductCard"],n());if(R.not(R.isEmpty(o))){var i=function(r,n){return R.equals(R.prop("journeyNum",r),t)&&R.equals(R.prop("index",n),e)&&R.not(R.prop("isPaxListOpen",r))},a=function(e){return function(t){return babelHelpers["extends"]({},t,{isPaxListOpen:i(t,e)})}},u=R.map(function(e){return babelHelpers["extends"]({},e,{journeys:R.map(a(e))(R.propOr([],"journeys",e))})},o);r(m(u))}}},g=function(e,t){return function(r,n){var o=R.path(["inflightProducts","checkinProductCard"],n()),a=R.path(["inflightProducts","items"],n()),u=R.pipe(R.find(R.whereEq({code:t.code})),R.propOr([],"journeys"),R.find(R.whereEq({journeyNum:e})),R.propOr([],"passengers"),R.filter(R.whereEq({isPurchased:!1,isSelected:!0,isEligible:!0})),R.pluck("paxNum"))(o),s=R.map(function(r){return c({paxNum:r,journeyNum:e,code:t.code,total:t.price,local:!0})},u),p=R.pipe(R.reject(function(r){var n=r.key,o=r.model;return R.whereEq({journeys:e})(n)&&R.whereEq({code:t.code})(o)}),R.concat(s))(a);if(R.not(R.isEmpty(o))){var d=s.length?"modify":"add",l=R.map(R.when(R.whereEq({code:t.code}),h(e,d,p)),o);r(m(l)),r(E(t.index,e))}r({type:i.UPDATE_SELECTED,payload:{items:p}})}},O=function(e,t,r){return function(n,o){var a=R.path(["inflightProducts","checkinProductCard"],o()),u=R.path(["inflightProducts","items"],o()),s=R.reject(function(n){var o=n.key,i=n.model;return R.whereEq({passengers:e,journeys:t})(o)&&R.whereEq({code:r.code})(i)},u);if(R.not(R.isEmpty(a))){var p=R.map(R.when(R.whereEq({code:r.code}),h(t,"add",s)),a);n(m(p))}n({type:i.REMOVE_SELECTED,payload:{items:s}})}},P=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:!0;return function(o,i){var a=R.path(["inflightProducts","checkinProductCard"],i());if(R.not(R.isEmpty(a))){var u=function(e){var t=R.add(1,R.length(R.filter(R.whereEq({isSelected:n}),e))),r=R.length(R.filter(R.whereEq({isEligible:!0}),e));return n&&t===r},s=R.when(R.whereEq({paxNum:e}),R.assoc("isSelected",n)),p=function(e){return babelHelpers["extends"]({},e,{passengers:R.map(s)(R.propOr([],"passengers",e)),isAddedToAllPax:u(R.propOr([],"passengers",e))})},c=R.when(R.whereEq({journeyNum:t}),p),d=function(e){return babelHelpers["extends"]({},e,{journeys:R.map(c)(R.propOr([],"journeys",e))})},l=R.map(R.when(R.whereEq({index:r}),d),a);o(m(l))}}},v=function(e,t,r){return function(n,o){var i=R.path(["inflightProducts","checkinProductCard"],o());if(R.not(R.isEmpty(i))){var a=function(e){return babelHelpers["extends"]({},e,{isAddedToAllPax:r,passengers:R.map(R.when(R.whereEq({isEligible:!0}),R.assoc("isSelected",r)),R.propOr([],"passengers",e))})},u=R.when(R.whereEq({journeyNum:t}),a),s=function(e){return babelHelpers["extends"]({},e,{journeys:R.map(u)(R.propOr([],"journeys",e))})},p=R.map(R.when(R.whereEq({index:e}),s),i);n(m(p))}}},_=function(){return function(e,t){var n=t(),o=n.inflightProducts.offers;return R.not(R.isEmpty(o))?s.resolve({offers:o}):(e({type:i.GET_OFFERS_START}),r.get(p.inflightProducts).then(function(t){var r=t.data;return e({type:i.GET_OFFERS_SUCCESS,payload:{offers:r}}),{offers:r}})["catch"](function(t){return e({type:i.GET_OFFERS_FAILED,payload:t}),{offers:[]}}))}},C=function(e,t){return function(r,n){r({type:i.SET_CHECKIN_PRODUCT_CARD_START}),r(_()).then(function(o){var u=o.offers;if(R.isEmpty(u)||R.isNil(u))throw new Error("Offers are not avilable");var s=n(),p=s.bookingModel,c=s.checkin,f=R.pipe(R.pathOr([],[0,"offers"]),R.any(R.whereEq({code:"BREK"})))(u),h=R.pipe(R.pluck("offers"),R.flatten,l(t,f),R.uniqWith(R.eqBy(R.prop("code"))))(u),m=a.getPassengersWithDobValidation(c,e),y=d(u,h,m,t,p),E=y.checkinProductCard,g=y.items;r({type:i.SET_CHECKIN_PRODUCT_CARD_SUCCESS,payload:{checkinProductCard:E,items:g}})})}},S=function(){return function(e,a){var s=a(),c=s.inflightProducts.items;e({type:i.ADD_TO_BOOKING_MODEL_START});var d=R.map(function(e){return{journeyNum:e.key.journeys,paxNum:e.key.passengers,segmentNum:e.key.segments,code:e.model.code,qty:e.model.qty}},c);return r.post(p.inflightProducts,d).then(function(r){var a=r.data,s=R.propOr([],"ssrs",o.normalize(n.postInflightProduct,a));e({type:i.ADD_TO_BOOKING_MODEL_SUCCESS,payload:s,meta:{analytics:{event:"rynProductTrack",action:"ADD",type:t.INFLIGHT,identity:"ssrs"}}});var p=u.get("PromotionActions");e(p.productAddedNotification({productAdded:t.INFLIGHT}))})["catch"](function(t){e({type:i.ADD_TO_BOOKING_MODEL_FAILED,payload:t})})}},w=function(e){return function(a){a({type:i.REMOVE_FROM_BOOKING_MODEL_START});var u=R.when(R.identity,function(){return{code:e}},e);return r["delete"](p.inflightProducts,{params:u}).then(function(e){var r=e.data,u=R.propOr([],"ssrs",o.normalize(n.postInflightProduct,r));a({type:i.REMOVE_FROM_BOOKING_MODEL_SUCCESS,payload:u,meta:{analytics:{event:"rynProductTrack",action:"REMOVE",type:t.INFLIGHT,identity:"ssrs"}}})})["catch"](function(e){a({type:i.REMOVE_FROM_BOOKING_MODEL_FAILED,payload:e})})}},T=function(){return{type:i.RESET}};return{getCheckinProductCard:C,addSelectedProduct:y,removeSelectedProduct:O,updateSelectedProducts:g,setSelectedProductForPassenger:P,setSelectedProductForAllPassengers:v,toggleDropdown:E,getInflightProductsOffers:_,postInflightProducts:S,removeInflightProducts:w,reset:T}}]);


"use strict";angular.module("app.booking").service("ParkingActions",["$http","$state","DialogManager","newDialogEnabled","RezApiConfig","PARKING_ACTION_TYPES","BasketMessageQueue","TotalHeaderActions","CARD_CODES","$injector",function(t,e,n,a,o,r,i,c,l,u){var p="extrasParking",d={template:a()?"/partials/extras/parking/templates/active-parking-selection.html":"/partials/extras/parking/templates/parking-selection.html",className:a()?"core-modal":"extras-parking-modal dialog-aside",controller:"ParkingCtrl",controllerAs:"$ctrl"},E=function(t){i.enqueue({code:"PARKING_UPDATED",price:t})},s={getParkings:function(e,n){return function(a){return a({type:r.FETCH_OFFERS_START}),t({url:o.parking,method:"GET",params:{startDate:e,endDate:n}}).then(function(t){a({type:r.FETCH_OFFERS_SUCCESS,payload:t.data})})["catch"](function(t){a({type:r.FETCH_OFFERS_FAILED,payload:t})})}},postParkings:function(n){return function(a){return a({type:r.ADD_TO_BOOKING_MODEL_START}),t.post(o.parking,n).then(function(t){a({type:r.ADD_TO_BOOKING_MODEL_SUCCESS,payload:t.data,meta:{analytics:{event:"rynProductTrack",action:"ADD",type:l.PARKING,identity:"addons"}}}),a(c.showExtrasInfo({totalCount:t.data.reduce(function(t,e){return t+e.qty},0),text:"trips.header.title.extras_PARKING"}));var o=u.get("PromotionActions");a(o.productAddedNotification({productAdded:l.PARKING})),E(n.price),e.includes("booking.active.checkin")||a(s.closeDialog())})["catch"](function(t){a({type:r.ADD_TO_BOOKING_MODEL_FAILED,payload:t})})}},removeAll:function(){return function(n){return n({type:r.REMOVE_FROM_BOOKING_MODEL_START}),t["delete"](o.parking).then(function(t){n({type:r.REMOVE_FROM_BOOKING_MODEL_SUCCESS,payload:t.data,meta:{analytics:{event:"rynProductTrack",action:"REMOVE",type:l.PARKING,identity:"addons"}}}),e.includes("booking.active.checkin")||n(s.closeDialog())})["catch"](function(t){n({type:r.REMOVE_FROM_BOOKING_MODEL_FAILED,payload:t})})}},addSelectedProviderAndOffer:function(t){return{type:r.ADD_SELECTED_OFFERS,payload:t}},setSelectedOffer:function(t){return{type:r.SET_SELECTED_OFFER,payload:t}},removeSelectedOffer:function(){return{type:r.REMOVE_SELECTED_OFFER}},openDialog:function(){return function(t){n.open(p,d,function(t){("DialogManagerCloseAll"!==t.value||t.value!==p)&&e.go(e.current.relative||"booking.extras")}),t({type:r.OPEN_MODAL})}},closeDialog:function(){return function(t){n.close(p),t({type:r.CLOSE_MODAL})}},clear:function(){return{type:r.CLEAR_ALL}}};return s}]);


"use strict";angular.module("app.booking").service("RefundActions",["$http","$window","RezApiConfig","REFUND_ACTION_TYPES","FEATURE_CONFIG","BookingRead","Session",function(e,t,n,r,u,o,a){var c=function(e){var t=R.map(function(t){var n=o.getCancelledFlights(e)[t.journeyNum];return babelHelpers["extends"]({},t,{isCancelled:n,isSelected:n,isRefundable:!1})})(o.getModel("journeys",e)),n=R.filter(function(e){return e.isCancelled})(t),r=o.getModel("passengers",e);return{journeys:t,selectedJourneys:n,passengers:r,selectedPassengers:[]}},p=function(e,t){return[].concat(babelHelpers.toConsumableArray(e.map(function(e){return"j="+e.journeyNum})),babelHelpers.toConsumableArray(t.map(function(e){return"paxNum="+e.num}))).reduce(function(e,t,n){return""+e+(n?"&":"?")+t},"")},i=function(e){return R.pipe(R.reduce(function(e,t){var n=t.passengers.reduce(function(e,t){return e.concat(t.breakdown)},[]);return e.concat(n)},[]),R.map(function(e){return{type:e.type.toUpperCase(),total:e.total}}),R.sort(function(e,t){return e.type>t.type?1:e.type<t.type?-1:0}),R.reduce(function(e,t){var n=e.pop();return n?n.type===t.type?(n.total+=t.total,e.push(n)):(e.push(n),e.push(t)):e.push(t),e},[]),R.sort(function(e,t){return"FARE"===e.type?-1:e.total>t.total?-1:e.total<t.total?1:0}))(e)},d={initRefund:function(){return function(e,t){var n=t(),u=n.bookingModel;e({type:r.INIT_REFUND,payload:c(u)})}},deselectPassenger:function(e){return function(t){return t({type:r.DESELECT_PAX,payload:e})}},selectPassenger:function(e){return function(t){return t({type:r.SELECT_PAX,payload:e})}},getRefundable:function(t){return function(u){return u({type:r.FETCH_REFUNDABLE_START}),e({url:n.refundStatus,method:"GET"}).then(function(e){u({type:r.FETCH_REFUNDABLE_SUCCESS,payload:{refundableJourneys:e.data}}),R.any(function(e){return e.refundable})(e.data)?t():u({type:r.FETCH_REFUNDABLE_FAILED})})["catch"](function(e){u({type:r.FETCH_REFUNDABLE_FAILED,payload:e})})}},toggleSelection:function(e){return{type:r.TOGGLE_SELECTED_FLIGHT,payload:e}},getRefundBreakdown:function(t,u,o){var a=p(u,o);return function(u){return u({type:r.FETCH_BREAKDOWN_ITEM_START}),e({url:""+n.refund+a,method:"GET"}).then(function(e){var n=i(R.pathOr([],["data","journeys"],e)),o=R.pathOr([],["data","payments"],e);u({type:r.FETCH_BREAKDOWN_ITEM_SUCCESS,payload:{totalRefund:R.pathOr(0,["data","total"],e),itemBreakdown:n,paymentBreakdown:o}}),t()})["catch"](function(e){u({type:r.FETCH_BREAKDOWN_ITEM_FAILED,payload:e})})}},refund:function(t,u,o){var c=o.reduce(function(e,t){return e.concat(u.map(function(e){return{journeyNum:e.journeyNum,paxNum:t.num}}))},[]);return function(u){return u({type:r.REFUND_START}),e.post(n.refund+"?CustomerId="+a.getClientId(),c).then(function(e){u({type:r.REFUND_SUCCESS,payload:e.data}),t()})["catch"](function(e){u({type:r.REFUND_FAILED,payload:e})})}},resetErrors:function(){return{type:r.RESET_REFUND_ERRORS}},setCta:function(e,t){return{type:r.SET_CTA,payload:{name:e,fn:t}}}};return d}]);


"use strict";angular.module("app.booking").service("SeatsActions",["$http","$state","$q","SEATS_ACTION_TYPES","RezApiConfig","Flatnmap","FlatmapMaps","BookingRead","SeatsService","PRIORITY_BOARDING_ACTIONS_TYPES","ModelQuery","BookingModelActions","CARD_CODES","CHILD_SEAT_LOCATION_ERROR","$injector",function(e,t,n,a,r,o,s,i,u,S,c,d,E,y,p){var l=function(){return{type:a.SEATS_CHANGED,seatsChanged:0}};return{getAvailability:function(){return function(t){return t({type:a.FETCH_SEATS_START}),e({method:"GET",url:r.seats}).then(function(e){var n=e.data;t({type:a.FETCH_SEATS_SUCCESS,payload:{seats:n}})})["catch"](function(e){var n=e.data;t({type:a.FETCH_SEATS_ERROR,data:n})})}},quickAdd:function(t){return function(n){return n({type:a.QUICK_ADD_START}),e({method:"POST",url:r.quickAdd,data:{seats:t}}).then(function(e){var t=e.data,r=o.normalize(s.postSeats,t).seats,i=R.pathOr([],["ssrs"],o.normalize(s.postSsr,t));n({type:a.QUICK_ADD_SUCCESS,payload:{seats:r},meta:{analytics:{event:"rynProductTrack",action:"QUICK_ADD",type:E.SEAT,identity:"seats"}}});var u=p.get("PromotionActions");return n(u.productAddedNotification({productAdded:E.SEAT})),n({type:S.ADD_ALL_SUCCESS,payload:{priority:i}}),t.reduce(function(e,t){return e&&t.segSeats.every(function(e){return"OK"===e.status})},!0)})["catch"](function(){n({type:a.QUICK_ADD_ERROR})})}},addSuggestedSeats:function(t){return function(n){return n({type:a.ADD_SUGGESTED_SEATS_START}),e({method:"POST",url:r.seats,data:t}).then(function(e){var t=e.data,r=o.normalize(s.postSeats,t).seats;n({type:a.ADD_SUGGESTED_SEATS_SUCCESS,payload:{seats:r},meta:{analytics:{event:"rynProductTrack",action:"SUGGESTED_SEATS",type:E.SEAT,identity:"seats"}}});var i=p.get("PromotionActions");n(i.productAddedNotification({productAdded:E.SEAT}))})["catch"](function(){n({type:a.ADD_SUGGESTED_SEATS_ERROR})})}},selectSeat:function(e){return{type:a.SELECT_SEAT,payload:{seats:[].concat(e)}}},selectPreviousSeat:function(e){return{type:a.SELECT_PREVIOUS_SEAT,payload:{seat:e}}},unselectSeat:function(e){return{type:a.UNSELECT_SEAT,payload:{seats:[].concat(e)}}},confirmSeats:function(t){return function(n,i){var S=i(),d=S.bookingModel,l=S.changeFlight,A=R.prop("changed",l),_=R.prop("originalFlightData",l),T=c.byModel({sold:!1})(t),f=function(e){return R.pipe(c.byKey(babelHelpers["extends"]({},e.key)),c.byModel({code:e.model.code,sold:!0}),c.hasAny)(_.seats)};A&&R.all(f,T)&&(T=[]);var C=T.map(function(e){return{paxNum:e.key.passengers,journeyNum:e.key.journeys,segmentNum:e.key.segments,designator:e.removed?"":e.model.code}});return n({type:a.CONFIRM_SEATS_START}),e({method:"POST",url:r.seats,data:C}).then(function(e){var t=e.data,r=R.pipe(R.propOr([],"seats"),R.filter(function(e){return""!==e.model.code}))(o.normalize(s.postSeats,t)),i=R.path(["key","segments"],R.head(r)),S=R.path(["key","journeys"],R.head(r)),y=R.pipe(c.byModel({sold:!0}),u.getSeatItemsByJourneyAndSegment(S,i))(d.seats),l=R.filter(function(e){return e.removed},y).length,A=l>=r.length?r.length:0,_=R.filter(function(e){return!R.equals(e.key.journeys,S)||!R.equals(e.key.segments,i)})(d.seats);n({type:a.CONFIRM_SEATS_SUCCESS,payload:{seats:[].concat(babelHelpers.toConsumableArray(r),babelHelpers.toConsumableArray(y),babelHelpers.toConsumableArray(_))},meta:{analytics:{event:"rynProductTrack",action:"UPDATE",type:E.SEAT,identity:"seats"}}}),n({type:a.SEATS_CHANGED,seatsChanged:A});var T=p.get("PromotionActions");n(T.productAddedNotification({productAdded:E.SEAT}));var f=t.reduce(function(e,t){return e&&!R.any(R.propEq("childSeatsWithAdult",!1))(t.segSeats)},!0);return{isOk:t.reduce(function(e,t){return e&&t.segSeats.every(function(e){return"OK"===e.status})},!0),isChildSeatWarning:!f}})["catch"](function(e){var t=R.pathOr({},["data"],e),r=t.code===y.code&&e.status===y.status;return n({type:a.CONFIRM_SEATS_ERROR}),r?{error:t.code}:null})}},setDrawerCloseable:function(){return{type:a.SET_DRAWER_TO_CLOSEABLE}},setDrawerUncloseable:function(){return{type:a.SET_DRAWER_TO_UNCLOSEABLE}},reset:function(){return{type:a.RESET}},setDrawerCloseError:function(e){return{type:a.DRAWER_CLOSE_ERROR,payload:{error:e}}},ignorePrioroityPopup:function(){return{type:a.IGNORE_PRIORITY_POPUP}},noticePrioroityPopup:function(){return{type:a.NOTICE_PRIORITY_POPUP}},resetSeatsChanged:l,clearAllSeats:function(n){return function(u,S){var y=S(),p=y.bookingModel,A=[],_=i.getPaxWhoNeedMandatorySeats(p).map(function(e){return e.key.id}),T=p.segments,f=p.passengers,C=i.isPotentialBooking(p);return T.forEach(function(e){var t=i.isBusinessPlusLeg(p,e.key.journeys),a=i.isLeisurePlusLeg(p,e.key.journeys);f.forEach(function(r){var o=i.getSeatByKey({passengers:r.key.id,journeys:e.key.journeys,segments:e.key.id})(p),s=o&&R.is(Number,n)&&e.key.journeys!==n;if(R.pathOr(!1,["model","sold"],o)!==!0){var u=(t||a||_.indexOf(r.key.id)>=0)&&C;A.push({paxNum:r.key.id,journeyNum:e.key.journeys,segmentNum:e.key.id,designator:u||s?o.model.code:""})}})}),R.isEmpty(A)?void 0:(u({type:a.CLEAR_ALL_SEATS_START}),e({method:"POST",url:r.seats,data:A}).then(function(e){var t=e.data,n=o.normalize(s.postSeats,t).seats.filter(function(e){return""!==e.model.code}),r=c.byModel({sold:!0})(p.seats);return u({type:a.CLEAR_ALL_SEATS_SUCCESS,payload:{seats:[].concat(babelHelpers.toConsumableArray(r),babelHelpers.toConsumableArray(n))},meta:{analytics:{event:"rynProductTrack",action:"REMOVE",type:E.SEAT,identity:"seats"}}}),u(l()),t.reduce(function(e,t){return e&&t.segSeats.every(function(e){return"OK"===e.status})},!0)})["catch"](function(e){var n=R.pathOr({},["data"],e),r="ChangeSeatFlowError"===n.code&&"ChangeSeatFlowError"===n.message&&412===e.status;r?(u({type:a.RESET_CHANGE_SEAT_STATE}),u(l()),u(d.refresh("home",!0,!0)).then(function(){"booking.active"!==t.current.name&&t.go("booking.active",{},{reload:!0})})):u({type:a.CLEAR_ALL_SEATS_ERROR})}))}},setSteps:function(e){return{type:a.SET_STEPS,payload:{steps:e}}},setCurrentStep:function(e){return function(t,n){var r={},o={step:e};"seats.confirm"===e&&(r={analytics:{event:"rynChangeSeatView"}},o=babelHelpers["extends"]({},o,{seats:R.pipe(c.byIdentity("seats"),c.byModel({sold:!1}))(n().bookingModel)})),t({type:a.SET_STEP,payload:o,meta:r})}},setMoneySavedOnChildSeats:function(e){return{type:a.SET_MONEY_SAVED_ON_CHILD_SEATS,payload:{moneySavedOnChildSeats:e}}},retrieveAircraftMaps:function(t){return function(o,s){var i=s(),u=i.bookingModel,S=t||u.journeys;o({type:a.GET_AIRCRAFT_MAP_START}),n.all(R.pipe(c.byIdentity("segments"),c.byBelongsToAny(S),R.map(R.path(["model","aircraft"])),R.uniq,R.map(function(t){return e.get(r.seatMap,{params:{aircraftModel:t,cache:!0}})}))(u)).then(function(e){o({type:a.GET_AIRCRAFT_MAP_SUCCESS,payload:R.pipe(R.pluck("data"),R.map(R.head))(e)})})["catch"](function(){o({type:a.GET_AIRCRAFT_MAP_ERROR})})}},resetAircraftSeatMap:function(){return{type:a.RESET_AIRCRAFT_SEAT_MAP}},setChangeSeatsMode:function(e,t){return function(n,r){var o=!1;if(t){var s=R.pipe(c.byModel({sold:!1,type:E.SEAT}),c.byRemoved(!1),R.length,R.lt(0))(r().bookingModel.seats);o=s?!0:e}else o=e;n({type:a.SET_CHANGE_SEATS_MODE,payload:o})}},openChangeSeatsModal:function(e){return function(n){n({type:a.SET_CHANGE_SEATS_ENGAGED_FROM_CHECKIN,payload:e}),t.go("booking.active.seats-change")}},changeSeatsEngagedFromCheckin:function(e){return{type:a.SET_CHANGE_SEATS_ENGAGED_FROM_CHECKIN,payload:e}},setSeatSelectedForChange:function(e){return{type:a.SET_SEAT_SELECTED_FOR_CHANGE,payload:e}},changeSeatsConfirmed:function(e){return{type:a.CHANGE_SEATS_CHANGE_CONFIRMED,payload:e}},resetAfterChangeSeat:function(){return{type:a.RESET_AFTER_CHANGE_SEAT}},resetChangeSeatPriority:function(){return{type:a.CHANGED_SEAT_RESET_PRIORITY_SUCCESS}},clearUnconfirmedSeatChange:function(){return function(e,t){var n=R.pipe(c.byModel({sold:!0}),R.map(function(e){return{key:e.key,model:e.model,identity:e.identity}}))(t().bookingModel.seats);e({type:a.CLEAR_UNCONFIRMED_SEAT_CHANGE,payload:n})}},resetChangeSeatsState:function(){return{type:a.RESET_CHANGE_SEAT_STATE}},resetToChangedState:function(){return function(e,t){var n=c.byLocal(!0)(t().bookingModel.seats),r=c.complement(t().bookingModel.seats)(n),o=r.map(function(e){return e.model.sold||(e.removed=!1),e});e({type:a.RESET_TO_CHANGED_STATE,payload:o})}},refreshSeatsDistances:function(){return function(e){e(d.refresh("",!1,!0))}},setChangeSeatsInfoPromptSeen:function(e){return{type:a.SET_CHANGE_SEATS_INFO_PROMPT,payload:e}},removeUnsoldSeats:function(){return{type:a.REMOVE_SEATS_SUCCESS}},changeChildSeatPromptSeen:function(e){return{type:a.CHANGE_CHILD_SEAT_PROMPT,payload:e}},setMandatorySeatsPromptSeenState:function(e){return{type:a.SET_MANDATORY_SEATS_PROMPT_SEEN_STATE,payload:e}}}}]);


"use strict";angular.module("app.booking").service("TransfersActions",["$http","ClearHttpCache","DialogManager","$state","newDialogEnabled","RezApiConfig","TRANSFERS_ACTION_TYPES","BasketMessageQueue","TotalHeaderActions","CARD_CODES","$location","$window",function(t,e,n,r,a,o,c,s,i,l,u,E){e.addUrlToState(o.transfer,"booking.home"),e.addUrlToState(o.transfer,"booking.active");var f="transfers",p=function(){return{template:a()?"/partials/extras/transfers/controller/active-transfers.html":"/partials/extras/transfers/controller/transfers.html",className:a()?"core-modal":"dialog-aside",controller:"TransfersCtrl",controllerAs:"$ctrl",closeByEscape:!u.search().fromTripOverviewDesktop}},O=function(t,e){s.enqueue({code:"TRANSFER_UPDATED",paxNum:t,price:e})},_={getTransfers:function(){return function(e){return e({type:c.FETCH_OFFERS_START}),t({url:o.transfer,method:"GET"}).then(function(t){e({type:c.FETCH_OFFERS_SUCCESS,payload:t.data})})["catch"](function(t){e({type:c.FETCH_OFFERS_FAILED,payload:t})})}},postTransfers:function(e,n){return function(r,a){return r({type:c.ADD_TO_BOOKING_MODEL_START}),t.post(o.transfer,e).then(function(t){var e=t.data.reduce(function(t,e){return t+e.qty},0),o=R.path(["transfers","totalPrice"],a());O(e,o),r(i.showExtrasInfo({totalCount:t.data.reduce(function(t,e){return t+e.qty},0),text:"trips.header.title.extras_TRANS"})),r({type:c.ADD_TO_BOOKING_MODEL_SUCCESS,payload:t.data,meta:{analytics:{event:"rynProductTrack",action:"UPDATE",type:l.TRANSFER,identity:"addons"}}}),n&&r(_.closeDialog())})["catch"](function(t){r({type:c.ADD_TO_BOOKING_MODEL_FAILED,payload:t})})}},removeAll:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!0;return function(n){return n({type:c.REMOVE_FROM_BOOKING_MODEL_START}),t["delete"](o.transfer).then(function(){n({type:c.REMOVE_FROM_BOOKING_MODEL_SUCCESS,payload:null,meta:{analytics:{event:"rynProductTrack",action:"REMOVE",type:l.TRANSFER,identity:"addons"}}}),e&&n(_.closeDialog())})["catch"](function(t){n({type:c.REMOVE_FROM_BOOKING_MODEL_FAILED,payload:t})})}},removeSome:function(e){return function(n){return n({type:c.REMOVE_FROM_BOOKING_MODEL_START}),t["delete"](o.transfer,{params:{itemId:e}}).then(function(){n({type:c.REMOVE_FROM_BOOKING_MODEL_SUCCESS,payload:e}),n(_.closeDialog())})["catch"](function(t){n({type:c.REMOVE_FROM_BOOKING_MODEL_FAILED,payload:t})})}},addSelectedOffer:function(t){return{type:c.ADD_SELECTED_OFFERS,payload:t}},removeSelectedOffer:function(t){return{type:c.REMOVE_SELECTED_OFFERS,payload:t}},openDialog:function(){return function(t){n.open(f,p(),function(t){("DialogManagerCloseAll"!==t.value||t.value!==f)&&r.go(r.current.relative||"booking.extras")}),t({type:c.OPEN_MODAL})}},closeDialog:function(){return function(t){n.close(f),t({type:c.CLOSE_MODAL})}},addTransfersPostMessage:function(t){return function(e){e({type:c.ADD_TRANSFERS_POST_MESSAGE});var n=u.protocol()+"://"+u.host();E.parent.window.postMessage({type:"SELECT_ADDON",payload:t},n)}},emitTransfersHeight:function(t){var e=u.protocol()+"://"+u.host();E.parent.window.postMessage({type:"SET_HEIGHT",payload:{iframeHeight:t}},e)},resetSelectedOffers:function(t){return function(e){e({type:c.RESET_SELECTED_OFFERS,payload:t})}},clear:function(){return function(t){t({type:c.CLEAR})}}};return _}]);


"use strict";angular.module("app.booking").service("TravelDocumentsActions",["TRAVEL_DOCUMENTS_ACTIONS_TYPES","API_PATH_V2","Session","$http","RezApiConfig","CheckinModelSelectors","$q","RezCountries","$filter","TravelDocumentsService","DocumentManager","CheckinFlow","Dates","BookingRead",function(t,e,n,o,a,r,u,c,i,s,_,T,d,p){return{getNationalities:function(){var e=function(t){return t.group=t.iseu?i("translate")("trips.contact.countries.groups.eu"):i("translate")("trips.contact.countries.groups.non-eu"),t};return function(n,o){n({type:t.GET_NATIONALITIES_START});var a=r.getNationalities(o());return R.isEmpty(a)?c.get().then(function(o){return a=o.map(e),n({type:t.GET_NATIONALITIES_SUCCESS,payload:{nationalities:a}}),a})["catch"](function(){n({type:t.GET_NATIONALITIES_ERROR})}):(n({type:t.GET_NATIONALITIES_FROM_CACHE,payload:{nationalities:a}}),u.when(a))}},getTraveldocumentRules:function(){return function(e,n){e({type:t.GET_DOCUMENTS_RULES_START});var c=r.getTraveldocumentRules(n());return R.isEmpty(c)?o.get(a.checkin.travelDocuments).then(function(n){var o=n.data;return e({type:t.GET_DOCUMENTS_RULES_SUCCESS,payload:{traveldocumentRules:o}}),o})["catch"](function(){e({type:t.GET_DOCUMENTS_RULES_ERROR})}):(e({type:t.GET_DOCUMENTS_RULES_FROM_CACHE,payload:{traveldocumentRules:c}}),u.when(c))}},getCustumersDocuments:function(a,r){return function(c){var i={params:{firstName:a,lastName:r}};return c({type:t.GET_CUSTOMER_DOCUMENTS_START}),n.getAuthenticated()?o.get(e+"/customers/"+n.getClientId()+"/passengers",i).then(function(e){var n=e.data,o=R.pathOr(null,[0],n),a=o.documents.map(function(t){return{docNumber:t.maskedNumber,docType:t.type,countryOfIssue:t.countryOfIssueCode,documentId:t.id,nationality:t.nationalityCountryCode}});return c({type:t.GET_CUSTOMER_DOCUMENTS_SUCCESS,payload:{customerDocuments:a,birthDate:o.dateOfBirth?d.parseISO(new Date(o.dateOfBirth).toISOString()):void 0,nationality:o.nationalityCountryCode,isCompanion:o.companion,passengerId:o.passengerId}}),o})["catch"](function(e){c({type:t.GET_TRAVEL_DOCUMENTS_ERROR,payload:{err:e}})}):(c({type:t.GET_CUSTOMER_DOCUMENTS_SUCCESS,payload:{customerDocuments:[]}}),u.when([]))}},selectCustumerDocument:function(e){return function(n){n({type:t.SELECT_CUSTOMER_DOCUMENT,payload:{doc:e}})}},setCurrentDocIndex:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function(o,a){o({type:t.SET_CURRENT_DOC_INDEX,payload:{index:T.getCurrentDocIndex(e,n,a())}})}},updateCurrentDoc:function(e){return function(n){n({type:t.UPDATE_CURRENT_DOC,payload:{doc:e}})}},updateParentDoc:function(e){return function(n){n({type:t.UPDATE_PARENT_DOC,payload:{doc:e}})}},saveDocToMyRyanair:function(e,n,o){return function(a){var r={number:e.docNumber,type:e.docType,countryOfIssueCode:e.countryOfIssue,documentId:e.documentId,nationalityCountryCode:e.nationality,expiryDate:e.expiryDate};return a({type:t.SAVE_DOC_TO_MYRYANAIR_START}),_.create(r,n,o).then(function(e){var n=e.data;return a({type:t.SAVE_DOC_TO_MYRYANAIR_SUCCESS,payload:{customerDocuments:n}}),n})["catch"](function(e){a({type:t.SAVE_DOC_TO_MYRYANAIR_ERROR,payload:{err:e}})})}},saveDocumentInBooking:function(){return function(e,n){e({type:t.ADD_TO_BOOKING_MODEL_START});var c=n(),i=r.getTravelDocumentsList(c),_=r.getCurrentDocIndex(c),T=r.getCurrentPax(c),d=s.saveTravelDocumentsPayload(i,_,T,p.isDomestic(c.bookingModel),R.pathOr([],["checkin","nationalities"],c));return o.post(a.checkin.saveTravelDocuments,d).then(function(n){var o=n.data;return e({type:t.ADD_TO_BOOKING_MODEL_SUCCESS,payload:{documents:o}}),o})["catch"](function(n){return e({type:t.ADD_TO_BOOKING_MODEL_ERROR,payload:{err:n}}),u.reject(n)})}},saveSingleDocument:function(e,n){return function(r,u){r({type:t.ADD_TO_BOOKING_MODEL_START});var c=u(),i=R.pathSatisfies(Boolean,["bookingModel","info","0","model","domestic"],c),_=s.saveTravelDocumentsPayload(e,e.length-1,n,i,R.pathOr([],["checkin","nationalities"],c));return o.post(a.checkin.saveTravelDocuments,_).then(function(e){var n=e.data;return r({type:t.ADD_TO_BOOKING_MODEL_SUCCESS,payload:{documents:n}}),n})["catch"](function(e){return r({type:t.ADD_TO_BOOKING_MODEL_ERROR,payload:{err:e}}),e})}},setShowAddedDocument:function(e){return function(n){n({type:t.SET_SHOW_ADDED_DOCUMENT,payload:{showAddedDocument:e}})}}}}]);


"use strict";angular.module("app.booking").component("bagSelection",{templateUrl:"/partials/booking/components/bags/bags.html",bindings:{confirmDialog:"&?",closeDialog:"&?",passengers:"<",journeys:"<",booking:"<",bagsStore:"<",extras:"<",isMobile:"<",isActiveTrip:"<",initCompleted:"<",onBagAdd:"&",onBagRemove:"&",onUpgradeAdd:"&",onUpgradeRemove:"&"},controller:["AEMConfig","CARD_CODES","BookingRead",function(n,e,o){var i=this,r=n.getStaticFilePrefix(),t=R.once(function(n){var o=n.extras;i.minPrice=R.pipe(R.filter(R.whereEq({code:e.BAGS})),R.head,R.propOr(0,"minPrice"))(o)}),a={plus:"plus",mixed:"mixed"},s={outbound:"outbound",inbound:"inbound",both:"both"},u=function(n){return R.pipe(R.propOr([],"journeys"),R.reduce(function(e,i){var r=i.key.id,t=!!e.includedFor,u=o.isLeisurePlusLeg(n,r);return u&&!t?{fareType:a.plus,includedFor:r?s.inbound:s.outbound}:u&&t?{fareType:e.fareType.plus?a.plus:a.mixed,includedFor:s.both}:e},{fareType:"",includedFor:""}))(n)};this.bagAdd=function(n){return i.onBagAdd({$event:n})},this.bagRemove=function(n){return i.onBagRemove({$event:n})},this.upgradeAdd=function(n){return i.onUpgradeAdd({$event:n})},this.upgradeRemove=function(n){return i.onUpgradeRemove({$event:n})},this.$onInit=function(){i.isConnectingFlight=o.isConnectingFlight(i.booking),i.zoneDiscount=R.path(["pct"],o.getZoneDiscountFor(0,i.booking)),i.bagsBannerBackgroundAT=r+"/resources/ui/img/overlay/banners/bags/bags-banner-active-trip",i.bagsBannerBackgroundPT=r+"/resources/ui/img/overlay/banners/bags/bags-banner-potential-trip",i.hasPlus=o.hasLeisurePlus(i.booking),i.hasIncludedBags=o.hasIncludedBags(i.booking),i.hasSpanishDiscount=o.hasSpanishDiscount(i.booking),i.hasAlertInfoMessage=i.hasPlus||i.hasSpanishDiscount,i.tranlations=u(i.booking)},this.$onChanges=function(n){var e=n.extras;R.not(R.isNil(R.prop("currentValue",e)))&&R.not(i.isActiveTrip)&&t({extras:e.currentValue})}}]});


"use strict";angular.module("app.booking").component("changeDocumentFormElement",{bindings:{passenger:"<",titles:"<",isOpened:"<",onTabToggle:"&",euOnlySegments:"<",index:"<"},templateUrl:"/partials/booking/components/change-document/change-document-form-element.html",controller:["Dates","$scope","$ngRedux","CheckinModelSelectors","TravelDocumentsService","TravelDocumentsActions","BookingRead","$element","Device","$timeout","smoothScroll",function(e,t,n,o,i,a,s,c,r,l,u){var m=this;this.pax=R.clone(this.passenger),this.sId=t.$id,this.initDob=R.pathOr(null,["pax","inf","dob"],this),this.nameLength={min:2,max:32},this.infantDocument={},this.isLoading=!1,this.paxObject=babelHelpers["extends"]({},this.pax,this.pax.model),this.paxObject.inf&&(this.infantName="+ "+this.paxObject.inf.first+" "+this.paxObject.inf.last,this.infantObject=babelHelpers["extends"]({},this.pax.inf,{type:"INF",model:{type:"INF"}}));var d=function(e){return{documentError:e.checkin.documentError,travelDocumentsList:o.getTravelDocumentsList(e),travelDocumentRules:o.getTraveldocumentRules(e),bookingModel:e.bookingModel,currentPax:m.paxObject,nationalities:o.getNationalities(e),isDomestic:s.isDomestic(e.bookingModel),isReturnTrip:s.isReturnTrip(e.bookingModel)}},p=n.connect(d,a)(function(e,t){m.$state=babelHelpers["extends"]({},m.$state,e),m.$state=i.attachOneTimeComputedProps(m.$state),m.$actions={travelDocuments:t};var n=s.getTravelDocumentForPax(e,m.paxObject.key.id);n&&(m.currentDocument=n.travelDocument,n.infantTravelDocument&&(m.infantDocument=n.infantTravelDocument))}),g=function(){var e=c.find(".core-input.ng-invalid")[0];if(e){var t=r.isMobile()?85:115;l(function(){u(e,{containerId:"dialog-body-slot",offset:t,easing:"easeInQuad"})})}};this.formIsValid=function(){return m.paxDocChangeForm.$valid},this.$onChanges=function(e){R.path(["passenger","currentValue"],e)&&(m.pax=R.clone(e.passenger.currentValue))},this.$onDestroy=p,this.onToggle=function(){m.onTabToggle({index:m.index})},this.onInfantDocumentUpdate=function(e){m.infantDocument=e},this.onParentDocumentUpdate=function(e){m.currentDocument=e},this.saveDocument=function(){if(m.paxDocChangeForm.pax["$ctrl.documentForm"].$setSubmitted(),m.infantObject&&m.paxDocChangeForm.infant["$ctrl.documentForm"].$setSubmitted(),m.formIsValid()){m.isLoading=!0;var e=[{model:m.currentDocument}],t=m.paxObject;m.paxObject.inf&&(e.push({model:m.infantDocument}),t=babelHelpers["extends"]({},m.infantObject,{key:{id:m.paxObject.key.id}})),m.$actions.travelDocuments.saveSingleDocument(e,t)["finally"](function(){m.isLoading=!1,m.paxDocChangeForm.$setPristine(),m.onToggle()})}else g()}}]});


"use strict";angular.module("app.booking").component("changeDocumentForm",{templateUrl:"/partials/booking/components/change-document/change-document-form.html",controller:["$ngRedux","BookingRead","BookingReadCheckin","Passengers","TravelDocumentsActions","$element","$timeout","smoothScroll","Device","Stations",function(e,n,t,o,s,i,a,c,r,u){var l=this,g=function(e){return{bookingModel:e.bookingModel,passengers:n.get("passengers",e.bookingModel)}},d=e.connect(g,s)(function(e,n){l.$state=babelHelpers["extends"]({},l.$state,e),l.$actions=babelHelpers["extends"]({},l.$actions,n),l.checkedInPassengers=l.$state.passengers.filter(function(e){return t.isPaxCheckedInForAnyJourney(e,l.$state.bookingModel)})}),m=function(e){var n=i.find("#change-document-form-"+e)[0],t=r.isMobile()?45:80;a(function(){c(n,{containerId:"dialog-body-slot",offset:t,easing:"easeInQuad"})},0)};o.getTitles().then(function(e){l.titles=e.data}),this.$actions.getNationalities().then(function(e){l.euOnlySegments=n.euSegmentsOnly(l.$state.bookingModel,e,u.get("stations"))}),this.$actions.getTraveldocumentRules(),this.preOpened=function(e,n){return!R.equals(e,n)},this.tabsOpened=this.$state.passengers.map(function(){return!1}),this.onTabToggle=function(e){l.tabsOpened=l.tabsOpened.map(function(n,t){return t!==e||n?!1:(m(t),!0)})},this.$onDestroy=function(){d()}}]});


"use strict";angular.module("app.booking").component("changeNameFormElement",{bindings:{passenger:"<",titles:"<",index:"<",isOpen:"<",onUpdate:"&",onFormClose:"&",isValidName:"<"},templateUrl:"/partials/booking/components/change-name/change-name-form-element.html",controller:["Dates","$scope",function(n,e){var a=this;this.pax=R.clone(this.passenger),this.sId=e.$id,this.initDob=R.pathOr(null,["pax","inf","dob"],this),this.nameLength={min:2,max:32},this.updatePax=function(){a.onUpdate({pax:a.pax,index:a.index,isValid:a.isValidName})},this.validInfantDob=function(){return a.initDob?n.parse(a.initDob).isValid():!1},this.formIsValid=function(){return a.paxNameChange.$valid},this.dateOfBirthRange={min:n.formatISO(n.now.subtract(2,"years")),max:n.formatISO(n.now.subtract(0,"years"))},this.validateDateOfBirth=function(n){return"Invalid date"!==n?(a.paxNameChange.$setValidity("dobInvalid",!0),n):a.paxNameChange.$setValidity("dobInvalid",!1)},this.$onChanges=function(n){R.path(["passenger","currentValue"],n)&&(a.pax=R.clone(n.passenger.currentValue))},this.onToggle=function(n){n||a.onFormClose({index:a.index,isInfant:!1})},this.onInfToggle=function(n){n||a.onFormClose({index:a.index,isInfant:!0})}}]});


"use strict";angular.module("app.booking").component("changeNameForm",{templateUrl:"/partials/booking/components/change-name/change-name-form.html",controller:["$ngRedux","NameChangeActions","Passengers",function(e,n,a){var o=this,t=function(e){return{areNewChangeNameRulesEnabled:e.launchDarkly["manage-hub-new-name-change-rules-dark"],bookingModel:e.bookingModel,nameChange:e.nameChange,isLoading:R.pathOr(!1,["isLoading"],e.nameChange),showInfoSection:R.pathOr(!1,["showInfoSection"],e.nameChange),changeNamePrice:R.pathOr(0,[0,"fee"],e.nameChange.fees),minorChange:R.pathOr({},["minorChange"],e.nameChange),isGroupBooking:R.pathOr(!1,["isGroupBooking"],e.nameChange),groupBookingChange:R.pathOr({},["groupBookingChange"],e.nameChange),gracePeriodChange:R.pathOr({},["gracePeriodChange"],e.nameChange),price:R.pathOr(0,["price"],e.nameChange),passengers:R.pipe(R.pathOr({},["nameChange","curPax"]),R.clone)(e)}},g=e.connect(t,null)(this);e.dispatch(n.setupChangeNameModel(this.bookingModel)),this.onPassengerUpdate=function(a,t,g){var h=R.update(t,a,o.passengers);Object.assign(o.passengers,h);var r=!R.equals(o.nameChange.origPax,o.passengers);e.dispatch(n.registerPaxChange(t,a,r,g)),e.dispatch(n.setNameChangeBtnType("check_price"))},this.onChangeNameFormClose=function(a,o){e.dispatch(n.resetPaxChange(a,o))},this.preOpened=function(e,n){return!R.equals(e,n)},a.getTitles().then(function(e){o.titles=e.data}),this.$onDestroy=function(){e.dispatch(n.resetBtnType()),g()}}]});


"use strict";angular.module("app.booking").component("contactDetailsForm",{templateUrl:"/partials/booking/components/contact-details-form/contact-details-form.html",bindings:{contact:"<",customOptions:"<",hasAccount:"<",toggleSms:"<",onToggleSms:"&",onUpdateValue:"&",smsFee:"<",operatedBy:"<",coFee:"<",ispccFee:"<",onToggleCo:"&",onToggleIspcc:"&",isPotentialHoldFare:"<?",payment:"<"},require:{form:"^form"},controller:["Countries","PhoneNumber","AEMConfig","MarketConfig","FEATURE_CONFIG","$ngRedux",function(e,n,t,a,o,i){var c=this;this.$onChanges=function(e){e.contact&&(c.contact=R.clone(c.contact),c.donateCo=R.pathOr(!1,["contact","currentValue","donateCO"],e),c.donateIspcc=R.pathOr(!1,["contact","currentValue","donateISPCC"],e)),!c.ispccFee&&c.coFee&&c.donateIspcc&&c.onToggleIspcc(),e.ispccFee&&(c.isIspccEnabled=R.pathOr(!1,["ispcc-charity-enabled"],o)&&c.ispccFee)},this.isGerman="de-de"===a.getCulture(),this.donateCo=!1,this.donateIspcc=!1;var s=function(){e.get().then(function(){c.countryPhoneCode=n.getCountryPhoneCode(c.contact.phoneNumber)})},r=function(){c.displayEmailView=!R.isNil(R.pathOr(null,["emailAddress"],c.contact)),c.displayPhoneView=!R.isEmpty(R.pathOr("",["phoneNumber","number"],c.contact)),c.displayPhoneView&&s()};this.changeEmail=function(){c.displayEmailView=!1},this.changePhoneNumber=function(){c.displayPhoneView=!1},this.handlePhoneNumberUpdate=function(e){c.onUpdateValue({$event:{phoneNumber:e}})};var l=function(e){var n=e.launchDarkly;return{$state:{isChangeEmailEnabled:R.pathEq(["change-email-enabled"],!0,n)}}};this.$onInit=function(){r(),i.connect(l,null)(function(e){Object.assign(c,e)}),c.options=R.merge({sendSms:!1,sendOffers:!1,smsFee:0,fistName:!1,lastName:!1,firstNameLabel:"trips.contact.first_name",lastNameLabel:"trips.contact.last_name",emailLabel:"trips.contact.email_address",confirmEmailLabel:"trips.contact.confirm_email",nameMinNumberOfChars:2,nameMaxNumberOfChars:32},c.customOptions),c.staticFilePrefix=t.getStaticFilePrefix(),c.myRyanairLogos=["","@2x"].map(function(e){return c.staticFilePrefix+"/resources/ui/illustrations/myryanair/myRyanairNew_OnWhite"+e+".png"}).join(","),c.isSendSmsVisible=function(){return c.options.sendSms&&!c.isPotentialHoldFare},c.isCoDonationVisible=function(){return c.options.carbonOffsetDonationEnabled&&!c.isPotentialHoldFare}}}]});


"use strict";angular.module("app.booking").component("flightsTableFares",{templateUrl:"/partials/booking/components/flights-table/flights-table-fares.html",bindings:{flight:"<",faresConfig:"<",onFareClick:"<",isCellSelected:"<",isFareTypeDisabled:"<",isMandatorySeatNeeded:"<",type:"<",outboundFlight:"<",childPaxCount:"<",adultPaxCount:"<",teenPaxCount:"<",passengers:"<",is20PercentDiscountEnabled:"<",isItalianMarket:"<",isLauda:"<",isPlusFareNewSsrsEnabled:"<"},controller:["FareOptions","$scope","DialogManager","FARES_ALL_BENEFITS","AllPlaces","RECOMMENDED_COUNTRIES","WEEKEND","PRODUCT_FARE_TYPES","$q","RECOMMENDED_PAX_COUNT","Dates","FEATURE_CONFIG","Basket",function(e,t,n,i,s,a,r,o,u,l,f,c,d){var h=this,g=c["family-plus-as-fare"],p=function(e){var t=e.reduce(function(e,t){return e+t.total},0),n=h.adultPaxCount+h.childPaxCount+h.teenPaxCount;return t/n},m=function(e){var t=R.path(["ADT","amount"]),n=R.sortBy(t);return n(e)},E=function(e,t,n){return R.intersection(R.pathOr([],[n,"dynamicBenefits"],e),R.pathOr([],[n,0,"includedSsrs"],t))},C=function(e,t){var n=h.isPlusFareNewSsrsEnabled?"activeBenefitsNewFare":"activeBenefits",i=R.pipe(R.pluck(n),R.mapObjIndexed(function(n,i){return R.concat(n,E(e,t,i))}))(e);return h.isPlusFareNewSsrsEnabled&&h.isConnectingFlight&&i.leisure.push("PRIORITY_BOARDING"),i};this.isLoading=!1,this.$onInit=function(){h.isConnectingFlight=h.flight.segments.length>1,h.showCabinBagsBenefit=(f.isSameOrAfter(h.flight.departTimeUTC,c.CABIN_BAG_LAUNCH_DATE)&&R.propOr(!1,"priority-boarding-and-cabin-bags-enabled",c)||h.isItalianMarket)&&!h.isConnectingFlight,h.fares=[],h.isLoading=!0,e.getFareOptions({flightKey:R.path(["flight","flightKey"],h),fareKey:R.path(["flight","fares",0,"fareKey"],h),type:h.type,passengers:h.passengers},h.outboundFlight).then(function(e){var t={leisure:e.filter(function(e){return"SURE"===e.code}),family:e.filter(function(e){return"FAMI"===e.code}),business:e.filter(function(e){return"PLUS"===e.code})};h.fares=h.flight.fares.map(function(e){if("regular"===e.type)return e;var n=angular.merge({},h.flight.fares[0],e),i=void 0;return i=e.type===o.FAMILY&&g?p(t.family):t[e.type].reduce(function(e,t){return e+t.total},0),h.isRecommendedFare(e.type).then(function(e){n.isRecommended=e}),n.ADT.amount+=i,n.ADT.publishedFare+=i,n.ADT.upgradePercentageDiscount=R.path([e.type,0,"percentageDiscount"],t),n.ADT.upgradeTotalDiscount=R.path([e.type,0,"totalDiscount"],t),n.fareOption=R.path([e.type,0,"code"],t),n}),h.fares=m(h.fares),h.activeBenefits=C(h.faresConfig,t),h.isLoading=!1})["catch"](function(){h.isLoading=!1})},this.shouldShowRefundNote=d.hasFareFootnote(),this.showFreeSeatChildren=this.childPaxCount>0,this.getRefundNote=function(t){return e.fareRefundFootnote(t)},this.getBenefits=function(e){return e===o.LEISURE&&(h.isPlusFareNewSsrsEnabled?(i[e].SEAT.connecting_flight_desc="trips.flight_list_table.benefits.seat",i[e].SEAT.desc="trips.flight_list_table.benefits.seat"):delete i[e].SMALL_CABIN_BAG),i[e]},this.familyShortBenefitChildren=function(e){return h.childPaxCount>0&&e===o.FAMILY?"_free_children_seats":""},this.isBenefitVisible=function(e,t){switch(e){case"SMALL_CABIN_BAG":return h.showCabinBagsBenefit;case"REFUND_NOTE":return h.shouldShowRefundNote;case"FREE_SEAT_CHILDREN":return h.showFreeSeatChildren;case"SEAT":return!h.showFreeSeatChildren||t!==o.FAMILY;default:return!0}},this.showIncludedSmallBagMessaging=function(e){return h.showCabinBagsBenefit&&"standard"===h.faresConfig[e.type].code},this.isBenefitActive=function(e,t){return h.activeBenefits[e].indexOf(t)>-1||h.shouldShowRefundNote&&"REFUND_NOTE"===t||"SMALL_CABIN_BAG"===t},this.isRecommendedFare=function(e){switch(e){case o.LEISURE:return h.isBusinessFareRecommended().then(function(e){if(e)return u.resolve(!1);var t=h.passengers.ADT+h.passengers.INF+h.passengers.TEEN+h.passengers.CHD;if(0===h.childPaxCount||l>t)return u.resolve(!1);if(!h.flight.inboundDate)return u.resolve(!1);var n=h.flight.inboundDate.day(),i=h.flight.outboundDate.day();if(-1===r.indexOf(n)&&-1===r.indexOf(i))return u.resolve(!1);var s=f.duration(h.flight.outboundDate,h.flight.inboundDate).asDays(),a=f.duration(f.now,h.flight.outboundDate).asDays();return s>3||a>21?u.resolve(!0):u.resolve(!1)});case o.BUSINESS:return h.isBusinessFareRecommended();default:return u.resolve(!1)}},this.isBusinessFareRecommended=function(){return s.get().then(function(e){return h.flight.segments.some(function(t){var n=e.allPlaces.find(function(e){return e.iataCode===t.origin}),i=e.allPlaces.find(function(e){return e.iataCode===t.destination});return a.indexOf(n.countryCode)>-1&&a.indexOf(i.countryCode)>-1})})},this.showCompareFaresPopup=function(){n.open("compareFaresPopup",{template:"/partials/booking/templates/compare-fares-popup.html",className:"compare-fares-popup dialog",scope:t})},this.displayDiscountRibbon=function(e){return h.is20PercentDiscountEnabled&&R.pathEq(["ADT","upgradePercentageDiscount"],20,e)},this.displayIsRecommended=function(e){return e.isRecommended&&!h.displayDiscountRibbon(e)}}]});


"use strict";angular.module("app.booking").component("flightsTableHeader",{templateUrl:"/partials/booking/components/flights-table/flights-table-header.html",bindings:{flight:"<",fares:"<",departure:"<",destination:"<",flightOpened:"<",selectedFareType:"<",faresConfiguration:"<",fareSelected:"<",type:"@",faresSsr:"<",onSelectFare:"&",onChangeFare:"&",freeMoveFlights:"<",isReturnTrip:"<",originalFlight:"<?",changeFlightType:"<",isMandatorySeatNeeded:"<",childPaxCount:"<",adultPaxCount:"<",teenPaxCount:"<",changeFlightState:"<",isLauda:"<"},controller:["Device","ChangeFlightDataStorage","LEG_TYPE","Stations","Dates","ngFolktale","DialogManager","FEATURE_CONFIG",function(e,t,a,i,r,n,o,s){var l=this,h=s["family-plus-as-fare"],u=e.onPhone(function(e){l.isMobile=e.matches});this.isTouch=function(){return e.isTouch()};var f=e.onLaptopAndAbove(function(e){l.onLaptopAndAbove=e.matches});this.connectionTime=R.path(["flight","segments","length"],this)>1?n.Either.of(R.path(["segments","length"],this.flight)).chain(function(e){return e?n.Either.Right(e):n.Either.Left(0)}).map(function(){return[R.path(["segments","1","timeUTC","0"],l.flight),R.path(["segments","0","timeUTC","1"],l.flight)]}).map(function(e){return e.map(r.utc)}).fold(function(){},function(e){return e[0].subtract(e[1])}):this.flight.duration,this.$onChanges=function(e){var t=e.selectedFareType,a=void 0===t?{}:t;a.currentValue&&l.fareSelected?l.fare=R.pathOr([],["fares"],l).find(function(e){return e.type===a.currentValue}):l.fareSelected||(l.fare=R.pathOr([],["fares"],l).find(function(e){return l.faresConfiguration[e.type].isVisible})),"family"!==a.currentValue||h||(l.selectedFareType="regular",l.fare=R.pathOr([],["fares"],l).find(function(e){return"regular"===e.type})),l.changeFlightType&&l.faresSsr&&0!==l.flight.faresLeft&&(l.fare=angular.merge({},l.fares[0],l.fare),l.fare.ADT.amount+=parseFloat(l.faresSsr.total),l.fare.ADT.publishedFare+=parseFloat(l.faresSsr.total),l.fare.fareOption=l.faresSsr.code)},this.isFreeMove=function(){var e=!1;return"inbound"===l.type?e=l.freeMoveFlights[a.inbound]:"outbound"===l.type&&(e=l.freeMoveFlights[a.outbound]),e},this.isFreeMoveOnDisrupt=function(){var e=l.isReturnTrip&&R.path(["changeFlightState","originalFlightData","journeys"],l).some(function(e){return R.path(["model","changeInfo","isChanged"],e)})&&"RoundTrip"===l.changeFlightType;return e};var g=function(){var e="outbound"===l.type?0:1,t=l.changeFlightState.availableFlights[e];return R.path(["journey","model","isCancelled"],t)};switch(this.showFreeMoveTooltip=function(){return g()&&l.isFreeMove()&&l.isReturnTrip},this.getFreeMoveRangePopupMessage=function(e){var t="";return l.showFreeMoveTooltip()&&(t=e.freeMoveRange?"trips.flight_list_table.warning_box.inside_free_move_range":"trips.flight_list_table.warning_box.outside_free_move_range"),t},this.$onDestroy=function(){u(),f()},this.openDetails=function(){return o.open("flightDetailsPopup",{template:"/partials/booking/templates/flight-search.trip-details.html",className:"flight-details-popup dialog",data:Object.assign({},{fromTable:!0,type:l.type,flights:l.flight,fromCity:l.departure,toCity:l.destination})})},this.carrierCode=R.cond([[R.startsWith("OE"),R.always("lm")],[R.startsWith("AL"),R.always("al")],[R.T,R.always("fr")]])(R.path(["flight","segments","0","flightNumber"],this)),this.carrierCode){case"lm":return void(this.iconId="lauda-logo-red");case"al":return void(this.iconId="malta-air-red");default:this.iconId="ryanair-logo-blue"}}]});


"use strict";angular.module("app.booking").component("flightsTableMixedFareToast",{templateUrl:"/partials/booking/components/flights-table/flights-table-mixed-fare-toast.html",bindings:{onClose:"&"},controller:["AEMConfig",function(e){var t=this;this.mixedFareBannerImage=e.getStaticFilePrefix()+"/resources/ui/img/banner/mixed_fares",this.close=function(){t.onClose()}}]});


"use strict";angular.module("app.booking").component("flightsTablePrice",{templateUrl:"/partials/booking/components/flights-table/flights-table-price.html",bindings:{flight:"<",fare:"<",selectedFareType:"<",faresConfiguration:"<",inHeader:"<",fareSelected:"<",onSelectFare:"&",onChangeFare:"&",originalFlight:"<?",isMandatorySeatNeeded:"<",childPaxCount:"<",adultPaxCount:"<",teenPaxCount:"<",isChoosingFare:"<",is20PercentDiscountEnabled:"<",isLauda:"<"},controller:["PRODUCT_FARE_TYPES",function(e){var a=this;this.$onInit=function(){if(a.mandatorySeatsTooltip=!1,a.isMandatorySeatNeeded&&(a.mandatorySeatsForAdults=Math.ceil((a.childPaxCount||0)/4),a.mandatorySeatsForAdults>a.adultPaxCount&&(a.mandatorySeatsForAdults=a.adultPaxCount)),a.isFareTypeRegularOrFamily=R.or(R.pathEq(["fare","type"],e.REGULAR,a),R.pathEq(["fare","type"],e.FAMILY,a)),a.originalFlightPrice=R.propOr(0,"total",a.originalFlight),a.isFreeMove=R.pathOr(!1,["freeMoveRange"],a.fare),a.fareDifference=R.pathOr(0,["ADT","amount"],a.fare)-a.originalFlightPrice-R.propOr(0,"bundlePrice",a.originalFlight),a.isFareDifferenceVisible=a.originalFlight&&a.fareDifference>0&&!a.isFreeMove,a.display20PercentDiscount=a.is20PercentDiscountEnabled&&R.pathEq(["fare","type"],"business",a)&&R.pathEq(["fare","ADT","upgradePercentageDiscount"],20,a)&&a.isChoosingFare,a.priceBefore20PercentDiscount=R.pathOr(0,["ADT","amount"],a.fare)+R.pathOr(0,["ADT","upgradeTotalDiscount"],a.fare),a.userHasDiscount=R.pathEq(["fare","ADT","hasDiscount"],!0,a),a.displayMandatorySeats=!a.inHeader&&a.isFareTypeRegularOrFamily&&a.isMandatorySeatNeeded,a.displayOldPrice=a.userHasDiscount||R.pathEq(["fare","ADT","upgradePercentageDiscount"],20,a)||R.converge(R.subtract,[R.propOr(0,"publishedFare"),R.propOr(0,"amount")])(a.fare.ADT)>0,a.displayStrikedPrice=a.userHasDiscount||!a.display20PercentDiscount&&a.fare.ADT.publishedFare!==a.fare.ADT.amount,a.displayOldPrice){var r=R.path(["fare","ADT"],a);a.savedMoney=R.converge(R.subtract,[R.propOr(0,"publishedFare"),R.propOr(0,"amount")])(r)}}}]});


"use strict";angular.module("app.booking").component("flightsTable",{templateUrl:"/partials/booking/components/flights-table/flights-table.html",bindings:{flights:"<",departure:"<",destination:"<",selectedFlight:"<",selectedFare:"<",selectedFareType:"<?",fareUpdateDisabled:"<?",onFlightFareSelected:"&",resetLeg:"&",outboundFlight:"<",sortBy:"<",type:"@",faresSsr:"<",onChangeFare:"&",isChangeFlight:"<?",originalFlight:"<?",isErasmus:"<",isMandatorySeatNeeded:"<",hasSpanishDiscount:"<",freeMoveFlights:"<",isReturnTrip:"<",changeFlightType:"<",childPaxCount:"<",adultPaxCount:"<",teenPaxCount:"<",changeFlightState:"<",outboundDate:"<",inboundDate:"<",passengers:"<",isConnectingFlight:"<",connectingAirport:"<",is20PercentDiscountEnabled:"<",isLauda:"<"},controller:["$scope","$state","$document","FARES_CONFIG","smoothScroll","Device","AirportClosures","$timeout","DialogManager","$ngRedux","FEATURE_CONFIG","FlightSearchUtil","MarketConfig","MAX_FAMILY_PAX_COUNT","Dates","AEMConfig","LaunchDarklyService",function(e,i,t,a,n,s,r,l,o,u,g,h,c,f,d,p,F){var b=this;this.dayDiscounts="",this.mixedFareToastClosedByUser=!1,this.isMixedFareToastVisible=!1,this.$onInit=function(){b.isItalianMarket=R.equals(c.getCountry(),"it"),b.isMobile=s.isMobile(),F.changeContext({Culture:c.getCutureLDFormat(),IsMobile:b.isMobile}).then(function(){b.isPlusFareNewSsrsEnabled=R.pathOr(!1,["launchDarkly","plus-fare-new-ssrs-enabled"],u.getState())})},this.$onChanges=function(e){if(R.path(["selectedFare"],e)&&e.selectedFare.previousValue&&!e.selectedFare.currentValue&&(b.flightOpened=null,b.flightSelected=null,b.selectedFareObject=null),e.flights&&e.flights.currentValue){var i=e.flights.currentValue,t=[],a=i.length||0,n=[];i.forEach(function(e){0===e.faresLeft&&(a-=1),t=t.concat((e.discountTypes||"").split("")),e.outboundDate=b.outboundDate,e.inboundDate=b.inboundDate}),t=t.reduce(function(e,i){return e[i]=++e[i]||1,e},{}),Object.keys(t).some(function(e){return t[e]===a&&n.push(e),!1}),(1===a||1===n.length&&"r"===n[0])&&(n.length=0),b.dayDiscounts=n.sort().join("")}var s=g["mixed-fare-nudge-message"]&&g["mixed-fare-types"];!s||"inbound"!==b.type||b.isChangeFlight||b.hasSpanishDiscount||(b.isMixedFareToastVisible=!b.mixedFareToastClosedByUser&&h.isOutboundStandardFareSelected(u.getState().flightSearch)&&!b.isConnectingFlight&&!b.isErasmus)},this.isFareTypeVisibleInChangeFlight=function(e){if(!i.includes("booking.active"))return!0;switch(e){case"FAMILY":return"family"===b.selectedFareType;case"BUSINESS":return"business"===b.selectedFareType;case"LEISURE":return"leisure"===b.selectedFareType;case"REGULAR":return"regular"===b.selectedFareType;default:return!1}};var y=function(){var e=g["family-plus-as-fare"];if(!e)return!1;var i=b.adultPaxCount>0,t=b.childPaxCount>0,a=b.teenPaxCount>0,n=b.adultPaxCount+b.childPaxCount+b.teenPaxCount,s=f>=n;return s&&i&&(t||a)&&!b.connectingAirport},m=function(){var e=R.path(["family","benefits"],a),i=b.childPaxCount>0,t=i?"SEAT":"FREE_SEAT_CHILDREN",n=R.propEq("code",t),s=R.reject(n,e);return s},C="resources/ui/img/logos/PLUS/on-white-background/icon";this.faresConfig=angular.merge({},a,{regular:{isVisible:this.isFareTypeVisibleInChangeFlight("REGULAR"),showRemainingSeats:!0,img:null},leisure:{isVisible:!this.hasSpanishDiscount&&this.isFareTypeVisibleInChangeFlight("LEISURE"),img:p.getStaticFilePrefix()+"/"+C+"/PLUS.png",imgLauda:p.getStaticFilePrefix()+"/"+C+"/PLUS-Lauda.png"},business:{isVisible:!y()&&!this.hasSpanishDiscount&&this.isFareTypeVisibleInChangeFlight("BUSINESS"),img:p.getStaticFilePrefix()+"/"+C+"/flexi-PLUS.png",imgLauda:p.getStaticFilePrefix()+"/"+C+"/flexi-PLUS-Lauda.png"},family:{isVisible:y()&&!this.hasSpanishDiscount&&this.isFareTypeVisibleInChangeFlight("FAMILY"),img:p.getStaticFilePrefix()+"/"+C+"/family-PLUS.png",imgLauda:p.getStaticFilePrefix()+"/"+C+"/family-PLUS-Lauda.png"}}),this.faresConfig=R.assocPath(["family","benefits"],m(),this.faresConfig),this.singleFareAvailable=!0,this.singleFareType=!1,Object.keys(this.faresConfig).find(function(e){return b.faresConfig[e].isVisible?b.singleFareType?(b.singleFareType=!1,b.singleFareAvailable=!1,!0):(b.singleFareType=e,!1):!1}),this.showCompareFaresPopup=function(){o.open("compareFaresPopup",{template:"/partials/booking/templates/compare-fares-popup.html",className:"compare-fares-popup dialog",scope:e})},this.showItalianBagsWarning=function(e){var i=d.isSameOrAfter(e.departTimeUTC,g.CABIN_BAG_LAUNCH_DATE)&&R.propOr(!1,"priority-boarding-and-cabin-bags-enabled",g);return i||!b.isItalianMarket||b.isMobile?!1:!0},this.isFareTypeDisabled=function(e){if(!g["mixed-fare-types"]||b.isConnectingFlight){var i="outbound"===b.type?"inboundFareType":"outboundFareType",t=R.path(["flightSearch","info",i],u.getState())||b.selectedFareType;return t&&!~t.indexOf(e)&&b.fareUpdateDisabled}return!1},this.isFlightDisabled=function(e){return e.selectionDisabled||!b.isChangeFlight&&!!R.path(["infoMsg","length"],e)},this.isCellDisabled=function(e,i){return b.isFlightDisabled(e)||!i.fareKey||b.isFareTypeDisabled(i.type)},this.onFareClick=function(e,i,t,a){(!a||s.isMobile()||angular.element(a.currentTarget).hasClass("fare-select"))&&(b.isCellDisabled(e,i)?b.isFareTypeDisabled(i.type)&&(i.tooltipVisible=!0):(b.selectedFlightFares=t,b.flightSelected=e,b.onFlightFareSelected({flight:e,fare:i}),b.legFareType=i.type))},this.onFlightOpened=function(e){if(b.singleFareAvailable||b.isErasmus)b.onFareClick(e,e.fares[0],e.fares);else if(b.flightOpened!==e.flightKey){b.flightOpened=e.flightKey;var i=t[0].getElementById("flight-"+e.flightKey),a={offset:s.isMobile()?10:100};l(function(){n(i,a)},400,!1)}else b.flightOpened=null;return!0},this.isRowSelected=function(e){return e.isSelected||b.selectedFlight===e.flightKey},this.isCellSelected=function(e,i){return b.isRowSelected(e)&&b.selectedFare===i.fareKey},this.hasAlerts=function(e){return!!R.path(["infoMsg","length"],e)&&e.infoMsg.some(function(e){return e.alert})},this.hasErrors=function(e){return!!R.path(["infoMsg","length"],e)&&e.infoMsg.some(function(e){return e.error})},r.get().then(function(e){b.airportInformationCollection=e.filter(function(e){return e.iataCode===e.divertedIataCode})}),this.getAirportInformation=function(e){var i=R.pipe(R.propOr([],"segments"),R.reduce(function(e,i){var t=i.origin,a=i.destination;return e.concat([t,a])},[]))(e);return R.pipe(R.find(function(e){var t=e.iataCode;return R.contains(t,i)}),R.pathOr(!1,["messageFrom"]))(b.airportInformationCollection)},this.closeMixedFareToast=function(){b.mixedFareToastClosedByUser=!0,b.isMixedFareToastVisible=!1}}]});


"use strict";angular.module("app.booking").component("flightsTableOpsFares",{templateUrl:"/partials/booking/components/flights-table-ops/flights-table-ops-fares.html",bindings:{flight:"<",faresConfig:"<",onFareClick:"<",isCellSelected:"<",isFareTypeDisabled:"<",isMandatorySeatNeeded:"<",type:"<",outboundFlight:"<",childPaxCount:"<",adultPaxCount:"<"},controller:["FareOptions","$log","$scope","DialogManager",function(e,t,a,o){var i=this;this.isLoading=!1,this.$onInit=function(){i.fares=[],i.isLoading=!0,e.getFareOptions({flightKey:R.path(["flight","flightKey"],i),fareKey:R.path(["flight","fares",0,"fareKey"],i),type:i.type},i.outboundFlight).then(function(e){var t={leisure:e.filter(function(e){return"SURE"===e.code})[0],business:e.filter(function(e){return"PLUS"===e.code})[0]};i.fares=i.flight.fares.map(function(e){if("regular"===e.type)return e;var a=angular.merge({},i.flight.fares[0],e),o=Number.parseFloat(t[e.type].total);return a.ADT.amount+=o,a.ADT.publishedFare+=o,a.fareOption=t[e.type].code,a}),i.isLoading=!1})["catch"](function(e){t.error(e),i.isLoading=!1})},this.showCompareFaresPopup=function(){o.open("compareFaresPopup",{template:"/partials/booking/templates/compare-fares-popup.html",className:"compare-fares-popup dialog",scope:a})}}]});


"use strict";angular.module("app.booking").component("flightsTableOpsHeader",{templateUrl:"/partials/booking/components/flights-table-ops/flights-table-ops-header.html",bindings:{flight:"<",fares:"<",departure:"<",destination:"<",flightOpened:"<",selectedFareType:"<",faresConfiguration:"<",fareSelected:"<",type:"@",faresSsr:"<",onSelectFare:"&",onChangeFare:"&",freeMoveFlights:"<",isReturnTrip:"<",originalFlight:"<?",changeFlightType:"<",isMandatorySeatNeeded:"<",childPaxCount:"<",adultPaxCount:"<",changeFlightState:"<",operatedBy:"<",isLauda:"<"},controller:["Device","ChangeFlightDataStorage","LEG_TYPE","Stations","Dates","ngFolktale","DialogManager","AirMaltaFlightSelect","AIRLINE_CONFIG",function(e,t,i,a,r,n,o,s,l){var f=this;this.airlineConfig=l.getAirlineConfig(this.operatedBy),this.flight.operatedBy===this.airlineConfig.airline&&(this.airMaltaFareOption=s.getFareOption(this.flight),this.airMaltaTranslations=this.airMaltaFareOption===this.airlineConfig.fareOptions.goSmart?"trips.airm.flight_list_table.fares.go_smart_fare":"trips.airm.flight_list_table.fares.go_light_fare");var h=e.onPhone(function(e){f.isMobile=e.matches});this.isTouch=function(){return e.isTouch()},this.operatedByClassname=this.operatedBy.replace(" ","-").toLowerCase();var g=e.onLaptopAndAbove(function(e){f.onLaptopAndAbove=e.matches});this.connectionTime=R.pathSatisfies(R.lt(1),["flight","segments","length"],this)?n.Either.of(R.path(["segments","length"],this.flight)).chain(function(e){return e?n.Either.Right(e):n.Either.Left(0)}).map(function(){return[R.path(["segments","1","timeUTC","0"],f.flight),R.path(["segments","0","timeUTC","1"],f.flight)]}).map(function(e){return e.map(r.utc)}).fold(function(){},function(e){return e[0].subtract(e[1])}):this.flight.duration,this.$onChanges=function(e){var t=e.selectedFareType,i=void 0===t?{}:t;i.currentValue&&f.fareSelected?f.fare=R.pathOr([],["fares"],f).find(function(e){return e.type===i.currentValue}):f.fareSelected||(f.fare=R.pathOr([],["fares"],f).find(function(e){return f.faresConfiguration[e.type].isVisible})),"family"===i.currentValue&&(f.selectedFareType="regular",f.fare=R.pathOr([],["fares"],f).find(function(e){return"regular"===e.type})),f.changeFlightType&&f.faresSsr&&0!==f.flight.faresLeft&&(f.fare=angular.merge({},f.fares[0],f.fare),f.fare.ADT.amount+=parseFloat(f.faresSsr.total),f.fare.ADT.publishedFare+=parseFloat(f.faresSsr.total),f.fare.fareOption=f.faresSsr.code)},this.isFreeMove=function(){switch(f.type){case"inbound":return f.freeMoveFlights[i.inbound];case"outbound":return f.freeMoveFlights[i.outbound];default:return!1}},this.getDayDifference=function(){var e=f.flight.arrivalTime.clone().startOf("day"),t=f.flight.departTime.clone().startOf("day");return r.diffInDays(e,t)},this.isFreeMoveOnDisrupt=function(){var e=f.isReturnTrip&&R.path(["changeFlightState","originalFlightData","journeys"],f).some(function(e){return R.path(["model","changeInfo","isChanged"],e)})&&"RoundTrip"===f.changeFlightType;return e},this.showFreeMoveTooltip=function(){var e=f.isFreeMoveOnDisrupt()||f.isFreeMove();return e},this.getFreeMoveRangePopupMessage=function(e){var t="";return f.showFreeMoveTooltip()&&(t=e.freeMoveRange?"trips.flight_list_table.warning_box.inside_free_move_range":"trips.flight_list_table.warning_box.outside_free_move_range"),t},this.$onDestroy=function(){h(),g()},this.openDetails=function(){return o.open("flightDetailsPopup",{template:"/partials/booking/templates/flight-search.trip-details.html",className:"flight-details-popup dialog",data:Object.assign({},{fromTable:!0,type:f.type,flights:f.flight,fromCity:f.departure,toCity:f.destination})})}}]});


"use strict";angular.module("app.booking").component("flightsTableOpsPrice",{templateUrl:"/partials/booking/components/flights-table-ops/flights-table-ops-price.html",bindings:{flight:"<",fare:"<",selectedFareType:"<",faresConfiguration:"<",inHeader:"<",fareIncludedSsrs:"<",fareSelected:"<",onSelectFare:"&",onChangeFare:"&",originalFlight:"<?",isMandatorySeatNeeded:"<",childPaxCount:"<",adultPaxCount:"<",isChoosingFare:"<",isLauda:"<"},controller:function(){function t(i,a,e){babelHelpers.classCallCheck(this,t),this.airlineConfig=i.getAirlineConfig(this.flight.operatedBy),this.AirMaltaHelper=a,this.DialogManager=e}return t.$inject=["AIRLINE_CONFIG","AirMaltaFlightSelect","DialogManager"],t.prototype.$onInit=function(){var t=this;this.isAirMaltaFlight=this.flight.operatedBy===this.airlineConfig.airline,this.airMaltaFareOption=this.isAirMaltaFlight&&this.AirMaltaHelper.getFareOption(this.flight),this.benefitsTooltip=!1,this.mandatorySeatsTooltip=!1,this.translation=this.getTranslation(),this.selectedFareTranslation=this.getSelectedFareTranslation(),this.fareIncludedSsrs=this.flight.operatedBy===this.airlineConfig.airline?this.getAirMaltaSsrs(this.airMaltaFareOption):this.flight.includedSsrs.ECONOMY,this.benefitsTooltipToggle=function(i){i.stopPropagation&&i.stopPropagation(),t.benefitsTooltip=!t.benefitsTooltip},this.isMandatorySeatNeeded&&(this.mandatorySeatsForAdults=Math.ceil((this.childPaxCount||0)/4),this.mandatorySeatsForAdults>this.adultPaxCount&&(this.mandatorySeatsForAdults=this.adultPaxCount)),this.fareDifference=this.originalFlight&&this.fare.ADT.amount-this.originalFlight.total},t.prototype.getTranslation=function(){return this.isAirMaltaFlight?this.getAirMaltaTranslation(this.airMaltaFareOption):"trips.flight_list_table.from"},t.prototype.getAirMaltaTranslation=function(t){return t===this.airlineConfig.fareOptions.goSmart?"trips.airm.flight_list_table.fares.go_smart_fare":"trips.airm.flight_list_table.fares.go_light_fare"},t.prototype.getSelectedFareTranslation=function(){return this.selectedFareType?this.flight.operatedBy===this.airlineConfig.airline?this.getAirMaltaTranslation(this.airMaltaFareOption):"trips.aire.flight_list_table.fares.economy_fare":"trips.flight_list_table.from"},t.prototype.getAirMaltaSsrs=function(t){return t===this.airlineConfig.fareOptions.goSmart?this.airlineConfig.goSmartFareFeatures:this.airlineConfig.goLightFareFeatures},t.prototype.showFlightsTablePopup=function(){this.DialogManager.open("flightsTablePopup",{template:"/partials/booking/components/flights-table-ops/flights-table-popup.html",className:"flights-table-ops-popup",closeByDocument:!1,showClose:!0,data:this.getPopupData()})},t.prototype.getPopupData=function(){return{airMaltaSsrs:this.fareIncludedSsrs,airMaltaFareOption:this.airMaltaFareOption,isGoSmart:this.airlineConfig.fareOptions.goSmart,fareTranslation:this.translation}},t}()});


"use strict";angular.module("app.booking").component("flightsTableOps",{templateUrl:"/partials/booking/components/flights-table-ops/flights-table-ops.html",bindings:{flights:"<",departure:"<",destination:"<",selectedFlight:"<",selectedFare:"<",selectedFareType:"<?",fareUpdateDisabled:"<?",onFlightFareSelected:"&",resetLeg:"&",outboundFlight:"<",sortBy:"<",type:"@",faresSsr:"<",onChangeFare:"&",isChangeFlight:"<?",originalFlight:"<?",isErasmus:"<",isMandatorySeatNeeded:"<",hasSpanishDiscount:"<",freeMoveFlights:"<",isReturnTrip:"<",changeFlightType:"<",childPaxCount:"<",adultPaxCount:"<",operatedBy:"<",changeFlightState:"<",outboundDate:"<",inboundDate:"<",passengers:"<",isConnectingFlight:"<",isLauda:"<"},controller:["$scope","$state","$document","FARES_CONFIG","smoothScroll","Device","AirportClosures","$timeout","DialogManager","$ngRedux","FEATURE_CONFIG","AEMConfig",function(e,t,i,n,r,s,a,o,l,u,g,p){var h=this,c=function(e){return e.map(function(e){var t=R.propOr("","fareKey",e.fares.find(function(e){return"regular"===e.type})),i=R.pathOr("",["fares",0,"fareOption"],e);return babelHelpers["extends"]({},e,{journeyDuration:moment.duration(e.duration).asMinutes(),outboundDate:h.outboundDate,inboundDate:h.inboundDate,trackingId:e.flightKey+t+i})})};this.isFareTypeVisibleInChangeFlight=function(e){if(!t.includes("booking.active"))return!0;switch(e){case"BUSINESS":return"business"===h.selectedFareType;case"LEISURE":return"leisure"===h.selectedFareType;case"REGULAR":return"regular"===h.selectedFareType;default:return!1}},this.faresConfig=angular.merge({},n,{regular:{isVisible:this.isFareTypeVisibleInChangeFlight("REGULAR"),showRemainingSeats:!0,img:null},leisure:{isVisible:!this.hasSpanishDiscount&&this.isFareTypeVisibleInChangeFlight("LEISURE"),img:p.getStaticFilePrefix()+"/resources/ui/img/logos/PLUS/on-white-background/icon/PLUS.png"},business:{isVisible:!this.hasSpanishDiscount&&this.isFareTypeVisibleInChangeFlight("BUSINESS"),img:p.getStaticFilePrefix()+"/resources/ui/img/logos/PLUS/on-white-background/icon/flexi-PLUS.png"}}),this.singleFareAvailable=!0,this.singleFareType=!1,this.showCompareFaresPopup=function(){l.open("compareFaresPopup",{template:"/partials/booking/templates/compare-fares-popup.html",className:"compare-fares-popup dialog",scope:e})},this.isFareTypeDisabled=function(e){if(!g["mixed-fare-types"]||h.isConnectingFlight){var t="outbound"===h.type?"outboundFareType":"inboundFareType",i=R.path(["flightSearch","info",t],u.getState())||h.selectedFareType;return i&&!~i.indexOf(e)&&h.fareUpdateDisabled}return!1},this.isFlightDisabled=function(e){return e.selectionDisabled||!h.isChangeFlight&&R.pathOr(!1,["infoMsg","length"],e)},this.isCellDisabled=function(e,t){return h.isFlightDisabled(e)||!t.fareKey||h.isFareTypeDisabled(t.type)},this.onFareClick=function(e,t,i,n){(!n||s.isMobile()||angular.element(n.currentTarget).hasClass("fare-select"))&&(h.isCellDisabled(e,t)?h.isFareTypeDisabled(t.type)&&(t.tooltipVisible=!0):(h.selectedFlightFares=i,h.flightSelected=e,h.onFlightFareSelected({flight:e,fare:t}),h.legFareType=t.type))},this.onFlightOpened=function(e){if(h.singleFareAvailable||h.isErasmus)h.onFareClick(e,e.fares[0],e.fares);else if(h.flightOpened!==e.flightKey){h.flightOpened=e.flightKey;var t=i[0].getElementById("flight-"+e.flightKey),n={offset:s.isMobile()?10:100};o(function(){r(t,n)},400,!1)}else h.flightOpened=null;return!0},this.isRowSelected=function(e){return e.isSelected||h.selectedFlight===e.flightKey},this.isCellSelected=function(e,t){return h.isRowSelected(e)&&h.selectedFare===t.fareKey},this.hasAlerts=function(e){return!h.operatedBy&&!!e.infoMsg.length&&e.infoMsg.some(function(e){return e.alert})},this.hasErrors=function(e){return!h.operatedBy&&!!e.infoMsg.length&&e.infoMsg.some(function(e){return e.error})},a.get().then(function(e){h.airportInformationCollection=e.filter(function(e){return e.iataCode===e.divertedIataCode})}),this.getAirportInformation=function(e){var t=R.pipe(R.propOr([],"segments"),R.reduce(function(e,t){var i=t.origin,n=t.destination;return e.concat([i,n])},[]))(e);return R.pipe(R.find(function(e){var i=e.iataCode;return R.contains(i,t)}),R.propOr(!1,"messageFrom"))(h.airportInformationCollection)},this.closeMixedFareToast=function(){h.mixedFareToastClosedByUser=!0,h.isMixedFareToastVisible=!1},this.$onChanges=function(e){var t=e.selectedFare,i=e.flights,n=R.prop("currentValue",i),r=!R.equals(R.prop("currentValue",i),R.prop("previousValue",i));R.prop("previousValue",t)&&R.not(R.prop("currentValue",t))&&(h.flightOpened=null,h.flightSelected=null,h.selectedFareObject=null),n&&r&&(h.flightsModel=c(n))}}]});


"use strict";angular.module("app.booking").component("iframeAutoHeight",{templateUrl:"/partials/booking/components/iframe-auto-height/iframe-auto-height.html",bindings:{origin:"<",url:"<",hasLoader:"<"},controller:function(){function e(i,t,n,o){babelHelpers.classCallCheck(this,e),this.RAIframeService=i,this.$element=t,this.$window=n,this.Device=o}return e.$inject=["RAIframeService","$element","$window","Device"],e.prototype.$onInit=function(){var e=this;this.showLoader=this.hasLoader,this.windowListeners=[this.RAIframeService.getHeightChangeListener(this.origin,function(i){var t=Math.max(e.$window.document.documentElement.clientHeight,e.$window.innerHeight||0),n=Math.min(t,i.payload);e.iframeEl.height=String(n),e.showLoader=!1,e.Device.isIOS()&&e.iframeEl.contentWindow.postMessage({type:"SET_HEIGHT",payload:n},"*")})]},e.prototype.$postLink=function(){this.iframeEl=R.head(this.$element.find("iframe")),this.RAIframeService.addWindowListeners(this.windowListeners)(null)},e.prototype.$onDestroy=function(){this.RAIframeService.removeWindowListeners(this.windowListeners)},e}()});


"use strict";angular.module("app.booking").component("manageTripItem",{templateUrl:"/partials/booking/components/manage-trip/manage-trip-item.html",bindings:{itemData:"<",states:"<"},controller:["$state","ChangeFlightUtil","NameChangeActions","$ngRedux","BookingRead","BookingModelActions","ChangeFlightActions",function(i,e,t,n,a,o,s){var c=this,g=(this.states[this.itemData.id]||{}).status,h=["active","pending","inactive","disabled","info"];this.bookingModel={};var r=function(i){return{bookingModel:i.bookingModel,nameChange:i.nameChange}},l=n.connect(r,null)(function(i){Object.assign(c,i)}),d=function(){n.dispatch(o.refresh("booking.active",!0,!0)).then(function(){i.go("booking.active",{},{reload:!0}),n.dispatch(s.resetChangeFlight())})},m=function(){n.dispatch(t.cancelNameChange()),i.go("booking.active")};this.journeys=a.getModel("journeys",this.bookingModel),this.showFlightDetails="changeFlight"===this.itemData.id;var u=h.map(function(i){return i===g}),b=babelHelpers.slicedToArray(u,5);this.isActive=b[0],this.isPending=b[1],this.isInactive=b[2],this.isDisabled=b[3],this.isInfo=b[4],this.getPrice=function(){switch(c.itemData.id){case"changeFlight":return e.totalFeesPayable;case"changeName":return c.nameChange.price;default:return""}},this.remove=function(){switch(c.itemData.id){case"changeFlight":d();break;case"changeName":m()}},this.manageTripRedirection=function(){c.isDisabled||i.go("booking.active.manage-trip."+c.itemData.url)},this.$onDestroy=function(){l()}}]});


"use strict";angular.module("app.booking").component("priorityBoardingSelection",{templateUrl:"/partials/booking/components/priority-boarding/priority-boarding.html",bindings:{passengers:"<",journeys:"<",cancelledFlights:"<",booking:"<",priorityBoardingStore:"<",totalBalance:"<",initCompleted:"<",onToggleForOne:"&",onToggleForAll:"&"},controller:["BookingRead","AEMConfig",function(i,o){var e=this;this.priorityBoardingBannerImage=o.getStaticFilePrefix()+"/resources/ui/img/overlay/banners/priority-boarding/bag_image",this.priorityBoardingBenefitList=["1","2"],this.isConnectingTrip=i.getBookingInfo(this.booking).isConnectingFlight,this.isMobile=!1,this.toggleForOne=function(i){e.onToggleForOne({$event:i})},this.toggleForAll=function(i){e.onToggleForAll({$event:i})},this.hasAlertInfoMessage=i.hasBusinessPlus(this.booking)||i.hasLeisurePlus(this.booking);var n={plus:"plus",flexiPlus:"flexiPlus",mixed:"mixed"},s={outbound:"outbound",inbound:"inbound",both:"both"};this.tranlations=this.booking.journeys.reduce(function(o,r){var t=!!o.includedFor;return i.isBusinessPlusLeg(e.booking,r.key.id)&&!t?{fareType:n.flexiPlus,includedFor:0===r.key.id?s.outbound:s.inbound}:i.isLeisurePlusLeg(e.booking,r.key.id)&&!t?{fareType:n.plus,includedFor:0===r.key.id?s.outbound:s.inbound}:i.isBusinessPlusLeg(e.booking,r.key.id)&&t?{fareType:"flexiPlus"===o.fareType?n.flexiPlus:n.mixed,includedFor:s.both}:i.isLeisurePlusLeg(e.booking,r.key.id)&&t?{fareType:"plus"===o.fareType?n.plus:n.mixed,includedFor:s.both}:o},{fareType:"",includedFor:""})}]});


"use strict";angular.module("app.booking").component("priorityBoardingView",{templateUrl:"/partials/booking/components/priority-boarding-view/priority-boarding-view.html",controller:function(){function e(i,t,s,o,r,n,a,l,g,p,c,h,d,u,y){babelHelpers.classCallCheck(this,e),Object.assign(this,{BAGS_OPTIONS:i,CARD_CODES:t,$ngRedux:s,isWarningMessageOpen:!1,isMobile:o.isPhone(),PriorityBoardingActions:r,PriorityBoardingUtil:n,CabinBagActions:a,FEATURE_CONFIG:l,BookingRead:g,$q:c,$element:h,DialogManager:d,smoothScroll:u,Device:o,total:0,SELECTORS:{INBOUND_SECTION:".priority-boarding-view__journey-list--1",PASSENGERS_SECTION:".priority-boarding-view__passengers-list-wrapper",FOOTER_SECTION:".priority-boarding-view__footer"},FlightExtrasActions:y},{routerState:p})}return e.$inject=["BAGS_OPTIONS","CARD_CODES","$ngRedux","Device","PriorityBoardingActions","PriorityBoardingUtil","CabinBagActions","FEATURE_CONFIG","BookingRead","$state","$q","$element","DialogManager","smoothScroll","FlightExtrasActions"],e.prototype.$onInit=function(){var e=this,i=function(e){var i=e.bookingModel,t=e.bookingModel,s=t.journeys,o=t.passengers,r=e.priorityBoarding,n=e.priorityBoarding.p2cbCardsConfig,a=e.cabinBag;return{bookingModel:i,journeys:s,passengers:o,cardsConfig:R.pathOr([],["p2cbCards"],n),priorityBoarding:r,cabinBag:a}};this.unsubscribe=this.$ngRedux.connect(i,[this.PriorityBoardingActions,this.CabinBagActions])(function(i,t){var s=babelHelpers.slicedToArray(t,2),o=s[0],r=s[1];if(Object.assign(e,{$state:i,$actions:{priority:o,cabinBags:r}}),!e.options&&R.path(["priorityBoarding","priorityAvailability"],e.$state)&&R.path(["priorityBoarding","offers"],e.$state)&&R.pipe(R.prop("meta"),R.isEmpty,R.not)(e.$state.cabinBag)){var n=function(i){var t=e.BookingRead.isFamilyPlusLeg(e.$state.bookingModel,i.key.id)?e.BAGS_OPTIONS.CABIN_BAG:e.BAGS_OPTIONS.PRIORITY_BOARDING;return e.isIncluded(i.key.id)?t:null};e.options=e.getOptions(),e.selections=e.$state.passengers.map(function(){return e.$state.journeys.map(n)});var a=babelHelpers.slicedToArray(e.$state.passengers,1);e.activePassenger=a[0],e.hasSelection=[],e.setSelectedOptions(),e.updateTotalPrice(),e.journeysAvailableForSelection=e.$state.journeys.filter(function(i){return!e.isIncluded(i.key.id)})}e.Device.onTablet(function(i){var t=i.matches;e.isTabletPortrait=t&&e.Device.isPortrait()})}),this.allLegsLauda=this.$state.journeys.every(function(i){return e.BookingRead.isLaudaJourney(i)}),this.showWarningMessage=this.$state.journeys.some(function(i){return!e.PriorityBoardingUtil.isCabinBagLaudaRulesDisabled(i)}),this.$actions.priority.getP2cbCardsConfig(),this.showBaggageInfo=R.range(0,this.$state.journeys.length).map(function(){return!1}),this.BookingRead.getSsrsByTypeAndSold(this.CARD_CODES.PRIOBRDNG,!1)(this.$state.bookingModel).length&&this.$actions.priority.removeAll(),this.BookingRead.getSsrsByTypeAndSold(this.CARD_CODES.CBAG,!1)(this.$state.bookingModel).length&&this.$actions.cabinBags.removeFromBasket()},e.prototype.getOptions=function(){var e=this;return this.$state.journeys.map(function(i){return e.getOptionsForJourney(i)})},e.prototype.isLauda=function(e){return this.BookingRead.isLaudaJourney(e)},e.prototype.isIncluded=function(e){return this.BookingRead.isBusinessPlusLeg(this.$state.bookingModel,e)||this.BookingRead.isLeisurePlusLeg(this.$state.bookingModel,e)||this.BookingRead.isFamilyPlusLeg(this.$state.bookingModel,e)},e.prototype.getOptionsForJourney=function(e){return{journeyNum:e.key.id,selectedType:null,bagsOptions:[{imageUrl:"/resources/ui/images/priority-and-cabin-bags/small@2x.png",isPriorityQueue:!1,isSoldOut:!1,isDisabled:!1,isLauda:this.isLauda(e),isIncluded:this.isIncluded(e.key.id),price:null,showWarningMessage:!1,showWarningMessageForLauda:this.PriorityBoardingUtil.isCabinBagLaudaRulesDisabled(e),type:this.BAGS_OPTIONS.CARRY_ON,keys:{benefits:["trips.booking.priority.small-bag"],benefitsTitle:"trips.booking.priority.small-bag-title"}},{imageUrl:"/resources/ui/images/priority-and-cabin-bags/priority@2x.png",isPriorityQueue:!0,price:this.getPriceForPriorityBoarding(e.key.id),isSoldOut:this.PriorityBoardingUtil.isPriorityBoardingSoldOut(e.key.id,this.$state.priorityBoarding),isDisabled:!1,isIncluded:this.isIncluded(e.key.id),showWarningMessage:!1,showWarningMessageForLauda:!1,type:this.BAGS_OPTIONS.PRIORITY_BOARDING,keys:{benefits:["trips.booking.priority.small-bag","trips.booking.priority.10kg-bag","trips.booking.priority.board-first"],benefitsTitle:"trips.booking.priority.pb-2c-title"}},{imageUrl:"/resources/ui/images/priority-and-cabin-bags/checkin@2x.png",isPriorityQueue:!1,isSoldOut:!1,isDisabled:this.PriorityBoardingUtil.isCabinBagLaudaRulesDisabled(e),isIncluded:this.isIncluded(e.key.id),price:this.getPriceForCabinBag(e.key.id),showWarningMessage:!1,showWarningMessageForLauda:!1,type:this.BAGS_OPTIONS.CABIN_BAG,keys:{benefits:["trips.booking.priority.small-bag","trips.booking.priority.10kg-bag-checked-in"],benefitsTitle:"trips.booking.priority.10kg-bag-title"}}]}},e.prototype.getPriceForPriorityBoarding=function(e){return this.PriorityBoardingUtil.getPriceForPriorityBoarding(e,this.$state)},e.prototype.getPriceForCabinBag=function(e){return R.pathOr(0,["cabinBag","meta",e,"minPrice"],this.$state)},e.prototype.onSelect=function(e){var i=this,t=e.journeyNum,s=e.optionType,o=this.hasBagsForAllLegs();this.updateOptions(t,s),this.showBaggageInfo=this.showBaggageInfo.map(function(e,s){return s===t?!1:!i.selections[i.activePassenger.key.id][s]}),this.selections[this.activePassenger.key.id][t]=s,this.hasSelection[this.activePassenger.key.id]=this.hasBagsForAllLegs(),this.handleBagOptionSelection(t,s),this.allPassengersHaveSelection()&&this.$actions.priority.setContinueButtonAvailability(!0),this.updateTotalPrice();var r=this.hasBagsForAllLegs();this.isSameForAllAvailable()&&this.shouldShowAddForAllDialog(o)?this.DialogManager.open("prioritySameForAll",{template:"/partials/booking/components/priority-boarding-view/same-for-all-form/same-for-all-form.html",className:"priority-same-for-all-dialog",data:this.getDialogData()}):0!==t||r?0!==t||!r||this.BookingRead.isReturnTrip(this.$state.bookingModel)||o?1===t&&r&&!o&&this.scrollToElement(this.SELECTORS.FOOTER_SECTION,{offset:200}):this.scrollToElement(this.SELECTORS.FOOTER_SECTION,{offset:200}):this.scrollToElement(this.SELECTORS.INBOUND_SECTION)},e.prototype.getDialogData=function(){var e=this;return{journeys:this.journeysAvailableForSelection,selectionDetails:this.getSelectionDetails(),passengersCount:this.$state.passengers.length,price:this.getTotalPriceForAll(),addHandler:function(){return e.addSameForAll()},rejectHandler:function(){return e.rejectSameForAll()}}},e.prototype.getSelectionDetailsForJourney=function(e){var i,t=(i={},babelHelpers.defineProperty(i,this.BAGS_OPTIONS.CARRY_ON,"trips.booking.priority.same-for-all.small-bag"),babelHelpers.defineProperty(i,this.BAGS_OPTIONS.PRIORITY_BOARDING,"trips.booking.priority.same-for-all.pb-2c-title"),babelHelpers.defineProperty(i,this.BAGS_OPTIONS.CABIN_BAG,"trips.booking.priority.same-for-all.10kg-bag-title"),i),s=this.selections[this.activePassenger.key.id][e];return t[s]},e.prototype.getSelectionDetails=function(){var e=this;return this.journeysAvailableForSelection.reduce(function(i,t){return Object.assign(i,babelHelpers.defineProperty({},t.key.id,e.getSelectionDetailsForJourney(t.key.id)))},{})},e.prototype.getPriceForPassengerByJourney=function(e){var i,t=(i={},babelHelpers.defineProperty(i,this.BAGS_OPTIONS.CARRY_ON,0),babelHelpers.defineProperty(i,this.BAGS_OPTIONS.PRIORITY_BOARDING,this.getPriceForPriorityBoarding(e)),babelHelpers.defineProperty(i,this.BAGS_OPTIONS.CABIN_BAG,this.getPriceForCabinBag(e)),i),s=this.selections[this.activePassenger.key.id][e];return t[s]},e.prototype.getTotalPriceForAll=function(){var e=this,i=this.journeysAvailableForSelection.reduce(function(i,t){return i+e.getPriceForPassengerByJourney(t.key.id)},0);return i*this.$state.passengers.length},e.prototype.handleBagOptionSelection=function(e,i){switch(i){case this.BAGS_OPTIONS.CARRY_ON:this.onRemovePriorityBoarding(e),this.onRemoveCabinBag(e);break;case this.BAGS_OPTIONS.CABIN_BAG:this.onRemovePriorityBoarding(e),this.onAddCabinBag(e);break;case this.BAGS_OPTIONS.PRIORITY_BOARDING:this.onRemoveCabinBag(e),this.onAddPriorityBoarding(e)}},e.prototype.addSameForAll=function(){var e=this;R.pipe(R.slice(1,1/0),R.addIndex(R.forEach)(function(i,t){return e.applySelectionForPassenger(i,t)}))(this.$state.passengers),this.$actions.priority.setContinueButtonAvailability(!0),this.updateTotalPrice(),this.closeDialog(),this.scrollToElement(this.SELECTORS.FOOTER_SECTION,{offset:200})},e.prototype.applySelectionForPassenger=function(e,i){var t=this;this.selections[i+1]=[].concat(babelHelpers.toConsumableArray(this.selections[this.activePassenger.key.id])),this.activePassenger=e,this.hasSelection[i+1]=!0,this.journeysAvailableForSelection.forEach(function(e){var i=t.selections[t.activePassenger.key.id][e.key.id];t.handleBagOptionSelection(e.key.id,i)})},e.prototype.rejectSameForAll=function(){this.closeDialog()},e.prototype.closeDialog=function(){this.DialogManager.closeByKey("prioritySameForAll")},e.prototype.isSameForAllAvailable=function(){return this.$state.passengers.length>1},e.prototype.shouldShowAddForAllDialog=function(e){return!this.activePassenger.key.id&&!e&&this.hasBagsForAllLegs()},e.prototype.onAddPriorityBoarding=function(e){var i=this.getPriceForPriorityBoarding(e);this.$actions.priority.addToJourney(e,this.activePassenger.key.id,i)},e.prototype.onRemovePriorityBoarding=function(e){this.$actions.priority.removeFromJourney(e,this.activePassenger.key.id)},e.prototype.onAddCabinBag=function(e){var i=this.getPriceForCabinBag(e),t={num:this.activePassenger.key.id};this.$actions.cabinBags.addToLocalBasket(t,e,i)},e.prototype.onRemoveCabinBag=function(e){this.$actions.cabinBags.removeFromLocalBasket(this.activePassenger.key.id,e)},e.prototype.passengerSelectHandler=function(e){var i=e.passenger;this.activePassenger=i,this.setSelectedOptions()},e.prototype.hasBagsForAllLegs=function(){var e=this;return this.$state.journeys.every(function(i){return Boolean(e.selections[e.activePassenger.key.id][i.key.id])})},e.prototype.navigateToNextPax=function(){var e=this;this.activePassenger=this.$state.passengers[this.activePassenger.key.id+1],this.options=this.getOptions(),this.setSelectedOptions(),this.paxToMoveIndex=this.$state.passengers.findIndex(function(i){return i.key.id===e.activePassenger.key.id}),this.scrollToElement(this.SELECTORS.PASSENGERS_SECTION)},e.prototype.setSelectedOptions=function(){var e=this;this.$state.journeys.forEach(function(i){var t=R.pathOr("",[e.activePassenger.key.id,i.key.id],e.selections);e.updateOptions(i.key.id,t)})},e.prototype.updateOptions=function(e,i){var t=R.clone(this.options);t[e].selectedType=i,t[e].bagsOptions=t[e].bagsOptions.map(function(e){return babelHelpers["extends"]({},e,{showWarningMessage:e.type===i})}),this.options=t},e.prototype.getButtonTranslationKey=function(){return this.isLastPassenger()||this.allPassengersHaveSelection()?"trips.booking.priority.continue":"trips.booking.priority.next-passenger"},e.prototype.isLastPassenger=function(){return this.activePassenger.key.id===this.$state.passengers.length-1},e.prototype.allPassengersHaveSelection=function(){return this.hasSelection.length===this.$state.passengers.length&&R.last(this.hasSelection)},e.prototype.clickHandler=function(){this.allPassengersHaveSelection()?this.navigateToExtrasView():this.navigateToNextPax()},e.prototype.navigateToExtrasView=function(){var e=this;this.$q.all([this.$actions.priority.post(),this.$actions.cabinBags.submitBasket()]).then(function(){e.routerState.go("booking.extras",{openSeatMapInfo:e.FEATURE_CONFIG["open-seat-map-for-all-on-pt"]})})},e.prototype.toggleWarningMessage=function(){this.isWarningMessageOpen=!this.isWarningMessageOpen},e.prototype.updateTotalPrice=function(){this.total=R.sum([this.BookingRead.getCabinBagTotal(this.$state.bookingModel),this.PriorityBoardingUtil.getTotalBalance(this.$state.priorityBoarding)])},e.prototype.scrollToElement=function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=R.head(this.$element.find(e));this.smoothScroll(t,babelHelpers["extends"]({easing:"easeInQuad"},i))},e.prototype.$onDestroy=function(){this.unsubscribe(),this.$ngRedux.dispatch(this.FlightExtrasActions.clearAll())},e}()});


"use strict";angular.module("app.booking").component("retrieveAndLogin",{templateUrl:"/partials/booking/components/retrieve-and-login/retrieve-and-login.html",controller:["Device",function(t){var n=this;this.$onInit=function(){var e=0;n.tabState=e,n.unsubscribe=t.onPhone(function(t){n.isMobile=t.matches})},this.setTabState=function(t){n.tabState=t},this.$onDestroy=function(){n.unsubscribe()}}]});


"use strict";angular.module("app.booking").component("retrieveBookingOptions",{templateUrl:"/partials/booking/components/retrieve-booking-options/retrieve-booking-options.html",controller:["$translate",function(n){var i=this,e=function(){var e={checkInOnlineVideo:"trips.my_trips.redirect_links.check_in_online_video"};n(R.values(e)).then(function(n){i.checkInOnline=R.assoc("redirectLink",n[e.checkInOnlineVideo],i.checkInOnline)})};this.$onInit=function(){i.checkInOnline={translation:"check_in_online",redirectLink:""},i.retrieveBookingOptionsList=["print_boarding_pass","add_checked_bags","change_flight","name_change","confirm_trip_details","print_view_trip_itinerary","add_special_assistance","allocated_seating"],e()}}]});


"use strict";angular.module("app.booking").component("travelDocumentOps",{templateUrl:"/partials/booking/components/travel-document-ops/travel-document-ops.html",bindings:{journeys:"<",paxType:"<",operator:"<",paxTravelDoc:"<"},controller:function(){function t(e,i,a,n,r,o){babelHelpers.classCallCheck(this,t),Object.assign(this,{$filter:e,CheckinUtil:i,DateConfig:a,Dates:n,PASSENGER_AGE_CONFIG:r,AIRLINE_CONFIG:o})}return t.$inject=["$filter","CheckinUtil","DateConfig","Dates","PASSENGER_AGE_CONFIG","AIRLINE_CONFIG"],t.prototype.$onInit=function(){var t=this,e=this.$filter("translate"),i=this.PASSENGER_AGE_CONFIG.getOperatorConfig(this.operator),a=this.journeys[0].model,n=this.Dates.parseISO(a.depart),r=this.journeys[1]?this.journeys[1].model:a,o=this.Dates.parseISO(r.depart);this.paxTravelDoc.docType="P",this.isNotAirMaltaFlight=this.operator!==this.AIRLINE_CONFIG.AIRMALTA.airline,this.CheckinUtil.getCountries().then(function(i){var a=i;i&&(a=i.map(function(t){return Object.assign({},t,{group:e(t.iseu?"trips.contact.countries.groups.eu":"trips.contact.countries.groups.non-eu")})})),t.countriesOfIssue=a,t.nationalities=a});var s=function(){return i.find(function(e){return e.type===t.paxType}).minAge},l=function(){switch(t.paxType){case"INF":return i[1].minAge;case"CHD":return i[2].minAge;default:return{years:t.DateConfig.dateOfBirthRange.maxAge}}};this.expiryDateRange={min:this.Dates.formatISO(o),max:this.Dates.formatISO(o.clone().add(this.DateConfig.expiryDateRange.maxAge,"years"))},this.dateOfBirthRange=function(){var e=o,i="INF"===t.paxType?n:o;return{min:t.Dates.formatISO(e.clone().subtract(l()).add(1,"days")),max:t.Dates.formatISO(i.clone().subtract(s()))}}(),this.validateDateOfBirth=this.birthValidation.bind(this),this.validateExpiryDate=this.expiryDateValidation.bind(this)},t.prototype.birthValidation=function(t){return"Invalid date"!==t?(this.documentForm.$setValidity("dobInvalid",!0),t):(this.documentForm.$setValidity("dobInvalid",!1),!1)},t.prototype.expiryDateValidation=function(t){return"Invalid date"!==t?(this.documentForm.$setValidity("expiryDateInvalid",!0),t):(this.documentForm.$setValidity("expiryDateInvalid",!1),!1)},t}()});


"use strict";angular.module("app.booking").component("upgradeCard",{bindings:{passengers:"<",card:"<",onAddUpgrade:"&",upgradeName:"<",isMobile:"<",legs:"<",addedPrice:"<",fareUpgradeExtras:"<"},templateUrl:"/partials/booking/templates/upgrade-card/upgrade-card.html",controller:["AEMConfig","FareOptions","CARD_STATES","CARD_CODES","FARES_CONFIG","FARE_UPGRADE_CODES","$ngRedux","CheckinFlow","FEATURE_CONFIG","$state",function(e,r,t,i,a,n,c,d,p,s){var o=this;this.first=this.passengers[0].model.name.first;var g=this.passengers.length,l=s.is("booking.active"),u=void 0;this.config=a[""+this.upgradeName],this.atpFamilyPlusPricePP=p["atp-family-plus-upgrade-price-pp"],this.chFamilyPlusPricePP=p["checkin-family-plus-upgrade-price-pp"],this.getImage=function(r,t){return""+e.getStaticFilePrefix()+r+(t?"@2x":"")+".png"},this.getMobileImage=function(r){return o.upgradeName===n.FAMI?""+e.getStaticFilePrefix()+r+"-mobile@3x.png":""+e.getStaticFilePrefix()+r+"@2x.png"};var f=function(){o.titleText=o.isMobile?o.config.mobileTitleText:o.config.titleText},P=function(e){o.upgradePricePerPerson=e},h=function(){o.definedUpgradePrice=o.upgradePricePerPerson||o.upgradePrice};this.action=function(){o.card.state===t.DEFAULT?o.addUpgrade():o.removeUpgrade()},this.addUpgrade=function(){o.onAddUpgrade({$event:{fareUpgradeAdded:o.config.type}})},this.isInCheckinFlow=function(){return d.currentStep(c.getState())},this.removeUpgrade=function(){o.onAddUpgrade({$event:{fareUpgradeAdded:null}})};var m=function(e){var r=R.pipe(R.filter(R.propEq("code",o.config.type)),R.flatten,R.head)(e);o.upgradePrice!==r.total&&o.card.state!==t.PURCHASED_ALL&&(o.familyPlusGroupType="trips.flight_selector_fare_upgrade.per_family.return",o.priceTotal=r.total*g,o.upgradePrice=r.total,r.code===i.FAMI&&(o.atpFamilyPlusPricePP&&l||o.chFamilyPlusPricePP&&!l)&&(o.familyPlusGroupType="trips.flight_selector_fare_upgrade.per_person.return",P(u=r.total/g)),o.upgradeDisc=r.percentageDiscount,o.discountKey="trips.flight_selector_fare_upgrade.discount_"+o.upgradeName+(o.upgradeDisc>0?"":"_static"),h(),o.benefits=o.config.benefits.filter(function(e){return r.includedSsrs.length>0&&e.code?r.includedSsrs.indexOf(e.code)>-1:!0}))};this.$onChanges=function(e){var r=e.fareUpgradeExtras;f(),R.path(["currentValue"],r)&&m(r.currentValue),o.upgradeName===n.FAMI&&(o.atpFamilyPlusPricePP||o.chFamilyPlusPricePP)&&P(o.card.state===t.ADDED_ALL?o.upgradePrice:u),h()},this.$onDestroy=function(){r.clearCache()}}]});


"use strict";angular.module("app.booking").service("UpgradeCardUtils",["$q","$http","RuleEngine","UpgradeCardRules","BookingRead","Dates","RezApiConfig","CARD_STATES","CARD_CODES","FEATURE_CONFIG",function(e,r,a,i,t,s,n,l,u,d){var g=120,o=function(e){return{arrive:s.parseISO(e.arrive),depart:s.parseISO(e.depart)}},p=function(e,r){return 0===r.length?[o(e)]:[o(e),o(r)]},c=function(e){return[!0,t.isReturnTrip(e)]},h=function(e){var r=t.getBundle(!1)(e),a=t.getBundle(!0)(e),i={};return a.length>0?i.state=l.PURCHASED_ALL:r.length>0?i.state=l.ADDED_ALL:i.state=l.DEFAULT,i};return{determinePlusCardType:function(r){if(!(t.isEligibleForPlusUpgrade(r)||t.isEligibleForFamilyUpgrade(r)||t.isFamilyBundlePurchased(r)||t.isPlusBundlePurchased(r)))return e.reject({showUpgradeCard:null});var s=this.getTimeToFlight(r)>g,n=new a;n.register(i.rules);var l=R.pathOr([],["0","model"],r.journeys),u=R.pathOr([],["1","model"],r.journeys),o=p(l,u),h={flights:o,legsEnabled:c(r),passengers:t.getPassengerBreakdownAsObject(r),isFamilyPlusEnabled:d["atp-family-plus-upgrade-card"],isPlusEnabled:d["plus-upgrade-card"],flightDepartInMoreThanTwoHours:s,isEligableForFamilyUpgrade:t.isEligibleForFamilyUpgrade(r),isEligibleForPlusUpgrade:t.isEligibleForPlusUpgrade(r),isFamilyPlusPurchased:t.isFamilyBundlePurchased(r),isPlusPurchased:t.isPlusBundlePurchased(r),isSomePaxCheckedIn:t.isSomePaxCheckIn(r)};return n.execute(h).then(function(r){return e.resolve({showUpgradeCard:r.offeredType})})},getTimeToFlight:function(e){var r=s.utc(e.serverTimeUTC[0].model),a=s.utc(R.path(["journeys","0","model","departUTC"],e));return s.diffInMinutes(a,r)},getUpgradePrice:function(){return r.get(n.fareUpgrade)},getCardState:h}}]);


"use strict";angular.module("app.booking").component("allocateSeatsSelection",{templateUrl:"/partials/booking/checkin/allocate-seats/allocate-seats-selection.html",controller:function(){function e(t,o,i,n,s,a,c,r){babelHelpers.classCallCheck(this,e),Object.assign(this,{BookingRead:o,CheckinAllocationActions:i,CheckinModelActions:n,Device:s,$ngRedux:a,SelectSeatService:c,$stateParams:r}),this.chooseSeatImagePath=t.getStaticFilePrefix()+"/resources/ui/images/seat-message",this.totalPassangers=0,this.subscriptions=[]}return e.$inject=["AEMConfig","BookingRead","CheckinAllocationActions","CheckinModelActions","Device","$ngRedux","SelectSeatService","$stateParams"],e.prototype.getChooseSeatImage=function(){var e=this.Device.isPhone()?"mobile":"desktop",t=this.totalPassangers>1?"choose-seat-many-pax-"+e:"choose-seat-one-pax-"+e;return this.chooseSeatImagePath+"/"+t+".png 1x, "+this.chooseSeatImagePath+"/"+t+"@2x.png 2x"},e.prototype.getChooseSeatDescription=function(){return this.totalPassangers>1?"trips.checkin.seats.choose_seat_option_description_many_pax":"trips.checkin.seats.choose_seat_option_description_one_pax"},e.prototype.getRandomSeatDescription=function(){return this.totalPassangers>1?"trips.checkin.seats.random_seat_option_description_many_pax":"trips.checkin.seats.random_seat_option_description_one_pax"},e.prototype.selectAllocationType=function(e){this.selectedOption[e]=!0,this.$actions.checkin.hideAllocationOptions(this.$stateParams.journey),this.$actions.allocation.select(this.$stateParams.journey,e,this.$stateParams.segment),("checkinLater"===e||"autoFree"===e)&&this.$actions.checkin.nextStep()},e.prototype.$onInit=function(){var e=this;this.isMobile=this.Device.isPhone();var t=R.pipe(R.propOr([],"extras"),R.find(R.whereEq({code:"SEATS"})),R.propOr(0,"minPrice"));this.selectedOption={autoFree:!1,checkinLater:!1,manualChoice:!1};var o=function(o){var i=o.bookingModel,n=o.checkin,s=o.flightExtras,a=e.$stateParams.journey,c=e.BookingRead.getSegmentsFor(a)(i),r=e.BookingRead.get("passengers",i).map(function(t){var o=c.map(function(o){return e.BookingRead.getSeatDesignator(i)({passengers:t.key.id,journeys:a,segments:o.key.id})});return{key:t.key,model:t.model,seats:o}}).filter(function(e){var t=e.seats;return!t.every(function(e){return"--"===e})});return{minSeatPrice:t(s),totalPassangers:R.pathOr(0,["passengers","length"],i),allocationState:R.pathOr({},["allocationState",a],n),allocationForm:R.pathOr({},["allocationForm",a],n),journey:e.SelectSeatService.getJourney(i,a),getOriginCity:R.curry(e.BookingRead.getOriginCityForJourney)(R.__,i),getDestinationCity:R.curry(e.BookingRead.getDestinationCityForJourney)(R.__,i),selectedPassengersSeats:r,isConnectingFlight:e.BookingRead.isConnectingFlight(i),connectionInfo:e.BookingRead.getConnectingCityCode(i),freeCheckinMessage:e.BookingRead.getFreeCheckin24HourPerJourney(i)[a]?"trips.checkin.seats.checkin_later_option_description_24":"trips.checkin.seats.checkin_later_option_description"}};this.subscriptions.push(this.$ngRedux.connect(o,[this.CheckinModelActions,this.CheckinAllocationActions])(function(t,o){var i=babelHelpers.slicedToArray(o,2),n=i[0],s=i[1];Object.assign(e,t,{$actions:{checkin:n,allocation:s}})}))},e.prototype.$onDestroy=function(){this.subscriptions.forEach(function(e){return e()})},e}()});


"use strict";angular.module("app.booking").service("CheckinAllocationActions",["CHECKIN_ALLOCATION_ACTION_TYPES","AllocateCheckin","FEATURE_CONFIG","$http","RezApiConfig",function(n,t,e,o,a){var r={checkinLater:!1,autoFree:!1,manualChoice:!1,manualEarly:!1,manualNow:!1},i={init:function(){return function(o,a){var i=a(),c=i.bookingModel,u=i.checkin.allocationForm,l=R.path(["journeys"],c);o({type:n.INIT_ALLOCATION_FORM,payload:{allocationForm:l.map(function(n,t){return e["open-seatmap-in-check-in"]&&u&&u[t].manualNow?u[t]:angular.copy(r)}),allocationState:t.generateAllocationState(a())}})}},select:function(t,e,o){return{type:n.SELECT,payload:{journeyIndex:t,segmentIndex:o,model:R.set(R.lensProp(e),!0,r)}}},initSeatPrices:function(){return function(t,e){var o=e(),a=o.bookingModel,r=R.path(["journeys"],a),i=R.pipe(R.pathOr([],["flightExtras","extras"]),R.find(R.propEq("code","SEATS")),R.path(["minPrice"]))(e()),c=r.map(function(){return i});t({type:n.INIT_BAG_PRICES_SUCCESS,payload:c})}},resetJourneyAllocationForm:function(t){return{type:n.RESET_JOURNEY_ALLOCATION_FORM,payload:{journeyIndex:t,allocationForm:angular.copy(r)}}},fetchLastTenStatus:function(t){return function(e){return e({type:n.FETCH_LAST_TEN_STATUS_START}),o.post(a.checkinStatus,t).then(function(t){var o=t.data;return e({type:n.FETCH_LAST_TEN_STATUS_SUCCESS}),o})["catch"](function(){e({type:n.FETCH_LAST_TEN_STATUS_FAILURE})})}},notifyLastTenComplete:function(t){return{type:n.NOTIFY_LAST_TEN_COMPLETE,payload:t}}};return i}]);


"use strict";angular.module("app.booking").constant("CHECKIN_ALLOCATION_ACTION_TYPES",{INIT_ALLOCATION_FORM:"[Checkin-Allocation] initialize alloaction form",INIT_ALLOCATION_STATE:"[Checkin-Allocation] initialize alloaction state",INIT_BAG_PRICES_START:"[Checkin-Allocation] initialize lowest bag prices call",INIT_BAG_PRICES_SUCCESS:"[Checkin-Allocation] init smallest price for bag recieved",INIT_BAG_PRICES_FAILURE:"[Checkin-Allocation] init smallest price for bag error",SELECT:"[Checkin-Allocation] select allocation option",RESET_JOURNEY_ALLOCATION_FORM:"[Checkin-Allocation] reset alloaction form by journey",FETCH_LAST_TEN_STATUS_START:"[Checkin-Allocation] fetch last ten status start",FETCH_LAST_TEN_STATUS_SUCCESS:"[Checkin-Allocation] fetch last ten status success",FETCH_LAST_TEN_STATUS_FAILURE:"[Checkin-Allocation] fetch last ten status failure",NOTIFY_LAST_TEN_COMPLETE:"[Checkin-Allocation] notify last ten complete"});


"use strict";angular.module("app.booking").component("allocateSeats",{template:'<div ng-include="::$ctrl.layout"></div>',controller:["$q","$ngRedux","$filter","CheckinFlow","Device","BookingRead","CheckinModelSelectors","CheckinModelActions","CheckinAllocationActions","BookingReadCheckinJourney","AllocateCheckin","ModelQuery","$state","DialogManager","AEMConfig","FEATURE_CONFIG",function(e,t,n,o,a,i,r,s,c,l,u,g,h,p,y,k){var d=this,f=function(e){return{checkin:e.checkin,bookingModel:e.bookingModel,extras:R.pathOr([],["flightExtras","extras"],e),launchDarkly:e.launchDarkly}},m=y.getStaticFilePrefix();this.seatsBannerImage=m+"/resources/ui/img/check_in/product-seats",this.getSeatOneImage=m+"/resources/ui/images/seat-message/checkin-seat-one",this.getSeatManyImage=m+"/resources/ui/images/seat-message/checkin-seat-many";var C=function(e){return function(t,n){var o=babelHelpers.slicedToArray(n,2),a=o[0],i=o[1],s=R.pipe(R.find(R.whereEq({code:"SEATS"})),R.propOr(0,"minPrice"))(t.extras);Object.assign(e,{$state:t,$actions:{checkin:a,allocation:i},selectedPassengers:r.getSelectedPassengers(t),minSeatPrice:s})}},$=t.connect(f,[s,c])(C(this)),M=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),o=1;t>o;o++)n[o-1]=arguments[o];return n.map(function(t){return moment.duration(e)[t]()})};this.transformJourney=function(e,t){return{diffrence:M(l.getDifference(t,e),"weeks","days","hours")}},this.getComeBackDateFreeHour=R.pipe(u.getComeBackDateFree,n("time24HourUTC")),this.getComeBackDateFree=R.pipe(u.getComeBackDateFree,n("dayAndMonth")),this.getComeBackDateEarly=R.pipe(u.getComeBackDateEarly,n("dayAndMonth")),this.getDepartDate=R.pipe(R.path(["model","departUTC"]),n("dayAndMonth")),this.getDateFormat=function(e,t,o){return R.pipe(R.path(["model",t]),n(o))(e)},this.hasJourneyCancelledFlight=function(e){return l.isJourneyCancelled(d.$state.bookingModel,e)},this.showPassengerName=function(e,t){return 0===e||t[e].passenger.key.id!==t[e-1].passenger.key.id},this.expandBox=function(e){d.isMaximized[e]=!d.isMaximized[e]};var F=function(e,t){var n=function(n){return R.pipe(R.curry(i.getSoldSeatByJourney)(n.key.id),g.byBelongsToAny(e))(t)},o=function(e){return{designator:R.path(["model","code"],e),passenger:i.getPassengerById(e.key.passengers,t),segments:i.getSegmentsFor(e.key.journeys,t)[e.key.segments]}};return t.journeys.map(n).map(function(e){return e.map(o)})},b=function(){return o.newCheckinFlow?"/partials/booking/checkin/allocate-seats/allocate-seats-new-checkin-flow.html":o.newDesignAllocation?"/partials/booking/checkin/allocate-seats/allocate-seats-new-design.html":"/partials/booking/checkin/allocate-seats/allocate-seats.html"};this.getLegJourneyDateDay=n("displayJourneyDay"),this.getLegJourneyDateMonthYear=n("displayJourneyMonthYear");var v=function(e){return R.pathOr({},["checkin","allocationState",e])};this.isCheckBoxVisible=function(e){return R.pipe(v(e),R.props(["manualNow","manualChoice","manualEarly"]),R.any(R.identity))(d.$state)},this.checkinOpen=function(e){return R.pipe(v(e),R.props(["manualNow","manualChoice"]),R.any(R.identity))(d.$state)},this.getTypeOfManualCheckIn=function(e){return R.pipe(v(e),R.pickAll(["manualNow","manualChoice","manualEarly"]),R.filter(R.identity),R.keysIn,R.head)(d.$state)},this.showFooter=function(e){return R.pipe(v(e),R.props(["allCheckedIn","notOpen","onlineCheckinNotOpen","flown","manualEarly","blocked"]),R.any(R.identity))(d.$state)},this.hasAllPaxesSeated=function(e){return R.pipe(v(e),R.propOr(!1,"allPaxesSeated"))(d.$state)},this.isEarlyCheckInWithPaxesSeated=function(e){return R.pipe(v(e),R.props(["manualNow","allPaxesSeated","checkinEarly"]),R.all(R.identity))(d.$state)},this.getCheckValue=function(e){return d.$state.checkin.allocationForm[e][d.getTypeOfManualCheckIn(e)]},this.selectAllocationType=function(e,t){d.$actions.checkin.toggleSelectedJourney(e),d.$actions.allocation.select(e,t)},this.toggleOnJourney=function(e){var t=v(e)(d.$state);t.allPaxesSeated&&t.manualNow?d.$actions.allocation.select(e,"manualNow"):d.$actions.allocation.resetJourneyAllocationForm(e)},this.toggleOffJourney=function(e){d.$actions.allocation.select(e,"checkinLater")},this.toggleSelectedJourney=function(e){d.isJourneySelected(e)?d.toggleOffJourney(e):d.toggleOnJourney(e),d.$actions.checkin.toggleSelectedJourney(e)},this.isJourneySelected=function(e){return R.contains(e,d.$state.checkin.selectedJourneys)};var S=function(t){if("booking.active.checkin.allocation"!==o.getCurrentRoute(d.$state).route)return e.resolve();d.$actions.allocation.notifyLastTenComplete(!1);var n=R.path(["checkin","allocationForm"],t),a=R.path(["launchDarkly","checkin-seats-last-pax-enabled-desktop-dark"],t)&&!d.isMobile&&!o.newCheckinFlow&&!i.isConnectingFlight(t.bookingModel)&&n.some(function(e){return e.autoFree})&&1===i.getPaxCount(t.bookingModel);if(!a)return e.resolve();var r=n.map(function(e,t){var n=e.autoFree;return{autoFree:n,journeyNum:t}}).filter(function(e){var t=e.autoFree;return t}).map(function(e){var t=e.journeyNum;return{journeyNum:t,paxNum:0,segmentNum:0}});return d.$actions.allocation.fetchLastTenStatus(r).then(function(t){var n=t&&t.some(function(e){return e.segSsrs.some(function(e){return"LAS"===e.code})});return n?p.openConfirm("lastTenPopup",{template:"/partials/extras/seats/directives/last-ten-popup/last-ten-popup.html",className:"extra-offer-popup-dialog",appendTo:"allocate-seats",data:{},overlay:!1},!1).then(function(){return d.$actions.allocation.notifyLastTenComplete(n),e.resolve()})["catch"](function(){return d.$actions.allocation.notifyLastTenComplete(n),e.reject()}):(d.$actions.allocation.notifyLastTenComplete(n),e.resolve())},function(){return d.$actions.allocation.notifyLastTenComplete(!1),e.reject()})},J=function(t){return function(){return R.pipe(R.path(["checkin"]),R.props(["allocationState","allocationForm"]),R.transpose,R.map(R.pipe(R.reduce(R.merge,{}),R.pick(["flown","cancelled","checkinLater","allCheckedIn"]),R.values,R.any(R.identity))),R.ifElse(R.all(R.identity),function(){return p.closeAllDialogs(),e.reject()},function(){return S(t)}))(o.newCheckinFlow?d.$state:t)}};this.$onInit=function(){d.isMaximized=[],o.setCurrentTask(J(d.$state)),o.setBackTask(function(){return e.resolve()}),d.getSeatDesignator=i.getSeatDesignator(d.$state.bookingModel),d.isReturnTrip=i.isReturnTrip(d.$state.bookingModel),d.cities={getOriginCity:R.curry(i.getOriginCityForJourney)(R.__,d.$state.bookingModel),getDestinationCity:R.curry(i.getDestinationCityForJourney)(R.__,d.$state.bookingModel),getConnectingCity:R.curry(i.getConnectingCityForJourney)(R.__,d.$state.bookingModel)},d.isConnectingFlight=i.isConnectingFlight(d.$state.bookingModel),d.seatDesignators=F(d.$state.bookingModel.passengers,d.$state.bookingModel),d.layout=b(),d.useIcons=k["check-in-seats-icons-design"],d.freeCheckinMessage=i.getFreeCheckin24HourPerJourney(d.$state.bookingModel).map(function(e){return e?"trips.checkin.seats.random_allocation_available_from_24":"trips.checkin.seats.random_allocation_available_from"}),d.freeCheckinFooterMessage=i.getFreeCheckin24HourPerJourney(d.$state.bookingModel).map(function(e){return e?"trips.checkin.seats.early_checkin_footer_24":"trips.checkin.seats.early_checkin_footer"}),d.$actions.checkin.verifySelectedJourneys(),o.newCheckinFlow&&d.$state.bookingModel.journeys.forEach(function(e,t){d.isJourneySelected(t)?d.toggleOnJourney(t):d.toggleOffJourney(t)})};var D=a.onPhone(function(e){d.isMobile=e.matches});this.$onDestroy=function(){$(),D()}}]});


"use strict";angular.module("app.booking").service("AllocateCheckin",["Dates","FEATURE_CONFIG","BookingRead","BookingReadCheckinJourney","CheckinModelSelectors",function(e,n,t,a,r){var u=n.CHECKIN_TIME_LIMIT.EARLY,l=R.pipe(R.path(["model","checkInFreeAllocateOpenUtcDate"]),e.utc,function(e){return e.format()}),o=R.pipe(R.path(["model","departUTC"]),e.utc,function(e){return e.subtract(u,"days")},function(e){return e.format()}),i=function(n,t){return e.utc(R.path(["departUTC"],t)).startOf("day").diff(e.utc(n).startOf("day"),"days")},c=function(n,t){return e.utc(R.path(["departUTC"],t)).startOf("hour").diff(e.utc(n).startOf("hour"),"hours")},s=function(e,n,a){return R.ifElse(function(){return!e.some(function(e){return"ADT"===e.model.type})&&!t.isSomeAdultCheckedIn(n)[a.key.id]},function(e){return babelHelpers["extends"]({},e,{autoFree:!1,autoDisabled:!1,manualChoice:!1,manualEarly:!1,manualNow:!1,checkinLater:!1,allCheckedIn:!1,notOpen:!1,blocked:!0})},function(e){return babelHelpers["extends"]({},e,{blocked:!1})})},f=function(e,n){return R.ifElse(function(){return a.isJourneyCancelled(e,n)},function(e){return babelHelpers["extends"]({},e,{autoFree:!1,autoDisabled:!1,manualChoice:!1,manualEarly:!1,manualNow:!1,checkinLater:!1,allCheckedIn:!1,notOpen:!1,seatList:!1})},function(e){return babelHelpers["extends"]({},e,{cancelled:!1})})},d=function(e,n){return R.ifElse(function(){return R.either(a.isJourneyFlown,a.isCheckinClosed)(e,n)},function(e){return babelHelpers["extends"]({},e,{autoFree:!1,autoDisabled:!1,manualChoice:!1,manualEarly:!1,manualNow:!1,notOpen:!1,checkinLater:!1,allCheckedIn:!1,seatList:!1})},function(e){return babelHelpers["extends"]({},e,{flown:!1})})},h=function(e,n){return R.ifElse(function(){return a.isCheckinNotOpen(e,n)},function(e){return babelHelpers["extends"]({},e,{autoFree:!1,autoDisabled:!1,manualChoice:!1,manualEarly:!1,manualNow:!1,allCheckedIn:!1,checkinLater:!1})},function(e){return babelHelpers["extends"]({},e,{notOpen:!1})})},m=function(e,n){return R.ifElse(function(){return!a.isOnlineCheckinOpen(e,n)},function(e){return babelHelpers["extends"]({},e,{autoFree:!1,autoDisabled:!1,manualChoice:!1,manualEarly:!1,manualNow:!1,allCheckedIn:!1,checkinLater:!1,flown:!1})},function(e){return babelHelpers["extends"]({},e,{onlineCheckinNotOpen:!1})})},p=function(e,n,t){return R.ifElse(function(){return a.areAllCheckedInForJourney(e,n,t)},function(e){return babelHelpers["extends"]({},e,{autoFree:!1,autoDisabled:!1,manualChoice:!1,manualEarly:!1,manualNow:!1,checkinLater:!1})},function(e){return babelHelpers["extends"]({},e,{allCheckedIn:!1})})},C=function(e,n,t){return function(r){return babelHelpers["extends"]({},r,{autoFree:R.when(function(){return a.allSeated(e,n,t)},R.F)(r.autoFree),autoDisabled:R.when(function(){return a.allSeated(e,n,t)},R.F)(r.autoDisabled),manualChoice:R.when(function(){return a.allSeated(e,n,t)},R.F)(r.manualChoice),manualEarly:R.when(function(){return a.allSeated(e,n,t)},R.F)(r.manualEarly),manualNow:R.when(function(){return a.someSeatless(e,n,t)},R.F)(r.manualNow),seatList:R.when(function(){return a.noneSeated(n.passengers,n,t)},R.F)(r.seatList),allPaxesSeated:R.when(function(){return!a.allSeated(e,n,t)},R.F)(r.allPaxesSeated)})}},b=function(e,n,t){return function(n){return babelHelpers["extends"]({},n,{autoFree:R.when(function(){return!a.isCheckinFree(e,t)},R.F)(n.autoFree),autoDisabled:R.when(function(){return a.isCheckinFree(e,t)},R.F)(n.autoDisabled),manualChoice:R.when(function(){return!a.isCheckinFree(e,t)},R.F)(n.manualChoice),manualEarly:R.when(function(){return!a.isCheckinEarly(e,t)},R.F)(n.manualEarly),manualNow:R.when(function(){return!a.isCheckinOpen(e,t)},R.F)(n.manualNow),checkinEarly:R.when(function(){return!a.isCheckinEarly(e,t)},R.F)(n.checkinEarly)})}},k=function(e,n,t){return function(a){return function(r){return R.pipe(b(t,e,r),C(e,n,r),p(e,n,r),h(t,r),m(t,r),d(n,r),f(n,r),s(e,n,r))(a)}}},F={cancelled:!0,flown:!0,notOpen:!0,onlineCheckinNotOpen:!0,allCheckedIn:!0,autoFree:!0,autoDisabled:!0,manualChoice:!0,manualEarly:!0,manualNow:!0,checkinLater:!0,checkinEarly:!0,seatList:!0,allPaxesSeated:!0},y=function(e){var n=r.getSelectedPassengers(e),a=e.bookingModel,u=t.getModel("serverTimeUTC",a)[0],l=k(n,a,u);return t.get("journeys",a).map(l(F))};return{generateAllocationState:y,getComeBackDateFree:l,getComeBackDateEarly:o,getDaysToDeparture:i,getHoursToDeparture:c}}]);


"use strict";angular.module("app.booking").controller("BoardingPassPaymentController",function(){function t(o,e,n,s){"ngInject";var c=this;babelHelpers.classCallCheck(this,t);var i=function(){return{totalPrice:e.totalPriceToShow()}};Object.assign(this,{$rootScope:o,Basket:e,$ngRedux:n,CheckinModelActions:s,unsubscribe:n.connect(i)(function(t){Object.assign(c,{$state:t})})})}return t.$inject=["$rootScope","Basket","$ngRedux","CheckinModelActions"],t.prototype.processPayment=function(t){this.$rootScope.$emit("payment-controller:process-payment"),this.$ngRedux.dispatch(this.CheckinModelActions.productsAddedFromBoardingPass(t))},t.prototype.$onDestroy=function(){this.unsubscribe()},t}());


"use strict";angular.module("app.booking").component("boardingPasses",{templateUrl:"/partials/booking/checkin/boarding-passes/boarding-passes.html",controller:["$element","$timeout","$state","AEMConfig","Device","Utilities","$q","$window","$document","newDialogEnabled","DialogManager","Session","NationalityManager","SeatsService","$ngRedux","BookingRead","SeatsActions","FEATURE_CONFIG","CheckinFlow","CheckinModelActions","FastTrackUtils","BOARDING_PASSES_PRODUCTS","CARD_CODES","Dates",function(e,t,n,o,i,s,a,r,l,u,c,d,g,h,p,m,f,k,b,y,S,C,E,v){var T=this,F=function(e){var n=[];if(k["boarding-pass-upsell"]&&!e.fastTrack.isLoading&&!e.groundTransfers.isLoading){var o=k["boarding-pass-upsell-fast-track"]&&S.isAvailableOnAnyLeg(e.bookingModel,e.fastTrack)&&S.getSoldFastTrackCount(e.bookingModel)<S.getAvailableFastTrackCount(e.fastTrack.priceBreakdown),i=k["boarding-pass-upsell-transfers"]&&!m.hasGroundTransferSold(e.bookingModel);n=R.map(function(e){var t=void 0;return e.code===E.FAST&&(t=o),e.code===E.GRTANSFER&&(t=i&&!o),babelHelpers["extends"]({},e,{available:t})},C)}var s=R.sort(function(e,t){return e.model.num-t.model.num},e.bookingModel.passengers),a=m.getCancelledFlights(e.bookingModel),r=v.parseISOFull(m.getServerTimeUTC(e.bookingModel)),l=s.map(function(t){var n=e.bookingModel.journeys.map(function(n){return babelHelpers["extends"]({},n,{available:!!e.bookingModel.checkin.find(function(e){return R.path(["key","passengers"],e)===t.model.num&&R.path(["key","journeys"],e)===n.key.id&&"nocheckin"!==R.path(["model","status"],e)&&"documentsadded"!==R.path(["model","status"],e)})&&!a[n.key.id]&&v.parseISOFull(n.model.departUTC).add(48,"hours")>r,error:e.checkin.uploadErrors.find(function(e){return e.journeyNum===n.key.id&&e.paxNum===t.model.num})})});return{pax:t.model,journeys:n,canUpload:n.some(function(e){return e.available})}}),u=l.some(function(e){return e.canUpload}),c=R.path(["launchDarkly","upload-pcr-enabled-dark"],e),d=c&&u&&e.checkin.upload.some(function(e){return!e.isFileSaved&&!e.pending&&R.path([e.paxNum,"journeys",e.journeyNum,"available"],l)});return d||t(function(){T.hasUploadCommitError=!1}),{bookingModel:e.bookingModel,journeys:e.bookingModel.journeys,connectingCityCode:m.getConnectingCityCode(e.bookingModel),connectingCity:m.getConnectingCity(e.bookingModel),travelDocuments:e.bookingModel.travelDocuments,checkinModel:e.checkin,checkins:e.bookingModel.checkin,seats:e.bookingModel.seats,segments:e.bookingModel.segments,passengers:s,originCity:m.getOriginCity(e.bookingModel),destCity:m.getDestCity(e.bookingModel),isReturn:m.isReturnTrip(e.bookingModel),hideDownloadAll:m.getPaxCount(e.bookingModel)>25,changeSeatsEnabled:k["change-seats-enabled"]&&h.checkinChangeSeatAvailability(e.bookingModel,R.path(["seats","availability"],e),m.getFutureFlights(e.bookingModel).length?h.getNumberOfSeatsOnAircraft(e.bookingModel,e.seats):0),cancelledFlights:a,isCheckin:m.isCheckin(e.bookingModel),seatPositionKeyForSinglePax:function(t){return b.getSeatFeatureKeyForSinglePax(e.bookingModel,t)},products:n,isDomestic:m.isDomestic(e.bookingModel),paxWithUpload:l,canUpload:u,uploadEnabled:c,uploadCommitRequired:d,uploadFetchPending:e.checkin.uploadFetchPending,wordingStrict:e.bookingModel.journeys.some(function(e){return["GB","DE","IT","ES","PT"].includes(e.model.destCountry)})}},M=p.connect(F,[y,f])(function(e,t){var n=babelHelpers.slicedToArray(t,2),o=n[0],i=n[1];T.$state=babelHelpers["extends"]({},T.$state,e),T.$actions={checkin:o,seats:i}});this.outFlight=this.$state.journeys.find(function(e){return 0===e.model.journeyNum}),this.inFlight=this.$state.journeys.find(function(e){return 1===e.model.journeyNum}),this.singlePax=1===this.$state.passengers.length,this.openChangeSeat=function(e){e?n.go("booking.active.seats"):T.$actions.seats.openChangeSeatsModal(!0)},this.showInfoMessages=!0;var P={SELECT:"select",LOADED:"loaded"},$={NONE:"none",CONNECTING_FLIGHT:"isConnectingFlight",SINGLE_RESTRICTED_AIRPORT:"singleRestrict",BOTH_RESTRICTED_AIRPORTS:"bothRestrict",NON_EU_PASSENGER:"nonEUPax"},D=function(){return T.$state.connectingCityCode?void(T.warning=$.CONNECTING_FLIGHT):(T.outFlightMobilebp=T.outFlight.model.mobilebp,!T.outFlight.model.mobilebp||T.inFlight&&!T.inFlight.model.mobilebp?T.warning=$[!T.inFlight||T.inFlight.model.mobilebp||T.outFlight.model.mobilebp?"SINGLE_RESTRICTED_AIRPORT":"BOTH_RESTRICTED_AIRPORTS"]:g.getNationalities().then(function(e){T.$state.travelDocuments.some(function(t){var n=R.path(["model","travelDocument","nationality"],t),o=s.isEuNationality(n,e.getData());return o||(T.warning=$.NON_EU_PASSENGER),o})}),void(T.hasBritishDocWarning=T.$state.travelDocuments.some(function(e){return["travelDocument","infantTravelDocument"].some(function(t){var n=R.path(["model",t],e);return n&&(!n.docType||"P"===n.docType)&&("GB"===n.nationality||"GB"===n.countryOfIssue)})&&!("GB"===T.outFlight.model.origCountry&&T.$state.isDomestic)})))},I=function(e,t,n,o){var i="number"!=typeof t?"":"paxNum="+t+"&",s="number"!=typeof n?"":"segNum="+n+"&";return e+"?"+i+s+"Boarding-Pass-Token="+o},N=function(e){return R.pipe(R.filter(function(t){return R.path(["key","passengers"],t)===e}),R.uniqBy(function(e){return R.path(["key","journeys"],e)}),R.map(function(e){return R.path(["model","status"],e)}))(T.$state.checkins)},A=function(e){return T.$state.seats.filter(function(t){return t.key.passengers===e}).map(function(e){return babelHelpers["extends"]({},R.pick(["code","type","sold","total","isPartOfBundle"],e.model),R.pick(["segments","journeys","passengers"],e.key))}).map(function(e){var t=h.getAircraftType(e.segments,e.journeys,T.$state.segments);return babelHelpers["extends"]({},e,{aircraft:t},h.getSeatsPosition(e.code))}).reduce(function(e,t){return e[t.journeys]?e[t.journeys]=[].concat(babelHelpers.toConsumableArray(e[t.journeys]),[t]):e[t.journeys]=1===t.segments?[null,t]:[t],e},{})};this.viewPass=function(t,n){if(!T.$state.uploadFetchPending)if(T.$state.uploadCommitRequired){if(T.hasUploadCommitError=!0,T.modalEl){var i=R.path(["0"],e.find("covid-documents"));T.modalEl.scrollTop=i?i.offsetTop:0}}else T.hideDownload=T.$state.hideDownloadAll&&void 0===t,(!T.singlePax||T.inFlight)&&T.$actions.checkin.setShowBackBtn(!0),T.pdfUrl=I(o.getBoardingPassPDF(),t,n,d.getSessionStorage("ryanair:token")),T.boardingPassState=P.LOADED,T.showInfoMessages=!1,T.productsAdeddFromBoardingPass=!1},this.cityNames={outOriginName:this.$state.originCity,outDestName:this.$state.destCity,inOriginName:this.$state.isReturn?this.$state.destCity:"",inDestName:this.$state.isReturn?this.$state.originCity:""},this.boardingPassState=P.SELECT,D();var O=this.singlePax&&!this.$state.isReturn;this.isInfoBoxShown=function(){return T.boardingPassState===P.SELECT||O},this.toggleTooltip=function(e,t){T.passengersMap=T.passengersMap.map(function(n){if(n.num===e.num){var o=!e.tooltipOpen[t];e.tooltipOpen=[!1,!1],e.tooltipOpen[t]=o}return babelHelpers["extends"]({},n,{tooltipOpen:n.num!==e.num?[!1,!1]:e.tooltipOpen})})},this.modalBody=u()?".core-modal-body":".dialog-body",this.modalEl=l[0].querySelector(this.modalBody),this.isNewDialogEnabled=u();var w=i.onPhone(function(e){T.isMobile=e.matches});this.toggleInfo=function(){T.moreInfo=!T.moreInfo},this.isJourneyFlown=function(e){return m.isJourneyFlown(e,T.$state.bookingModel)},this.shouldShowAwaitingChecking=function(e,t){return!("nocheckin"!==e.journeys[t.key.id]&&"documentsadded"!==e.journeys[t.key.id]||T.$state.isCheckin.due[t.key.id]||T.$state.cancelledFlights[t.key.id]||T.isJourneyFlown(t.key.id))},this.calculateStickyOffset=function(){var e=110,t=R.prop("products",T.$state)&&R.any(function(e){return e.available})(T.$state.products)?101:0,n=106,o=0;return T.isNewDialogEnabled||(o+=T.isInfoBoxShown()?202:86),e+t+o+n};var B=function(){return t(function(){return T.boardingPassState===P.SELECT||T.singlePax&&!T.inFlight||(T.boardingPassState=P.SELECT,T.$actions.checkin.setShowBackBtn(!1)),a.reject()})};this.printPass=function(){return i.isFirefox()||i.isPhoneOrTablet()?void window.open(T.pdfUrl):(T.printIframe||(T.printIframe=document.createElement("iframe"),document.body.appendChild(T.printIframe),T.printIframe.style.display="none",T.printIframe.onload=function(){setTimeout(function(){T.printIframe.focus(),T.printIframe.contentWindow.print()})}),void(T.printIframe.src=T.pdfUrl))};var j=function(){return c.closeAllDialogs(),a.reject()};this.$onInit=function(){T.passengersMap=R.map(function(e){var t=R.clone(e.model);t.journeys=N(e.key.id),t.seats=A(e.key.id),t.tooltipOpen=[!1,!1];var n=m.getSsrsByCode(null,"LAS")(T.$state.bookingModel);return t.las=T.$state.journeys.map(function(o){return!t.seats[o.key.id]&&n.some(function(t){return t.key.passengers===e.key.id&&t.key.journeys===o.key.id})}),t},T.$state.passengers);var e=m.getFlightDuration(R.path(["journeys","0","model"],T.$state)),t=T.$state.journeys.length>1?m.getFlightDuration(R.path(["journeys","1","model"],T.$state)):null;T.flightDuration=[{hours:e.hours(),minutes:e.minutes()},{hours:t?t.hours():0,minutes:t?t.minutes():0}],T.$actions.checkin.setShowBackBtn(!1),b.setCurrentTask(j),b.setBackTask(B),T.changeSeatsMessageState=b.getChangeSeatsMessageState(T.$state.bookingModel,T.passengersMap),T.hasLas=T.changeSeatsMessageState.some(function(e){return"BP_MESSAGE_LAS"===e});var n=b.getBoardingPassChangeSeatsIconStatePerLeg(T.$state.bookingModel,T.passengersMap);T.flightFlownPerLeg=m.getFlightFlownStatusesPerLeg(T.$state.bookingModel),T.seatChangeImageLas=o.getStaticFilePrefix()+"/resources/ui/ryanair3.0/checkin/seat",T.seatChangeImage=n.reduce(function(e,t,n){switch(t){case"SINGLE_PAX":e[n]=o.getStaticFilePrefix()+"/resources/ui/img/check_in/single-seat";break;case"MULTI_PAX_SITTING_TOGETHER":e[n]=o.getStaticFilePrefix()+"/resources/ui/img/check_in/selected-seat";break;default:e[n]=o.getStaticFilePrefix()+"/resources/ui/img/check_in/random-seat"}return e},[]),T.productsAdeddFromBoardingPass=R.path(["productsAdeddFromBoardingPass"],T.$state.checkinModel)},this.productsEngagedFromBardingPass=function(e){var t=e.link;n.go(t),T.$actions.checkin.productsEngagedFromBoardingPass(!0)},this.$onDestroy=function(){M(),t(function(){R.not(R.contains(n.current.name,["booking.active","booking.active.seats","booking.active.seats-change","booking.active.fast-track","booking.active.transfers"]))&&n.go("booking.active")},0,!1),w()}}]});


"use strict";angular.module("app.booking").component("checkinCarousel",{templateUrl:"/partials/booking/checkin/checkin-carousel/checkin-carousel.html",bindings:{paxes:"<",seatOptions:"<",seats:"<",isConnectingFlight:"<"}});


"use strict";angular.module("app.booking").component("checkinSlidePax",{templateUrl:"/partials/booking/checkin/checkin-carousel/checkin-slide-pax.html",bindings:{pax:"<",seatOptions:"<",seats:"<",isConnectingFlight:"<"},controller:["ModelQuery",function(e){var n=this;this.getSeat=function(t,i){return R.path([0,"model","code"],e.byKey({passengers:t,journeys:i})(n.seats))}}]});


"use strict";angular.module("app.booking").component("checkinExtras",{templateUrl:"/partials/booking/checkin/checkin-extras/checkin-extras.html",controller:["$q","$ngRedux","CabinBagActions","CHECKIN","SeatsActions","PriorityBoardingUtil","BookingModelActions","PriorityBoardingActions","BagsActions","InsuranceActions","CheckinModelActions","AdobeAnalytic","BookingRead","FastTrackActions","ModelQuery","CheckinModelSelectors","SeatsService","FastTrackUtils","CheckinFlow","UpgradeCardUtils","FEATURE_CONFIG","FARE_UPGRADE_CODES","CARD_STATES","BookingReadCheckinJourney","FareUpgradeActions","$scope","BagsUtils","FlightExtrasActions","InflightProductsActions","InflightProductsUtils","TransfersActions",function(e,t,n,r,o,s,i,a,c,d,u,g,l,h,f,p,k,m,y,$,b,P,A,C,v,S,M,T,U,B,E){var N=this,x=t.getState(),O=x.bookingModel.journeys,I=R.pipe(f.byIdentity("seats"),f.byRemoved(!1))(x.bookingModel),F=function(e){return 1===e.group||3===e.group},j=R.once(function(e){var t=R.pipe(R.pathOr([],["checkin","products"]),R.find(R.propEq("code","INSURANCE")))(e);t&&N.$actions.insurance.getCountries()}),w=function(e){return{bookingModel:e.bookingModel,bags:e.bags,checkin:e.checkin,countries:R.path(["insurance","countries"],e),isLoading:e.checkin.isLoading,products:e.checkin.products,transfersTotalPrice:R.pathOr(0,["transfers","totalPrice"],e),allAvailableJourneys:l.filterUnavailableJourneys(e.bookingModel,e.bookingModel.journeys),hasUnpaidProducts:!!R.sum([l.getBookingTotal(e.bookingModel),s.getTotal(e.priorityBoarding.ssrs),m.getTotalBalance(e.bookingModel,e.fastTrack),M.getTotalUnsoldData(e.bags).totalBalance,B.getTotalBalance(e.inflightProducts)]),hasRemovedProducts:R.pipe(R.pathOr([],["bookingModel","ssrs"]),R.any(R.prop("removed")))(e),hasCabinBags:R.not(R.isEmpty(l.getCabinBagItems(!1)(e.bookingModel))),priorityBoarding:e.priorityBoarding,fastTrack:e.fastTrack,priorityAdded:s.areAllPriorityAdded(e.bookingModel),canRemovePriority:!s.areAllPrioritySold(e.bookingModel),upgradeCard:$.getCardState(e.bookingModel),familyAddedPrice:l.getFamilyCost(e.bookingModel),fareUpgradeModel:e.fareUpgrade,inflightProducts:e.inflightProducts,checkinExtrasConfig:R.pathOr({},["checkin","checkinExtrasConfig","extrasProductCards"],e),selectedOffers:R.path(["selectedOffers"],e.transfers)}},D=t.connect(w,[u,n,o,i,a,c,d,h,v,T,U,E])(function(e,t){var n=babelHelpers.slicedToArray(t,12),r=n[0],o=n[1],s=n[2],i=n[3],a=n[4],c=n[5],d=n[6],u=n[7],g=n[8],l=n[9],h=n[10],f=n[11];N.$state=e,N.$actions={checkin:r,cabinBag:o,seats:s,bookingModel:i,priorityBoarding:a,bags:c,insurance:d,fastTrack:u,fareUpgrade:g,flightExtras:l,inflightProducts:h,transfersActions:f},R.length(R.path(["checkin","products"],N.$state))&&j(N.$state)});this.$actions.checkin.getCheckinProducts();var q=function(e){for(var t=k.passengersGrouped(e),n=0;n<e.length;n+=1)e[n].displayNum=t[n][e[n].type]+1},J=function(){var e=0,t=O.map(function(e){return k.getReservedSeats(e.key.id,N.$state.bookingModel)}),n=function(t){var n=!I.some(function(n){return n.journeyNum===e&&n.designator===t.seat.code}),r=!I.some(function(n){return n.paxNum===t.paxNum&&n.journeyNum===e});return n&&r};t.forEach(function(t){t.forEach(function(t){!t.seat.sold&&n(t)&&I.push({paxNum:t.paxNum,journeyNum:e,designator:""})}),e+=1})},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return R.allPass([function(){return R.either(l.isPlusUpgradeAdded,function(e){return C.noneSeated(t,e,n)})(e)},function(){return R.all(function(t){return C.isCheckinFree(l.getCurrentServerTime(e),t)})(n)},function(){return!s.areSomeStandalonePriorityAdded(r)}])()};this.isCardOpen=function(e){return N.selectedProductCode===e},this.onCardToggle=function(e){var t=e.code;N.selectedProductCode=N.isCardOpen(t)?null:t},this.onRemoveTransfers=function(){N.$actions.transfersActions.resetSelectedOffers(!0),N.$actions.transfersActions.removeAll(!1)},this.onUpgradeCardClick=function(e){N.$actions.bags.postBags().then(function(){e.fareUpgradeAdded?N.$actions.fareUpgrade.addUpgrade(e.fareUpgradeAdded).then(function(){N.$actions.bags.syncBags(),N.$actions.priorityBoarding.resetPriorityBoardings(),N.$actions.seats.getAvailability().then(function(){N.$actions.checkin.setMandatorySeatMap(!0),C.allSeated(N.$state.bookingModel.passengers,N.$state.bookingModel,N.$state.bookingModel.journeys)||N.$actions.checkin.nextStep()})}):N.$actions.fareUpgrade.removeUpgrade().then(function(){N.$actions.bags.syncBags(),N.$actions.checkin.setMandatorySeatMap(!1),N.$actions.checkin.updateSteps(),N.$actions.checkin.getCheckinProducts(),N.$actions.checkin.resetCheckinPrioritySelection()})})},this.setSyncRequiredFlag=function(e){var t=e.unsynchronized;N.hasUnsynchronizedProducts=t},this.hasPriority=function(e,t){return e.segSsrs[t][0]?e.segSsrs[t].every(function(e){return"PS"===e.code}):I.find(function(n){return n.paxNum===e.num&&n.journeyNum===t&&F(n)})},this.removePriority=function(){N.$actions.seats.ignorePrioroityPopup()},this.removeProduct=function(e){N.$actions.checkin.removeProduct(e)},this.ctaButtonsEnabled=!0,this.getPaxSeats=function(e,t){var n=I.find(function(n){return n.paxNum===e&&n.journeyNum===t});return R.pathOr("——",["designator"],n)},this.getPassengerName=function(e){return e.name.first?e.name.first+e.name.last:e.type[0]+e.displayNum},this.passengers=p.getSelectedPassengers(x),this.journeys=p.getSelectedJourneysToCheckin(x),this.familyExtra=l.isFamilyDiscountEligible(x.bookingModel),this.isReturn=l.isReturnTrip(x.bookingModel),this.isConnectingFlight=l.isConnectingFlight(x.bookingModel),this.empty=!I[0],J(),this.empty?S.$emit("seat-map:no-seats"):q(this.passengers);var _=function(){var n=y.getPreviousCurrentNext({checkin:N.$state.checkin}),o=n.currentStep,s=n.nextStep,i=e.defer(),a=[R.pathOr({},["orig"],N.$state.selectedOffers),R.pathOr({},["dest"],N.$state.selectedOffers)].filter(function(e){return 0!==Object.keys(e).length&&e.isChanged});if(!N.$state.hasUnpaidProducts&&!N.$state.hasRemovedProducts&&!N.hasUnsynchronizedProducts&&!a||R.equals(o,r.ROUTES.PRIORITY)&&R.equals(s,r.ROUTES.EXTRAS))i.resolve();else{var c=l.getAddonsByCodeAndLocal("INS",!0,t.getState().bookingModel);e.all([c.length?N.$actions.insurance.updateInsurance():e.when(),m.isChanged(N.$state.fastTrack)?N.$actions.fastTrack.update():e.when(),N.$actions.bags.postBags({isCheckInFlow:!0}),N.$actions.cabinBag.submitBasket(),N.$actions.priorityBoarding.post({isCheckInFlow:!0}),N.$actions.inflightProducts.postInflightProducts(),a.length?N.$actions.transfersActions.postTransfers(a,!1):e.when()]).then(function(){i.resolve()})}return i.promise},z=function(){return e.resolve("EXTRAS")};y.setCurrentTask(_),y.setBackTask(z),this.triggerProductAction=function(e){var n=e.action,r=e.code,o=g.getAreas().checkIn;g.trackProductAction(o,n,r,y.currentStep(t.getState()),y.previousStep(t.getState()))},this.$onInit=function(){var e=N.$state,t=e.bookingModel,n=e.priorityBoarding;if(N.$actions.checkin.setCTA(!0),N.legs=t.journeys.length,N.inflightProductAvailable=N.$state.inflightProducts.offers.some(function(e){return e.offers.length}),R.path(["fareUpgradeModel","type"],N.$state)){var r=p.getSelectedJourneysToCheckin(x),o=p.getSelectedPassengers(x);N.cardName=P[N.$state.fareUpgradeModel.type];var s=function(){return N.cardName===P.SURE&&b["checkin-plus-upgrade-card"]&&L(t,o,r,n)},i=function(){return N.cardName===P.FAMI&&b["checkin-family-plus-upgrade-card"]};N.showUpgradeCard=N.$state.upgradeCard.state===A.ADDED_ALL||s()||i()}N.showProductCards=b["checkin-extras-product-cards-enabled"],N.showProductCardsWithoutImages=b["checkin-extras-product-cards-without-image"]},this.$onDestroy=function(){N.$actions.insurance.clear(),N.$actions.bags.resetBags(),N.$actions.inflightProducts.reset(),D()}}]});


"use strict";angular.module("app.booking").service("CheckinExtrasService",["SeatsService","AEMConfig",function(e,r){var t={setPaxDisplayNumbers:function(r){var t=e.passengersGrouped(r);return r.map(function(e,n){return babelHelpers["extends"]({},e,{displayNum:t[n][r[n].type]+1})})},reservedSeats:function(r,t){return r.reduce(function(r,n){return[].concat(babelHelpers.toConsumableArray(r),[e.getReservedSeats(n.key.id,t)])},[])},seatRemoved:function(e,r,t){var n=!r.find(function(r){return r.journeyNum===t&&r.designator===e.seat.code}),u=!r.find(function(r){return r.paxNum===e.paxNum&&r.journeyNum===t});return n&&u},checkForRemovedSeats:function(e,r,n){var u=t.reservedSeats(e,n),c=[].concat(babelHelpers.toConsumableArray(r)),a=0;return u.forEach(function(e){e.forEach(function(e){!e.seat.sold&&t.seatRemoved(e,r,a)&&c.push({paxNum:e.paxNum,journeyNum:a,designator:""})}),a+=1}),c},getFallbackImageForProduct:function(e){switch(e){case"FAST":return r.getStaticFilePrefix()+"/resources/ui/img/check_in/products/product-fast-track@2x.png";case"INSURANCE":return r.getStaticFilePrefix()+"/resources/ui/img/check_in/products/product-insurance@2x.png";case"TRANSFERS":return r.getStaticFilePrefix()+"/resources/ui/img/check_in/products/product-transfers@2x.png";default:return r.getStaticFilePrefix()+"/resources/ui/img/check_in/products/product-bag@2x.png"}}};return t}]);


"use strict";angular.module("app.booking").component("checkinInsuranceActiveChoice",{templateUrl:"/partials/booking/checkin/checkin-insurance-active-choice/checkin-insurance-active-choice.html",controller:function(){function n(e,t,i,s,o,a,c,r,u,h,l,d,p,g,k){var C=this;babelHelpers.classCallCheck(this,n),Object.assign(this,{$ngRedux:e,$state:t,$q:i,InsuranceUtil:a,Stations:c,BookingRead:r,CARD_CODES:u,CheckinModelActions:h,CheckinFlow:l,InsuranceActions:d,INSURANCE_TYPES:p,PaymentActions:g,TravelDocumentsActions:k}),this.subscriptions=[],this.subscriptions.push(o.onPhone(function(n){var e=n.matches;C.isMobile=e}),o.onLaptop(function(n){var e=n.matches;C.isLaptop=e})),this.language=s.getLanguage(),this.isItalianMarket=R.equals(s.getCountry(),"it")}return n.$inject=["$ngRedux","$state","$q","MarketConfig","Device","InsuranceUtil","Stations","BookingRead","CARD_CODES","CheckinModelActions","CheckinFlow","InsuranceActions","INSURANCE_TYPES","PaymentActions","TravelDocumentsActions"],n.prototype.confirmSelectedInsurance=function(){var n=this;this.$actions.insurance.confirmSelectedInsurance().then(function(){return n.$actions.payment.updateCurrencyConversionOffer()})},n.prototype.removeAllInsurance=function(){var n=this;this.$actions.insurance.removeAllInsurance().then(function(){return n.$actions.payment.updateCurrencyConversionOffer()})},n.prototype.makeInsuranceChoice=function(){this.$actions.insurance.makeChoice(),this.$actions.checkin.setCTA(!0)},n.prototype.unmakeInsuranceChoice=function(){this.$actions.insurance.unmakeChoice()},n.prototype.$onInit=function(){var n=this,e=function(n){return{bookingModel:R.prop("bookingModel",n),insurance:R.prop("insurance",n),extras:R.path(["flightExtras","extras"],n),ctaEnabled:R.path(["checkin","ctaEnabled"],n)}};this.subscriptions.push(this.$ngRedux.connect(e,[this.InsuranceActions,this.PaymentActions,this.CheckinModelActions,this.TravelDocumentsActions])(function(e,t){var i=babelHelpers.slicedToArray(t,4),s=i[0],o=i[1],a=i[2],c=i[3];n.$state=babelHelpers["extends"]({},n.$state,e),n.$actions={insurance:s,payment:o,checkin:a,travelDocs:c}}));var t=this.BookingRead.get("passengers",this.$state.bookingModel);this.insurancePassengers=this.BookingRead.enumPassengersByType(t),this.originCountryCode=R.pipe(this.BookingRead.getOriginCityCode,this.Stations.getCountryCode.bind(this.Stations),R.when(R.identity,R.toUpper))(this.$state.bookingModel),this.isFamilyDiscountEligible=this.BookingRead.isFamilyDiscountEligible(this.$state.bookingModel),this.insuranceExtra=this.InsuranceUtil.getInsuranceExtra(this.$state.extras),this.hasAddedPlusInsurance=this.InsuranceUtil.hasAddedPlusInsurance(this.$state.bookingModel),this.$actions.checkin.setCTA(!0),this.CheckinFlow.setCurrentTask(function(){return n.$q.resolve()});var i=this.InsuranceUtil.hasAddedInsurance(this.$state.bookingModel);i&&R.not(R.path(["insurance","choiceIsMade"],this.$state))&&(this.$actions.insurance.makeChoice(),this.$actions.insurance.refreshSelectedInsurance()),this.$actions.travelDocs.getNationalities().then(function(e){n.brexitAffectedJourneyFrom=n.BookingRead.brexitAffectedJourneyFrom(n.$state.bookingModel,e)})},n.prototype.$onDestroy=function(){this.subscriptions.forEach(function(n){return n()})},n}()});


"use strict";angular.module("app.check-in-menu",["ui.router","common"]);


"use strict";angular.module("app.booking").controller("CheckInFlights",["$scope","$state","Booking","Dates","Currency","Session","DateConfig","$stateParams","Device","Stations","$ngRedux","BookingModelActions",function(e,t,i,o,a,n,r,s,c,l,g,d){s.paxEmail||t.go("check-in");var u=s.bookings,m=s.paxEmail,h=Object.keys(u).map(function(e){return u[e]});e.checkInFlights=h.map(function(e){return e.origin=l.getCityName(e.orig),e.destination=l.getCityName(e.dest),e.dateOfDep=o.parseISOFull(e.date).format(r.displayFormats.activeFromTo),e.timeOfDep=o.parseISOFull(e.date).format(r.displayFormats.time24Hour),e}),e.selectedThisFlight={},e.isMobile=c.isPhone(),e.getSelectedFlight=function(){var t={EmailAddress:m,ReservationNumber:e.selectedThisFlight.pnr};g.dispatch(d.retrieveBooking(t))["catch"](function(t){e.retrieveBookingError=t.data.code.toLowerCase()})},e.cancelMultipleFlights=function(){t.go("check-in")},void 0===m&&t.go("check-in")}]);


"use strict";angular.module("app.booking").component("checkinPayment",{templateUrl:"/partials/booking/checkin/checkin-payment/checkin-payment.html",controller:["$rootScope","$q","CheckinFlow",function(e,n,t){var o=[];this.paymentTask=function(){var t=n.defer();return e.$emit("payment-controller:process-payment"),o.push(e.$on("payment-controller:payment-processed",function(){t.resolve("skipStepUpdate")})),o.push(e.$on("payment-controller:payment-error",function(e){t.reject(e)})),t.promise},t.setCurrentTask(this.paymentTask),t.setBackTask(n.resolve),this.$onDestroy=function(){o.forEach(function(e){return e()})}}]});


"use strict";angular.module("app.booking").component("checkinPriority",{templateUrl:"/partials/booking/checkin/checkin-priority/checkin-priority.component.html",controller:["$document","$scope","$ngRedux","PriorityBoardingActions","CabinBagActions","Device","CheckinModelActions","CheckinFlow","BookingRead","smoothScroll","CARD_CODES","BAGS_OPTIONS","PriorityBoardingUtil","CabinBagsUtils","AEMConfig","FEATURE_CONFIG",function(e,i,n,t,r,o,a,s,c,d,l,u,g,y,p,b){var h=this,f=function(e){return{bookingModel:e.bookingModel,checkin:e.checkin,priorityBoarding:e.priorityBoarding,hasCabinBags:c.hasCabinBagItems(e.bookingModel),cabinBag:e.cabinBag,flightExtras:e.flightExtras}},k=n.connect(f,[t,a,r])(function(e,i){var n=babelHelpers.slicedToArray(i,3),t=n[0],r=n[1],o=n[2];h.$state=e,h.$actions={priority:t,checkin:r,cabinBags:o}}),P=o.onPhone(function(e){h.isMobile=e.matches}),B=function(e,i){var t=e.filter(function(e,n){return R.contains(n,i)&&!h.soldout[n]&&!h.maxedOutLegs[n]}),r=R.pipe(R.map(R.any(R.identity)),R.all(R.identity))(t);n.dispatch(a.setCTA(r))},m=function(e){return Object.assign(e,{isUnavailable:e.isUnavailable||e.type===u.CABIN_BAG})},$=function(e,i){return Object.assign(e,{isHidden:e.type===u.CABIN_BAG&&h.showWarningMessageForLauda(i)})},O=function(e,i){return!R.pipe(R.find(R.propEq("journeyNumber",e)),R.propOr(!1,"isAvailable"))(i)},v=function(e,i){var n=h.$state,t=n.checkin.priorityAvailability,r=n.cabinBag.meta,o=n.bookingModel.passengers,a=R.pipe(R.head,R.path(["model","type"]))(o),s=g.getPassengersCount(e,h.$state);h.maxedOutLegs[e]=h.maxedOutLegs[e]||!s,h.pbUnitPrice=g.getPriceForPriorityBoarding(e,h.$state);var c=h.pbUnitPrice*s;h.cbUnitPrice=R.path([e,"offers",l.CBAG,"prices",a],r);var d=h.cbUnitPrice*s;return[{type:u.PRIORITY_BOARDING,image:i+"/resources/ui/images/priority-and-cabin-bags/dropbag@2x.png",price:c,unitPrice:h.pbUnitPrice,isUnavailable:!1,isHidden:!1,isSoldOut:O(e,t)},{type:u.CABIN_BAG,image:i+"/resources/ui/images/priority-and-cabin-bags/holdbag@2x.png",price:d,unitPrice:h.cbUnitPrice,isUnavailable:!R.pathOr(!1,["priority-boarding-and-cabin-bags-at"],b),isHidden:!1,isSoldOut:!1}]},A=function(e){var i=[{isValid:h.selectedJourneys.every(c.isRyanairJourney),getOptions:function(){return e}},{isValid:h.selectedJourneys.some(c.isRyanairJourney)&&h.selectedJourneys.some(c.isLaudaJourney),getOptions:function(){return h.selectedJourneys.reduce(function(i,n,t){var r=h.showWarningMessageForLauda(n)?e[t].map(m):e[t];return Object.assign(i,babelHelpers.defineProperty({},t,r))},{})}},{isValid:h.selectedJourneys.every(c.isLaudaJourney),getOptions:function(){return h.selectedJourneys.reduce(function(i,n,t,r){var o=n.key.id;return Object.assign(i,babelHelpers.defineProperty({},o,e[o].map(function(e){return $(e,r[t])})))},{})}}];return i.find(function(e){return R.pathOr(!0,"isValid",e)}).getOptions()},J=function(e){return!angular.isUndefined(h.$state.checkin.selectedPassengersIds.find(function(i){return i===e.key.id}))},C=function(e){return Boolean(h.$state.checkin.prioritySelectionNewPolicy[e]||h.maxedOutLegs[e])},x=function(){h.areAllOptionsSelected=h.selectedJourneyNums.every(C),n.dispatch(a.setCTA(h.areAllOptionsSelected))},S=function(e,i){h.$actions.checkin.setCheckinPrioritySelectionNewPolicy(i,e)};this.updateAllForSelectedJourney=function(n){var t=n.journey,r=n.price,o=R.pathOr(0,["key","journey"],t);if(r&&h.$state.hasCabinBags&&h.$actions.cabinBags.removeFromBasket(),r)h.$actions.priority.addAllForSelectedJourneyAndPax(r,o,h.$state.checkin.selectedPassengersIds),h.$actions.checkin.setCheckinPrioritySelection(o,[!0,!1]);else{h.$actions.priority.removeAllForSelectedJourney(o),h.$actions.checkin.setCheckinPrioritySelection(o,[!1,!0]);var a=e[0].getElementsByClassName("orange-box")[0];i.$applyAsync(function(){d(a,{containerId:"dialog-body-slot",easing:"easeInQuad"})})}h.showWarningMessage=R.any(R.last)(h.$state.checkin.prioritySelection),B(h.$state.checkin.prioritySelection,h.selectedJourneyNums)},this.$onInit=function(){var e=y.getPaxWithCabinBagsByLeg(h.$state.bookingModel,h.$state.bookingModel.passengers,h.$state.checkin.selectedPassengersIds),i=s.getAvailablePriorityBoardingConfig(h.$state.bookingModel,h.$state.checkin),n=i.selectedJourneys,t=i.selectedJourneyNums,r=i.selectedPassengers,o=i.paxWithPriorityByLegs,a=i.maxedOutLegs,d=i.soldout,l=i.minPrice,u=i.discount;h.staticFilePrefix=p.getStaticFilePrefix(),h.$actions.priority.getPrices(r,n,!0),Object.assign(h,{selectedJourneys:n,selectedJourneyNums:t,paxWithPriorityByLegs:o,paxWithCabinBagsByLegs:e,maxedOutLegs:a,soldout:d,minPrice:l,discount:u}),B(h.$state.checkin.prioritySelection,h.selectedJourneyNums);var g=h.selectedJourneys.reduce(function(e,i){var n=Object.assign(e.defaultOptions,babelHelpers.defineProperty({},i.key.id,v(i.key.id,h.staticFilePrefix))),t=Object.assign(e.isLaudaJourney,babelHelpers.defineProperty({},i.key.id,c.isLaudaJourney(i)));return Object.assign(e,{defaultOptions:n},{isLaudaJourney:t})},{defaultOptions:{},isLaudaJourney:{}});h.options=A(g.defaultOptions),h.isLaudaJourney=g.isLaudaJourney,x()},this.showWarningMessageForLauda=function(e){return g.isCabinBagLaudaRulesDisabled(e)},this.cabinBagsText=[{text:"trips.checkin.priority.cabin-bag.all"},{text:"trips.checkin.priority.cabin-bag.additional"},{text:"trips.checkin.priority.cabin-bag.not"},{text:"trips.checkin.priority.cabin-bag.oversized"},{text:"trips.checkin.priority.cabin-bag.reduced_mobility"}],this.isOpen=!1,this.toggleInfos=function(){h.isOpen=!h.isOpen},this.shouldShowNewBagsComponent=function(){return g.isPriorityAndCabinBagsCampaignLaunched(h.selectedJourneys)},this.onToggle=function(e,i){var n=e.value;h.$actions.checkin.setCheckinPrioritySelectionNewPolicy(i,n),h.$state.checkin.prioritySelectionNewPolicy.map(S),x()},this.addPriorityBoarding=function(e){var i=h.$state.checkin.selectedPassengersIds.filter(function(i){return!R.length(c.getSoldSsrsForPaxAndJourneyByType(i,l.CBAG,e)(h.$state.bookingModel))});h.$actions.priority.addAllForSelectedJourneyAndPax(g.getPriceForPriorityBoarding(e,h.$state),e,i)},this.removePriorityBoarding=function(e){h.$actions.priority.removeAllForSelectedJourney(e)},this.addCabinBag=function(e){var i=h.$state.bookingModel.passengers.filter(function(i){return J(i)&&!R.length(c.getSoldSsrsForPaxAndJourneyByType(i.key.id,l.PRIOBRDNG,e)(h.$state.bookingModel))});h.$actions.cabinBags.addForJourneyLocally(i,e)},this.removeCabinBag=function(e){h.$actions.cabinBags.removeFromJourneyLocally(h.$state.checkin.selectedPassengersIds,e)},this.$onDestroy=function(){k(),P()}}]});


"use strict";angular.module("app.booking").component("covidDocsList",{templateUrl:"/partials/booking/checkin/covid-docs-list/covid-docs-list.html",bindings:{upload:"<",paxNum:"<",journeyNum:"<",error:"<",fetchPending:"<",onRemove:"&"},controller:function(){var o=this;this.remove=function(e){e.key&&!e.removing&&o.onRemove({$event:{fileKey:e.key,journeyNum:o.journeyNum,paxNum:o.paxNum}})},this.$onChanges=function(){o.files=(o.upload||[]).filter(function(e){return e.journeyNum===o.journeyNum&&e.paxNum===o.paxNum})}}});


"use strict";angular.module("app.booking").component("covidDocsUpload",{templateUrl:"/partials/booking/checkin/covid-docs-upload/covid-docs-upload.html",bindings:{fetchPending:"<",onUpload:"&"},controller:["$element","$timeout",function(n,e){var t=this;this.onBrowse=function(){n.find("input")[0].click()},n.find("input")[0].addEventListener("change",function(n){t.onUpload({$event:n.target.files})});var o=n.find(".covid-docs-upload__drop-area")[0];o.addEventListener("dragenter",function(n){n.preventDefault(),e(function(){t.active=!0})}),o.addEventListener("dragleave",function(n){n.preventDefault(),e(function(){t.active=!1})}),o.addEventListener("dragover",function(n){n.preventDefault(),e(function(){t.active=!0})}),o.addEventListener("drop",function(n){n.preventDefault(),e(function(){t.active=!1}),t.onUpload({$event:n.dataTransfer.files})})}]});


"use strict";angular.module("app.booking").component("covidDocuments",{templateUrl:"/partials/booking/checkin/covid-documents/covid-documents.html",bindings:{paxWithUpload:"<",hasCommitError:"<",uploadEnabled:"<",canUpload:"<"},controller:["$ngRedux","BookingRead","CheckinModelActions",function(n,o,i){var t=this,e=function(n){var o=n.checkin.upload,i=n.checkin.uploadFetchPending||n.checkin.uploadCommitPending;return{upload:o,fetchPending:i,canCommit:!i&&o.some(function(n){return!n.isFileSaved&&!n.pending})}},c=n.connect(e,[i])(function(n,o){var i=babelHelpers.slicedToArray(o,1),e=i[0];t.$state=babelHelpers["extends"]({},t.$state,n),t.$actions={checkin:e}});this.setCurJourney=function(n){t.curJourney=n},this.upload=function(o){o.length&&n.dispatch(i.uploadCovidDocs(Array.prototype.slice.call(o),t.curJourney,t.curPax))},this.remove=function(o){n.dispatch(i.removeCovidDoc(o.fileKey,o.journeyNum,o.paxNum))},this.commit=function(){t.$state.canCommit&&n.dispatch(i.commitCovidDocs())},this.setCurPax=function(n){t.curPax=n,t.paxWithUpload&&t.paxWithUpload[n]&&(t.curJourney=t.paxWithUpload[n].journeys.find(function(n){return n.available}).key.id)},this.$onInit=function(){var n=t.paxWithUpload.find(function(n){return n.canUpload});n&&t.setCurPax(n.pax.num)},this.$onDestroy=function(){c()}}]});


"use strict";angular.module("app.booking").component("dangerousGoodsPolicy",{templateUrl:"/partials/booking/checkin/information-templates/dangerous-goods-policy.html",controller:function(){this.dangerousGoodsList=["explosives","weapon","flammable","petrol","gas","oil","paint","magnetised","battery","corrosives","organic_peroxides","radioactives","toxic","smart_bags"]}});


"use strict";angular.module("app.booking").component("selectSeats",{templateUrl:"/partials/booking/checkin/select-seats/select-seats.html",bindings:{seatConfirmation:"<",onOpenMobileSeatInfo:"&"},controller:["$scope","ModelQuery","$document","newDialogEnabled","AdobeAnalytic","SeatsActions","$ngRedux","BookingRead","SelectSeatService","BookingReadCheckinJourney","$stateParams","CheckinModelActions","CheckinAllocationActions","CheckinFlow","$q","CHECKIN","FareUpgradeActions","DialogManager","AEMConfig","PriorityBoardingActions","PRIORITY_BOARDING_WITH_BAGS_POPUP_IMAGES","BREAKPOINTS","FEATURE_CONFIG","TargetService","CheckinModelSelectors","SeatsService",function(e,t,n,o,i,a,s,r,c,l,u,g,d,p,h,S,y,m,k,b,f,A,M,$,P,v){var C=this,I=void 0,F=function(e){return{checkin:e.checkin,bookingModel:e.bookingModel,selectedSeats:R.pipe(t.byIdentity("seats"),t.byRemoved(!1))(e.bookingModel),seatMapMessage:c.computeSeatMapMessage(e),priorityBoarding:e.priorityBoarding,hasCabinBags:r.hasCabinBagItems(e.bookingModel)}},B=R.once(function(e,t,n){var o=r.isConnectingFlight(e.bookingModel);C.outboundSegmentsCount=r.getOutboundSegments(e.bookingModel).length,C.inboundSegmentsCount=r.getInboundSegments(e.bookingModel).length,C.journey=c.getJourney(e.bookingModel,n.journey),C.segment=R.pipe(r.getSegmentsByKey({id:n.segment,journeys:n.journey}),R.head)(e.bookingModel),C.selectedPassengers=r.isPlusUpgradeAdded(e.bookingModel)?r.get("passengers",e.bookingModel):r.getPassengersByIds(e.checkin.selectedPassengersIds,e.bookingModel),C.currentSeatMapIndex=c.getCurrentSeatMapIndex(o),C.currentUpgradeSeatMapIndex=c.getCurrentUpgradeSeatMapIndex(o),C.orig=R.path(["journeys",C.journey.key.id,"model","orig"],e.bookingModel),C.dest=R.path(["journeys",C.journey.key.id,"model","dest"],e.bookingModel),n.isUpgrade||P.hasAllocationChoiceSegment(e,n.journey)&&P.isAllocationFormElementForSeats(R.path(["checkin","allocationForm",n.journey],e))||(t.checkin.showAllocationOptions(n.journey),M["open-seatmap-in-check-in"]&&t.allocations.resetJourneyAllocationForm(u.journey))}),E=function(e){return function(t,n){var o=babelHelpers.slicedToArray(n,4),i=o[0],a=o[1],s=o[2],r=o[3],c={checkin:i,allocations:a,seats:s,priority:r};Object.assign(e,{$state:t,$actions:c}),B(t,c,u)}},j=function(){var e=p.getNextRoute(C.$state),t=e.route;if(t!==S.ROUTES.SEATS){var n=R.path(["key","id"],C.journey),o=R.path(["key","id"],C.segment),i=R.pipe(r.getSeatItems(!1,!1),v.getSeatItemsByJourneyAndSegment(n,o))(s.getState().bookingModel),a=r.isPlusUpgradeAdded(C.$state.bookingModel),c=l.allSeated(C.selectedPassengers,C.$state.bookingModel,C.$state.bookingModel.journeys),u=R.pipe(r.getSeatItems(!1,!0),v.getSeatItemsByJourneyAndSegment(n,o),R.filter(function(e){return!i.some(function(t){return R.equals(e.key,t.key)})}))(s.getState().bookingModel),g=function(){a||s.dispatch(y.getEligibleFareTypeForUpgrade())},d=R.when(R.both(function(){return a},function(){return c}),function(){return h.when("skipStepUpdate")});return C.$actions.seats.confirmSeats(i.concat(u)).then(g).then(d)}return s.dispatch(C.$actions.seats.setDrawerCloseError("")),h.when(!0)},T=function(e,t){var o=p.getNextRoute(C.$state),i=o.state,a=r.isPlusUpgradeAdded(C.$state.bookingModel),s=R.pipe(R.map(function(e){return P.isAllocationFormElementForSeats(R.path(["checkin","allocationForm",e],C.$state))}),R.ifElse(function(){return M["open-seatmap-in-check-in"]},R.last,R.any(R.identity)))(e);return M["pb-pop-up-in-checkin-seatmap"]&&!C.isConnectingFlight&&!R.isEmpty(e)&&n[0].querySelector("select-seats")&&t&&!a&&!C.$state.hasCabinBags&&i!==S.ROUTES.SEATS&&s},O=function(){if(M["open-seatmap-in-check-in"]&&!P.hasFlightsToCheckin(C.$state))return m.closeAllDialogs(),h.reject();var e=p.getAvailablePriorityBoardingConfig(C.$state.bookingModel,C.$state.checkin),t=e.selectedJourneys,n=e.selectedJourneyNums,o=e.selectedPassengers,i=e.maxedOutLegs,a=e.soldout,s=e.minPrice,r=e.isPriorityAvailableForSelectedLegs;C.$actions.priority.getPrices(o,t,!0);var c=R.filter(function(e){return!a[e]&&!i[e]},n);if(!T(c,r))return j();var l=k.getStaticFilePrefix(),u=R.pathOr(!1,["pb-seats-popup-sash-tag-enabled"],M),g=$.isPbSashTagVisibleInSeatsSection();return m.openConfirm("priorityBoardingPopup",{template:"/partials/extras/priority/directives/priority-boarding-with-bags-popup.html",className:"extra-offer-popup-dialog",appendTo:"select-seats",data:{minPrice:s,images:R.map(function(e){return l+"/"+e},f),mobileScreen:A.phone,sashTagBackground:l+"/resources/ui/images/BS_Sash",isSashTagVisible:u&&g},overlay:!1},!1).then(function(){return C.$actions.checkin.setPriorityPopupAcceptedJourneyNums(c),c.forEach(function(e){C.$actions.priority.addAllForSelectedJourneyAndPax(s,e,C.$state.checkin.selectedPassengersIds)}),j()})["catch"](function(){return j()})},U=function(){return C.$actions.seats.reset(),h.resolve()};this.shouldHideSameSeatsPrompt=function(){return M["open-seatmap-in-check-in"]},this.seatAdded=function(e){var t=e.seat;i.trackProductAction(i.getAreas().checkIn,"Added Seat "+t.model.code,"SEATS",p.currentStep(s.getState()),p.previousStep(s.getState())),C.$actions.checkin.setCtaOnSeatMap({journeys:u.journey,segments:u.segment})},this.seatRemoved=function(e){var t=e.designator;i.trackProductAction(i.getAreas().checkIn,"Removed Seat "+t,"SEATS",p.currentStep(s.getState()),p.previousStep(s.getState())),C.$actions.checkin.setCtaOnSeatMap({journeys:u.journey,segments:u.segment})},this.toggleMobileSeatMapInfo=function(e){C.onOpenMobileSeatInfo({$event:e})},e.$evalAsync(function(){var e=o()?".core-modal-container":".no-footer-mobile",t=n[0].querySelector(e);t&&(C.seatMapHeight={height:t.getBoundingClientRect().height-110+"px"})}),this.$onInit=function(){var e=[g,d,a,b];I=s.connect(F,e)(E(C)),C.$state.checkin.priorityPopupAcceptedJourneyNums&&(C.$state.checkin.priorityPopupAcceptedJourneyNums.forEach(function(e){C.$actions.priority.removeAllForSelectedJourney(e)}),C.$actions.checkin.setPriorityPopupAcceptedJourneyNums()),p.setCurrentTask(O),p.setBackTask(U),C.isConnectingFlight=r.isConnectingFlight(C.$state.bookingModel)},this.$onDestroy=function(){I()}}]});


"use strict";angular.module("app.booking").service("SelectSeatService",["BookingRead","CheckinFlow","$state","$stateParams",function(e,r,t,n){var a=this;this.computeSeatMapMessage=function(e){var r=R.pathOr(!1,["seats","drawerCloseError"],e);return r?{type:"error",message:r}:""},this.getJourney=function(r,t){return R.pipe(e.getJourneyFromId(t),R.head)(r)},this.getCurrentSeatMapIndex=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.journey,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.segment;if(e){if(0===r&&0===t)return 0;if(0===r&&1===t)return 1;if(1===r&&0===t)return 2;if(1===r&&1===t)return 3}return r},this.getCurrentUpgradeSeatMapIndex=function(e){return n.isUpgrade?a.getCurrentSeatMapIndex(e):void 0}}]);


"use strict";angular.module("app.booking").component("addedTravelDocuments",{templateUrl:"/partials/booking/checkin/directives/added-travel-documents.html",bindings:{pax:"<",travelDoc:"<",documentsRules:"<",nationalities:"<",isDomestic:"<",canEdit:"<",onEditPressed:"&"},controller:function(){var t=this,e=function(t,e){return t.find(function(t){return t.code===e})};this.$onChanges=function(){t.docTypeName=R.pipe(R.pathOr([],["acceptedDocumentTypes"]),R.find(function(e){return e.typeCode===R.path(["travelDoc","docType"],t)}),R.path(["typeName"]))(t.documentsRules),t.nationality=R.path(["nationality"],e(t.nationalities,t.travelDoc.nationality)),t.countryOfIssue=R.path(["name"],e(t.nationalities,t.travelDoc.countryOfIssue)),t.showAmericanPassportWarning=(t.isDomestic||R.propEq("docType","P",t.travelDoc))&&R.propEq("nationality","US",t.travelDoc)},this.showDetails=!1}});


"use strict";angular.module("app.booking").directive("infoPaymentBanner",function(){return{restrict:"EA",templateUrl:"/partials/booking/checkin/directives/info-payment-banner.html",controllerAs:"vm",controller:["$log","$attrs","$parse","$scope","$timeout",function(n,e,t,o,r){n.log("[infoPaymentBanner]: Info Payment Banner directive loaded");var i=5e3;this.state=t(e.infoPaymentBanner)(o),this.price=t(e.infoPaymentBannerPrice)(o);var a=r(function(){o.nextStep()},i);o.actions.confirm=function(){r.cancel(a),o.nextStep()},o.$on("$destroy",function(){n.log("Destroy infoPaymentBanner"),r.cancel(a)})}]}});


"use strict";angular.module("app.booking").directive("infoSlider",function(){return{restrict:"A",scope:{isOpen:"=",infoTitle:"@",infoMessage:"@",infoMessageTxKey:"@?"},templateUrl:"/partials/booking/checkin/directives/info-slider.html"}});


"use strict";angular.module("app.booking").component("moreLessExpander",{bindings:{isOpen:"=",title:"@",messageTxKey:"@?",type:"@"},templateUrl:"/partials/booking/checkin/directives/more-less-expander.html"});


"use strict";angular.module("app.booking").component("productBanner",{templateUrl:"/partials/booking/checkin/directives/product-banner.html",bindings:{title:"<",subTitle:"<",minPrice:"<"}});


"use strict";angular.module("app.booking").directive("progressTabs",function(){return{restrict:"A",templateUrl:"/partials/booking/checkin/directives/progress-tabs.html",scope:{namespace:"=?",milestones:"=",steps:"=",currentStep:"=",isSeatMapWithPaxCarousel:"<"}}});


"use strict";angular.module("app.booking").component("selectPax",{templateUrl:"/partials/booking/checkin/directives/select-pax.html",controller:["BookingRead","BookingReadCheckin","$ngRedux","CheckinModelActions","CheckinModelSelectors","CheckinFlow","$q",function(e,t,n,s,o,i,c){var a=this,r=function(e){var t=e.checkin,n=e.bookingModel;return n.passengers.map(function(e){return R.contains(e.key.id,t.selectedPassengersIds)})},l=function(e){return{selectedPassengers:o.getSelectedPassengers(e),checkin:e.checkin,bookingModel:e.bookingModel,passengersIdSelection:r(e)}},g=function(e){return function(t,n){Object.assign(e,{$state:t,$actions:{checkin:n}})}},d=n.connect(l,s)(g(this));this.passengers=this.$state.bookingModel.passengers;var k=function(e){return a.$state.selectedPassengers.some(function(t){return t.key.id===e.key.id})},u=R.compose(R.contains(R.__,["TEEN","CHD"]),R.path(["model","type"]));this.getMessageType=function(n){var s=t.isPaxCheckedIn(n,a.$state.bookingModel),o=babelHelpers["extends"]({},a.$state.bookingModel,{selectedPassengers:a.$state.selectedPassengers}),i=e.isJourneyFlown(0,a.bookingModel)&&!k(n),c=!k(n)&&t.isPaxCheckinActive(n,o)&&t.isPaxCheckedInForAnyJourney(n,a.$state.bookingModel),r=k(n)&&!t.canPaxSelectCheckin(n,o);return s?"success":i||c||r?"warning":""},this.getMessage=function(n){return!k(n)&&t.isPaxCheckinActive(n,a.$state.bookingModel)&&e.isReturnTrip(a.$state.bookingModel)?t.canPaxSelectCheckinForJourney(0,n,a.$state.bookingModel)?"no_outbound":"no_return":k(n)&&!t.canPaxSelectCheckin(n,babelHelpers["extends"]({},a.$state.bookingModel,{selectedPassengers:a.$state.selectedPassengers}))&&u(n)?"TEEN"===n.model.type?"teen_validation":"child_validation":""},this.isPassengerSelected=k,this.toggleInfo=function(){a.moreInfo=!a.moreInfo},this.selectAll=function(){var e=R.pathOr([],["bookingModel","passengers"],a.$state).map(function(e){return e.key.id});a.$actions.checkin.selelectPassengers(e)},this.isPaxSelected=function(e){return a.$state.selectedPassengers.some(function(t){return t.key.id===e.key.id})},this.onUpdateSelection=function(e){a.$state.selectedPassengers.some(function(t){return t.key.id===e.key.id})?a.$actions.checkin.unselectPassenger(e.key.id):a.$actions.checkin.selectPassenger(e.key.id)},this.$onInit=function(){a.$actions.checkin.setShowBackBtn(!1),i.setCurrentTask(function(){return c.resolve()}),a.getSeatDesignator=e.getSeatDesignator(a.$state.bookingModel),a.isReturnTrip=function(){return e.isReturnTrip(a.$state.bookingModel)},a.cities={originCity:e.getOriginCity(a.$state.bookingModel),destCity:e.getDestCity(a.$state.bookingModel),connectingCity:e.getConnectingCity(a.$state.bookingModel)},a.showSelectAll=e.getPaxCount(a.$state.bookingModel)>2},this.getSeatForSegment=function(e,t){return R.pipe(R.find(function(e){return e.key.segments===t}),R.path(["model","code"]))(e)},this.$onDestroy=function(){d()}}]});


"use strict";!function(e){var s=function(){function e(s){"ngInject";babelHelpers.classCallCheck(this,e),Object.assign(this,{$q:s}),this.productServices=[],this.selectedPassengers=[],this.selectedJourneys=void 0}return e.$inject=["$q"],e.prototype.reset=function(){this.productServices=[],this.selectedPassengers=[],this.selectedJourneys=void 0},e.prototype.setSelectedJourneys=function(e,s){var t=this,n=[].concat(e);s?this.selectedJourneys=n:n.forEach(function(e){t.isJourneySelected(e)||t.selectedJourneys.push(e)})},e.prototype.deselectJourney=function(e){return e?void(~this.selectedJourneys.indexOf(e)&&this.selectedJourneys.splice(this.selectedJourneys.indexOf(e),1)):void(this.selectedJourneys=[])},e.prototype.isPassengerSelected=function(e){return!!R.find(function(s){return s.model.num!==e.model.num},this.selectedPassengers)},e.prototype.setSelectedPassengers=function(e,s){var t=this;s?this.selectedPassengers=e:e.forEach(function(e){t.isPassengerSelected(e)||t.selectedPassengers.push(e)})},e.prototype.selectedPaxHasPurchasedSeatsForSelectedJourneys=function(e,s){var t=this.selectedJourneys.map(function(e){var s=e.key;return s.id}),n=this.selectedPassengers.map(function(e){var s=e.key;return s.id});return R.pipe(R.filter(function(e){var s=e.key;return R.contains(R.path(["journeys"],s),t)}),R.filter(function(e){var s=e.key;return R.contains(R.path(["passengers"],s),n)}),R.filter(function(e){var t=e.model;return t.sold===s}),R.length,R.equals(R.multiply(R.pathOr(0,["length"],this.selectedPassengers),R.pathOr(0,["length"],this.selectedJourneys))))(e)},e}();e.module("app.booking").service("CheckinModel",s)}(angular);


"use strict";!function(t){var e=function(){function t(e,n,r,a){"ngInject";babelHelpers.classCallCheck(this,t),Object.assign(this,{FEATURE_CONFIG:e,FlightExtras:n,BookingRead:r,CARD_CODES:a})}return t.$inject=["FEATURE_CONFIG","FlightExtras","BookingRead","CARD_CODES"],t.prototype.getProducts=function(){var t=this,e=[{order:1,code:"BAGS",flag:"checkin-products-bags",image:"product-bag",tag:'<bags-product\n                  products="$ctrl.$state.products"\n                  bags="$ctrl.$state.bags"\n                  booking="$ctrl.$state.bookingModel"\n                  passengers="$ctrl.passengers"\n                  journeys="$ctrl.$state.allAvailableJourneys"\n                  on-change="$parent.$parent.$ctrl.setStatus($event)">\n              </bags-product>'},{order:2,code:"CBAG",flag:"checkin-products-cabin-bag",image:"product-cabin-bag",tag:'<cabin-bag-product\n                  passengers="$ctrl.passengers"\n                  journeys="$ctrl.journeys"\n                  on-change="$parent.$parent.$ctrl.setStatus($event)">\n              </cabin-bag-product>'},{order:3,code:"INSURANCE",flag:"checkin-products-insurance",image:"product-insurance",tag:'<insurance-product\n                  products="$ctrl.$state.products"\n                  passengers="$ctrl.passengers"\n                  countries="$ctrl.$state.countries"\n                  on-change="$parent.$parent.$ctrl.setStatus($event)">\n              </insurance-product>'},{order:4,code:"FAST",flag:"checkin-products-fasttrack",image:"product-fast-track",tag:'<fasttrack-product\n                  products="$ctrl.$state.products"\n                  passengers="$ctrl.passengers"\n                  journeys="$ctrl.$state.bookingModel.journeys"\n                  booking="$ctrl.$state.bookingModel"\n                  on-change="$parent.$parent.$ctrl.setStatus($event)">\n              </fasttrack-product>'},{order:5,code:"PARKING",flag:"checkin-products-parking",image:"product-parking",tag:'<parking-product\n                  on-toggle="$parent.$parent.$ctrl.toggleCard()"\n                  on-change="$parent.$parent.$ctrl.setStatus($event)">\n              </parking-product>'},{order:6,code:"TRANSFERS",flag:"checkin-products-transfers",image:"product-transfers",tag:'<transfers-product\n                  on-change="$parent.$parent.$ctrl.setStatus($event)">\n              </transfers-product>'},{order:7,code:"INFLIGHT",flag:"inflight-meals-in-ci-flow",image:"product-onboard-meals",tag:'<inflight-products\n                  passengers="$ctrl.passengers"\n                  journeys="$ctrl.$state.bookingModel.segments"\n                  inflight-products="$ctrl.$state.inflightProducts"\n                  booking-model="$ctrl.$state.bookingModel"\n                  on-change="$parent.$parent.$ctrl.setStatus($event)">\n              </inflight-products>'}],n=e.filter(function(e){return t.FEATURE_CONFIG[e.flag]});return this.FlightExtras.getExtras(n.map(function(t){return t.code}).join(","),{isPotential:!1},{isCheckInFlow:!0}).then(function(e){return e.reduce(function(e,r){var a=n.find(function(t){return t.code===r.code}),c={};return"BAGS"===r.code&&(c.upgradable=t.FEATURE_CONFIG["5kg-upgrade"]?r.upgradable:!1),[].concat(babelHelpers.toConsumableArray(e),[Object.assign(r,a,c)])},[])})},t}();t.module("app.booking").service("CheckinProducts",e)}(angular);


"use strict";!function(t){var e=function(){function t(e,n,i,o,s,r,u){"ngInject";babelHelpers.classCallCheck(this,t),Object.assign(this,{$q:e,$http:n,RezCountries:i,RezApiConfig:o,Stations:s,BookingRead:r,ModelQuery:u}),this.travelDocuments=void 0,this.countries=void 0,this.stations=void 0,this.CHECKIN_OPTIONS={PAID:"paid",EARLY:"early",FREE:"free",JUSTCHECKIN:"justCheckin",LATER:"later"},this.CHECKIN={OPTIONS:this.CHECKIN_OPTIONS,ENABLED:[this.CHECKIN_OPTIONS.PAID,this.CHECKIN_OPTIONS.EARLY,this.CHECKIN_OPTIONS.FREE,this.CHECKIN_OPTIONS.JUSTCHECKIN],DISABLED:[this.OPTIONS_LATER],SEATMAP:[this.CHECKIN_OPTIONS.EARLY,this.CHECKIN_OPTIONS.PAID]}}return t.$inject=["$q","$http","RezCountries","RezApiConfig","Stations","BookingRead","ModelQuery"],t.prototype.getSeatMapLegs=function(t,e){var n=this;return e.filter(function(e){return R.contains(t[e.key.id],n.CHECKIN.SEATMAP)})},t.prototype.getCountryNameFromCode=function(t){return this.getCountries().then(function(e){return e.find(function(e){return e.code===t})})},t.prototype.getDocumentFromType=function(t){return this.getDocumentTypes().then(function(e){return e.acceptedDocumentTypes.find(function(e){return e.typeCode===t}).typeName})},t.prototype.getNameFromIATAs=function(t){var e=this,n=function(){return t.map(function(t){return(e.stations[t]||{}).name})};return this.stations?this.$q.when(n()):this.Stations.query().then(function(t){return e.stations=t,n()})},t.prototype.getCountriesFromIATAs=function(t){var e=this;return this.stations?this.$q.when(t.map(function(t){return e.stations[t].country})):this.RezCountries.get().then(function(n){return e.stations=n,t.map(function(t){return e.stations[t].country})})},t.prototype.getCountries=function(){var t=this;return this.countries?this.$q.when(this.countries):this.RezCountries.get().then(function(e){return t.countries=e,t.countries})},t.prototype.getDocumentTypes=function(){var t=this;return this.travelDocuments?this.$q.when(this.travelDocuments):this.$http.get(this.RezApiConfig.checkin.travelDocuments).then(function(e){return t.travelDocuments=e.data,t.travelDocuments})},t.prototype.getMappedPassengers=function(t,e,n){var i=this,o={seats:e};return t.map(function(t){return babelHelpers["extends"]({},t.model,{seats:n.reduce(function(e,s){var r=R.path(["model"],i.BookingRead.getSeatByKey({journeys:s.key.journeys,segments:s.key.id,passengers:t.key.id})(o));return n.length>1&&!r&&(r={sold:!0}),R.path(["sold"],r)?e.concat(r):e},[])})})},t}();t.module("app.booking").service("CheckinUtil",e)}(angular);


"use strict";angular.module("app.booking").component("documentForm",{templateUrl:"/partials/booking/checkin/travel-documents/document-form.component.html",bindings:{isChangeDocument:"<",documentError:"<",customerDocs:"<",currentDocument:"<",currentSavedDocument:"<",defaultAdditionalVisitInfo:"<",documentsLoaded:"<",documentInBookingModel:"<",isDomestic:"<",isReturnTrip:"<",pax:"<",inFlightDate:"<",outFlight:"<",outFlightDate:"<",fats:"<",nationalities:"<",documentsRules:"<",euOnlySegments:"<",myRyanairDob:"<",myRyanairNationality:"<",onDocumentUpdate:"&",onSelectDocument:"&",onFormInit:"&"},controller:["$ngRedux","TravelDocumentsService","DOC_RULES_COUNTRIES","$scope","TURKISH_VISA_CONFIG","GERMAN_PERMIT_CONFIG","Dates",function(t,e,i,o,n,a,r){var c=this,s=!0;this.germanPermitTypes=a.types;var u=[],d=function(){return e.getDocumentTypes(c.passportOnlyAllowed,c.documentsRules,c.nationality,c.nationalities,c.dob,c.outFlightDate,c.euOnlySegments)},l=function(t,i,o){var n=t;return e.isEmptyDoc(t)&&i.length>1&&!o&&(n=i[i.length-1],c.onSelectDocument({$event:{doc:babelHelpers["extends"]({},n,{dob:c.dob,nationality:n.nationality||c.nationality})}})),babelHelpers["extends"]({},n,{documentId:e.getDocumentId(n,i)})},D=function(){if(c.isDomestic||!e.isEmptyDoc(c.currentDoc)){var t=c.isDocumentWithNoExpiryDate&&c.isExpiryDateCheckboxVisible()?null:c.expiryDate;c.onDocumentUpdate({$event:babelHelpers["extends"]({},c.currentDoc,{acceptUkResidency:c.showConfirmUkResidency&&c.currentDoc.acceptUkResidency||c.autoConfirmUkResidency,dob:c.dob,nationality:c.nationalityDirty||R.pathEq(["currentDoc","documentId"],"another",c)?c.nationality:c.currentDoc.nationality,expiryDate:t,saveToMyRyanair:!!c.saveDocuments&&!!c.canSaveDocument})})}};this.clearDocNumber=function(){var t=R.pathOr(!1,["docNumber"],c.currentDoc);(!t||t&&R.contains("*",t))&&(c.currentDoc.docNumber="")};var y=function(){c.isMyRyanairDoc=c.customerDocs.length&&c.customerDocsDecision&&c.customerDocsDecision.documentId&&"another"!==c.customerDocsDecision.documentId,c.passportPattern=c.isMyRyanairDoc?void 0:/^[A-Za-z0-9_]+$/},p=R.once(function(t,e,i){var o=void 0;e&&!R.isEmpty(e)&&(o=l(t,e,i)),c.customerDocsDecision=o,y(),c.changeExpiryDateState(),c.currentDoc=R.clone(c.customerDocsDecision)}),m=function(){c.isTurkishVisaWarningVisible=c.documentsLoaded&&c.nationality!==n.nationality&&c.destCountryCode===n.countryCode},h=function(){var t=R.propOr("","checkin-require-german-permit-countries",c.launchDarkly);if(!R.isNil(c.nationality)&&c.destCountryCode&&c.origCountryCode){var i="GB"===c.nationality.toUpperCase(),o=i||!e.isEEACitizen(c.nationality,c.nationalities),n=c.destCountryCode===a.countryCode&&t.indexOf(c.origCountryCode.toUpperCase())>=0,r=c.origCountryCode===a.countryCode&&t.indexOf(c.destCountryCode.toUpperCase())>=0&&c.isReturnTrip;c.showGermanPermitSection=!!R.prop("travel-documents-special-visa-enabled",c.launchDarkly)&&(!c.currentDoc.hasBiometricPassport||!c.nationalities.some(function(t){return t.code===c.nationality.toUpperCase()&&t.isBioSn}))&&o&&(n||r)}c.isGermanPermitTypeSelected=!R.isNil(R.path(["specialVisaDetails","docType"],c.currentDoc))},f=r.utc("2021-10-01T00:00:00Z"),g=function(){if(!R.isNil(c.nationality)&&c.destCountryCode&&c.origCountryCode){var t=R.propOr(!1,"brexit-eea-id-validation-enabled",c.launchDarkly)&&"I"===c.currentDoc.docType&&"GB"!==c.nationality&&"IE"!==c.nationality&&"GI"!==c.nationality&&!c.isDomestic;c.autoConfirmUkResidency=t&&!c.isReturnTrip&&"GB"===c.origCountryCode.toUpperCase()&&c.outFlightDate.isAfter(f),c.showConfirmUkResidency=t&&("GB"===c.destCountryCode.toUpperCase()&&c.outFlightDate.isAfter(f)||"GB"===c.origCountryCode.toUpperCase()&&c.isReturnTrip&&c.inFlightDate.isAfter(f))}};this.selectRetrievedDocument=function(){c.nationalityDirty=!1,y(),c.onSelectDocument({$event:{doc:c.customerDocsDecision}}),c.changeExpiryDateState(),c.currentDoc=R.clone(c.customerDocsDecision),R.pathEq(["documentId"],"another",c.customerDocsDecision)&&(c.currentDoc.docNumber="")},this.validateDateOfBirth=function(t){return"Invalid date"!==t?(c.documentForm.$setValidity("dobInvalid",!0),t):(c.documentForm.$setValidity("dobInvalid",!1),!1)},this.validateExpiryDate=function(t){return(t<c.expiryDateRange.min||t>c.expiryDateRange.max)&&(t="Invalid date"),c.documentForm?c.isDocumentWithNoExpiryDate&&c.isExpiryDateCheckboxVisible()?(c.expiryDateForm.dateForm.$setValidity("expiryDateInvalid",!0),c.documentForm.$setValidity("expiryDateInvalid",!0),!1):"Invalid date"!==t?(c.expiryDateForm.dateForm.$setValidity("expiryDateInvalid",!0),c.documentForm.$setValidity("expiryDateInvalid",!0),t):(c.expiryDateForm.dateForm.$setValidity("expiryDateInvalid",!1),c.documentForm.$setValidity("expiryDateInvalid",!1),!1):!0},this.isExpiryDateCheckboxVisible=function(){return"I"===R.path(["docType"],c.currentDoc)&&i.expiryDate.some(function(t){return t===R.path(["countryOfIssue"],c.currentDoc)&&t===c.nationality})},this.isBritishCheckboxVisible=function(){return!(R.path(["docType"],c.currentDoc)&&"P"!==R.path(["docType"],c.currentDoc)||"GB"!==R.path(["countryOfIssue"],c.currentDoc)&&"GB"!==c.nationality||"gb"===c.origCountryCode&&c.isDomestic)},this.changeExpiryDateState=function(){c.isDocumentWithNoExpiryDate=c.currentDoc.docNumber&&!c.currentDoc.expiryDate,c.updateExpiryDate()},this.isSaveToMyRyanairVisible=function(){if(!c.canSaveDocument||c.isDomestic)return!1;if(!c.isExpiryDateCheckboxVisible())return!0;var t=c.isExpiryDateCheckboxVisible()&&!c.isDocumentWithNoExpiryDate;return t?!1:!0},this.updateExpiryDate=function(){var t=e.formatExpiryDate(R.path(["expiryDate"],c.currentDoc));return!c.isExpiryDateCheckboxVisible()&&t?void(c.expiryDate=t):void(c.expiryDate=c.isDocumentWithNoExpiryDate?null:t||null)},this.onUpdate=function(t){switch(t){case"nationality":c.nationalityChanged=c.nationality!==c.previousNationality,c.previousNationality=c.nationality,c.nationalityDirty=c.nationalityChanged,s&&(c.nationalityDirty=!0,s=!1),c.nationalityChanged=!1,c.documentTypes=d(),c.changeExpiryDateState(),m(),h(),g();break;case"dob":c.documentTypes=d();break;case"type":case"countryOfIssue":c.changeExpiryDateState(),g();break;case"saveDocuments":c.saveDocuments=!c.saveDocuments;break;case"hasBiometricPassport":h()}D()},this.maxLength={visitLength:5,addressLine:52,city:32,postcode:10,italianPostcode:5},this.minLength={postcode:0,italianPostcode:5},this.pattern={visitLength:"[1-9]\\d*",postcode:"[a-zA-Z0-9]+[ -]?[a-zA-Z0-9]+",italianPostcode:"[0-9]+"};var x=function(t){return{launchDarkly:t.launchDarkly}};this.$onInit=function(){u.push(t.connect(x)(function(t){var e=t.launchDarkly;c.launchDarkly=e})),c.myRyanairLogos=e.getMyRyanairLogos(),c.countriesOfIssue=c.nationalities,c.isDniSelected=c.isDomestic&&("D"===R.path(["model","residentInfo","docType"],c.pax)||"S"===R.path(["model","residentInfo","docType"],c.pax)),c.isDniSelected&&(c.nationality="ES"),c.visaPattern=/^[A-Za-z0-9_]+$/,y()},this.$onChanges=function(){c.currentDoc=R.clone(c.currentDocument),c.visitInfoDisabled=!!R.path(["additionalVisitInfo","contactEmail"],c.currentSavedDocument),c.currentDoc.additionalVisitInfo||(c.currentDoc.additionalVisitInfo=c.defaultAdditionalVisitInfo||{address:{}}),c.countriesOfIssue=c.nationalities,c.hasUKAPD=e.hasUKAPD(c.pax,c.fats),c.invalidUKAPD=e.isValidUKAP(c.pax,c.paxDob,c.hasUKAPD,c.inFlightDate),c.customerDocsOptions=e.getCustomerDocsOptions(c.customerDocs,c.euOnlySegments,c.documentInBookingModel),c.dateOfBirthRange=e.getDateOfBirthRange(R.path(["model","type"],c.pax),c.outFlightDate,c.inFlightDate),c.expiryDateRange=e.getExpiryDateRange(c.inFlightDate),c.passportOnlyAllowed=e.isPassportOnlyAllowed(c.documentsRules,c.outFlight,c.euOnlySegments),c.canSaveDocument=e.canSaveDocument(c.currentDoc,c.customerDocs)&&!c.documentError,c.documentTypes=d(),c.updateExpiryDate();var t=R.path(["dob"],c.currentDoc);10===R.path(["length"],t)?c.dob=t:c.dob=e.formatDob(c.pax,t,c.myRyanairDob,c.dateOfBirthRange);var i=c.nationality;c.nationality=c.currentDoc.nationality||!R.isEmpty(c.currentDoc)&&c.documentsLoaded&&e.getNationality(c.currentDoc,c.myRyanairNationality)||i,c.nationalityDirty=!1,c.nationality&&!s&&(s=!0,c.isDocumentWithNoExpiryDate=c.currentDoc.docNumber&&!c.currentDoc.expiryDate),c.disableDOBField=e.isDobDisabled(c.pax)||c.isChangeDocument,c.showDocumentsDropdown=c.customerDocsOptions&&c.customerDocsOptions.length>1&&!c.isDomestic,c.showDocumentsDropdown&&p(c.currentDoc,c.customerDocsOptions,c.isDomestic),c.updateDateModel=!c.updateDateModel,c.showAmericanPassportWarning=(c.isDomestic||R.propEq("docType","P",c.currentDoc))&&"US"===c.nationality;var o=R.pathOr("",["model","destCountry"],c.outFlight);c.destCountryCode=o.toLowerCase(),c.origCountryCode=R.pathOr("",["model","origCountry"],c.outFlight).toLowerCase(),c.toItaly="it"===c.destCountryCode;var n=(c.nationalities||[]).find(function(t){var e=t.code;return c.destCountryCode===e.toLowerCase()});c.countryName=n&&n.name;var a=R.path(["travel-documents-additional-visit-info-allowed-countries"],c.launchDarkly)||"";c.hasVisitInfoFields=!c.isDomestic&&"INF"!==R.path(["model","type"],c.pax)&&R.path(["travel-documents-additional-visit-info-enabled"],c.launchDarkly)&&("*"===a||a.indexOf(o)>=0),h(),g(),m()},this.$onDestroy=function(){u.forEach(function(t){return t()})};var v=o.$watch("$ctrl.documentForm",function(){c.onFormInit({$event:{documentForm:c.documentForm}}),v()});o.$watch("$ctrl.nationality",function(){return c.onUpdate("nationality")}),o.$watch("$ctrl.dob",function(t){return t&&c.onUpdate("dob")}),o.$watch("$ctrl.expiryDate",function(t){return t&&c.onUpdate()}),o.$watch("$ctrl.isDocumentWithNoExpiryDate",function(){return c.onUpdate("isDocumentWithNoExpiryDate")})}]});


"use strict";angular.module("app.booking").component("travelDocuments",{templateUrl:"/partials/booking/checkin/travel-documents/travel-documents.html",controller:["$ngRedux","CheckinModelSelectors","TravelDocumentsActions","BookingRead","CheckinModelActions","Dates","$q","CheckinFlow","Stations","TravelDocumentsService",function(e,t,n,o,a,c,s,r,i,u){var l=this,d=void 0,m=function(e){var n=t.getCurrentTravelDocument(e);return{bookingModel:e.bookingModel,checkin:t.getState(e),travelDocumentsList:t.getTravelDocumentsList(e),currentTravelDocument:n,currentSavedDocument:R.path(["travelDocument"],o.getTravelDocumentForPax(e,R.path(["key","id"],n))),documentError:e.checkin.documentError,nationalities:t.getNationalities(e),travelDocumentRules:t.getTraveldocumentRules(e),isCurrentDocSavedInBookingModel:t.isDocInBookingModel(e),documentInBookingModel:t.getDocumentInBookingModel(e),currentPax:t.getCurrentPax(e),isLastDoc:t.isLastDoc(e),defaultAdditionalVisitInfo:t.getDefaultAdditionalVisitInfo(e)}};this.$onInit=function(){r.setCurrentTask(l.documentTask),r.setBackTask(l.backTask),d=e.connect(m,[a,n])(function(e,t){var n=babelHelpers.slicedToArray(t,2),o=n[0],a=n[1];l.$state=babelHelpers["extends"]({},l.$state,e),l.$actions={checkin:o,travelDocs:a}}),l.$actions.checkin.setCTA(!0),l.$actions.travelDocs.getTraveldocumentRules();var t=l.$state.currentPax.model.name,c=t.first,s=t.last;l.$actions.travelDocs.getCustumersDocuments(c,s),l.$state=u.attachOneTimeComputedProps(l.$state),l.$actions.travelDocs.getNationalities().then(function(e){l.$state.euOnlySegments=o.euSegmentsOnly(l.$state.bookingModel,e,i.get("stations"))})},this.onDocumentUpdate=function(e){l.$state.saveToMyRyanair=e.saveToMyRyanair;var t={countryOfIssue:e.countryOfIssue,dob:e.dob,documentId:e.documentId,expiryDate:e.expiryDate,nationality:e.nationality,docNumber:e.docNumber,docType:e.docType,hasBiometricPassport:e.hasBiometricPassport,specialVisaDetails:babelHelpers["extends"]({docType:null,docNumber:null,countryOfIssue:null},e.specialVisaDetails),additionalVisitInfo:e.additionalVisitInfo,acceptUkResidency:e.acceptUkResidency};l.$actions.travelDocs.updateCurrentDoc(t)},this.onSelectDocument=function(e){return l.$actions.travelDocs.selectCustumerDocument(e.doc)},this.onFormInit=function(e){l.documentForm=e.documentForm},this.onEditPressed=function(){return l.$actions.travelDocs.setShowAddedDocument(!1)},this.showAddedDocument=function(){return l.$state.isCurrentDocSavedInBookingModel&&l.$state.currentTravelDocument.showAddedDocument};var D=function(){var e=l.$state.saveToMyRyanair?l.$actions.travelDocs.saveDocToMyRyanair(l.$state.currentTravelDocument.model,l.$state.currentPax.passengerId,l.$state.currentPax.isCompanion):s.when(),t=R.path(["currentPax","model","inf"],l.$state)?s.when():l.$actions.travelDocs.saveDocumentInBooking().then(function(e){if(e.length){var t=R.not(R.isNil(e[0].infantTravelDocument));t?(l.$actions.travelDocs.updateCurrentDoc(e[0].infantTravelDocument),l.$actions.travelDocs.updateParentDoc(e[0].travelDocument)):l.$actions.travelDocs.updateCurrentDoc(e[0].travelDocument)}});return s.all([t,e])},v=function(){return l.documentForm.$setSubmitted(),l.documentForm.$valid?s.resolve():s.reject()};this.backTask=function(){return s.resolve()},this.documentTask=function(){return l.showAddedDocument()?s.when():v().then(function(){return D()}).then(function(){l.$actions.travelDocs.setShowAddedDocument(!0)})},this.$onDestroy=d}]});


"use strict";angular.module("app.booking").service("TravelDocumentsService",["Dates","DateConfig","$filter","Stations","AEMConfig","BookingRead","BookingReadCheckin","Session",function(e,t,n,o,r,i,a,s){var d=function(t){var n=new Date(t);return e.formatISO(e.parseISO(n.getFullYear()+"-"+(n.getMonth()+1)+"-"+n.getDate()))},u=function(e){switch(e){case"INF":return 0;case"CHD":return 2;case"TEEN":return 12;default:return t.dateOfBirthRange.minAge}},c=function(e){switch(e){case"INF":return 2;case"CHD":return 12;case"TEEN":return 16;default:return t.dateOfBirthRange.maxAge}};this.getDateOfBirthRange=function(t,n,o){return{min:e.formatISO(o.clone().subtract(c(t),"years").add(1,"days")),max:e.formatISO(n.clone().subtract(u(t),"years"))}},this.hasUKAPD=function(e,t){return"CHD"===e.model.type&&t.some(function(e){return"CB4"===e.code})},this.isValidUKAP=function(e,t,n,o){return"CHD"===e.model.type&&n?o.diff(d(t),"years",!0)>12:!1};var l=function(e){return n("translate")("trips.checkin.travel_documents.type."+e.docType,{docNumber:e.docNumber})},f=function(e,t){var n=e.nationality===t.nationality&&e.docType===t.docType&&e.docNumber===t.docNumber&&e.countryOfIssue===t.countryOfIssue;return n&&"I"!==e.docType&&(n=d(e.expiryDate)===d(t.expiryDate)),n};this.getCustomerDocsOptions=function(e,t,o){var r=[];r.push({typeTranslated:n("translate")("trips.checkin.travel_documents.use_another_document"),documentId:"another"});var i=e;if(t||(i=e.filter(R.propEq("docType","P"))),i.forEach(function(e){var t=R.clone(e);t.typeTranslated=e.docType?l(e):e,r.push(t)}),o){var a=!i.reduce(function(e,t){return f(t,o)||e},!1);a&&r.push(babelHelpers["extends"]({},o,{typeTranslated:o.docType?l(o):o}))}return r},this.getDocumentTypes=function(t,n,o,r,i,a,s){if(R.isEmpty(n))return[];var d=n.acceptedDocumentTypes,u=n.passportCardCountries,c=n.eeaNonIssuingCountries;if(t)return d.filter(function(e){return"P"===e.typeCode});var l=R.clone(d);return~u.indexOf(o)&&s||(l=l.filter(function(e){return"PC"!==e.typeCode})),(~c.indexOf(o)||r.some(function(e){return e.code===o&&!e.iseu}))&&(l=l.filter(function(e){return"I"!==e.typeCode})),i&&a.diff(e.utc(i),"years")<18&&(l=l.filter(function(e){return"PC"!==e.typeCode})),l},this.isPassportOnlyAllowed=function(e,t,n){var r=e.passportOnlyCountries,i=e.idCardAllowedInNonEEACountries,a=[o.getCountryCode(t.model.orig).toUpperCase(),o.getCountryCode(t.model.dest).toUpperCase()],s=i&&i.some(function(e){return~a.indexOf(e)});return n||s?r&&r.some(function(e){return~a.indexOf(e)})?!0:!1:!0},this.getExpiryDateRange=function(n){return{min:e.formatISO(n),max:e.formatISO(n.clone().add(t.expiryDateRange.maxAge,"years"))}},this.getMyRyanairLogos=function(){return["","@2x"].map(function(e){return r.getStaticFilePrefix()+"/resources/ui/illustrations/myryanair/myryanair-logo"+e+".png"}).join(",")},this.canSaveDocument=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];return s.getAuthenticated()&&(e.documentId&&"another"===e.documentId||0===t.length)};var p=function(e,t,n,o,r){return babelHelpers["extends"]({Nationality:e.nationality,DOB:d(e.dob),DocType:e.docType,DocNumber:e.docNumber&&R.contains("*",e.docNumber)?void 0:e.docNumber,CountryOfIssue:e.countryOfIssue,ExpiryDate:t||!e.expiryDate?null:d(e.expiryDate),DocumentId:o,companionId:n,SpecialVisaDetails:!R.path(["specialVisaDetails","docType"],e)||e.hasBiometricPassport&&r.some(function(t){return t.code===e.nationality&&t.isBioSn})?void 0:{DocType:e.specialVisaDetails.docType,DocNumber:e.specialVisaDetails.docNumber,CountryOfIssue:e.specialVisaDetails.countryOfIssue},AdditionalVisitInfo:R.path(["additionalVisitInfo","contactEmail"],e)?{Length:parseInt(e.additionalVisitInfo.length,10)||1,ContactEmail:e.additionalVisitInfo.contactEmail,Address:{Line1:e.additionalVisitInfo.address.line1,Line2:e.additionalVisitInfo.address.line2||" ",City:e.additionalVisitInfo.address.city,Postal:e.additionalVisitInfo.address.postal}}:void 0},e.acceptUkResidency?{AcceptUkResidency:e.acceptUkResidency}:{})};this.saveTravelDocumentsPayload=function(e,t,n,o,r){var i={};i.Num=n.key.id;var a=s.getClientId();if("INF"===n.model.type){var d=e[t-1].model,u=e[t].model,c=d.documentId&&"another"!==d.documentId?d.documentId:void 0,l=u.documentId&&"another"!==u.documentId?u.documentId:void 0,f=e[t-1].passengerId,m=R.pathOr(void 0,["passengerId"],e[t]),y=f!==a&&c?f:void 0;i.TravelDocument=p(d,o,y,c,r),i.InfantTravelDocument=p(u,o,m,l,r)}else{var I=e[t].model,h=I.documentId&&"another"!==I.documentId?I.documentId:void 0,g=e[t].passengerId,D=g!==a&&h?g:void 0;i.TravelDocument=p(e[t].model,o,D,h,r)}return{CustomerId:a,Documents:[i]}},this.formatExpiryDate=function(e){return e?d(e):void 0},this.isDobDisabled=function(e){var t=e.model;return"INF"===R.path(["type"],t)||R.path(["residentInfo"],t)&&"U"===R.path(["residentInfo","docType"],t)},this.formatDob=function(t,n,o,r){var i=void 0;if(n?i=n:"INF"===t.model.type?i=t.model.dob:o?i=o:t.model.residentInfo&&(i=t.model.residentInfo.dob),i&&r){var a=d(i);if(e.parseISO(a).startOf("day").diff(e.parseISO(r.min).startOf("day"))>=0&&e.parseISO(r.max).startOf("day").diff(e.parseISO(i).startOf("day"))>=0)return a}},this.getNationality=function(e,t){return R.path(["nationality"],e)||(t?t.toLocaleUpperCase():void 0)},this.isEmptyDoc=function(e){return!e||R.isEmpty(e)||Object.keys(e).every(function(t){return!e[t]})},this.getDocumentId=function(e,t){var n=t.find(function(t){return t.nationality===e.nationality&&t.docType===e.docType&&t.docNumber===e.docNumber&&t.countryOfIssue===e.countryOfIssue});return R.path(["documentId"],n)},this.isEEACitizen=function(e,t){return t.some(function(t){return t.code===e&&t.iseu})},this.attachOneTimeComputedProps=function(t){var n=t.bookingModel.journeys[0],o=R.pathOr(n,["bookingModel","journeys",1],t);return babelHelpers["extends"]({},t,{showMyRyanairInfo:!1,isDomestic:i.isDomestic(t.bookingModel),isReturnTrip:i.isReturnTrip(t.bookingModel),outFlight:n,outFlightDate:e.parseISO(n.model.depart),inFlight:o,inFlightDate:e.parseISO(o.model.depart),outboundFlown:i.isJourneyFlown(0,t.bookingModel),checkedInForAnyJourney:a.isPaxCheckedInForAnyJourney(t.currentPax,t.bookingModel)})}}]);


"use strict";angular.module("app.booking").component("basketContainer",{templateUrl:"/partials/booking/directives/basket/basket-container.html",bindings:{passengerList:"<",isSummary:"<",scrollableContent:"<",hideHeader:"<"},controller:["$ngRedux","$state","Basket","BookingRead","FlightSearch","PaymentActions","Session","FEATURE_CONFIG","CurrencyConversionService","TravelCreditActions","TRAVEL_CREDIT","MarketConfig","MorphPopupManager",function(e,t,o,n,a,i,r,s,l,d,c,u,p){var g=this;this.operatedBy=a.model.operatedBy,this.isLaudaMotion=u.isLaudaMotion();var m=function(){var e=n.getHoldFareObjects(g.bookingModel);return{selected:e.length>0,total:R.pipe(R.map(function(e){return e.model}),R.reduce(function(e,t){return e+t.total},0))(e)}},y=function(){var e=t.current.name.replace(/priority-boarding/g,"standalone-priority-boarding").split(".").join(" "),o=!g.isAuthenticated&&g.loginIsEnforced&&t.is("booking.payment");g.classList=o?e+" disabled":e},h=function(t){g.isAuthenticated=t,y(),t||0===n.getTravelCredits(g.bookingModel).length||e.dispatch(d.remove(c.CODE)),t||p.isOpen("basketVisible")||(e.dispatch(i.resetCurrencyConversionOffer()),e.dispatch(i.setAnonymousPayment()),e.dispatch(i.setPaymentFeeMsgVisibility({isVisible:!0})))},b=function(){var e=n.totalCarHire(R.pick(["bookingModel"],g));g.heldFare=m(),g.breakdown=o.getBreakdownItems(g.bookingModel,g.payment,g.samsonite,g.isSummary),g.total=o.getTotal(g.isSummary),g.paymentFee=l.getCorporateCardFee(g.payment),g.paymentDiscount=n.getPaymentDiscount(g.bookingModel),g.isFlightChanged=n.anyFlightWasChanged(g.bookingModel),g.totalPriceToShow=o.getTotalPriceToPay(g,o.getTotalPriceToPayConfigurationObject(g.isSummary)),g.totalVatPriceToShow=n.getVatSumForJourneys(g.bookingModel),g.hideGroupTotal=!!e&&g.totalPriceToShow-e===0,g.totalPriceLabel=g.isSummary?"vouchers.order_summary.total_paid":"trips.total_price",g.hideTotalPrice=R.pathOr(!1,["price-breakdown-hide-total-price-enabled"],s)&&n.hasNonRyanairProductsBySold(g.bookingModel,!1);var t=n.hasStandardFare(g.bookingModel),a=n.hasFamilyPlus(g.bookingModel),i=s["lauda-airport-checkin-message-enabled"];g.showLaudaFeeMsg=(t||a)&&i},k=function(e){return{bookingModel:e.bookingModel,payment:e.payment,samsonite:e.samsonite,loginIsEnforced:R.pathOr(!0,["launchDarkly","my-ryanair-login-is-enforced"],e)}},f=e.connect(k,null)(function(e,o){var n=function(e,t,o){return!R.equals(R.path(e,t),R.path(e,o))};g.isFeeMsgVisible=R.pathOr(!1,["payment","isFeeMsgVisible"],e)&&!t.is("vouchers.summary"),(n(["selectedPaymentMethod"],g.payment,e.payment)||n(["availablePaymentOptionFees"],g.payment,e.payment)||n(["dccOfferApplied"],g.payment,e.payment)||n(["currencyConversionOffer","instrumentFee","feeValue"],g.payment,e.payment)||n(["bookingModel"],g,e))&&(Object.assign(g,e,o),b()),g.loginIsEnforced=e.loginIsEnforced,y()});this.setSelectedMethod=function(t){var o=t.method;return e.dispatch(i.setSelectedPaymentMethod(o))},this.$onInit=function(){h(r.getAuthenticated()),r.subscribe("user:details",h),b(),g.operatedBy=n.getOperator(g.bookingModel)},this.$onDestroy=function(){f(),r.unsubscribe("user:details",h)}}]});


"use strict";angular.module("app.booking").component("basketMessage",{templateUrl:"/partials/booking/directives/basket-message/basket-message.html",bindings:{isLightBanner:"<",isAllowedStickyMessage:"<",isLauda:"<"},controller:["$scope","BasketMessageQueue",function(s,e){var i=this,t=function(e){i.messages=e,i.messages.length||s.$evalAsync()};this.$onInit=function(){i.iconId=i.isLauda?"glyphs.circle-tick":"circle-tick",e.subscribe("basket",t)},this.$onDestroy=function(){e.unsubscribe("basket",t)}}]});


"use strict";angular.module("app.booking").directive("resizePopup",["$document","$window","Device",function(n,e,t){return{restrict:"A",link:function(r,o,i){if(i.resizePopup){var u=function(e){return n[0].querySelectorAll("[content-id="+e+"]")[0]||null},c=!1,a=u("popup_parent"),f=160,l=f-68,s=0,d=n[0].getElementById("ryanair-navbar"),p=function(){return a.scrollHeight+a.offsetTop},v=function(n){var e=5,t=p(),r=n-f;return r>t+e},h=function(){return e.innerHeight},g=function(){var n=e.pageYOffset>=d.offsetHeight;return n?l:f},m=function(){if(!c){c=!0;var n=h(),e=o[0].getBoundingClientRect().height;v(n)?o.css({"overflow-y":"hidden","overflow-x":"hidden",height:"auto"}):o.css({"overflow-y":"scroll","overflow-x":"hidden",height:Math.min(n-(p()-e),n)-g()+"px"}),r.$apply(),c=!1}},y=function(){s=e.requestAnimationFrame(m)},$=r.$watch(function(){return p()},function(n,e){var t=5;n!==e&&Math.abs(n-e)>t&&y()}),w=function(){s&&(e.cancelAnimationFrame(s),s=null),$(),t.onResize(function(){return y()}),e.removeEventListener("scroll",m,!1)};r.$on("$destroy",w),o.on("scroll",function(n){n.preventDefault(),n.stopImmediatePropagation()}),o.on("$destroy",function(){return r.$destroy()}),t.onResize(function(){return y()}),e.addEventListener("scroll",m,!1)}}}}]);


"use strict";angular.module("app.booking").component("changeFlightConfirm",{templateUrl:"/partials/booking/directives/change-flight/change-flight-confirm.html",bindings:{cta:"=",ctaBack:"=",shared:"=",changingCancelledFlight:"<"},controller:function(){function e(t,a,i,n,s,r,o,l,g){var h=this;babelHelpers.classCallCheck(this,e),Object.assign(this,{Passengers:t,ChangeFlightUtil:a,$ngRedux:i,$filter:n,ChangeFlightActions:s,BookingRead:r,ModelQuery:o,Dates:l,PRESELL_PRODUCT_CODES:g});var c=function(e){return{originalFlightData:e.changeFlight.originalFlightData,availableFlights:e.changeFlight.availableFlights,warnings:e.changeFlight.warnings,isFreeMove:e.changeFlight.isFreeMove,flightSearch:e.flightSearch,bookingModel:e.bookingModel,journeys:R.pathOr([],["journeys"],e.bookingModel),fares:R.pathOr([],["fares"],e.bookingModel),isFamilyPlus:r.hasFamilyPlus(e.bookingModel),hasPlusFare:r.hasLeisurePlus(e.bookingModel),hasFlexiPlusFare:r.hasBusinessPlus(e.bookingModel),parkingPurchased:r.getParkingItems(!0)(e.bookingModel),transfersPurchased:r.getTransferItems(!0)(e.bookingModel),carhirePurchased:r.getCarHireItems(!0)(e.bookingModel),insurancePurchased:r.getInsuranceItems(!0)(e.bookingModel),showFarePrice:!a.hideFarePrice(e.changeFlight.originalFlightData,e.bookingModel)}};this.removeConnection=i.connect(c,s)(function(e,t){Object.assign(h,{$state:e,$actions:t})})}return e.$inject=["Passengers","ChangeFlightUtil","$ngRedux","$filter","ChangeFlightActions","BookingRead","ModelQuery","Dates","PRESELL_PRODUCT_CODES"],e.prototype.setChangeFlightMessages=function(e,t){var a=this.Dates,i=this.$state,n=this.$actions,s=R.any(R.length),r=s([i.parkingPurchased,i.transfersPurchased,i.carhirePurchased]),o=!!R.length(i.insurancePurchased),l=R.pathOr([],["$state","flightSearch","info","flights"],this),g=[],h=l.filter(function(e){return e.warning}).reduce(function(t,i){return e.reduce(function(e,t){var n=t.journey;return 0===a.utc(n.model.depart).diff(i.depart)&&n.model.flt===i.number?[].concat(babelHelpers.toConsumableArray(e),[i.warning]):e},t)},[].concat(babelHelpers.toConsumableArray(t)));n.setChangeFlightMessages([]),h.length&&h.forEach(function(e){-1===g.indexOf(e.key)&&(g=[].concat(babelHelpers.toConsumableArray(g),[e.key]),n.addChangeFlightMessage({type:"warning",message:"trips.changeflight.drawer.message."+e.key}))}),r&&n.addChangeFlightMessage({type:"warning",message:"trips.changeflight.drawer.message.addons"}),o&&n.addChangeFlightMessage({type:"warning",message:"trips.changeflight.drawer.message.insurance"})},e.prototype.calculateFareSsrPricesPerLeg=function(e,t){var a=this,i=this.BookingRead,n=this.ChangeFlightUtil;return e.journeys.reduce(function(s,r){return i.isLeisurePlusLeg(e,r.key.id)?n.calculateFeeDifference("SURE",[r],e,!0,t).fee+s:i.isBusinessPlusLeg(e,r.key.id)?n.calculateFeeDifference("PLUS",[r],e,!0,t).fee+s:a.$state.isFamilyPlus?n.calculateFeeDifference("FAMI",[r],e,!0,t).fee+s:s},0)},e.prototype.getPriceBreakdown=function(e,t){var a=this.ModelQuery,i=this.ChangeFlightUtil,n=this.PRESELL_PRODUCT_CODES,s=this.$filter,r=this.$state,o=this.$actions,l=function(e,t){return i.calculateFeeDifference(e,r.bookingModel.journeys,r.bookingModel,t)},g=function(e,t,a){return R.append(i.getPriceBreakdownItemModel(e,t),a)},h=0,c=0,d=0,u=0,f=void 0;if(r.hasPlusFare||r.hasFlexiPlusFare||r.isFamilyPlus){var F=[this.calculateFareSsrPricesPerLeg(r.originalFlightData,!0),this.calculateFareSsrPricesPerLeg(r.bookingModel,!1)];h=F[0],c=F[1]}var m=R.pipe(a.byIdentity("fees"),a.byModel({code:"SPOIL"}),a.sumUpTotal)(r.bookingModel),p=R.pipe(a.byIdentity("fares"),a.sumUpTotal)(r.originalFlightData)+h;d=m?p-m+c:a.sumUpTotal(t)+p+c;var b=d-p,y=l("FLTCHG",!0).fee,P=[{code:"bags",item:l("BAGS",!1)},{code:"baby",item:l("BABY",!1)},{code:"sports",item:l("SPORTS",!1)},{code:"music",item:l("MUSIC",!1)},{code:"seats",item:l("SEATS",!1)},{code:"priorityboarding",item:l("PRIOBRDNG",!1)},{code:"cabin-bag",item:l("CBAG",!1)},{code:"fasttrack",item:l("FAST",!1)},{code:"breakfast",item:l("BREK",!0)},{code:"adult-meal",item:l("ADTM",!0)},{code:"kids-meal",item:l("KIDM",!0)},{code:"afternoon-tea",item:l("AFTN",!0)},{code:"cheeseboard",item:l("CHSE",!0)},{code:"fresh-breakfast",item:l("FRUT",!0)},{code:"vegetarian-meal",item:l("VMEA",!0)}],C=!0,k=!1,M=void 0;try{for(var v,D=n[Symbol.iterator]();!(C=(v=D.next()).done);C=!0){var S=v.value;P.push({code:S,item:l(S,!0)})}}catch(w){k=!0,M=w}finally{try{!C&&D["return"]&&D["return"]()}finally{if(k)throw M}}r.showFarePrice&&(f=g("new-price",{total:d,str:e},f),f=g("original-price",{total:p,str:e},f)),m||(f=g("difference",{total:b},f),u+=b),P.forEach(function(e){var t=e.code,a=e.item;a.qty&&(f=g(t,a,f),u+=a.fee)}),f=g("change-fee",{total:y,str:e},f),u+=y,r.isFreeMove&&o.addChangeFlightMessage({type:"info",message:"trips.changeflight.drawer.message.freeMoveInfoTimeFrame"});var T=r.isFreeMove&&0===u?"trips.changeflight.drawer.label.totalFreeMove":"trips.side.total";return o.setChangeFlightPaymentNotRequired(0===u),{translatedTotalLabel:s("translate")(T),totalOverallToPay:u,faresBreakdown:f}},e.prototype.$onInit=function(){var e=this,t=this.BookingRead,a=this.ChangeFlightUtil,i=this.Passengers,n=this.$state,s=n.journeys,r=n.fares,o=n.warnings,l=function(e){return t.getCities({journeys:[e]})},g=function(e,t){var a=babelHelpers.slicedToArray(e,2),i=a[0],n=a[1],s="Inbound"===t?n:i;return R.last(s.route).toUpperCase()},h=function(t){var a=e.$state.originalFlightData.segments.find(function(e){return e.model.flt===t});return R.path(["model","isCancelled"],a)};this.changedFlights=this.$state.availableFlights.map(function(e,t){return babelHelpers["extends"]({},e,{journey:s[t]||e.journey,route:l(s[t])})}),this.oldFlights=this.$state.originalFlightData.journeys.map(function(e){return{isChanged:!0,journey:e,isCancelled:h(e.model.flt),route:l(e)}}),this.showLoader=!1,this.shared.showTotalPrice=!1,this.toConfirm=!0,this.flightType=a.getChangedFlightType(s,r),this.flightDestination=g(this.changedFlights,this.flightType),this.changeFlightMessageCode=this.changingCancelledFlight?"fees_info_cancelled":"fees_info",this.setChangeFlightMessages(this.changedFlights,o),i.passengerBreakdownAsString().then(function(t){var a=e.getPriceBreakdown(t,r);Object.assign(e,a)}),this.cta=function(e){e()},this.ctaBack=function(e){e()}},e.prototype.$onDestroy=function(){this.removeConnection()},e}()});


"use strict";angular.module("app.booking").component("changeFlightMoveSsrsMsg",{templateUrl:"/partials/booking/directives/change-flight/change-flight-move-ssrs-msg.html",bindings:{translationPrefix:"@",bookingModel:"<",originalFlightData:"<"},controller:function(){function e(t,i,s){babelHelpers.classCallCheck(this,e),Object.assign(this,{BookingRead:t,ChangeFlightUtil:i,$filter:s})}return e.$inject=["BookingRead","ChangeFlightUtil","$filter"],e.prototype.$onInit=function(){var e=this,t=this.BookingRead,i=this.ChangeFlightUtil,s=this.$filter,a=[{key:"seats",display:function(s){var a=!R.isEmpty(t.getSeatItems(!0)(e.originalFlightData)),n=i.seatsNotChanged(e.originalFlightData,s);return a&&n}},{key:"checkin_bags",display:R.pipe(t.getBagItems(!0),R.complement(R.isEmpty))},{key:"cabin_bag_dropoff",display:R.pipe(t.getCabinBagItems(!0),R.complement(R.isEmpty))},{key:"fast_track",display:R.pipe(t.getFastTrackItems(!0),R.complement(R.isEmpty))},{key:"priority_cabin_bags",display:R.pipe(t.getPriorityBoardingItems(!0),R.complement(R.isEmpty))},{key:"baby_equipment",display:R.pipe(t.getBabyItems(!0),R.complement(R.isEmpty))},{key:"music_equipment",display:R.pipe(t.getMusicItems(!0),R.complement(R.isEmpty))},{key:"sports_equipment",display:R.pipe(t.getSportItems(!0),R.complement(R.isEmpty))},{key:"inflight_meals",display:R.pipe(t.getInflightAndPresellProductItems(!0),R.complement(R.isEmpty))},{key:"free_airport_checkin",display:t.hasBusinessPlus},{key:"special_assistance",display:R.pipe(t.getPrmItems(!1),R.complement(R.isEmpty))}],n=",",l=s("translate")(this.translationPrefix+"and"),p=a.filter(function(t){return t.display(e.bookingModel)}).map(function(t,i,a){var p=s("translate")(""+e.translationPrefix+t.key);switch(i){case 0:return""+p[0].toUpperCase()+p.slice(1);case a.length-1:return" "+l+" "+p;default:return n+" "+p}}).join("");this.message=this.translationPrefix+"message",this.translations={ssrs:p}},e}()});


"use strict";angular.module("app.booking").component("changeFlightPriceInfo",{templateUrl:"/partials/booking/directives/change-flight/change-flight-price-info.html",bindings:{currentStep:"<"},controller:function(){function e(t){babelHelpers.classCallCheck(this,e),Object.assign(this,{ChangeFlightPriceInfoService:t})}return e.$inject=["ChangeFlightPriceInfoService"],e.prototype.setOpen=function(e){this.open=e,this.headerTitle=e?"trips.changeflight.heading.change-fee-info.title-hide":"trips.changeflight.heading.change-fee-info.title"},e.prototype.toggleOpen=function(){this.setOpen(!this.open)},e.prototype.$onChanges=function(e){var t=e.currentStep;t&&this.setOpen(!1)},e.prototype.$onInit=function(){var e=this,t=this.ChangeFlightPriceInfoService;this.flightInfoData={},this.setOpen(!1),t.getAll().then(function(t){t&&(e.flightInfoData=t)})},e}()});


"use strict";angular.module("app.booking").component("searchFlights",{templateUrl:"/partials/booking/directives/change-flight/search-flights.html",bindings:{cta:"=",ctaBack:"=",changingCancelledFlight:"<"},controller:["$scope","$ngRedux","ChangeFlightActions","Availability","BookingRead","LEG_TYPE",function(e,t,i,a,l,n){var o=this;this.$onInit=function(){a.resetRequests();var e=o.changingCancelledFlight?[{type:"info",message:"trips.changeflight.drawer.message.fees_info_cancelled"}]:[];o.setChangeFlightModelToOriginal(o.originalFlightModel),o.setChangeFlightMessages(e),o.nextStepCallback=null};var s=["passenger"],c=function(e){if(e){o.disabledFields=s;var t=[];e.every(function(e){return e})||(t=[].concat(babelHelpers.toConsumableArray(t),["origin","destination"])),e.length>1&&(e[n.outbound]||t.push("outboundDate"),e[n.inbound]||t.push("inboundDate")),o.disabledFields=[].concat(babelHelpers.toConsumableArray(t),babelHelpers.toConsumableArray(o.disabledFields)),o.disableAutofocus=o.disabledFields.some(function(e){return R.contains(e,["outboundDate","inboundDate"])})}};e.$on("change-flight:form-is-valid",function(e){if(o.nextStepCallback){var t=R.path(["targetScope","flightModel"],e);o.setChangeFlightModel(R.clone(t)),o.nextStepCallback(),o.nextStepCallback=null}}),this.cta=function(t){o.nextStepCallback||(o.nextStepCallback=t),e.$broadcast("change-flight:validate-form")},this.ctaBack=function(e){e()},this.scrollToBottom=function(){var e=document.getElementsByClassName("core-modal-body");e[0]&&setTimeout(function(){e[0].scrollTop=e[0].scrollHeight},300)};var r=function(e){var t=e.bookingModel,i=e.changeFlight;switch(i.flightModel.ChangeFlight){case"RoundTrip":o.searchFlightTitleKey="trips.changeflight.drawer.pick_a_new_flight_both";break;case"Inbound":o.searchFlightTitleKey="trips.changeflight.drawer.pick_a_new_flight_in";break;case"Outbound":o.searchFlightTitleKey="trips.changeflight.drawer.pick_a_new_flight_out";break;default:o.searchFlightTitleKey="one-way"===i.flightModel.type?"trips.changeflight.drawer.pick_a_new_flight_out":null}return c(i.selectedFlights),{availableFlights:i.availableFlights,selectedFlights:i.selectedFlights,originalFlightModel:i.originalFlightModel,showAutoCorrectDateWarning:i.showAutoCorrectDateWarning,isReturn:l.isReturnTrip(t),flightModel:i.flightModel,bookingType:{international:l.isBooked(t)&&!l.isDomestic(t),isBooked:l.isBooked(t),domestic:l.isDomestic(t),vatRate:l.getVatRate(t)}}},g=t.connect(r,i)(this);this.$onDestroy=function(){g()}}]});


"use strict";angular.module("app.booking").component("selectFares",{templateUrl:"/partials/booking/directives/change-flight/select-fares.html",bindings:{cta:"=",ctaBack:"=",changingCancelledFlight:"<"},controller:["FlightSearch","ChangeFlightActions","$scope","$log","$ngRedux","BookingModelActions","FlightSearchActions",function(t,e,i,a,n,l,s){var o=this;this.$onInit=function(){n.dispatch(e.setChangeFlightMessages([])),n.dispatch(e.setChangeFlightStatus(!1))};var g=function(t){return{flightModel:t.changeFlight.flightModel,availableFlights:t.changeFlight.availableFlights}},h=function(e){if(o.flightModel!==e.flightModel){var i=t.getSearchData(t.createSearchObj(e.flightModel).searchObj);t.set(i),n.dispatch(s.setFlightInfo(i))}Object.assign(o,e)},c=n.connect(g,null)(h),r=function(){o.availabilityResponseError=null};r(),i.$on("booking:updating",r),i.$on("availability:error",function(t,i){o.availabilityResponseError=i,n.dispatch(e.setChangeFlightMessages([{type:"error",message:"trips.changeflight.errors."+i.data.code}]))}),i.$on("$destroy",function(){c(),a.info("[Select Fares (ChangeFlight) destroy")}),this.changeFlightMessageCode=this.changingCancelledFlight?"fees_info_cancelled":"fees_info",this.cta=function(t){n.dispatch(e.setChangeFlightWarnings(R.pathOr([],["bookingModel","warnings"],n.getState()))),t()},this.ctaBack=function(t){n.dispatch(l.refresh("booking.active",!0,!0)).then(function(){t()})}}]});


"use strict";angular.module("app.booking").component("selectFlights",{templateUrl:"/partials/booking/directives/change-flight/select-flights.html",bindings:{cta:"=",ctaBack:"=",shared:"="},controller:["ChangeFlightUtil","$ngRedux","ChangeFlightActions","BookingRead",function(e,t,s,a){var i=this;this.$onInit=function(){var e=R.pipe(a.getCancelledFlights,R.any(R.identity))(t.getState().bookingModel),s=e?"flight-dates-changable":"change-fees";i.setChangeFlightMessages([{type:"info",message:"trips.changeflight.drawer.select-flights.info."+s}])},this.cta=function(e){2===i.availableFlights.length&&(i.shared.selectSeats[0]=i.availableFlights[0].isSelected&&i.shared.passengersWithBoughtSeats[0].length>0,i.shared.selectSeats[1]=i.availableFlights[1].isSelected&&i.shared.passengersWithBoughtSeats[1].length>0),e()};var l=function(e){return{availableFlights:e.changeFlight.availableFlights,selectedFlights:e.changeFlight.selectedFlights,passengers:e.bookingModel.passengers}},n=t.connect(l,s)(this);this.$onDestroy=function(){n()}}]});


"use strict";angular.module("app.booking").component("changeFlightSelectSeats",{templateUrl:"/partials/booking/directives/change-flight/select-seats.html",bindings:{shared:"=",cta:"=",ctaBack:"=",disableNextSeatStep:"=",seatConfirmation:"<",onOpenMobileSeatInfo:"&"},controller:["$scope","$document","SeatsService","Utilities","$ngRedux","SeatsActions","ChangeFlightActions","BookingRead","ModelQuery","CHILD_SEAT_LOCATION_ERROR","DialogManager",function(e,t,n,s,a,o,i,r,p,g,u){var c=this;this.showLoader=!1;var l=!1,d=function(){c.shared.totalPrice=n.getTotalBalance},h=R.pipe(p.byIdentity("journeys"),R.head,R.path(["model","changeInfo","isChanged"])),m=R.pipe(p.byIdentity("seats"),p.byRemoved(!1)),S=function(e){var t=R.pathOr("",["mapSteps","current"],c),n=-1!==t.indexOf("inbound")?1:0,s=-1!==t.indexOf("Segment")?1:0,a=p.byKey({journeys:n,segments:s})(e.bookingModel.seats),o=R.pathOr([],["selectedPassengers",n,s],c),i=e.changeFlight.originalFlightData.seats,g=p.byKey({journeys:n,segments:s})(i).filter(function(e){return!(e.model.sold&&e.model.isRandom)}),u=g.some(function(e){return 0===p.byKey(e.key)(a).length});return{disableNextSeatStep:0===o.length||u||l,bookingModel:e.bookingModel,passengers:e.changeFlight.originalFlightData.passengers,seats:i,seatsNew:e.bookingModel.seats,isChanged:h(e.bookingModel),allocatedSeats:m(e.bookingModel),passengersNew:e.bookingModel.passengers,journeys:e.bookingModel.journeys,segments:e.bookingModel.segments,selectedFlights:e.changeFlight.selectedFlights,isConnectingFlight:r.getBookingInfo(e.bookingModel).isConnectingFlight,flightExtras:e.flightExtras,journeyNum:n,segmentNum:s}},f=a.connect(S,i)(this);this.$onInit=function(){c.outboundSegmentsCount=r.getOutboundSegments(c.bookingModel).length,c.inboundSegmentsCount=r.getInboundSegments(c.bookingModel).length,a.dispatch(i.setChangeFlightMessages([])),c.disableNextSeatStep=!0,d()},this.shouldOpenSameSeatsPrompt=function(){return c.selectedPassengers[0][0].length!==c.selectedPassengers[1][0].length?!1:c.isChanged?!c.selectedPassengers[0][0].every(function(e){return c.selectedPassengers[1][0].some(function(t){return t.key.id===e.key.id})}):!1};var b=function(){l=!0,c.disableNextSeatStep=!0},y=function(){l=!1,c.disableNextSeatStep=!1},x=function(e,t){return u.openConfirm("childSeatPopup",{template:"/partials/extras/seats/directives/child-seat-popup/child-seat-popup.html",closeAfter:!0,className:"extra-offer-popup-dialog",appendTo:"seat-map",data:{isWarning:t},overlay:!1},!1).then(function(){t&&(e(),c.mapSteps.next())})},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:angular.noop,t=["seats.outboundMap","seats.inboundMap","seats.outboundSegmentMap","seats.inboundSegmentMap"];if(!R.any(R.equals(c.mapSteps.current),t))return e(),void c.mapSteps.next();var s=n.getSeatItemsByJourneyAndSegment(c.journeyNum,c.segmentNum)(c.seatsNew);b(),a.dispatch(o.confirmSeats(s)).then(function(t){var n=t.error,s=t.isChildSeatWarning;return n===g.code||s?(a.dispatch(o.changeChildSeatPromptSeen(!0)),x(e,s)):(e(),c.mapSteps.next(),null)})["finally"](function(){y()})},k=function(t){a.dispatch(o.reset()),t&&(n.set("infoMessage",t),e.$emit("seat-map:post-failed"))};this.shared.goToSeatsConfirmStep||k(),a.dispatch(i.setHideFooter(!0));var v=function(){c.continueButtonText="start_again"},C=function(){var e=babelHelpers.slicedToArray(c.steps,1);c.currentStep=e[0]},F=function(){"seats.confirm"===c.mapSteps.nextStep&&M()},I=[];this.selectedPassengers=[[[],[]],[[],[]]],this.seats.forEach(function(e){var t=p.byKey(e.key)(c.bookingModel.seats);if(0===t.length){var n=p.byKey({id:e.key.passengers})(c.passengers)[0];c.selectedPassengers[e.key.journeys][e.key.segments].push(n)}}),this.selectedPassengers.forEach(function(e,t){e.forEach(function(e,n){var s=0===t?"outbound":"inbound",a=0===n?"":"Segment";e.length>0&&I.push("seats."+s+a+"Map")})}),I.push("seats.confirm"),this.mapSteps=s.createStepIterator(I),this.getCurrentIndex=function(){return I.indexOf(c.mapSteps.current)},this.shared.seatSelectionStep=this.mapSteps.current,this.mapSteps.onChange(function(){c.shared.seatSelectionStep=c.mapSteps.current}),this.getCurrentStepIndex=function(){c.steps.indexOf(c.currentStep)},this.cta=function(e,t){return"start_again"===c.continueButtonText?(c.continueButtonText="next",void c.mapSteps.reset()):void(c.mapSteps.isLast?e():M(t))},this.ctaBack=function(e){c.mapSteps.isFirst?e():(c.mapSteps.previous(),c.continueButtonText="next")},this.toggleMobileSeatMapInfo=function(e){c.onOpenMobileSeatInfo({$event:e})},e.$evalAsync(function(){var e=t[0].querySelector(".core-modal-container");e&&(c.seatMapHeight={height:e.getBoundingClientRect().height-110+"px"})}),this.$onChanges=function(){d()},e.$on("seat-map:no-seats",v),e.$on("seat-map:post-failed",C),e.$on("seat-map:popup-opened",b),e.$on("seat-map:popup-closed",y),e.$on("seat-map:next-step",F),this.$onDestroy=function(){a.dispatch(i.setHideFooter(!1)),f()}}]});


"use strict";angular.module("app.booking").component("connectingFlightTripDetails",{templateUrl:"/partials/booking/directives/connecting-flight-trip-details/connecting-flight-trip-details.html",bindings:{flight:"<",origin:"<",destination:"<",fromTable:"<",type:"<"},controller:["Dates","Stations",function(t,i){var e=this;this.connectionTime=t.utc(this.flight.segments[1].timeUTC[0]).subtract(t.utc(this.flight.segments[0].timeUTC[1])),this.getAirportName=function(t){return i.getCityName(t)},this.$onInit=function(){var i=e.flight.arrivalTime||e.flight.arrive,n=e.flight.departTime||e.flight.depart,a=i.clone().startOf("day"),r=n.clone().startOf("day");e.dayDifference=t.diffInDays(a,r)}}]});


"use strict";angular.module("app.booking").component("flightSummaryPanels",{templateUrl:"/partials/booking/directives/flight-panels/flight-panels.html",bindings:{changedFlights:"<?",oldFlights:"<?",enableSelect:"<?",hidePrices:"<?",stage:"@"},controller:["ChangeFlightUtil","ChangeFlightActions","$ngRedux","BookingRead","LEG_TYPE","AEMConfig",function(e,t,i,s,n,a){var l=this,o=["search-flights"];this.overrideDisabledFlights=[];var r=function(e){return l.$actions.setSelectedFlights(e,!l.$state.selectedFlights[e])},g=function(e){var t=l.$state.isReturn&&1===R.reduce(R.add,0,l.$state.freeMoveFlights);if(l.overrideDisabledFlights=[!1,!1],t&&l.$state.departedFlights.every(function(e){return e})){if(l.$state.freeMoveFlights[n.outbound]&&!l.$state.paxBoardedStatus[n.outbound])return l.overrideDisabledFlights[n.inbound]=!0,l.$actions.setSelectedFlights(n.inbound,!0),void l.$actions.setSelectedFlights(n.outbound,!0);l.$state.freeMoveFlights[n.inbound]&&!l.$state.paxBoardedStatus[n.inbound]&&(l.overrideDisabledFlights[n.outbound]=!0,l.$state.selectedFlights[n.inbound]||e!==n.inbound?l.$state.selectedFlights[n.outbound]&&l.$actions.setSelectedFlights(n.inbound,!0):l.$actions.setSelectedFlights(n.outbound,!1))}},d=function(e){l.enableSelect&&(r(e),l.$state.freeMoveFlights.every(function(e){return e})||g(e))};this.$onInit=function(){l.staticFilePrefix=a.getStaticFilePrefix(),g()},this.toggleFlight=function(e){d(e)},this.isFlightDisabled=function(t){return e.isFlightDisabled(t,l.$state.journeys,l.$state.checkin,l.$state.serverTimeUTC,l.$state.freeMoveFlights,l.$state.availableFlights)&&!l.overrideDisabledFlights[t]};var h=function(e){var t=e.bookingModel,i=e.changeFlight,n=s.isReturnTrip(t),a=i.selectedFlights,r=i.originalFlightData,g=i.availableFlights.map(function(e,t){var i=babelHelpers["extends"]({},e);return i.journey.model.isCancelled=R.path(["model","isCancelled"],r.segments[t]),i.totalPrice=i.total+i.bundlePrice,i});return{availableFlights:g,selectedFlights:a,journeys:t.journeys,checkin:t.checkin,serverTimeUTC:s.getServerTimeUTC(t),freeMoveFlights:s.getFreeMoveFlights(t),departedFlights:s.getDepartedFlights("journeys",t),isReturn:n,paxBoardedStatus:s.getPaxBoardedStatus(t),showOneWayCheckboxes:!n&&o.indexOf(l.stage)>=0,originalFlightData:r}},c=i.connect(h,t)(function(t,i){if(Object.assign(l,{$state:t,$actions:i}),!l.$state.isReturn&&!l.$state.selectedFlights.length){var s=e.isFlightDisabled(0,l.$state.journeys,l.$state.checkin,l.$state.serverTimeUTC,l.$state.freeMoveFlights,l.$state.availableFlights);if(s)return;l.$actions.setSelectedFlights(0,!0)}});this.$onDestroy=function(){c()}}]});


"use strict";angular.module("app.booking").component("leadDriver",{require:{form:"^form"},templateUrl:"/partials/booking/directives/lead-driver/lead-driver.html",bindings:{model:"<",onLeadDriverFormUpdate:"&"},controller:function(){var e=this;this.maxNumberOfChars=32,this.tooltipVisible=!1,this.updateForm=function(){return e.onLeadDriverFormUpdate({$event:{driver:e.model}})},this.$onChanges=function(r){var o=r.model;o&&(e.model=R.clone(e.model))}}});


"use strict";angular.module("app.booking").directive("manageTripsCard",function(){return{restrict:"E",templateUrl:"/partials/booking/directives/manage-trips-card/manage-trips-card.html",controllerAs:"manageTripsController",controller:["$scope","$state","$filter","Session",function(t,e,r,n){t.pointsGroups=function(){return r("translate")("TRIPS.MY_TRIPS_LOGIN_BULLET_ITEMS").split(",")},t.getTemplate=function(){return n.getAuthenticated()?"LOGGED_IN":"NOT_LOGGED_IN"}}]}});


"use strict";angular.module("app.booking").component("redeemTravelCredits",{templateUrl:"/partials/booking/directives/redeem-travel-credits/redeem-travel-credits.html",bindings:{},controller:["$ngRedux","TravelCreditActions","Currency","BookingRead","DialogManager","FEATURE_CONFIG","CurrencyConversionService","PaymentActions","TRAVEL_CREDIT","MorphPopupManager",function(e,r,t,n,o,i,a,c,d,l){var s=this;this.showRedeemSection=!0,this.exchangeRate=1,this.originalExchangeRate=1;var u=function(e){return parseFloat(parseFloat(e).toFixed(2))},m=function(e){var r=i["currency-converter"]&&!e.bookingModel.operatedBy,t=R.path(["conversionRates"],e.travelCredit),o=0,c=R.path(["availableTravelCreditsTotalCredit","value"],e.travelCredit),d=R.path(["info",0,"model","curr"],e.bookingModel),l=e.payment,m=R.path(["isBlacklisted"],e.travelCredit),C=R.path(["disableTravelCredit"],e.travelCredit)&&!m;"EUR"!==d&&t?(s.originalExchangeRate=R.pathOr(1,["exchangeRate"],t.find(function(e){return e.currencyCode===d})),o=c*s.originalExchangeRate):o=c;var v=function(e,n){var i=r&&n?n:d;s.exchangeRate=R.pathOr(1,["exchangeRate"],t.find(function(e){return e.currencyCode===i}));var a=o*s.exchangeRate;return e>a?a:e},p=0,y=0,f=void 0,g=void 0,h=void 0;if(r&&l.currencyConversionOfferApplied&&R.path(["currencyConversionOffer","quotes","length"],l)&&l.ForeignCurrencyCode){var A=a.getCurrencyConversionDetails();p=R.pathOr(1,["rate"],A),f=l.ForeignCurrencyCode,g=l.currencyConversionOfferApplied,y=A.foreignAmount,h=R.pathOr(!1,["currencyConversionOffer","applicable"],e.payment)}else p=R.pathOr(0,["rate"],e.payment.dcc),f=R.path(["foreignCurrencyCode"],e.payment.dcc),y=R.pathOr(0,["foreignAmount"],e.payment.dcc),g=R.pathOr(!1,["applied"],e.payment.dcc),h=R.pathOr(!1,["applicable"],e.payment.dcc);var $=R.pathOr(0,["travelCredit","maximumAllowedAmount"],e);s.redeemedTravelCredits=function(){return R.path([0,"model"],n.getTravelCredits(e.bookingModel))},s.isRedeemed=function(){return 0!==n.getTravelCredits(e.bookingModel).length};var b=!("EUR"===d||R.path(["dccOfferApplied"],e.payment)&&R.path(["currencyConversionOfferApplied"],e.payment)||!t||!r&&"EUR"!==d&&R.path(["dccOfferApplied"],e.payment)),O=p&&"EUR"!==f&&f&&"EUR"!==d&&t?o:o*p,E=function(e,n){if(n&&t&&!r)return v(e,f);var i=g?O:o,a=g?e*p:e;return i>a?a:i},w=R.pipe(R.propOr({},"travelCredit"),R.props(["travelCreditsLoading","maxAllowedLoading","conversionRatesLoading"]),R.any(Boolean));return{currencyConverterTurnedOn:r,maximumAllowedAmount:u(E($,b)),originalMaxAllowed:$,selectedPaymentMethod:e.payment.selectedPaymentMethod,foreignAmount:y,dccRate:p,isCurrencyConversionOfferApplied:g,isCurrencyConversionApplicable:h,voucherAdded:n.hasVoucher(e.bookingModel),showLinkForConversionDialog:!r&&"EUR"!==d||b&&"EUR"!==f,availableTravelCreditsTotal:c,exchangedAvailableTravelCreditsTotal:o,bookingCurrency:d,foreignCurrencyCode:f,currencyConversionOfferApplied:e.payment.currencyConversionOfferApplied,travelCreditsLoading:w(e),currencyCode:g?f:d,isFeeMsgVisible:e.payment.isFeeMsgVisible,isBlacklisted:m,isDisabled:C,payment:e.payment}},C=function(){var e=u(s.travelCreditAmount);return e>parseFloat(s.$state.maximumAllowedAmount)||0===e||s.$state.maximumAllowedAmount<0||!s.$state.maximumAllowedAmount},v=e.connect(m,[r,c])(function(e,r){var t=babelHelpers.slicedToArray(r,2),n=t[0],o=t[1];s.$state=e,s.$actions={travelCreditActions:n,paymentActions:o}}),p=function(){return s.$state.isCurrencyConversionOfferApplied?s.travelCreditAmount/s.$state.dccRate:s.travelCreditAmount},y=R.when(R.propEq("isFeeMsgVisible",!0),function(){return s.$actions.paymentActions.setPaymentFeeMsgVisibility({isVisible:!1})}),f=function(){a.getCorporateCardFee(s.$state.payment)&&s.$actions.paymentActions.updateCurrencyConversionOffer()};this.getCurrencySymbol=function(){var e=void 0;return s.$state.isCurrencyConversionApplicable||s.$state.currencyConversionOfferApplied&&s.$state.foreignCurrencyCode?(s.foreignCurrencySymbol=t.findCurrencyByCode(s.$state.currencyCode).CURRENCY_SYM,s.currencySymbol=t.findCurrencyByCode(s.$state.currencyCode).CURRENCY_SYM,e=s.$state.isCurrencyConversionOfferApplied?s.foreignCurrencySymbol:s.currencySymbol):e=t.findCurrencyByCode(s.$state.bookingCurrency).CURRENCY_SYM,e},this.dccChanged=function(){return s.redeemedTravelCredits().currency===s.$state.currencyCode},this.amountChanged=function(){y(s.$state),s.showError=C()},this.remove=function(){s.$actions.travelCreditActions.remove(d.CODE).then(function(){return f()}),s.travelCreditAmount=void 0},this.$onInit=function(){s.showError=!1,s.isRedeemed()&&(s.travelCreditAmount=s.redeemedTravelCredits().amt,l.isOpen("basketVisible")||s.remove()),s.$actions.travelCreditActions.getConversionRates(),s.$actions.travelCreditActions.getMaximumAllowed(),s.$actions.travelCreditActions.getTravelCredits(d.PAYMENT_PAGE_LIMIT)},this.toggleRedeemForm=function(){s.isRedeemed()?s.showRedeemSection=!0:s.showRedeemSection=!s.showRedeemSection},this.isRedeemSectionVisible=function(){return s.showRedeemSection&&!s.$state.voucherAdded},this.redeemTravelCredit=function(){var e={type:d.TYPE,code:d.CODE,amt:p(),redeemedAmount:s.travelCreditAmount,currency:s.$state.currencyCode};if(s.showError=C()||!s.travelCreditAmount,!s.showError){var r=u(e.redeemedAmount);if(s.$state.isCurrencyConversionOfferApplied){var t=u(s.$state.foreignAmount/(1+s.$state.selectedPaymentMethod.perc/100));t=t>s.$state.maximumAllowedAmount?s.$state.maximumAllowedAmount:t,r===t&&(e.amt=s.$state.originalMaxAllowed),r=u(e.amt)}s.$actions.travelCreditActions.redeem(e,r).then(function(){return f()}),s.travelCreditAmount=void 0}},this.showConversionDialog=function(){o.open("conversionDialog",{template:"/partials/account/travel-credit/travel-credit-conversion-dialog.html",className:"travel-credit-conversion-dialog",controller:"travelCreditConversionController",controllerAs:"$ctrl",closeByDocument:!1,showClose:!1,data:Object.assign({},{travelCreditConvertedTotal:s.$state.originalMaxAllowed/s.originalExchangeRate,travelCreditAmount:s.$state.maximumAllowedAmount/s.originalExchangeRate})})},this.$onDestroy=v}]});


"use strict";angular.module("app.booking").component("passengerInputGroup",{require:{form:"^form",passengersForm:"^passengersForm"},bindings:{index:"<",pax:"<",bookingModel:"<",isRoomsPaymentPage:"<",passengers:"<",inFlightDate:"<",outFlightDate:"<",hasSpanishDiscount:"<",config:"<",onDisableTravelCredit:"&"},templateUrl:"/partials/booking/directives/passengers-form/passenger-input-group.html",controller:["$scope","BookingRead","SARA","KEYMAP","Session","$timeout","Device","$document","PassengerAgeService","PASSENGER_TYPES","AIRLINE_CONFIG",function(e,t,i,n,o,a,s,r,l,u,d){var g=this;this.$onInit=function(){g.operator=t.getOperator(g.bookingModel),g.pax.travelDocuments={travelDocument:{},infantTravelDocument:{}},g.isErasmus=t.isErasmus(g.bookingModel),g.specialNameRule=R.equals(g.operator,d.AIRMALTA.airline)?d.AIRMALTA.passengerNameRegexp:"",g.disableTravelCredit=function(e){g.onDisableTravelCredit({$event:e})}},this.infantValidDob=function(e){if(e){var t=u.Infant,i=l.isValidPaxDob(g.bookingModel,t,e,"inbound"),n=R.path(["dateForm","day"],g.form["passengerForm"+g.index]);if(n&&n.$setValidity("dobValid",i),i)return e}return null},this.paxValidDob=function(e){if(e){var t=g.passengers[g.index].type,i=l.isValidPaxDob(g.bookingModel,t,e,"outbound"),n=l.isTypeChangingBetweenFlights(g.bookingModel,t,e),o=R.path(["dateForm","day"],g.form["passengerForm"+g.index]);if(o&&(o.$setValidity("dobByOutbound"+t,i),o.$setValidity("typeIsChangingBetweenFlights"+t,!n)),i&&!n)return e}return null},this.spanishValidDob=function(e){if(e){var t=g.inFlightDate.diff(e,"years",!0)<=i.dob[g.pax.type].max&&g.outFlightDate.diff(e,"years")>=i.dob[g.pax.type].min,n=R.path(["dateForm","day"],g.form["passengerForm"+g.index]);if(n&&n.$setValidity("dobValid",t),t)return e}return null},this.visibility={list:!1,infantList:!1,show:function(e){g.visibility[e]=!0},hide:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1;i?a(function(){g.visibility[t]=!1,e.$digest()},200,!1):g.visibility[t]=!1}},this.listControls={list:{},infantList:{}},this.controlList=function(e,t){if(g.visibility[t]&&o.isAuthenticated){var i=g.listControls[t];switch(e.keyCode){case n.ENTER:i.select();break;case n.UP_ARROW:i.moveUp();break;case n.DOWN_ARROW:i.moveDown()}}},this.pax.infant&&e.$watch("$ctrl.pax.infant.dob",function(e,t){e&&e!==t&&g.infantValidDob(e)&&(g.toggleInfantDobUpdate=!g.toggleInfantDobUpdate)}),e.$watch("$ctrl.pax.dob",function(e,t){e&&e!==t&&g.paxValidDob(e)&&(g.togglePaxDobUpdate=!g.togglePaxDobUpdate)}),this.displayCompanionsList=function(e){return e?o.isAuthenticated&&g.listControls[e].getLength&&g.listControls[e].getLength():!1},this.checkElementError=function(e){var t=g.form["passengerForm"+g.index][e],i=t.$invalid,n=t.$touched,o=g.form.$submitted;return i&&(n||o)},this.getElementErrorMessage=function(e){return g.checkElementError(e)&&g.form["passengerForm"+g.index][e].$error},s.isIE().value&&0===this.pax.number&&(angular.element(r[0].querySelector(".payment-passenger-first-name input"))[0].focus(),angular.element(r[0].querySelector(".payment-passenger-first-name"))[0].focus())}]});


"use strict";angular.module("app.booking").component("passengerSearchList",{templateUrl:"/partials/booking/directives/passengers-form/passenger-search-list.html",bindings:{showList:"=",passenger:"=",listControls:"=",operator:"<"},controller:["$scope","CompanionService","Session","PASSENGER_TYPES","Booking","Dates","AIRLINE_CONFIG",function(e,t,n,i,s,r,o){var a=this,l=void 0,c=void 0,u=angular.noop,f=angular.noop,h=0,g=function(){(c||{}).selected=!1,c=void 0},d=function(e){(c||{}).selected=!1,e.selected=!0,a.passenger.selected=!0,c=e,a.showList=!1},p=function(e,t){return e.first+" "+e.last==t.first+" "+t.last},m=function(){return t.getCompanionsPassengerFormatted(s.get("journeys"),!0).then(function(e){var t=R.contains(a.operator,[o.AIRMALTA.airline,o.AIREUROPA.airline])&&a.passenger.type===i.Adult;return a.searchList=e.filter(function(e){return e.type===a.passenger.type||t&&e.type===i.Teen}),a.searchList})},L=function(){return e.$watchCollection(function(){return a.passenger.name},function(e){if(h=0,!c||!p(e,c.name)){var t=(a.searchList||[]).find(function(t){return!t.selected&&p(t.name,e)});return t?void d(t):void(c&&!p(e,c.name)&&g())}})},v=function(){return e.$watch(function(){return a.passenger.dob},function(e){var t=(a.searchList||[]).find(function(t){return!t.selected&&p(t.name,a.passenger.name)&&e===r.formatISO(t.dateOfBirth)});return t?void d(t):void(c&&e!==r.formatISO(c.dateOfBirth)&&g())})},C=function(){a.listControls={getLength:function(){return(a.filteredList||[]).length},moveDown:function(){h++},moveUp:function(){--h<0&&(h=a.filteredList.length-1)},select:function(){if(a.filteredList&&a.filteredList.length){var e=a.listControls.getHighlightIndex();a.selectPassenger(a.filteredList[e])}},getHighlightIndex:function(){return h%a.filteredList.length}}},I=function(e){l=!!e,l?m().then(function(){C(),u=L(),a.passenger.type===i.Infant&&(f=v())}):(u(),f(),g(),t.clearCompanionsPassengerCache())},S=function(e){a.passenger.name=e.name.clone(),a.passenger.dob=r.formatISO(e.dateOfBirth)};I(n.get("user:details")),n.subscribe("user:details",I),this.$onDestroy=function(){t.clearCompanionsPassengerCache(),n.unsubscribe("user:details",I)},this.shouldDisplayList=function(){return l&&this.showList&&this.searchList&&this.searchList.length&&(!this.filteredList||this.filteredList.length)},this.selectPassenger=function(e){S(e)},this.isMale=function(e){return"MR"===e.name.title},this.isFemale=function(e){return"MRS"===e.name.title||"MS"===e.name.title},this.isChildOrInfant=function(e){return e.type===i.Child||e.type===i.Infant}}]});


"use strict";angular.module("app.booking").component("passengerToCompanion",{require:{form:"^form"},bindings:{passenger:"=",infant:"=?",saveAs:"=",passengers:"<",onDisableTravelCredit:"&"},templateUrl:"/partials/booking/directives/passengers-form/passenger-to-companion.html",controller:["$q","$log","$timeout","$scope","$element","Session","CompanionService","Passengers",function(n,e,a,s,t,o,i,r){var l=this,u=10,c=!1,m=void 0,f=[],v=[];this.isSaveable=!0,this.$onInit=function(){l.saveAs=!1};var p=function(){a.cancel(m),m=a(function(){var n=l.name.first+" "+l.name.last,e=~v.indexOf((n||"").toLowerCase()),a=!e&&l.isSaveable&&!c,s=l.passengers.some(function(n){return!R.contains(R.toLower(n.name.first+" "+n.name.last),v)&&!n.saveToCompanion||n.infant&&!R.contains(R.toLower(n.infant.name.first+" "+n.infant.name.last),v)&&!n.infant.saveToCompanion});l.onDisableTravelCredit({$event:s||l.form.$invalid}),(l.name.first||"").length<2||(l.name.last||"").length<2?(l.status="disabled",l.saveAs=null):a?l.status="not saved":e?(l.status="duplicate",l.saveAs=null):(!l.isSaveable||c)&&(l.status="max",l.saveAs=null)},500)},d=function(){n.all({maxAllowed:i.maxAllowed(!0),companions:i.getCompanionsPassenger()}).then(function(n){n.maxAllowed&&n.maxAllowed.data.maxAllowedCompanions&&(u=n.maxAllowed.data.maxAllowedCompanions),v=n.companions.data.map(function(n){return(n.firstName+" "+n.lastName).toLowerCase()}),c=v.length===u+1,p()})["catch"](function(n){e.warn("[passengerToCompanion]: ",n)})},g=function(n){n+v.length>=u+1?l.isSaveable=!!l.saveAs:l.isSaveable||(l.isSaveable=!0,l.saveAs=!1),~["max","not saved"].indexOf(l.status)&&p()},h=function(){f.push(s.$watch(function(){return R.ifElse(function(){return l.infant},R.pathOr("",["infant","name"]),R.pathOr("",["name"]))(l.passenger)},function(n){l.name=n,l.passenger.isSaved=!1;var e=R.all(function(n){var e=n.name;return R.contains(R.toLower(e.first+" "+e.last),v)},l.passengers),a=!l.passengers.some(function(n){return n.infant&&!R.path(["infant","selected"],n)});l.onDisableTravelCredit({$event:!(e&&a)}),l.passenger.selected?(l.status="loaded",l.passenger.selected=!1,l.saveAs=null):p()},!0)),f.push(s.$watch(function(){return!!l.saveAs},function(n,e){if(n!==e&&void 0!==e){var a=r.get("numPaxToSave")||0;a+=n?1:-1,r.set("numPaxToSave",a)}})),r.subscribe("numPaxToSave",g)};s.$watch(function(){return o.getAuthenticated()},function(n){l.isAuthenticated=n,n?(d(),h()):(v=[],a.cancel(m),l.status="disabled",l.saveAs=null,f.forEach(function(n){n()}),r.unsubscribe("numPaxToSave",g))}),this.$onDestroy=function(){r.unsubscribe("numPaxToSave",g)}}]});


"use strict";angular.module("app.booking").constant("SARA",{dob:{CHD:{min:2,max:12},TEEN:{min:12,max:14}}}).directive("passengersForm",["smoothScroll","$timeout","BookingRead",function(e,t,i){return{restrict:"EA",require:"^form",templateUrl:"/partials/booking/directives/passengers-form/passengers-form.html",controllerAs:"paxForm",bindToController:{bookingModel:"<",passengers:"<",specialAssistanceRequired:"<?",assistanceAvailability:"<?",serverErrors:"<",lockedState:"&",onValidateCallback:"&onValidate",options:"<?",onSpecialAssistanceRequiredChanged:"&",operatedBy:"<"},scope:{},link:function(t,i,n,a){var s=this,o=function(){var n={},a=!0,o=(s.serverErrors||[]).length;s.serverErrors=null;var r=t.paxForm.passengers.reduce(function(e,t){return t.infant?e.concat(t.name,t.infant.name):e.concat(t.name)},[]);return r.forEach(function(s){var r=s.first.toLowerCase()+s.last.toLowerCase()+s.middle.toLowerCase();n[r]&&(a=!1,t.paxForm.serverErrors=["DuplicateNameSARA"],o&&e(i.find("prompt.error")[0],{offset:70})),n[r]=!0}),a};t.submitForm=function(){if(t.passengersForm.$submitted=!0,t.passengersForm.$valid&&o())t.paxForm.openDomesticModal=!0;else{var n=i.find("ng-form .ng-invalid");n.length&&e(n[0],{offset:70})}},t.$watch(function(){return a.$submitted},function(e){e&&(t.passengersForm.$submitted=!0)})},controller:["$document","$scope","Passengers","Dates","DateConfig","SpecialAssistanceService","SARA","$log","Configuration","$ngRedux","SpecialAssistanceActions","PassengerAgeService","FEATURE_CONFIG","PASSENGER_TYPES","TravelCreditActions",function(n,a,s,o,r,c,l,u,d,p,f,h,g,m,v){function b(){t(function(){var t=n[0].querySelector(".special-assistance .form-field.form-invalid");t&&e(t,{offset:70})},0)}var A=this;this.extendedDobEnabled=!this.operatedBy&&g["passenger-dob-validation-cultures"]&&!i.hasSpanishDiscount(this.bookingModel),this.$onChanges=function(e){e.assistanceAvailability&&b()};var S=function(e){return{areAllFlightsDepartureDatesNear:R.path(["specialAssistance","areAllFlightsDepartureDatesNear"],e),SApassengerEnumerators:R.pipe(R.pathOr([],["bookingModel","passengers"]),i.enumPassengersByType,R.pluck("model"))(e),bookingModel:e.bookingModel}},y=R.pipe(R.propOr([],"passengers"),R.addIndex(R.map)(function(e,t){return babelHelpers["extends"]({},e,{model:A.passengers[t]})}));this.SApassengers=y(this.bookingModel);var D=p.connect(S,f)(this);this.$onDestroy=function(){D()},this.specialAssistanceRequired=this.specialAssistanceRequired||!1,this.config=Object.assign({minNumberOfChars:2,maxNumberOfChars:32,firstNamePlaceholder:"trips.pax.placeholder_first_name",lastNamePlaceholder:"trips.pax.placeholder_last_name",formTitleLabel:"trips.checkout.passengers.passenger_details",infoMessage:"trips.pax.pax_form_info_names"},this.options);var E=this.config.guestsForm?[{}]:i.getModel("journeys")(this.bookingModel);this.outFlightDate=o.parseISOFull(E[0].depart),this.inFlightDate=E[1]?o.parseISOFull(E[1].depart):this.outFlightDate,s.getTitles().then(function(e){A.titles=e.data.map(function(e){return{key:e.code,value:e.description,paxType:e.paxType}})}),this.infantDobRange=h.getDobRanges(this.bookingModel,"inbound")[m.Infant],this.fullDobRange=h.getFullDobRange(this.bookingModel),this.isDateOfBirthShown=function(e){return A.extendedDobEnabled&&e!==m.Adult&&!A.operatedBy||e===m.Infant&&!A.operatedBy?!0:!1};var C=i.getZoneDiscount(this.bookingModel);if("ES"===C.zone){this.spanishDiscount=!0,this.discountType=C.code.toLowerCase();var x=R.path(["journeys","0","model"],this.bookingModel);d.query({origin:x.orig,destination:x.dest,discountPercentage:R.prop("pct",C)}).then(function(){var e=(d.get("spanishDiscounts")||[]).find(function(e){return e.code===C.code})||{};A.showMunicipalities=e.isResident,A.showCommunities=e.isLargeFamily,A.isSaraValidationEnabled=e.isResident,A.saraValidated=0===A.passengers.filter(function(e){return"success"!==e.status}).length,A.isSaraValidationEnabled&&(A.lockedState({$event:{value:!A.passengers.every(function(e){return e.locked})}}),A.onSaraValidationAction=function(e){var t=e.value;if("success"===t||"final"===t){A.saraValidated=!0,A.lockedState({$event:{value:!1}});var i=a.$watch(function(){return A.openDomesticModal},function(e){e||(A.isSaraValidationEnabled=!1,A.onValidateCallback(),i())})}}),A.showMunicipalities&&s.getMunicipalities().then(function(e){e&&e.data.length>0&&(A.municipalities=e.data.reduce(function(e,t){return e.concat(t)}).reduce(function(e,t){return t.municipalities.forEach(function(i){e.push({group:t.name,name:i.name,code:i.code})}),e},[]))})["catch"](function(e){u.warn(e)}),A.showCommunities&&s.getCommunities().then(function(e){A.communities=e.data})["catch"](function(e){u.warn(e)})}),angular.extend(this.config,{firstNamePlaceholder:"trips.pax.placeholder_first_name_spanish",lastNamePlaceholder:"trips.pax.placeholder_last_name_spanish"});var k=function(e){var t=l.dob[e];return{min:o.formatISO(A.inFlightDate.clone().subtract(t.max,"year").add(1,"day")),max:o.formatISO(A.outFlightDate.clone().subtract(t.min,"year"))}};this.spanishDateRange={CHD:k("CHD"),TEEN:k("TEEN")},this.proofsOfResidency=[{name:"trips.pax.DNI",value:"D"},{name:"trips.pax.NIE",value:"E"},{name:"trips.pax.DNISenator",value:"S",paxType:["ADT"]},{name:"trips.pax.withoutDNI",value:"U",paxType:["TEEN","CHD"]}],this.filterProofOfResidency=function(e){return function(t){return!t.paxType||~t.paxType.indexOf(e.type)}},this.onDocTypeChanged=function(e){"U"===e.residentInfo.docType?(e.residentInfo.docNum=void 0,e.residentInfo.dob=e.dob):e.residentInfo.dob=void 0,A.docNumberDuplicateCheck(0)};var F=void 0,N=function(){var e={},t=void 0;A.passengers.forEach(function(i,n){t=!0;var s=a.passengersForm["passengerForm"+n].docNum;if(i.residentInfo&&i.residentInfo.docType&&i.residentInfo.docNum){var o=i.residentInfo.docNum.toLowerCase();e[o]&&(t=!1,e[o].$setValidity("docDuplicateCheck",!1)),e[o]=s}s&&s.$setValidity("docDuplicateCheck",t)})};this.docNumberDuplicateCheck=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500;t.cancel(F),F=t(N,e)}}this.getServerErrors=function(){var e=A.serverErrors||[];return A.saraServerErrors&&(e=e.concat(A.saraServerErrors)),e},this.getFlights=function(){var e=[];return E.filter(function(e){return!e.flown}).forEach(function(t,i){var n={number:i,type:0===i?"outbound":"inbound",departureAirportCode:t.orig,destinationAirportCode:t.dest,date:o.utc(t.depart)};e[n.type]=n,e.push(n)}),e},this.specialAssistanceRequiredChanged=function(e){A.onSpecialAssistanceRequiredChanged({value:e})},this.disableTravelCredit=function(e){p.dispatch(v.disableTravelCredit(e))},this.flights=this.getFlights(),this.isSpecialAssistanceLoading=!1,this.getSpecialAssistanceAvailability=function(){A.isSpecialAssistanceLoading=!0,c.getAssistanceAvailability(A.passengers).then(function(e){A.mapBookingModelToSA(e,A.bookingModel)})["finally"](function(){A.isSpecialAssistanceLoading=!1}),A.SApassengers=y(A.bookingModel)},this.isSpecialAssistanceDisabled=function(){return A.isSpecialAssistanceLoading},a.$watch(function(){return A.specialAssistanceRequired},function(e){e&&A.assistanceAvailability&&A.getSpecialAssistanceAvailability()}),a.$watch(function(){return A.passengers},function(e){!A.operatedBy&&e&&A.assistanceAvailability&&A.assistanceAvailability.length&&A.getSpecialAssistanceAvailability()}),this.onDialogCloseAction=function(e){var t=e.value;A.openDomesticModal=t},this.getSaraServerErrorsAction=function(e){var t=e.value;A.saraServerErrors=t}}]}}]);


"use strict";angular.module("app.booking").component("redeemVoucher",{templateUrl:"/partials/booking/directives/redeem-voucher/redeem-voucher.html",bindings:{state:"<",passengers:"<"},controller:["USED_VOUCHERS_LIMIT","RewardsFactory","Session","PassengerFactory","$state","BOOKING_STATES","RewardsUtil","BookingRead","$ngRedux","VoucherActions","PaymentActions",function(e,r,t,o,n,i,s,a,c,u,h){var d=this;this.isVoucherGracePeriodOver=!1,this.remainingVoucherCredit=0,this.disableVoucherDropdown=!1,this.showRewardOnCheckoutOnly=!1,this.voucher={},this.vouchers=[],this.isBookingPayment=n.is("booking.payment"),this.hasSpanishDiscount=a.hasSpanishDiscount(this.state),this.minRefundCap=2;var m={ReferenceFormat:"reference_format",NoBooking:"no_booking",VoucherMaxPaymentsLimitBreached:"voucher_max_payments_limit_breached",VoucherMaxVoucherPaymentsLimitBreached:"voucher_max_voucher_payments_limit_breached",VoucherRedeemed:"voucher_redeemed",VoucherMaxAttemptsLimitBreached:"voucher_max_attempts_limit_breached",NoVoucher:"no_voucher",VoucherNameMatchError:"voucher_name_match_error",VoucherExpired:"voucher_expired","Session Token invalid / not found.":"session_token_invalid","Session expired.":"session_expired",UnexpectedError:"unexpected_error",InvalidRedemptionDate:"invalid_redemption_date"},l=function(e,r){d.form&&d.form.voucherNumber.$setValidity(e,r)},v=function(){r.getVouchersAndTokens().then(function(e){d.rewards=s.filter(e.data.vouchers,d.state.journeys)})},p=function(){var e=t.isAuthenticated;d.isAuthenticated!==e&&e&&v(),d.isAuthenticated=e},g=function(e){d.redeemErrorLabel="trips.vouchers.breakdown.errors."+(m[e.code]||"unexpected_error"),l("validation",!1)},f=function(){d.$actions.voucherActions.redeem(d.voucherNumber,o.getPaymentFormPayload(d.passengers),t.getClientId()).then(function(){return d.$actions.paymentActions.updateCurrencyConversionOffer()})},b=function(){l("validation",!0),d.$actions.voucherActions.useReward(d.voucher.id,o.getPaymentFormPayload(d.passengers),t.getClientId())},_=R.when(R.propEq("isFeeMsgVisible",!0),function(){return d.$actions.paymentActions.setPaymentFeeMsgVisibility({isVisible:!1})});this.redeem=function(){d.voucher.id?b():f()},this.rewardSelected=function(){d.voucher.id&&(d.voucherNumber="")},this.visibleVouchersFilter=function(e){return"VO"===e.code&&!!~[i.AVAILABLE,i.PENDING].indexOf(e.status)},this.canVouchersBeRedeemed=function(){return o.isPassengersListValid(d.passengers,d.$state.bookingModel)},this.onVoucherNumberChanged=function(){l("validation",!0),_(d.$state.payment)};var y=function(r){var t=r.filter(function(e){return"VO"===e.model.code}).map(function(e){return e.model});d.vouchers.length<t.length&&(d.voucherNumber=""),d.vouchers=t,d.vouchersCapReached=t.some(function(e){return e.voucherCap&&!e.isVoucherGracePeriodOver}),d.isVoucherLimitReached=t.length>=e,d.isStoredVoucherUsed=t.some(function(e){return e.isReward}),d.lastVoucherUsed=t[t.length-1]};t.subscribe("user:details",p),p(t.get("user:details"));var V=function(e){var r=a.isPotentialBooking(e.bookingModel),t=R.path([[0],"model"],a.getTravelCredits(e.bookingModel));return t>0&&r&&(d.voucherShown=!1),{bookingModel:e.bookingModel,payment:e.payment,redeemError:R.pathOr({},["voucher","redeemError"],e),travelCreditAdded:t&&r}},A=c.connect(V,[u,h])(function(e,r){var t=babelHelpers.slicedToArray(r,2),o=t[0],n=t[1];d.$actions={voucherActions:o,paymentActions:n},d.$state=e,R.isEmpty(e.redeemError)||g(e.redeemError)});this.$onInit=function(){y(d.state.payments)},this.$onChanges=function(){y(d.state.payments)},this.$onDestroy=function(){t.unsubscribe("user:details",p),d.$actions.voucherActions.reset(),A()}}]});


"use strict";angular.module("app.booking").component("flightSpecialAssistanceSelector",{templateUrl:"/partials/booking/directives/special-assistance/flight-special-assistance-selector.html",bindings:{assistanceAvailabilityList:"<",chosenAssistanceCode:"<",onAssistanceTypeSelect:"&",name:"@",segment:"<",form:"<"},controller:function(){var i=this;this.assistanceAvailabilityList=this.assistanceAvailabilityList||[],this.additionalAssistanceAvailabilityList=[],this.selectMainAssistanceType=function(e){i.mainSelector=e,i.mainSelector.isAssistanceContainer?i.additionalAssistanceAvailabilityList=i.mainSelector.childPrms:(i.onAssistanceTypeSelect({assistanceCode:i.mainSelector.code,segment:i.segment.key.id}),i.additionalAssistanceAvailabilityList=[],i.additionalSelector="")},this.selectAdditionalAssistanceType=function(e){i.additionalSelector=e,i.onAssistanceTypeSelect({assistanceCode:i.additionalSelector.code,segment:i.segment.key.id})},this.isAssistanceTypeUnavailable=function(){return(i.mainSelector?i.mainSelector.isUnavailable:!1)||(i.additionalSelector?i.additionalSelector.isUnavailable:!1)},this.$onChanges=function(){var e=function(e){return R.equals(i.chosenAssistanceCode,e.code)},s=function(s){return i.additionalSelector=R.find(e,s.childPrms),i.additionalAssistanceAvailabilityList=s.childPrms,!!i.additionalSelector},t=R.ifElse(e,function(){return i.additionalSelector="",!0},R.F),a=R.ifElse(R.prop("isAssistanceContainer"),s,R.F),n=R.either(t,a);i.mainSelector=R.find(n,i.assistanceAvailabilityList)}}});


"use strict";angular.module("app.booking").component("flightSpecialAssistance",{templateUrl:"/partials/booking/directives/special-assistance/flight-special-assistance.html",bindings:{name:"@",model:"<",flight:"<",passenger:"<",form:"<"},controller:["$q","Stations","SpecialAssistanceType","$ngRedux","SpecialAssistanceActions","ModelQuery","SpecialAssistanceUtils",function(e,s,i,t,a,n,c){var r=this;this.name=this.name||"flightSpecialAssistance",this.flight=this.flight||{},this.passenger=this.passenger||{},this.$onInit=function(){r.flight?e.all([s.getAirportName(r.flight.departureAirportCode),s.getAirportName(r.flight.destinationAirportCode)]).then(function(e){r.departureAirportName=e[0],r.destinationAirportName=e[1]}):(r.departureAirportName="",r.destinationAirportName="")},this.isAssistanceTypeUnavailable=function(e){return r.selectedAssistanceType[e].code?r.selectedAssistanceType[e].isUnavailable:!1},this.areGuideDogsAllowed=function(e){return r.selectedAssistanceType[e].code?r.selectedAssistanceType[e].areGuideDogsAllowed:!0},this.isSeatRestricted=function(e){return r.selectedAssistanceType[e].code?r.selectedAssistanceType[e].isSeatRestricted:!1},this.isSeatAvailable=function(e){return r.selectedAssistanceType[e].code?r.selectedAssistanceType[e].isSeatAvailable:!0},this.showWheelchairAssistance=function(e){return r.selectedAssistanceType[e].code!==i.NotRequired.code&&""!==r.selectedAssistanceType[e].code};var l=function(e){var s=R.pipe(n.byIdentity("assistanceAvailability"),n.byKey({journeys:r.flight.number,passengers:r.passenger.key.id}),R.path([0,"model"]))(e.specialAssistance),i=R.pipe(n.byIdentity("prms"),n.byKey({passengers:r.passenger.key.id,journeys:r.flight.number}),R.pluck("model"))(e.specialAssistance),t=i.reduce(function(e,i){return e.selectedAssistanceType.push(c.getSpecialAssistance(R.path(["assistanceType","code"],i),s)||babelHelpers["extends"]({},R.path(["assistanceType"],i))),e.wheelchairType.push(s.wheelchair.find(function(e){return e.code===R.path(["wheelchairSelector","wheelchairType","code"],i)})||R.path(["wheelchairSelector","wheelchairType"],i)),e.isRequired.push(R.path(["wheelchairRequired"],i)),e.wheelchairAssistance.push(R.path(["wheelchairSelector","assistanceType"],i)),e},{selectedAssistanceType:[],wheelchairType:[],wheelchairAssistance:[],isRequired:[]}),a=t.selectedAssistanceType,l=t.wheelchairType,p=t.wheelchairAssistance,h=t.isRequired;return{selectedAssistanceType:a,selectedWheelchair:i.map(function(e,s){return{wheelchairSelector:{wheelchairType:l[s],assistanceType:p[s]},isRequired:h[s]}}),segments:R.pipe(n.byIdentity("segments"),n.byKey({journeys:r.flight.number}))(e.bookingModel),assistanceAvailability:s}},p=t.connect(l,a)(this);this.$onDestroy=function(){p()},this.updateSelectedAssistance=function(e,s){r.selectSpecialAssistance(e,r.passenger.key.id,r.flight,s)},this.updateWheelchair=function(e,s,i){r.selectWheelchair(e,s,r.passenger.key.id,r.flight,i)}}]});


"use strict";angular.module("app.booking").component("passengerSpecialAssistance",{templateUrl:"/partials/booking/directives/special-assistance/passenger-special-assistance.html",bindings:{name:"@",passenger:"<",flights:"<",form:"<?",passengerEnumerator:"<?"},controller:["$filter","$ngRedux","SpecialAssistanceActions","ModelQuery",function(e,s,a,i){var t=this;this.name=this.name||"passengerSpecialAssistance",this.passenger=this.passenger||{},this.flights=this.flights||{};var n=e("translate");this.isDepartureDateNear=function(e){var s=R.pipe(i.byKey({journeys:e.number}),R.path([0,"model"]))(t.assistanceAvailability);return s&&s.isDepartureDateNear},this.travelsWithInfant=function(){return t.assistanceAvailability&&t.assistanceAvailability.length&&t.assistanceAvailability.some(function(e){return e.model.travelsWithInfant})},this.isAvailable=function(e){return!t.travelsWithInfant(e)};var r=function(e){return!(e.model.name.title||e.model.name.first||e.model.name.last||e.model.name.middle||e.model.name.suffix)};this.getName=function(e){return r(e)?n("trips.pax.type."+t.passengerEnumerator.type,{index:t.passengerEnumerator["enum"]}):n("trips.special_assistance.display_name",e.model.name)},this.toggleSpecialAssistanceRequired=function(e){t.toggleIsRequired(e)};var l=function(e){return{specialAssistanceRequired:babelHelpers["extends"]({},R.pipe(i.byIdentity("SARequired"),i.byKey({passengers:t.passenger.key.id}),R.path([0]))(e.specialAssistance)),assistanceAvailability:R.pipe(i.byIdentity("assistanceAvailability"),i.byKey({passengers:t.passenger.key.id}))(e.specialAssistance)}},p=s.connect(l,a)(this);this.$onDestroy=function(){p()}}]});


"use strict";angular.module("app.booking").component("specialAssistanceDropdown",{templateUrl:"/partials/booking/directives/special-assistance/special-assistance-dropdown.html",bindings:{dropdownId:"@",name:"@",dropdownValues:"<",form:"<",isAssistanceTypeUnavailable:"<",onAssistanceSelect:"&",selectedAssistance:"<",isRequired:"<",placeholderCode:"<",isAdditional:"<"},controller:["$document","smoothScroll",function(o,e){var s=this;this.$onInit=function(){s.dropdownExpanded=!1,s.placeholderCode=s.placeholderCode||"compound_select"},this.toggleDropdown=function(){s.dropdownExpanded=!s.dropdownExpanded},this.collapseDropdown=function(){s.dropdownExpanded=!1},this.selectAssistance=function(o,e){s.onAssistanceSelect({assistanceType:o}),s.collapseDropdown(),s.scrollTo(e)},this.scrollTo=function(s){var n={containerId:"dialog-body-slot",offset:o[0].getElementById("dialog-body-slot")?90:0},t=R.path(["target","closest"],s)&&s.target.closest("passenger-special-assistance");e(t,n)}}]});


"use strict";angular.module("app.booking").component("specialAssistanceForm",{templateUrl:"/partials/booking/directives/special-assistance/special-assistance-form.html",bindings:{specialAssistanceForm:"=",passengers:"="},controller:["$ngRedux","SpecialAssistanceService","Dates","SpecialAssistanceActions","BookingRead",function(e,s,i,n,o){var t=this,a=function(e,s,n){return s.model.flown?e:e.concat([{number:n,type:0===n?"outbound":"inbound",departureAirportCode:s.model.orig,destinationAirportCode:s.model.dest,date:i.utc(s.model.depart),isBusiness:s.model.isBusiness}])},c=function(e){return{flights:e.bookingModel.journeys.reduce(a,[]),bookingModel:e.bookingModel}},l=e.connect(c,n)(this);this.$onDestroy=function(){l()},this.getSpecialAssistanceAvailability=function(){s.getAssistanceAvailability(t.passengers).then(function(e){t.mapBookingModelToSA(e,t.bookingModel)})["finally"](function(){t.isSpecialAssistanceLoading=!1})},this.checkShouldShowENACSeatMessage=function(e){return R.pathOr(!1,["enac-seats-enabled"],e.launchDarkly)&&o.checkCountriesInJourney(e.bookingModel,["IT"])},this.getSpecialAssistanceAvailability(),this.shouldShowENACSeatMessage=this.checkShouldShowENACSeatMessage(e.getState())}]});


"use strict";angular.module("app.booking").component("wheelchairSpecialAssistanceSelector",{templateUrl:"/partials/booking/directives/special-assistance/wheelchair-special-assistance-selector.html",bindings:{name:"@",model:"<",passenger:"<",selectedMainAssistance:"<",wheelchairAssistanceAvailabilityList:"<",onWheelchairSelectorUpdate:"&",segment:"<",form:"<"},controller:["$filter",function(e){var i=this;this.name=this.name||"wheelchairSpecialAssistance",this.passenger=this.passenger||{},this.wheelchairAssistanceAvailabilityList=this.wheelchairAssistanceAvailabilityList||[];var s=e("translate");this.$onInit=function(){i.passengerTypeName=s("trips.pax.type."+i.passenger.type,{index:i.passenger.typeNumber})},this.$onChanges=function(){i.isRequired=i.model.isRequired,i.wheelchairType=i.model.wheelchairSelector.wheelchairType,i.wheelchairTypeRadioButtonModel=i.wheelchairType.code,i.assistanceType=i.model.wheelchairSelector.assistanceType},this.isAssistanceTypeUnavailable=function(){return R.propOr(!1,"isUnavailable",i.assistanceType)},this.isWheelchairTypeUnavailable=function(){return R.propOr(!1,"isUnavailable",i.wheelchairType)},this.selectAssistanceType=function(e){i.updateWheelchairSelector(i.wheelchairType,e)},this.selectWheelchairType=function(e){var s=i.wheelchairAssistanceAvailabilityList.find(function(i){return i.code===e});i.updateWheelchairSelector(s,i.assistanceType)},this.updateWheelchairSelector=function(e,s){var a={wheelchairType:e,assistanceType:s};i.onWheelchairSelectorUpdate({isRequired:!0,wheelchairSelector:a,segment:i.segment.key.id})},this.updateIsRequired=function(e){i.onWheelchairSelectorUpdate({isRequired:e,wheelchairCode:"",segment:i.segment.key.id})}}]});


"use strict";angular.module("app.booking").directive("tripImage",["Stations","Booking","DateConfig","AEMConfig",function(e,t,o,i){return{restict:"E",scope:{bookingModel:"="},link:function(n){function r(t){e.getAirport(t.journeys[0].orig).then(function(e){n.origPort=e}),e.getAirport(t.journeys[0].dest).then(function(e){n.destPort=e}),n.departDate=moment(t.journeys[0].depart).format(o.displayFormats.activeFromTo),n.arriveDate=t.journeys&&t.journeys[1]?moment(t.journeys[1].depart).format(o.displayFormats.activeFromTo):null;var r="/resources/ui/illustrations/destinations/";n.iataImage=i.getStaticFilePrefix()+r+t.journeys[0].dest+".png",n.retinaImage=i.getStaticFilePrefix()+r+t.journeys[0].dest+"@2x.png"}var a=t.get("payments")[t.get("payments").length-1];n.pending="pending"===a.status.toLowerCase(),n.bookingModel.journeys&&(r(n.bookingModel),t.subscribe(r,!0),n.$on("$destroy",function(){t.unsubscribe(r)}))},templateUrl:"/partials/booking/directives/trip-image/trip-image.html"}}]);


"use strict";angular.module("app.booking").factory("AddonsReducer",["INSURANCE_ACTION_TYPES","GROUND_TRANSFERS_ACTION_TYPES","PARKING_ACTION_TYPES","CARHIRE_ACTION_TYPES","LOCK_FARE_ACTION_TYPES","ModelQuery","BookingWrite","ROOMS_ACTION_TYPES","RA_IFRAME_ACTION_TYPES","TRANSFERS_ACTION_TYPES",function(e,d,o,a,n,s,r,l,t,p){return function(){var c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},O=arguments[1];switch(O.type){case e.ADD_TO_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},c,{addons:R.pipe(s.byModel({code:"INS"}),s.complement(c.addons),R.concat(O.payload.map(function(e){return{key:{},model:e,identity:"addons"}})))(c.addons)});case e.ADD_INSURANCE:var _=R.pipe(s.byModel({code:"INS",paxNum:O.payload.insurance.paxNum}),s.byLocal(!0),s.complement(c.addons))(c.addons);return babelHelpers["extends"]({},c,{addons:r.add({key:{},model:O.payload.insurance,local:!0},_)});case e.DRAWER_CLOSED:return babelHelpers["extends"]({},c,{addons:R.pipe(s.byModel({code:"INS",sold:!1}),s.byLocal(!0),s.complement(c.addons))(c.addons).map(function(e){return"INS"===e.model.code&&e.removed?babelHelpers["extends"]({},e,{removed:!1}):e})});case e.CLEAR:return babelHelpers["extends"]({},c,{addons:R.pipe(s.byModel({code:"INS",sold:!1}),s.byLocal(!0),s.complement(c.addons))(c.addons)});case e.REMOVE_INSURANCE:var m=R.pipe(s.byModel({code:"INS",paxNum:O.payload.paxNum}),s.byLocal(!1),s.byRemoved(!1))(c.addons);return m.length>0?babelHelpers["extends"]({},c,{addons:r.remove(m[0],c.addons)}):babelHelpers["extends"]({},c,{addons:R.pipe(s.byModel({code:"INS",paxNum:O.payload.paxNum}),s.byLocal(!0),s.complement(c.addons))(c.addons)});case e.REMOVE_FROM_BOOKING_MODEL_SUCCESS:var S=R.when(R.propSatisfies(R.isNil,"itemId"),R.dissoc("itemId"))({code:"INS",sold:!1,itemId:O.forType});return babelHelpers["extends"]({},c,{addons:R.pipe(s.byModel(S),s.complement(c.addons))(c.addons)});case p.ADD_TO_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},c,{addons:R.pipe(R.pathOr([],["addons"]),s.byModel({src:"TRANS",sold:!1}),s.complement(R.pathOr([],["addons"],c)),R.concat(R.pipe(R.filter(function(e){return"TRANS"===e.src&&!e.sold}),R.map(function(e){return{identity:"addons",key:{},model:e,local:!1,removed:!1,confirmed:!0}}))(O.payload)))(c)});case p.REMOVE_FROM_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},c,{addons:R.pipe(R.pathOr([],["addons"]),O.payload?s.byModel({src:"TRANS",sold:!1,itemId:O.payload}):s.byModel({src:"TRANS",sold:!1}),s.complement(R.pathOr([],["addons"],c)))(c)});case d.ADD_TO_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},c,{addons:R.pipe(s.byIdentity("addons"),s.byModel({type:"GRTANSFER",sold:!1}),s.complement(R.pathOr([],["addons"],c)),R.concat(R.pipe(R.filter(function(e){return"GRTANSFER"===e.type}),R.map(function(e){return{identity:"addons",key:{},model:e,local:!1,removed:!1,confirmed:!0}}))(O.payload)))(c)});case d.REMOVE_FROM_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},c,{addons:R.pipe(R.pathOr([],["addons"]),s.byModel({type:"GRTANSFER",sold:!1}),s.complement(R.pathOr([],["addons"],c)))(c)});case a.ADD_TO_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},c,{addons:R.pipe(R.pathOr([],["addons"]),s.byModel({src:"CARHIRE",sold:!1}),s.complement(R.pathOr([],["addons"],c)),R.concat(O.payload.map(function(e){return{identity:"addons",key:{},model:e,local:!1,removed:!1,confirmed:!0}})))(c)});case a.REMOVE_FROM_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},c,{addons:R.pipe(R.pathOr([],["addons"]),s.byModel({src:"CARHIRE",sold:!1}),s.complement(R.pathOr([],["addons"],c)))(c)});case o.ADD_TO_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},c,{addons:R.pipe(R.pathOr([],["addons"]),s.byModel({src:"PARKING",sold:!1}),s.complement(R.pathOr([],["addons"],c)),R.concat(R.pipe(R.filter(function(e){return"PARKING"===e.src}),R.map(function(e){return{identity:"addons",key:{},model:e,local:!1,removed:!1,confirmed:!0}}))(O.payload)))(c)});case o.REMOVE_FROM_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},c,{addons:R.pipe(R.pathOr([],["addons"]),s.byModel({src:"PARKING",sold:!1}),s.complement(R.pathOr([],["addons"],c)))(c)});case n.ADD_TO_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},c,{addons:[]});case l.ADD_TO_BOOKING_SUCCESS:var i=R.find(R.pathEq(["model","src"],"HOTEL"),c.addons),E=R.without([i],c.addons);return babelHelpers["extends"]({},c,{addons:[].concat(babelHelpers.toConsumableArray(E),[{identity:"addons",key:{},model:babelHelpers["extends"]({},O.payload.room),local:!1,removed:!1,confirmed:!0}])});case l.REMOVE_FROM_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},c,{addons:R.pipe(R.pathOr([],["addons"]),s.byModel({src:"HOTEL",sold:!1}),s.complement(R.pathOr([],["addons"],c)))(c)});case t.ADD_TO_BOOKING_MODEL_SUCCESS:case t.REMOVE_FROM_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},c,{addons:R.pipe(s.byModel({sold:!1,src:O.payload.id}),s.complement(c.addons),R.concat(O.payload.items))(c.addons)});default:return c}}}]);


"use strict";angular.module("app.booking").factory("BookingModelBasicReducer",["BOOKING_MODEL_ACTION_TYPES","FLIGHT_SEARCH_ACTION_TYPES","ModelQuery","EXPRESS_BOOKING_POPUP_ACTIONS","PAYMENT_ACTION_TYPES","VOUCHER_ACTION_TYPES","MANAGE_TRIPS_ACTION_TYPES","TRAVEL_DOCUMENTS_ACTIONS_TYPES","SAMSONITE_ACTION_TYPES","CHECKIN_MODEL_ACTION_TYPES","RA_IFRAME_ACTION_TYPES",function(e,r,s,n,a,E,t,_,o,S,c){var O={info:[],passengers:[],contacts:[],carHire:[],serverTimeUTC:[],addons:[],extras:[],ssrs:[],journeys:[],warnings:[],seats:[],segments:[],checkin:[],fats:[],paxFees:[],segFees:[],fees:[],fares:[],infSsrs:[],zoneDiscount:[],payments:[],status:"",errors:[],segPrm:[],isLoading:!1,travelDocuments:[],fareErrors:[],fareWarnings:[],operatedBy:""},l=function(e){var r=e;if(e.ssrs){var n=e.ssrs.filter(function(e){return"BAGS"===e.model.type}).reduce(s.inflateQuantities,[]);r=babelHelpers["extends"]({},e,{ssrs:[].concat(babelHelpers.toConsumableArray(e.ssrs.filter(function(e){return"BAGS"!==e.model.type})),babelHelpers.toConsumableArray(n))})}return r};return function(){var T=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,i=arguments[1],C=i.type,u=i.payload;switch(C){case e.RESET:case n.CLOSE_DIALOG:return babelHelpers["extends"]({},O);case e.GET_UNBALANCED_BOOKING_MODEL_START:return babelHelpers["extends"]({},O,{isLoading:!0});case e.GET_BOOKING_MODEL_START:case e.POST_SELECTED_FLIGHT_START:case e.PAGE_REFRESH_START:case t.CONTACT_UPDATE_START:case t.SPECIAL_ASSISTANCE_UPDATE_START:case c.ADD_TO_BOOKING_MODEL_START:case c.REMOVE_FROM_BOOKING_MODEL_START:return babelHelpers["extends"]({},T,{isLoading:!0});case e.CREATE_BOOKING_MODEL_START:return babelHelpers["extends"]({},T,{bookingModel:babelHelpers["extends"]({},T.bookingModel,{isLoading:!0}),isLoading:!0});case c.REMOVE_FROM_BOOKING_MODEL_ERROR:case c.ADD_TO_BOOKING_MODEL_ERROR:return babelHelpers["extends"]({},T,{isLoading:!1,errors:T.errors.concat(u)});case e.CREATE_BOOKING_MODEL_FAILED:case e.POST_SELECTED_FLIGHT_ERROR:case e.GET_BOOKING_MODEL_FAILED:case e.GET_UNBALANCED_BOOKING_MODEL_FAILED:case E.SELECT_VOUCHER_ERROR:case e.PAGE_REFRESH_ERROR:return babelHelpers["extends"]({},O,{errors:T.errors.concat(u),bookingModel:babelHelpers["extends"]({},T.bookingModel,{isLoading:!1})});case e.SET_FARE_ERROR:return babelHelpers["extends"]({},T,{fareErrors:T.errors.concat(u)});case e.SET_FARE_WARNING:return babelHelpers["extends"]({},T,{fareWarnings:T.warnings.concat(u)});case e.RESET_FARE_ERRORS:return babelHelpers["extends"]({},T,{fareErrors:[]});case e.RESET_FARE_WARNINGS:return babelHelpers["extends"]({},T,{fareWarnings:[]});case E.SELECT_VOUCHER_SUCCESS:case a.PROCESS_PAYMENT_SUCCESS:case e.GET_BOOKING_MODEL_SUCCESS:case e.PAGE_REFRESH_SUCCESS:case e.POST_SELECTED_FLIGHT_SUCCESS:case e.GET_UNBALANCED_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},O,l(u));case n.PROCESS_PAYMENT_SUCCESS:case n.CREATE_BOOKING_SUCCESS:case e.CREATE_BOOKING_MODEL_SUCCESS:case t.CONTACT_UPDATE_SUCCESS:case t.SPECIAL_ASSISTANCE_UPDATE_SUCCESS:return babelHelpers["extends"]({},T,l(u),{isLoading:!1,bookingModel:babelHelpers["extends"]({},T.bookingModel,{isLoading:!1})});case r.REMOVE_SELECTED_JOURNEY:var A=R.pipe(s.byIdentity("journeys"),s.byKey({journey:u}),s.complement(T.journeys))(T);if(!A.length)return O;var b={};return Object.keys(T).forEach(function(e){Array.isArray(T[e])&&(b[e]=T[e].filter(function(e){return R.path(["key","journeys"],e)!==u}))}),babelHelpers["extends"]({},T,b,{journeys:A});case _.ADD_TO_BOOKING_MODEL_SUCCESS:var d=R.pipe(s.byIdentity("travelDocuments"),R.filter(function(e){return!R.find(R.propEq("num",e.key.passengers),u.documents)}))(T),N=R.map(function(e){return{identity:"travelDocuments",key:{passengers:e.num},model:R.pick(["travelDocument","infantTravelDocument"],e)}},u.documents);return babelHelpers["extends"]({},T,{travelDocuments:[].concat(babelHelpers.toConsumableArray(d),babelHelpers.toConsumableArray(N))});case _.UPDATE_DOCUMENTS_IN_BOOKING_MODEL:var p=R.find(function(e){return e.key.passengers===u.num},T.checkin);return p&&(p.model=babelHelpers["extends"]({},p.model,u.travelDocuments)),babelHelpers["extends"]({},T);case o.POST_SAMSONITE_SUCCESS:return babelHelpers["extends"]({},T,{fees:[],info:u.info,passengers:u.passengers,serverTimeUTC:u.serverTimeUTC});case S.CHECKIN_PAX_SUCCESS:var I=T.checkin.filter(function(e){return!u.checkin.find(function(r){return R.equals(r.key,e.key)})});return babelHelpers["extends"]({},T,{checkin:[].concat(babelHelpers.toConsumableArray(I),babelHelpers.toConsumableArray(u.checkin))});default:return T}}}]);


"use strict";angular.module("app.booking").factory("BookingModelNameChangeReducer",["CHANGE_NAME_ACTION_TYPES",function(e){var a={isLoading:!1};return function(){var s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,n=arguments[1];switch(n.type){case e.CHANGE_NAME_UPDATE_START:return babelHelpers["extends"]({},s,{isLoading:!0});case e.CHANGE_NAME_UPDATE_SUCCESS:return babelHelpers["extends"]({},s,{passengers:n.payload.passengers,paxFees:n.payload.paxFees,isLoading:!1});case e.CHANGE_NAME_UPDATE_FAILED:case e.CHANGE_RESET_FAILED:return babelHelpers["extends"]({},s,{isLoading:!1,modifyBookingModelError:n.payload});case e.CHANGE_NAME_RESET:return babelHelpers["extends"]({},s,{isLoading:!0});case e.CHANGE_NAME_REVERTED:return babelHelpers["extends"]({},s,{paxFees:[],isLoading:!1});default:return s}}}]);


"use strict";angular.module("app.booking").factory("BookingModelPaymentsReducer",["VOUCHER_ACTION_TYPES","ModelQuery","TRAVEL_CREDIT_ACTIONS",function(e,a,n){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments[1];switch(s.type){case e.USE_REWARD_VOUCHER_SUCCESS:case e.REDEEM_VOUCHER_SUCCESS:return babelHelpers["extends"]({},t,{payments:t.payments.concat(s.payload.payments.map(function(e){return babelHelpers["extends"]({},e,{key:{id:t.payments.length+e.key.id}})}))});case e.REMOVE_VOUCHER_SUCCESS:var r=a.byModel({accNum:s.payload})(t.payments);return babelHelpers["extends"]({},t,{payments:a.complement(t.payments)(r)});case n.REDEEM_TRAVEL_CREDIT_SUCCESS:return s.payload.payments?babelHelpers["extends"]({},t,{payments:t.payments.concat(s.payload.payments.map(function(e){return babelHelpers["extends"]({},e,{key:{id:t.payments.length+e.key.id}})}))}):babelHelpers["extends"]({},t);case n.REMOVE_TRAVEL_CREDIT_SUCCESS:var p=a.byModel({code:s.payload})(t.payments);return babelHelpers["extends"]({},t,{payments:a.complement(t.payments)(p)});default:return t}}}]);


"use strict";angular.module("app.booking").factory("BookingModelReducer",["BookingModelBasicReducer","SsrsReducer","AddonsReducer","ExtrasReducer","BookingModelNameChangeReducer","BookingModelSeatsReducer","BookingModelPaymentsReducer",function(e,r,n,o,u,t,d){var c=function(){for(var e=arguments.length,r=Array(e),n=0;e>n;n++)r[n]=arguments[n];return function(e,n){return r.reduceRight(function(e,r){return r(e,n)},e)}};return c(r,n,o,t,u,d,e)}]);


"use strict";angular.module("app.booking").factory("BookingModelSeatsReducer",["SEATS_ACTION_TYPES","ModelQuery","BookingWrite",function(e,s,a){var t={seats:[]};return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,n=arguments[1];switch(n.type){case e.CLEAR_ALL_SEATS_SUCCESS:return babelHelpers["extends"]({},r,{seats:n.payload.seats});case e.RESET:return babelHelpers["extends"]({},r,{seats:R.pipe(s.byLocal(!1),R.map(function(e){return babelHelpers["extends"]({},e,{removed:!1})}))(r.seats)});case e.REMOVE_SEATS_SUCCESS:return babelHelpers["extends"]({},r,{seats:R.pipe(s.byModel({sold:!0}))(r.seats)});case e.SELECT_PREVIOUS_SEAT:var l=r.seats.map(function(e){return R.equals(n.payload.seat.key,e.key)?R.omit(["removed"],e):e});return babelHelpers["extends"]({},r,{seats:l});case e.SELECT_SEAT:return babelHelpers["extends"]({},r,{seats:r.seats.concat(n.payload.seats)});case e.UNSELECT_SEAT:var o=r.seats;return n.payload.seats.forEach(function(e){var t=R.pipe(s.byKey(e.key),s.byLocal(!1),s.byRemoved(!1),R.head)(o);o=t?a.remove(t,o):s.complement(o)(R.pipe(s.byKey(e.key),s.byRemoved(!1))(o))}),babelHelpers["extends"]({},r,{seats:o});case e.CONFIRM_SEATS_SUCCESS:return babelHelpers["extends"]({},r,{seats:n.payload.seats});case e.CONFIRM_SEATS_SUCCESS_ON_CHECKIN:var S=r.seats.filter(function(e){return!n.payload.seats.find(function(s){return R.equals(s.key,e.key)})});return babelHelpers["extends"]({},r,{seats:[].concat(babelHelpers.toConsumableArray(S),babelHelpers.toConsumableArray(n.payload.seats))});case e.QUICK_ADD_SUCCESS:case e.ADD_SUGGESTED_SEATS_SUCCESS:return babelHelpers["extends"]({},r,{seats:n.payload.seats});case e.RESET_AFTER_CHANGE_SEAT:var E=r.seats.reduce(function(e,s){return s.removed||e.push(babelHelpers["extends"]({},s,{removed:!1})),e},[]);return babelHelpers["extends"]({},r,{seats:E});case e.CLEAR_UNCONFIRMED_SEAT_CHANGE:return babelHelpers["extends"]({},r,{seats:n.payload});case e.RESET_TO_CHANGED_STATE:return babelHelpers["extends"]({},r,{seats:n.payload});default:return r}}}]);


"use strict";angular.module("app.booking").factory("ExtrasReducer",["LOCK_FARE_ACTION_TYPES","PAYMENT_ACTION_TYPES","SAMSONITE_ACTION_TYPES",function(e,r,t){return function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments[1];switch(s.type){case e.ADD_TO_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},a,{extras:[]});case r.TOGGLE_ISPCC_SUCCESS:case r.TOGGLE_CO_SUCCESS:case r.TOGGLE_SMS_SUCCESS:return babelHelpers["extends"]({},a,{extras:s.payload});case t.POST_SAMSONITE_SUCCESS:return babelHelpers["extends"]({},a,{extras:R.pipe(R.filter(function(e){return s.payload.codesToRemove.indexOf(e.model.code)<0}),R.concat(s.payload.extras))(a.extras)});case t.REMOVE_SAMSONITE_SUCCESS:return babelHelpers["extends"]({},a,{extras:a.extras.filter(function(e){return s.payload.codesToRemove.indexOf(e.model.code)<0})});default:return a}}}]);


"use strict";angular.module("app.booking").factory("SsrsReducer",["EQUIPMENT_ACTION_TYPES","FAST_TRACK_ACTION_TYPES","BAGS_ACTION_TYPES","ModelQuery","BookingWrite","BOOKING_MODEL_ACTION_TYPES","FARE_UPGRADE_ACTION_TYPES","PRIORITY_BOARDING_ACTIONS_TYPES","LOCK_FARE_ACTION_TYPES","BREAKFAST_ACTION_TYPES","CABINBAG_ACTION_TYPES","INFLIGHT_PRODUCTS_ACTION_TYPES","CARD_CODES",function(e,s,r,n,t,o,l,_,a,c,E,p,d){var S=function(e,s,r){return R.pipe(n.byModel(e),n.byKey(s),n.byLocal(!0),n.complement(r))(r)},u=function(e){return R.pipe(n.byModel({isPartOfBundle:!0}),n.complement(e),R.filter(function(e){return"SURE"!==e.model.code&&"BUND"!==e.model.code&&"FAMI"!==e.model.code}))(e)};return function(){var O=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},A=arguments[1],b=A.type,C=A.payload;switch(b){case e.ADD_TO_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},O,{ssrs:O.ssrs.filter(function(e){return e.model.type!==C.equipmentType}).concat(C.items)});case o.RESET_SARA_VALIDATION:return babelHelpers["extends"]({},O,{ssrs:R.pipe(R.filter(function(e){return~["BAPV","BAFV"].indexOf(e.code)}),n.complement(O.ssrs))(O.ssrs)});case s.ADD_REST_FAST_TRACKS:return babelHelpers["extends"]({},O,{ssrs:t.add(C.items,S({code:"FAST",sold:!1},{journeys:C.journeyNum},O.ssrs))});case s.ADD_TO_BOOKING_MODEL_SUCCESS:case s.REMOVE_FROM_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},O,{ssrs:R.pipe(n.byModel({code:"FAST",sold:!1}),n.complement(O.ssrs),R.concat(C))(O.ssrs)});case _.ADD_ALL_SUCCESS:return babelHelpers["extends"]({},O,{ssrs:R.pipe(n.byModel({type:"PRIOBRDNG",sold:!1}),n.complement(O.ssrs),R.concat(C.priority))(O.ssrs)});case _.REMOVE_ALL_SUCCESS:return babelHelpers["extends"]({},O,{ssrs:n.complement(O.ssrs)(n.byModel({type:"PRIOBRDNG",sold:!1})(O.ssrs))});case a.ADD_TO_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},O,{ssrs:C.ssrs});case r.REMOVE_ALL_BAG_BY_CODE_SUCCESS:case r.QUICK_ADD_SUCCESS:case r.UPDATE_TO_BOOKING_MODEL_SUCCESS:case r.REMOVE_ALL_BAG_UPGRADE_BY_CODE_SUCCESS:return babelHelpers["extends"]({},O,{ssrs:R.pipe(R.converge(R.concat,[n.byModel({type:"BAGS"}),n.byModel({type:"BAGUPGRADES"})]),R.filter(function(e){return R.contains(e.key.passengers,C.paxesToUpdate)}),n.complement(O.ssrs),R.concat(C.ssrs),R.reduce(n.inflateQuantities,[]))(O.ssrs)});case r.REMOVE_ALL_BAG_BY_TYPE_SUCCESS:var i=R.pipe(n.byModel({code:C,sold:!1}))(O.ssrs);return babelHelpers["extends"]({},O,{ssrs:t.remove(i,O.ssrs)});case c.POST_TO_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},O,{ssrs:R.pipe(n.byModel({code:"BREK"}),n.complement(O.ssrs),R.concat(C))(O.ssrs)});case c.REMOVE_ALL_FROM_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},O,{ssrs:R.pipe(n.byModel({code:"BREK",sold:!1}),n.complement(O.ssrs))(O.ssrs)});case E.ADD_SELECTED_CABIN_BAGS:var y=n.byModel({code:"CBAG"})(O.ssrs),m=C.filter(function(e){return R.none(function(s){return R.equals(s.key,e.key)})(y)}),D=y.filter(function(e){return C.find(function(s){return R.equals(s.key,e.key)&&e.removed})});return babelHelpers["extends"]({},O,{ssrs:t.add([].concat(babelHelpers.toConsumableArray(m),babelHelpers.toConsumableArray(D)),O.ssrs)});case E.REMOVE_SELECTED_CABIN_BAGS:var M=R.pipe(n.byModel({code:"CBAG",sold:!1}),n.byKey({journeys:C.journeyNum,passengers:C.paxNum}),n.byLocal(!1),n.byRemoved(!1))(O.ssrs);if(M.length)return babelHelpers["extends"]({},O,{ssrs:t.remove(M,O.ssrs)});var T=R.pipe(n.byModel({code:"CBAG",sold:!1}),n.byKey({journeys:C.journeyNum,passengers:C.paxNum}),n.byLocal(!0))(O.ssrs);return babelHelpers["extends"]({},O,{ssrs:O.ssrs.filter(function(e){return!T.some(function(s){return e.uuid===s.uuid})})});case E.REMOVE_CABIN_BAGS_FOR_SELECTED_PAX:var B=function(e){return R.contains(R.path(["key"],e))(C)};return babelHelpers["extends"]({},O,{ssrs:R.pipe(n.byModel({code:"CBAG",sold:!1}),R.filter(B),n.complement(O.ssrs))(O.ssrs)});case E.REMOVE_ALL:var G=R.pipe(n.byModel({code:"CBAG",sold:!1}),n.byLocal(!0))(O.ssrs);return babelHelpers["extends"]({},O,{ssrs:t.remove(G,O.ssrs)});case E.REMOVE_FROM_BOOKING_MODEL_SUCCESS:if(C)return babelHelpers["extends"]({},O,{ssrs:R.pipe(n.byModel({type:d.CBAG}),n.complement(O.ssrs),R.concat(C.ssrs))(O.ssrs)});var I=R.pipe(n.byModel({code:"CBAG",sold:!1}))(O.ssrs);return babelHelpers["extends"]({},O,{ssrs:t.remove(I,O.ssrs)});case E.ADD_TO_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},O,{ssrs:R.pipe(n.byModel({code:"CBAG"}),n.complement(O.ssrs),R.concat(C.ssrs))(O.ssrs)});case p.ADD_TO_BOOKING_MODEL_SUCCESS:case p.REMOVE_FROM_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},O,{ssrs:R.pipe(n.byModel({type:d.INFLIGHT}),n.complement(O.ssrs),R.concat(C))(O.ssrs)});case l.FARE_UPGRADE_ADD_SUCCESS:var N=R.reduce(n.inflateQuantities,[])(C.ssrs);return babelHelpers["extends"]({},O,{ssrs:N,seats:C.seats});case l.FARE_UPGRADE_REMOVE_SUCCESS:return babelHelpers["extends"]({},O,{ssrs:u(O.ssrs),seats:C.seats});default:return O}}}]);


"use strict";angular.module("app.booking").factory("CarhireReducer",["CARHIRE_ACTION_TYPES",function(e){var r={isAddingToBookingModel:!1,isAddingToBookingModelError:!1,isRemovingFromBookingModel:!1,isRemovingFromBookingModelError:!1,isCarTrawlerReady:!1,model:{}};return function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,n=arguments[1];switch(n.type){case e.INIT_CAR_SEARCH:return babelHelpers["extends"]({},o,{model:n.payload.model});case e.CAR_TRAWLER_READY:return babelHelpers["extends"]({},o,{isCarTrawlerReady:!0});case e.ADD_TO_BOOKING_MODEL_START:return babelHelpers["extends"]({},o,{isAddingToBookingModel:!0});case e.ADD_TO_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},o,{isAddingToBookingModel:!1});case e.ADD_TO_BOOKING_MODEL_FAILED:return babelHelpers["extends"]({},o,{isAddingToBookingModel:!1,isAddingToBookingModelError:!0});case e.REMOVE_FROM_BOOKING_MODEL_START:return babelHelpers["extends"]({},o,{isRemovingFromBookingModel:!0});case e.REMOVE_FROM_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},o,{isRemovingFromBookingModel:!1});case e.REMOVE_FROM_BOOKING_MODEL_FAILED:return babelHelpers["extends"]({},o,{isRemovingFromBookingModel:!1,isRemovingFromBookingModelError:!0});case e.REMOVE_FROM_BASKET:return babelHelpers["extends"]({},o);case e.OPEN_MODAL:return r;case e.CLOSE_MODAL:return r;default:return o}}}]);


"use strict";angular.module("app.booking").factory("ChangeFlightReducer",["CHANGE_FLIGHT_ACTION_TYPES",function(e){var t={changed:!1,messages:[],warnings:[],errors:[],showAutoCorrectDateWarning:!1,hideFooter:!1,selectedPaxMap:{},paymentNotRequired:!1,isFreeMove:!1,flightModel:{departure:{},destination:{},startDate:0,endDate:0,type:"one-way",ChangeFlight:"Outbound",flightInKey:"",discounts:[],passengers:[]},hasErrorsOnSelectedFares:!1,selectedFlights:[],availableFlights:[],originalFlightModel:{},originalFlightData:{}};return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,l=arguments[1],s=l.type,a=l.payload;switch(s){case e.SET_CHANGE_FLIGHT_STATUS:return babelHelpers["extends"]({},r,{changed:a});case e.SET_CHANGE_FLIGHT_MESSAGES:return babelHelpers["extends"]({},r,{messages:a});case e.ADD_CHANGE_FLIGHT_MESSAGE:return babelHelpers["extends"]({},r,{messages:[].concat(babelHelpers.toConsumableArray(r.messages),[a])});case e.SET_CHANGE_FLIGHT_WARNINGS:return babelHelpers["extends"]({},r,{warnings:a});case e.SET_CHANGE_FLIGHT_ERRORS:return babelHelpers["extends"]({},r,{errors:a});case e.SET_SHOW_AUTO_CORRECT_DATE_WARNING:return babelHelpers["extends"]({},r,{showAutoCorrectDateWarning:a});case e.SET_HIDE_FOOTER:return babelHelpers["extends"]({},r,{hideFooter:a});case e.SET_CHANGE_FLIGHT_SELECTED_PAX_MAP:return babelHelpers["extends"]({},r,{selectedPaxMap:a});case e.SET_CHANGE_FLIGHT_PAYMENT_NOT_REQUIRED:return babelHelpers["extends"]({},r,{paymentNotRequired:a});case e.SET_CHANGE_FLIGHT_IS_FREE_MOVE:return babelHelpers["extends"]({},r,{isFreeMove:a});case e.SET_CHANGE_FLIGHT_MODEL_DESTINATION:return babelHelpers["extends"]({},r,{flightModel:babelHelpers["extends"]({},r.flightModel,{destination:a})});case e.SET_CHANGE_FLIGHT_MODEL_DEPARTURE:return babelHelpers["extends"]({},r,{flightModel:babelHelpers["extends"]({},r.flightModel,{departure:a})});case e.SET_CHANGE_FLIGHT_MODEL_START_DATE:return babelHelpers["extends"]({},r,{flightModel:babelHelpers["extends"]({},r.flightModel,{startDate:a})});case e.SET_CHANGE_FLIGHT_MODEL_END_DATE:return babelHelpers["extends"]({},r,{flightModel:babelHelpers["extends"]({},r.flightModel,{endDate:a})});case e.SET_CHANGE_FLIGHT_MODEL_TYPE:return babelHelpers["extends"]({},r,{flightModel:babelHelpers["extends"]({},r.flightModel,{type:a})});case e.SET_CHANGE_FLIGHT_MODEL_TRIP_TYPE:return babelHelpers["extends"]({},r,{flightModel:babelHelpers["extends"]({},r.flightModel,{ChangeFlight:a})});case e.SET_CHANGE_FLIGHT_MODEL:return babelHelpers["extends"]({},r,{flightModel:babelHelpers["extends"]({},a,{ChangeFlight:a.ChangeFlight||r.flightModel.ChangeFlight})});case e.SET_CHANGE_FLIGHT_ORIGINAL_FLIGHT_MODEL:return babelHelpers["extends"]({},r,{originalFlightModel:a});case e.RESET_CHANGE_FLIGHT:return t;case e.SET_SELECTED_FLIGHTS:var n=r.availableFlights,_=[].concat(babelHelpers.toConsumableArray(r.selectedFlights));return _.length||(_=Array.from({length:n.length},function(){return!1})),_[a.index]=a.value,babelHelpers["extends"]({},r,{selectedFlights:_});case e.SET_AVAILABLE_FLIGHTS_SUCCESS:return babelHelpers["extends"]({},r,{availableFlights:a});case e.HAS_ERRORS_ON_SELECTED_FARES:return babelHelpers["extends"]({},r,{hasErrorsOnSelectedFares:a});case e.SET_CHANGE_FLIGHT_ORIGINAL_FLIGHT_DATA:return babelHelpers["extends"]({},r,{originalFlightData:a});case e.SET_CHANGE_FLIGHT_ORIGINAL_TO_ORIGINAL:return babelHelpers["extends"]({},r,{flightModel:babelHelpers["extends"]({},r.flightModel,{departure:a.departure,destination:a.destination,startDate:a.startDate,endDate:a.endDate})});default:return r}}}]);


"use strict";angular.module("app.booking").factory("CarRentalReducer",["CAR_RENTAL_ACTION_TYPES",function(e){var a={isCarRentalReady:!1,model:{},token:""};return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments[1];switch(t.type){case e.INIT_CAR_SEARCH:return babelHelpers["extends"]({},r,{model:t.payload.model});case e.CAR_RENTAL_READY:return babelHelpers["extends"]({},r,{isCarRentalReady:!0});case e.FETCH_BOOKING_TOKEN:return babelHelpers["extends"]({},r,{token:t.payload});case e.FETCH_BOOKING_TOKEN_ERROR:return babelHelpers["extends"]({},r,{token:t.payload});default:return r}}}]);


"use strict";angular.module("app.booking").factory("FareUpgradeReducer",["FARE_UPGRADE_ACTION_TYPES",function(e){var t={type:void 0,extras:void 0};return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,a=arguments[1],E=a.type,n=a.payload;switch(E){case e.SET_ELIGIBLE_FARE_TYPE_FOR_UPGRADE:return babelHelpers["extends"]({},r,{type:n.type});case e.FETCH_UPGRADE_PRICES_SUCCESS:return{type:R.isEmpty(n)?t.type:r.type,extras:n};case e.RESET:case e.FETCH_UPGRADE_PRICES_ERROR:return t;default:return r}}}]);


"use strict";angular.module("app.booking").factory("GroundTransfersReducer",["GROUND_TRANSFERS_ACTION_TYPES",function(e){var r={isLoading:!1};return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,s=arguments[1];switch(s.type){case e.ADD_TO_BOOKING_MODEL_START:return babelHelpers["extends"]({isLoading:!0},n);case e.ADD_TO_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({isLoading:!1},n);case e.ADD_TO_BOOKING_MODEL_FAILED:return babelHelpers["extends"]({isLoading:!1},n);case e.REMOVE_FROM_BOOKING_MODEL_START:return babelHelpers["extends"]({isLoading:!0},n);case e.REMOVE_FROM_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({isLoading:!1},n);case e.REMOVE_FROM_BOOKING_MODEL_FAILED:return babelHelpers["extends"]({isLoading:!1},n);default:return n}}}]);


"use strict";angular.module("app.booking").factory("InflightProductsReducer",["INFLIGHT_PRODUCTS_ACTION_TYPES",function(e){var r={isLoading:!1,items:[],checkinProductCard:[],offers:[]};return function(){var s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,a=arguments[1],E=a.type,_=a.payload;switch(E){case e.ADD_SELECTED:case e.REMOVE_SELECTED:case e.UPDATE_SELECTED:var t=_.items;return babelHelpers["extends"]({},s,{items:t});case e.SET_CHECKIN_PRODUCT_CARD_SUCCESS:var c=_.checkinProductCard,n=_.items;return babelHelpers["extends"]({},s,{items:n,checkinProductCard:c});case e.UPDATE_CHECKIN_PRODUCT_CARD:var O=_.checkinProductCard;return babelHelpers["extends"]({},s,{checkinProductCard:O});case e.GET_OFFERS_START:case e.ADD_TO_BOOKING_MODEL_START:case e.REMOVE_FROM_BOOKING_MODEL_START:return babelHelpers["extends"]({},s,{isLoading:!0});case e.GET_OFFERS_SUCCESS:return babelHelpers["extends"]({},s,{isLoading:!1,offers:_.offers});case e.GET_OFFERS_FAILED:case e.ADD_TO_BOOKING_MODEL_FAILED:case e.ADD_TO_BOOKING_MODEL_SUCCESS:case e.REMOVE_FROM_BOOKING_MODEL_SUCCESS:case e.REMOVE_FROM_BOOKING_MODEL_FAILED:return babelHelpers["extends"]({},s,{isLoading:!1});case e.RESET:return r;default:return s}}}]);


"use strict";angular.module("app.booking").factory("ParkingReducer",["PARKING_ACTION_TYPES",function(e){var r={isLoadingOffers:!1,isLoadingOffersError:!1,hasLoadedOffers:!1,isAddingToBookingModel:!1,isAddingToBookingModelError:!1,isRemovingFromBookingModel:!1,isRemovingFromBookingModelError:!1,bannerPrice:0,totalPrice:0,providers:[],selectedProvider:{},parkings:[],selectedOffer:null,total:0},o=function(e){return e.providers.map(function(e){var r=e.offers.sort(function(e,r){return e.price-r.price}).map(function(r,o){var n=e.offers.length>1&&e.offers.length-1===o;return babelHelpers["extends"]({},r,{recommended:n})});return babelHelpers["extends"]({},e,{offers:r,selectedOffer:r[0]})})},n=function(e){return R.pipe(R.map(function(e){return R.map(function(r){return babelHelpers["extends"]({},r,{provider:e.code,showMoreInfo:!1})})(e.offers)}),R.flatten(),R.sortBy(R.prop("pricePerDay")))(e.providers)},s=function(e){var r=void 0;return e.providers.forEach(function(e){var o=Math.min.apply(Math,babelHelpers.toConsumableArray(e.offers.map(function(e){return e.price})));r=o>r?r:o}),r};return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,a=arguments[1];switch(a.type){case e.FETCH_OFFERS_START:return babelHelpers["extends"]({},t,{isLoadingOffers:!0});case e.FETCH_OFFERS_SUCCESS:var i=o(a.payload),d=n(a.payload).map(function(e,r,o){var n=o.length>1&&o.length-1===r;return babelHelpers["extends"]({},e,{recommended:n})}),l=1===R.pathOr(0,["length"],i)?R.path([0],i):null,f=t.selectedOffer&&R.any(function(e){return t.selectedOffer.key===e.key})(d)?R.find(function(e){return t.selectedOffer.key===e.key})(d):null;return babelHelpers["extends"]({},t,{isLoadingOffers:!1,hasLoadedOffers:!0,providers:i,bannerPrice:s(a.payload),selectedProvider:l,totalPrice:R.pathOr(0,["selectedOffer","price"],l),parkings:d,selectedOffer:f,total:f?f.price:0});case e.FETCH_OFFERS_FAILED:return babelHelpers["extends"]({},t,{isLoadingOffers:!1,hasLoadedOffers:!0,isLoadingOffersError:!0});case e.ADD_TO_BOOKING_MODEL_START:return babelHelpers["extends"]({},t,{isAddingToBookingModel:!0,isAddingToBookingModelError:!1});case e.ADD_TO_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},t,{isAddingToBookingModel:!1});case e.ADD_TO_BOOKING_MODEL_FAILED:return babelHelpers["extends"]({},t,{isAddingToBookingModel:!1,isAddingToBookingModelError:!0});case e.REMOVE_FROM_BOOKING_MODEL_START:return babelHelpers["extends"]({},t,{isRemovingFromBookingModel:!0,isAddingToBookingModelError:!1});case e.REMOVE_FROM_BOOKING_MODEL_SUCCESS:return babelHelpers["extends"]({},t,{isRemovingFromBookingModel:!1});case e.REMOVE_FROM_BOOKING_MODEL_FAILED:return babelHelpers["extends"]({},t,{isRemovingFromBookingModel:!1,isRemovingFromBookingModelError:!0});case e.ADD_SELECTED_OFFERS:return babelHelpers["extends"]({},t,{selectedProvider:a.payload,totalPrice:a.payload.selectedOffer.price});case e.SET_SELECTED_OFFER:return babelHelpers["extends"]({},t,{selectedOffer:a.payload,total:a.payload.price});case e.REMOVE_SELECTED_OFFER:return babelHelpers["extends"]({},t,{selectedOffer:null,total:0,isAddingToBookingModelError:!1});case e.OPEN_MODAL:case e.CLOSE_MODAL:case e.CLEAR_ALL:return r;default:return t}}}]);


"use strict";angular.module("app.booking").factory("RefundReducer",["REFUND_ACTION_TYPES",function(e){var n={isLoadingRefundable:!1,isLoadingRefundableError:!1,isLoadingBreakdownItems:!1,isLoadingBreakdownItemsError:!1,isLoadingRefund:!1,isLoadingRefundError:!1,isChildAloneWarn:!1,journeys:[],selectedJourneys:[],passengers:[],selectedPassengers:[],cta:{confirm:null,back:null,confirmEnabled:!0,backEnabled:!0,reset:function(){this.confirm=null,this.back=null,this.confirmEnabled=!0,this.backEnabled=!0}},refundableJourneys:[],totalRefund:0,itemBreakdown:[]},r={partialRefundNotAllowed:"PartialRefundNotAllowed",paymentMethodNotAllowed:"PaymentMethodNotAllowed",passengerNotFlown:"PassengerNotFlown",refundNotAllowed:"RefundNotAllowed",componentsRefundNotAllowed:"ComponentsRefundNotAllowed",passengerHaveFlown:"PassengerHaveFlown"},s=function(e,n){return e.some(function(e){return e.journeyNum===n.journeyNum})},a=function(e,n){var a=function(e){return n.some(function(n){return n.journeyNum===e.journeyNum&&n.refundable})||R.pathOr([],["reason"],n[e.journeyNum]).some(function(e){return e===r.passengerNotFlown})};return e.journeys.map(function(n){return babelHelpers["extends"]({},n,{isRefundable:a(n),isSelected:s(e.selectedJourneys,n)})})},o=function(e,n){var r=s(e.selectedJourneys,n),a=R.pipe(r?R.filter(function(e){return e.journeyNum!==n.journeyNum}):R.pipe(R.append(babelHelpers["extends"]({},n,{isSelected:!0})),R.sortBy(R.prop("depart"))));return R.pipe(R.pathOr([],["selectedJourneys"]),a)(e)},t=function(e,n){return e.journeys.map(function(e){return babelHelpers["extends"]({},e,{isSelected:s(n,e)})})},l=R.anyPass([R.propEq("type","CHD"),R.propEq("type","TEEN")]),d=function(e,n){var r=R.pipe(R.difference(e),R.ifElse(R.isEmpty,R.F,R.none(R.propEq("type","ADT"))))(n),s=r?R.pipe(R.filter(l),R.flip(R.difference)(n),R.concat(n))(e):[].concat(babelHelpers.toConsumableArray(n)),a=s.length===e.length?R.filter(l,e):[];return{selectedPassengers:s,lockedPassengers:a}},u=function(e,n){var r=d(n.passengers,e),s=r.selectedPassengers,a=r.lockedPassengers;return babelHelpers["extends"]({},n,{selectedPassengers:s,lockedPassengers:a,isChildAloneWarn:a.length})};return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,s=arguments[1];switch(s.type){case e.INIT_REFUND:return babelHelpers["extends"]({},r,{journeys:s.payload.journeys,selectedJourneys:s.payload.selectedJourneys,passengers:s.payload.passengers,selectedPassengers:s.payload.selectedPassengers,lockedPassengers:[],isChildAloneWarn:!1});case e.SELECT_PAX:var l=[].concat(babelHelpers.toConsumableArray(r.selectedPassengers),[s.payload]);return u(l,r);case e.DESELECT_PAX:var d=r.selectedPassengers.filter(function(e){return e!==s.payload});return u(d,r);case e.FETCH_REFUNDABLE_START:return babelHelpers["extends"]({},r,{isLoadingRefundable:!0});case e.FETCH_REFUNDABLE_SUCCESS:var i=a(r,s.payload.refundableJourneys),c=R.filter(function(e){return e.isCancelled})(i);return babelHelpers["extends"]({},r,{isLoadingRefundable:!1,refundableJourneys:s.payload.refundableJourneys,selectedJourneys:c,journeys:i});case e.FETCH_REFUNDABLE_FAILED:return babelHelpers["extends"]({},r,{isLoadingRefundable:!1,isLoadingRefundableError:!0});case e.TOGGLE_SELECTED_FLIGHT:var p=o(r,s.payload),f=t(r,p);return babelHelpers["extends"]({},r,{journeys:f,selectedJourneys:p});case e.FETCH_BREAKDOWN_ITEM_START:return babelHelpers["extends"]({},r,{isLoadingBreakdownItems:!0});case e.FETCH_BREAKDOWN_ITEM_SUCCESS:return babelHelpers["extends"]({},r,{isLoadingBreakdownItems:!1,totalRefund:s.payload.totalRefund,itemBreakdown:s.payload.itemBreakdown,paymentBreakdown:s.payload.paymentBreakdown});case e.FETCH_BREAKDOWN_ITEM_FAILED:return babelHelpers["extends"]({},r,{isLoadingBreakdownItems:!1,isLoadingBreakdownItemsError:!0});case e.REFUND_START:return babelHelpers["extends"]({},r,{isLoadingRefund:!0});case e.REFUND_SUCCESS:return babelHelpers["extends"]({},r,{isLoadingRefund:!1,dividedBooking:s.payload.dividedBooking});case e.REFUND_FAILED:return babelHelpers["extends"]({},r,{isLoadingRefund:!1,isLoadingRefundError:!0});case e.RESET_REFUND_ERRORS:return babelHelpers["extends"]({},r,{isLoadingRefundError:!1,isLoadingRefundableError:!1,isLoadingBreakdownItemsError:!1});case e.SET_CTA:var E=r.cta;return E[s.payload.name]=s.payload.fn,babelHelpers["extends"]({},r,{cta:E});default:return r}}}]);


"use strict";angular.module("app.booking").factory("SeatsReducer",["SEATS_ACTION_TYPES",function(e){var a={isLoading:!1,availability:[],message:{},seatsError:{},isClosable:!0,isLoadingQuickAdd:!1,isLoadingSuggestedSeatsAdd:!1,isPriorityPopupIgnored:!1,drawerCloseError:"",steps:[],currentStep:"",moneySavedOnChildSeats:0,aircraftMap:[],aircraftMaps:{loading:!0},aircraftMapLoading:!1,numberOfSeatsOnAircraft:0,changeSeatsMode:!1,changeSeatsEngagedFromCheckin:!1,designatorSelectedForChange:"",changedSeatsConfirmed:!1,changedSeatsAddedPriority:!1,seatsChanged:0,changeSeatsInfoPromptSeen:!1,childSeatPromptSeen:!1,mandatorySeatsPromptSeen:!1};return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,s=arguments[1];switch(s.type){case e.RESET:return babelHelpers["extends"]({},a);case e.FETCH_SEATS_START:return babelHelpers["extends"]({},r,{isLoading:!0});case e.FETCH_SEATS_SUCCESS:return babelHelpers["extends"]({},r,{isLoading:!1,availability:s.payload.seats});case e.FETCH_SEATS_ERROR:return babelHelpers["extends"]({},r,{isLoading:!1,availability:[],seatsError:s.data});case e.SET_DRAWER_TO_CLOSEABLE:return babelHelpers["extends"]({},r,{isClosable:!0});case e.SET_DRAWER_TO_UNCLOSEABLE:return babelHelpers["extends"]({},r,{isClosable:!1});case e.QUICK_ADD_START:return babelHelpers["extends"]({},r,{isLoadingQuickAdd:!0});case e.QUICK_ADD_SUCCESS:return babelHelpers["extends"]({},r,{isLoadingQuickAdd:!1});case e.QUICK_ADD_ERROR:return babelHelpers["extends"]({},r,{isLoadingQuickAdd:!1});case e.ADD_SUGGESTED_SEATS_START:return babelHelpers["extends"]({},r,{isLoadingSuggestedSeatsAdd:!0});case e.ADD_SUGGESTED_SEATS_SUCCESS:case e.ADD_SUGGESTED_SEATS_ERROR:return babelHelpers["extends"]({},r,{isLoadingSuggestedSeatsAdd:!1});case e.IGNORE_PRIORITY_POPUP:return babelHelpers["extends"]({},r,{isPriorityPopupIgnored:!0});case e.NOTICE_PRIORITY_POPUP:return babelHelpers["extends"]({},r,{isPriorityPopupIgnored:!1});case e.DRAWER_CLOSE_ERROR:return babelHelpers["extends"]({},r,{drawerCloseError:s.payload.error});case e.SET_STEPS:return babelHelpers["extends"]({},r,{steps:s.payload.steps});case e.SET_STEP:return babelHelpers["extends"]({},r,{currentStep:s.payload.step});case e.SET_MONEY_SAVED_ON_CHILD_SEATS:return babelHelpers["extends"]({},r,{moneySavedOnChildSeats:s.payload.moneySavedOnChildSeats});case e.GET_AIRCRAFT_MAP_START:return babelHelpers["extends"]({},r,{aircraftMap:[],aircraftMapLoading:!0,numberOfSeatsOnAircraft:0,aircraftMaps:babelHelpers["extends"]({},r.aircraftMaps,{loading:!0})});case e.GET_AIRCRAFT_MAP_SUCCESS:var t=R.pipe(R.prop("designator"),R.equals("AISLE")),n=R.pipe(R.flatten,R.reject(R.isNil),R.reject(t),R.length),d=R.pipe(R.map(function(e){return babelHelpers.defineProperty({},e.equipmentModel,{seatRows:e.seatRows,numberOfSeatsOnAircraft:n(R.propOr([],"seatRows",e))})}),R.mergeAll)(s.payload);return babelHelpers["extends"]({},r,{aircraftMaps:babelHelpers["extends"]({loading:!1,multipleMaps:s.payload.length>1},d)});case e.GET_AIRCRAFT_MAP_ERROR:return babelHelpers["extends"]({},r,{aircraftMap:[],aircraftMapLoading:!1,numberOfSeatsOnAircraft:0});case e.RESET_AIRCRAFT_SEAT_MAP:return babelHelpers["extends"]({},r,{aircraftMap:[]});case e.SET_CHANGE_SEATS_MODE:return babelHelpers["extends"]({},r,{changeSeatsMode:s.payload});case e.SET_CHANGE_SEATS_ENGAGED_FROM_CHECKIN:return babelHelpers["extends"]({},r,{changeSeatsEngagedFromCheckin:s.payload});case e.SET_SEAT_SELECTED_FOR_CHANGE:return babelHelpers["extends"]({},r,{designatorSelectedForChange:s.payload});case e.CHANGE_SEATS_CHANGE_CONFIRMED:return babelHelpers["extends"]({},r,{changedSeatsConfirmed:s.payload});case e.CHANGED_SEAT_ADDED_PRIORITY_SUCCESS:return babelHelpers["extends"]({},r,{changedSeatsAddedPriority:!0});case e.CHANGED_SEAT_RESET_PRIORITY_SUCCESS:return babelHelpers["extends"]({},r,{changedSeatsAddedPriority:!1});case e.RESET_CHANGE_SEAT_STATE:return babelHelpers["extends"]({},r,{changeSeatsMode:!1,changeSeatsEngagedFromCheckin:!1,designatorSelectedForChange:"",changedSeatsConfirmed:!1,changedSeatsAddedPriority:!1});case e.SEATS_CHANGED:return babelHelpers["extends"]({},r,{seatsChanged:s.seatsChanged});case e.SET_CHANGE_SEATS_INFO_PROMPT:return babelHelpers["extends"]({},r,{changeSeatsInfoPromptSeen:s.payload});case e.CHANGE_CHILD_SEAT_PROMPT:return babelHelpers["extends"]({},r,{childSeatPromptSeen:s.payload});case e.SET_MANDATORY_SEATS_PROMPT_SEEN_STATE:return babelHelpers["extends"]({},r,{mandatorySeatsPromptSeen:s.payload});default:return r}}}]);


"use strict";angular.module("app.booking").factory("SpecialAssistanceReducer",["SPECIAL_ASSISTANCE_ACTION_TYPES","ModelQuery",function(e,a){var s={SARequired:[],prms:[],assistanceAvailability:[],areAllFlightsDepartureDatesNear:!1};return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,n=arguments[1];switch(n.type){case e.SET_SPECIAL_ASSISTANCE_STORE_VALUES:return babelHelpers["extends"]({},r,{SARequired:n.payload.SARequired,prms:n.payload.prms,assistanceAvailability:n.payload.assistanceAvailability,areAllFlightsDepartureDatesNear:n.payload.areAllFlightsDepartureDatesNear});case e.TOGGLE_SA_REQUIRED_VALUE:var l=r.SARequired.map(function(e){return e.key.passengers===n.payload.pax?babelHelpers["extends"]({},e,{model:!e.model}):e}),t=r.prms;return R.pipe(a.byKey({passengers:n.payload.pax}),R.path([0,"model"]),R.not)(l)&&(t=r.prms.map(function(e){return e.key.passengers===n.payload.pax?babelHelpers["extends"]({},e,{model:{assistanceType:{code:""},wheelchairSelector:{wheelchairType:{code:""},assistanceType:{code:""}},wheelchairRequired:!1}}):e})),babelHelpers["extends"]({},r,{SARequired:l,prms:t});case e.SELECT_SPECIAL_ASSISTANCE:var i=r.prms.map(function(e){var a=n.payload.find(function(a){return e.key.passengers===a.pax&&e.key.journeys===a.flight&&e.key.segments===a.segment});if(a){var s=angular.copy(e);return s.model.assistanceType=a.assistance,s.model.wheelchairSelector.assistanceType={code:""},s.model.wheelchairRequired=R.pathEq(["model","assistanceType","code"],"NORQ",s)?!1:s.model.wheelchairRequired,s}return e});return babelHelpers["extends"]({},r,{prms:i});case e.SELECT_WHEELCHAIR:var p=r.prms.map(function(e){var a=n.payload.find(function(a){return e.key.passengers===a.pax&&e.key.journeys===a.flight&&e.key.segments===a.segment});if(a){var s=angular.copy(e);return a.wheelchairType&&(s.model.wheelchairSelector.wheelchairType=a.wheelchairType),a.assistanceType&&(s.model.wheelchairSelector.assistanceType=a.assistanceType),s.model.wheelchairRequired=a.isRequired,s}return e});return babelHelpers["extends"]({},r,{prms:p});case e.SET_ASSISTANCE_AVAILABILITY_CODES:var c=function(e){return e.nestCode===n.payload.assistanceCode?babelHelpers["extends"]({},e,{availabilityCode:n.payload.code,isUnavailable:n.payload.isUnavailable}):e},o=r.assistanceAvailability.map(function(e){if(n.payload.filteredAssistances.some(function(a){return a.key.passengers===e.key.passengers})&&n.payload.filteredAssistances.some(function(a){return a.key.journeys===e.key.journeys})){var a=angular.copy(e);return a.model.assistance=e.model.assistance.map(c),a.model.assistance=a.model.assistance.map(function(e){return e.childPrms.length>0?babelHelpers["extends"]({},e,{childPrms:e.childPrms.map(c)}):e}),a.model.wheelchair=e.model.wheelchair.map(c),a}return e}),d={model:{assistanceType:c,wheelchairSelector:{assistanceType:c,wheelchairType:c}}},u=r.prms.map(function(e){var s=R.pipe(a.byKey({journeys:e.key.journeys,passengers:e.key.passengers}),a.hasAny)(n.payload.filteredAssistances);return s?R.evolve(d,e):e});return babelHelpers["extends"]({},r,{assistanceAvailability:o,prms:u});default:return r}}}]);


"use strict";angular.module("app.booking").factory("VoucherReducer",["VOUCHER_ACTION_TYPES",function(e){var r={hasSession:!1,isLoading:!1,redeemError:{}};return function(){var s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,a=arguments[1],E=a.type,n=a.payload;switch(E){case e.RESET:return r;case e.SELECT_VOUCHER_START:return babelHelpers["extends"]({},s,{hasSession:!1,isLoading:!0});case e.SELECT_VOUCHER_ERROR:return babelHelpers["extends"]({},s,{hasSession:!1,isLoading:!1});case e.SELECT_VOUCHER_SUCCESS:return babelHelpers["extends"]({},s,{hasSession:!0,isLoading:!1});case e.REDEEM_VOUCHER_START:case e.USE_REWARD_VOUCHER_START:return babelHelpers["extends"]({},s,{redeemError:{}});case e.REDEEM_VOUCHER_ERROR:case e.USE_REWARD_VOUCHER_ERROR:return babelHelpers["extends"]({},s,{redeemError:n});default:return s}}}]);


"use strict";angular.module("app.booking").service("RAIframeActions",["RA_IFRAME_ACTION_TYPES",function(n){return{saveAddon:function(t,a){return{type:n.SAVE_ADDON,payload:{id:t,addon:a}}},updateParams:function(t){return{type:n.UPDATE_PARAMS,payload:t}},startLoading:function(t){return{type:n.START_LOAD,payload:{id:t}}},endLoading:function(t){return{type:n.END_LOAD,payload:{id:t}}},drawerError:function(t){return{type:n.DRAWER_ERROR,payload:{id:t}}},initIframe:function(t){return{type:n.INIT_IFRAME,payload:t}}}}]);


"use strict";angular.module("app.booking").directive("raIframeWrapper",function(){return{restrict:"A",scope:!1,controllerAs:"raiw",bindToController:!0,controller:["$attrs","$scope","$ngRedux","RAIframeService","$timeout",function(r,e,t,a,n){var i=this,o=a.get(r.raIframeWrapperFor);this.isHovered=!1,this.isLoading=!0;var u=void 0;this.isOn=o.isIframeOn(r.raIframeWrapperFeatureFlag,t.getState().bookingModel),this.startTimeout=function(r){u=n(function(){i.turnOff()},r,!1)},this.turnOff=function(){n.cancel(u),e.$applyAsync(function(){i.isOn=!1,(o.onIframeTurnedOff||angular.noop)(r.raIframeWrapperFeatureFlag)})},this.loaded=function(){n.cancel(u),e.$applyAsync(function(){i.isLoading=!1})}}],link:function(r,e,t,a){t.raIframeWrapperTimeout&&a.startTimeout(t.raIframeWrapperTimeout)}}});


"use strict";angular.module("app.booking").factory("RAIframeReducer",["RA_IFRAME_ACTION_TYPES",function(e){var r={};return function(){var s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,a=arguments[1],d=a.payload,n=a.type;switch(n){case e.INIT_IFRAME:return babelHelpers["extends"]({},s,babelHelpers.defineProperty({},d.id,babelHelpers["extends"]({},s[d.id],{id:d.id,ORIGIN:d.ORIGIN,CARD_URL:d.CARD_URL,DRAWER_URL:d.DRAWER_URL,isLoading:!1,isDrawerFailed:!1})));case e.SAVE_ADDON:return babelHelpers["extends"]({},s,babelHelpers.defineProperty({},d.id,babelHelpers["extends"]({},s[d.id],{addon:d.addon})));case e.UPDATE_PARAMS:return babelHelpers["extends"]({},s,babelHelpers.defineProperty({},d.id,babelHelpers["extends"]({},s[d.id],{params:d.params})));case e.START_LOAD:return babelHelpers["extends"]({},s,babelHelpers.defineProperty({},d.id,babelHelpers["extends"]({},s[d.id],{isLoading:!0})));case e.END_LOAD:return babelHelpers["extends"]({},s,babelHelpers.defineProperty({},d.id,babelHelpers["extends"]({},s[d.id],{isLoading:!1})));case e.DRAWER_ERROR:return babelHelpers["extends"]({},s,babelHelpers.defineProperty({},d.id,babelHelpers["extends"]({},s[d.id],{isDrawerFailed:!0})));case e.GET_CONFIG_START:return babelHelpers["extends"]({},s,babelHelpers.defineProperty({},d.id,babelHelpers["extends"]({},s[d.id],{configLoading:!0})));case e.GET_CONFIG_ERROR:return babelHelpers["extends"]({},s,babelHelpers.defineProperty({},d.id,babelHelpers["extends"]({},s[d.id],{getConfigError:d.error,configLoading:!1})));case e.GET_CONFIG_SUCCESS:return babelHelpers["extends"]({},s,babelHelpers.defineProperty({},d.id,babelHelpers["extends"]({},s[d.id],{config:d.config,configLoading:!1})));default:return s}}}]);


"use strict";angular.module("app.booking").factory("RaIframeCarHireProduct",["RaIframeProduct","ngFolktale","FEATURE_CONFIG","$state","Session","BookingRead","$window","$ngRedux","CarhireActions","RaIframeCarTrawlerService","RaIframeCarRentalService","RA_IFRAME_TYPES",function(e,t,r,a,n,o,i,s,c,u,d,l){var m=Object.create(e),g=function(e,t){var r=e.location,a=e.bookingModel;return t===l.CAR_HIRE?u.buildQueriesFor({location:r,bookingModel:a},l.CAR_HIRE):d.buildQueriesFor({location:r,bookingModel:a},l.CAR_RENTAL)},h={GET_ADDON_STATE:function(e){return e&&!o.isPotentialBooking(e)?"booking.active.car-rental":"booking.extras.car-rental"},ID:"CAR_HIRE",PRODUCT_ID:"rentals",ORIGIN:R.pathOr("",["Origin"],r.CAR_HIRE_AEM),SET_SELECTED_ADDON_LENS:function(e,t){return t?e[1]:e[0]},UPDATE_PARAMS_LENS:function(e,t){return a.go(a.current.name,u.getStateParamsFromPayload(e.payload)),this.cardIframe&&"drawer"===t&&this.dispatchRefreshAddon(e.payload),e},URLS:{Card:R.pathOr("",["Card"],r.CAR_HIRE_AEM),Drawer:R.pathOr("",["Drawer"],r.CAR_HIRE_AEM)},cleanService:function(){this.cardIframe=void 0,this.drawerIframe=void 0,this.updatedParams=void 0,n.removeSessionStorage("CT_ELID")},handleGetAddon:function(e,t){var n=o.isPotentialBooking(e)?"potentialTripMicrosite":"activeTripMicrosite";r.CAR_HIRE_AEM[n]?i.open(t.deeplinkParams):(u.setEngineLoadId(R.path(["stateParams","elID"],t)),a.go(this.GET_ADDON_STATE(e),u.getStateParamsFromPayload(t)))},getQueryParams:function(e,t){var r=e.breakpoint,a=e.location,n=e.bookingModel;return babelHelpers["extends"]({Breakpoint:r},g({location:a,bookingModel:n},t))},onCardIframeLoaded:function(){s.dispatch(c.carTrawlerReady())},removeAction:c.confirmCarRemoval,saveToBasket:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1;if("UNCONFIRM"===t[0].state){var a=o.getCarhireObject(s.getState().bookingModel);s.dispatch(this.removeAction()).then(function(){var t=JSON.parse(R.pathOr("{}",["model","status"],a));e.dispatchRemoveSelectedAddon(t)})}else{var n=r?t[1]:t[0];s.dispatch(c.confirmCarSelection(n))}},quickSaveToBasket:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(R.propEq("state","UNCONFIRM",t)){var r=o.getCarhireObject(s.getState().bookingModel);s.dispatch(this.removeAction()).then(function(){var t=JSON.parse(R.pathOr("{}",["model","status"],r));e.dispatchRemoveSelectedAddon(t)})}else s.dispatch(c.confirmCarSelection(t))},removeFromBasket:function(e){return s.dispatch(this.removeAction()),this.dispatchRemoveSelectedAddon(e[0])},getTotalPrice:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.tryCatch(function(){if("UNCONFIRM"===R.path(["state"],e[0]))return 0;var t=R.pathOr({},["product","price","totalPayNow"],e[0]);return{label:t.label,amount:t.amount,currency:t.currencyCode}})},getCustomTexts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.tryCatch(function(){var t=R.pathOr("",["product","insurance","label"]);return{confirm:t(e[0]),confirmPlus:t(e[1])}})},isConfirmEnabled:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return!R.isEmpty(e)},isRebuildNeeded:function(e,t){return o.isPotentialBooking(e)?!1:!!o.getCarhireObject(e)!=!!o.getCarhireObject(t)},isConfirmPlusAvailable:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],r=R.pathOr(!1,["0","model","confirmationId"],t.carHire);return!r&&e.length>1},isIframeOn:function(e,t){return o.isPotentialBooking(t)?r.CAR_HIRE_AEM["potentialTrip"+e]||!e:r.CAR_HIRE_AEM["activeTrip"+e]||!e},getAddedItems:function(e){return o.getCarHireItems(e)}};return Object.assign(m,h)}]);


"use strict";angular.module("app.booking").factory("RaIframeCarRentalProduct",["RaIframeProduct","FEATURE_CONFIG","$ngRedux","CarRentalActions","RaIframeCarRentalService","RA_IFRAME_TYPES","IFRAME_IDS",function(a,e,o,n,r,t,i){var c=Object.create(a),d=function(a){var e=a.location,o=a.bookingModel,n=a.token;return r.buildQueriesFor({location:e,bookingModel:o,token:n},t.CAR_RENTAL)},l={ID:i.CAR_RENTAL,PRODUCT_ID:"rentals",URLS:{Card:R.pathOr("",["Card"],e.RENTAL_CARS_AEM)},cleanService:function(){this.cardIframe=void 0,this.updatedParams=void 0},getQueryParams:function(a,e){var o=a.breakpoint,n=a.location,r=a.bookingModel,t=a.token;return babelHelpers["extends"]({Breakpoint:o},d({location:n,bookingModel:r,token:t},e))},onCardIframeLoaded:function(){o.dispatch(n.carRentalReady())}};return Object.assign(c,l)}]);


"use strict";angular.module("app.booking").factory("RaIframeCarRentalService",["BookingRead","MarketConfig","LEG_TYPE","$cookies","Session","$state","Dates","PASSENGER_TYPES","RA_IFRAME_TYPES","$ngRedux","CarRentalActions","ngFolktale","$httpParamSerializer","$stateParams","$location",function(e,a,r,t,n,o,i,u,s,c,p,d,g,l,f){var m=function(e){return e.orig?e.orig+"|"+e.dest+"|"+e.depart+"|"+e.arrive+"|"+e.flt:void 0},h=function(e){return e.orig?e.dest:null},k=function(e){return e.orig?e.orig:null},y=function(e){return e.reduce(function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[].concat(babelHelpers.toConsumableArray(e));switch(a.type){case u.Child:r[2]+=1;break;case u.Teen:r[1]+=1;break;default:r[0]+=1,a.inf&&(r[3]+=1)}return r},[0,0,0,0]).join(":")},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.replace(/,/g,";").replace(/\./g,",")},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.replace(/,/g,".").replace(/;/g,",")},C=function(r){var t=o.params;if(!R.isEmpty(t.pickupLocation)&&!R.isNil(t.pickupLocation))return[v(t.pickupLocation),v(t.returnLocation),t.pickupDateTime,t.returnDateTime,e.getBookingInfo(r).curr,t.residenceID||a.getCountry().toUpperCase(),t.passengers||y(e.getModel("passengers",r)),t.refId,t.filters,t.referral].filter(function(e){return null!==e}).join("|")},P=function(e){var a=e.isCarRentalAtPageEnabled,r=e.isActiveTrip,t=e.carHireModel,n=R.isEmpty(t),o=R.pathOr(void 0,["serviceProvider"],t),i="rentalcars"===o;return(n||i)&&a&&r},D=function(e){var a=e.emailAddress,r=e.bookingRef,t=e.partnerId,n=void 0===t?"ryanair":t;return c.dispatch(p.getBookingToken({bookingRef:r,emailAddress:a,partnerId:n}))};return{CAR_RENTAL:s.CAR_RENTAL,searchUrl:"http://www.rentalcars.com/SearchLoaderWidget.do?",setEngineLoadId:function(e){n.setSessionStorage("CT_ELID",e)},buildQueriesFor:function(n){var o=n.location,u=n.bookingModel,s=n.token,c=e.getModel("passengers",u),p=R.pathOr({},["journeys",r.inbound,"model"],u),d=R.pipe(e.getFlightsDeparturesTime,R.map(i.utc),R.map(function(e){return e.format("YYYY-MM-DD")}))(u),g=!!l.confirmation||!!f.search().confirmation;return{view:o,partner:"ryanair",departureDate:d[0],returnDate:d[1],destination:h(p),flightOutbound:m(R.path(["journeys",r.outbound,"model"],u)),flightInbound:m(p),language:a.getLanguage().toUpperCase(),currency:e.getBookingInfo(u).curr,sourceCountry:R.defaultTo(a.getCountry(),t.get("ctr")).toUpperCase(),clientId:g?643333:648739,affiliateCode:a.isLaudaMotion()?"laudamotion":"ryanair",market:a.getCountry(),noPassengers:y(c),stateParams:C(u),deeplink:!0,manageBooking:!!s,bookingToken:s||void 0}},getStateParamsFromPayload:function(e){return{pickupLocation:T(R.path(["stateParams","pickupLocation"],e)),dropOffLocation:T(R.path(["stateParams","dropoffLocation"],e)),pickupDateTime:R.path(["stateParams","pickupDateTime"],e),dropOffDateTime:R.path(["stateParams","dropoffDateTime"],e),currency:R.path(["stateParams","currency"],e),residenceID:R.path(["stateParams","residence"],e),sourceCountry:R.defaultTo(a.getCountry(),t.get("ctr")).toUpperCase(),noPassengers:R.path(["stateParams","passengers"],e),searchId:"",refId:R.pathOr("",["stateParams","refID"],e)}},mergeUrl:function(e){var a=this;return function(r){return function(t){var n=g(a.getSearchIataData({bookingModel:t,stateParams:r}));return R.contains("?",e)?e+"&"+n:e+"?"+n}}},buildSearchIataUrl:function(e,a){return d.Box(this.mergeUrl.bind(this)).ap(d.Box(this.searchUrl)).ap(d.Box(a)).ap(d.Box(e)).fold(function(e){return e})},getSearchIataData:function(e){var t=e.bookingModel,n=e.payload,o=R.pathOr({},["journeys",r.outbound,"model"],t),u=R.pathOr(30,["stateParams","driversAge"],n),s="2019-11-01T00:30:00",c="2019-11-10T09:30:00",p=i.separateDateByTimeType(s),d=i.separateDateByTimeType(c);return{preflang:a.getLanguage().toLowerCase(),affiliateCode:"ryanair",from:k(o),to:h(o),puDay:p.day,puMonth:p.month,puYear:p.year,puHour:p.hour,puMinute:p.minutes,doDate:d.day,doYear:d.year,doHour:d.hour,doMinute:d.minutes,driversAge:u,adcamp:"flights",adplat:"633371"}},encodeLocation:T,decodeLocation:v,isNeedToShowCarRentalIframe:P,getBookingToken:D}}]);


"use strict";angular.module("app.booking").factory("RaIframeCarTrawlerService",["$document","BookingRead","MarketConfig","LEG_TYPE","$cookies","Session","$state","RA_IFRAME_TYPES","PASSENGER_TYPES",function(e,r,a,t,n,o,s,i,c){var u="AT",p="PT",d="MMB",l=function(e){return e.orig?e.orig+"|"+e.dest+"|"+e.depart+"|"+e.arrive+"|"+e.flt:void 0},g=function(e){return e.reduce(function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=[].concat(babelHelpers.toConsumableArray(e));switch(r.type){case c.Child:a[2]+=1;break;case c.Teen:a[1]+=1;break;default:a[0]+=1,r.inf&&(a[3]+=1)}return a},[0,0,0,0]).join(":")},m=function(e,a){var t=void 0;if(a===i.CAR_HIRE){var n=r.getCarhireObject(e),s=e.carHire[0];if(n){var c=JSON.parse(n.model.status);t=[c.pickup.location.code,c.dropoff.location.code,c.pickup.datetime,c.dropoff.datetime,c.currency,c.residence,c.search.passengers.adults+":"+c.search.passengers.teens+(":"+c.search.passengers.children+":"+c.search.passengers.infants),c.id,c.insurance.isSelected,(c.extras||[]).map(function(e){return e.type+":"+e.selected}).join(","),R.pathOr(0,["price","payLater","rental","amount"],c)>0,o.getSessionStorage("CT_ELID")],t="['"+t.join("|")+"']"}else s&&R.path(["model","confirmationId"],s)&&(t="['"+s.model.confirmationId+"']")}else if(a===i.GROUND_TRANSFERS){var u=r.addedTransfer(e),p=r.getSoldGroundTransfers(e);R.isEmpty(u)?R.isEmpty(p)||(t=p.map(function(e){return e.model.confirmationId}),t="['"+t.join(",")+"']"):t=u.map(function(e){var r=[e.pickup.location.code,e.dropoff.location.code,e.pickup.datetime,e.dropoff.datetime,e.currency,e.residence,e.search.passengers.adults+":"+e.search.passengers.teens+(":"+e.search.passengers.children+":"+e.search.passengers.infants),e.oneway,e.id,o.getSessionStorage("CT_ELID")].join("|");return"['"+r+"']"},"").join(",")}return t},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.replace(/,/g,";").replace(/\./g,",")},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.replace(/,/g,".").replace(/;/g,",")},k=function(e,t){var n=s.params;if(!R.isEmpty(n.pickupLocation)&&!R.isNil(n.pickupLocation))return[h(n.pickupLocation),h(n.returnLocation),n.pickupDateTime,n.returnDateTime,r.getBookingInfo(e).curr,n.residenceID||a.getCountry().toUpperCase(),n.passengers||g(r.getModel("passengers",e)),t===i.GROUND_TRANSFERS?n.oneway:null,n.refId,n.filters,n.referral].filter(function(e){return null!==e}).join("|")},v=function(e){return r.hasBusinessPlus(e)?"business":r.hasLeisurePlus(e)?"leisure":"regular"},y=function(){var r=e[0].cookie.match("%7CMCMID%7C(.*)"),a=void 0;if(r&&r.length>1){var t=babelHelpers.slicedToArray(r,2),n=t[1],o=n.split("%7"),s=babelHelpers.slicedToArray(o,1),i=s[0];a=i}return a},I=function(e){var a=void 0;return a=r.isPotentialBooking(e)?p:s.params.confirmation?u:d};return{setEngineLoadId:function(e){o.setSessionStorage("CT_ELID",e)},buildQueriesFor:function(e){var s=e.location,c=e.bookingModel,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.CAR_HIRE,d=r.getModel("passengers",c),f={view:"Card"===s?"card":"drawer",context:I(c),flightOutbound:l(R.path(["journeys",t.outbound,"model"],c)),flightInbound:l(R.pathOr({},["journeys",t.inbound,"model"],c)),language:a.getLanguage().toUpperCase(),currency:r.getBookingInfo(c).curr,market:a.getCountry(),sourceCountry:R.defaultTo(a.getCountry(),n.get("ctr")).toUpperCase(),serviceClass:v(c),noPassengers:g(d),firstname:R.path(["0","name","first"],d),surname:R.path(["0","name","last"],d),email:R.path(["0","email"],r.getModel("contacts",c)),flightFare:r.getBookingTotal(c),flightBookingTime:r.getModel("serverTimeUTC",c)[0],basketParams:m(c,u),stateParams:k(c,u),visitorID:y(),myRyanairID:o.getCurrentUser().surrogateId,clientId:853045};return f.context!==p&&u===i.CAR_HIRE&&(f.pnrRef=r.getBookingInfo(c).pnr),f},getStateParamsFromPayload:function(e){return{pickupLocation:f(R.path(["stateParams","pickupLocation"],e)),returnLocation:f(R.path(["stateParams","dropoffLocation"],e)),pickupDateTime:R.path(["stateParams","pickupDateTime"],e),returnDateTime:R.path(["stateParams","dropoffDateTime"],e),currency:R.path(["stateParams","currency"],e),residenceID:R.path(["stateParams","residence"],e),passengers:R.path(["stateParams","passengers"],e),oneway:R.path(["stateParams","oneway"],e),refId:R.path(["stateParams","refID"],e),filters:R.path(["stateParams","filters"],e),referral:R.path(["stateParams","elID"],e)}},encodeLocation:f,decodeLocation:h}}]);


"use strict";angular.module("app.booking").factory("RaIframeEventsProduct",["RaIframeProduct","ngFolktale","$ngRedux","RAIframeActions","FEATURE_CONFIG","BookingRead","MarketConfig","Dates","AEMConfig","Stations","RA_IFRAME_ACTION_TYPES","RezApiConfig","$http","Flatnmap","FlatmapMaps","BasketMessageQueue","ModelQuery",function(t,e,n,a,o,r,i,d,s,u,c,p,E,O,g,f,l){var C=Object.create(t),I=R.pipe(r.getModel("journeys"),R.map(R.pipe(R.prop("departUTC"),d.utc,d.formatISO.bind(d)))),_=function(t){return{total:t.total,qty:t.qty,code:t.code,name:t.name}},D=function(t){return{total:Number(t.PRICE),name:t.NAME,code:t.PRODUCT_ID,qty:t.QTY}},y=R.pipe(r.getEventItems(!1),R.pluck("model")),m=function(t){return R.pipe(R.prop("name"),R.equals(t),R.not)},v=function(t,e){return{products:R.pipe(y,R.filter(m(t.NAME)),R.map(_),R.append(D(t)))(e)}},T=function(t,e){return{products:R.pipe(y,R.filter(function(e){return e.code!==t}),R.map(_))(e)}},S=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.some(function(e){return t&&e.toLowerCase()===t.toLowerCase()})},M={ID:"EVENTS",GET_ADDON_STATE:"booking.active.events",ORIGIN:R.pathOr("",["Origin"],o.CORAS_EVENTS),URLS:{Card:R.pathOr("",["Card"],o.CORAS_EVENTS),Drawer:R.pathOr("",["Drawer"],o.CORAS_EVENTS)},getQueryParams:function(t){var e=this,n=t.location,a=void 0===n?"Card":n,o=t.bookingModel,d=t.displayType,s=t.stateParams,c=t.flightExtras,p=I(o),E=babelHelpers.slicedToArray(p,2),O=E[0],g=E[1],f=r.getDestCityCode(o),l=c.find(R.propEq("code",this.ID)),C=function(t){return R.path(["updatedParams",t],e)},_={destCode:f,destCountry:u.getCountryCode(f).toUpperCase(),retDt:C("retDt")||g,depDt:C("depDt")||O,lang:i.getLanguage(),cc1:r.getBookingInfo(o).curr,sessionId:l.corasSessionId};return l.corasUserId&&(_.transactionId=l.corasUserId),s.PRODUCT_ID&&(_.productId=s.PRODUCT_ID),"card"===a.toLowerCase()&&(_.display=d),_},getTotalPrice:function(t){var n=Number(t.PRICE);return e.Either.of(n)},isConfirmEnabled:function(t,e){return!!Number(t.PRICE)&&!R.pipe(r.getEventItems(!1),l.findByModel({code:t.PRODUCT_ID}))(e)},addAction:function(t){var e=this;return function(n,a){n({type:c.ADD_TO_BOOKING_MODEL_START});var o=a(),r=o.bookingModel;return E.post(p.events,v(t,r)).then(function(t){var a=t.data;n({type:c.ADD_TO_BOOKING_MODEL_SUCCESS,payload:{items:O.normalize(g.postEvents,a).addons||[],id:e.ID},meta:{analytics:{event:"rynProductTrack",action:"ADD",type:"EVENTS",identity:"addons"}}}),f.enqueue({code:"EVENTS_MESSAGE",translation:"trips.basket.events_added"})})["catch"](function(t){var a=t.data;n({type:c.ADD_TO_BOOKING_MODEL_ERROR,payload:{id:e.ID,items:a}})})}},removeAction:function(t){var e=this;return function(n,a){n({type:c.REMOVE_FROM_BOOKING_MODEL_START});var o=a(),r=o.bookingModel;return E.post(p.events,T(t,r)).then(function(t){var a=t.data;n({type:c.REMOVE_FROM_BOOKING_MODEL_SUCCESS,payload:{items:O.normalize(g.postEvents,a).addons||[],id:e.ID},meta:{analytics:{event:"rynProductTrack",action:"REMOVE",type:"EVENTS",identity:"addons"}}})})["catch"](function(t){var e=t.data;n({type:c.REMOVE_FROM_BOOKING_MODEL_ERROR,payload:e})})}},eventsEnabled:function(t){var e=t.eventsConfig,n=void 0===e?{}:e,a=t.bookingModel,o=t.language,i=r.getDestCityCode(a),d=r.getBookingInfo(a).curr,s=n.destinations,u=n.currencies,c=n.languages;return S(i,s)&&S(d,u)&&S(o,c)},getEventsConfig:function(){var t=this;return function(e){return e({type:c.GET_CONFIG_START,payload:{id:t.ID}}),E.get(s.getCorasConfigUrl()).then(function(n){var a=n.data;e({type:c.GET_CONFIG_SUCCESS,payload:{id:t.ID,config:a}})})["catch"](function(n){var a=n.data;e({type:c.GET_CONFIG_ERROR,payload:{id:t.ID,error:a}})})}},getAddedItems:function(t){return r.getEventItems(t)}};return Object.assign(C,M)}]);


"use strict";angular.module("app.booking").factory("RaIframeGroundTransfersProduct",["RaIframeProduct","BookingRead","FEATURE_CONFIG","ngFolktale","RaIframeCarTrawlerService","$window","$state","$ngRedux","GroundTransfersActions","$filter","ModelQuery","RA_IFRAME_TYPES",function(e,t,r,o,n,a,i,s,d,u,c,l){var f=Object.create(e),m=function(e){var t=e.location,r=e.bookingModel;return n.buildQueriesFor({location:t,bookingModel:r},l.GROUND_TRANSFERS)},p={ID:"GROUND_TRANSFERS",ORIGIN:R.pathOr("",["Origin"],r.GROUND_TRANSFERS_AEM),PRODUCT_ID:"transfers",URLS:{Card:R.pathOr("",["Card"],r.GROUND_TRANSFERS_AEM),Drawer:R.pathOr("",["Drawer"],r.GROUND_TRANSFERS_AEM)},GET_ADDON_STATE:function(e){return e&&!t.isPotentialBooking(e)?"booking.active.transfers":"booking.extras.transfers"},UPDATE_PARAMS_LENS:function(e){return i.go(i.current.name,n.getStateParamsFromPayload(e.payload)),this.cardIframe&&this.dispatchRefreshAddon(e.payload),e},getQueryParams:function(e){var t=e.breakpoint,r=e.location,o=e.bookingModel;return babelHelpers["extends"]({Breakpoint:t},m({location:r,bookingModel:o}))},handleGetAddon:function(e,o){var s=t.isPotentialBooking(e)?"potentialTripGroundTransfersMicrosite":"activeTripGroundTransfersMicrosite";r.GROUND_TRANSFERS_AEM[s]?a.open(o.deeplinkParams):(n.setEngineLoadId(R.path(["stateParams","elID"],o)),i.go(this.GET_ADDON_STATE(e),n.getStateParamsFromPayload(o)))},saveToBasket:function(e){return"UNCONFIRM"===e.state?s.dispatch(this.removeAction()):s.dispatch(d.postGroundTransfers(e))},extractTotalFromBookingModel:function(e,t){return R.pipe(this.getAddedItems(t),R.map(function(e){return R.pathOr(!1,["config","mor"],JSON.parse(e.model.status))?babelHelpers["extends"]({},e,{model:babelHelpers["extends"]({},e.model,{total:e.model.total})}):e}),c.sumUpTotal)(e)||0},getTotalPrice:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=R.pathOr(0,["product","price","total"],e),r=R.pathOr(0,["product","price","total","amount"])(e);return R.is(Object,t)&&(t=babelHelpers["extends"]({},t,{amount:r})),o.tryCatch(function(){return"UNCONFIRM"!==e.state?t:0})},getAddedItems:function(e){return t.getGroundTransfersItems(e)},isConfirmEnabled:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!R.isEmpty(e)},removeAction:d.confirmGroundTransferRemoval,removeFromBasket:function(e){return s.dispatch(this.removeAction()),this.dispatchRemoveSelectedAddon(e[0])},isIframeOn:function(e,o){return t.isPotentialBooking(o)?r.GROUND_TRANSFERS_AEM["potentialTrip"+e]||!e:r.GROUND_TRANSFERS_AEM["activeTrip"+e]||!e},isRebuildNeeded:function(e,r){if(!t.isPotentialBooking(e)){var o=t.addedTransfer(r),n=t.addedTransfer(e);return o.length!==n.length||R.path(["0","key"],o)!==R.path(["0","key"],n)}return!1},requestAddressConfirmation:function(e){var t="card"===e,r=t?this.cardIframe:this.drawerIframe,o=t?this.URLS.Card:this.URLS.Drawer;r&&r.postMessage({type:"DESTINATION_UNCONFIRMED"},o)},isAllowedToPerformAction:function(e){var t=R.pathOr(!1,["product","search","dropoff","location","confirmed"],e);return t?o.Either.of(e):(this.requestAddressConfirmation(e.view),o.Either.Left({msg:"User didn't confirm the dropoff address"}))}};return Object.assign(f,p)}]);


"use strict";angular.module("app.booking").factory("RaIframeProduct",["ngFolktale","Device","$httpParamSerializer","$ngRedux","RAIframeActions","ModelQuery","RA_IFRAME_TYPES",function(t,e,n,r,a,o,i){var u=function(t){return{message:t+" has to be defined by the product specific service (child service)",name:"RaIframeProductException"}},d=R.prop("payload");return{onInit:function(){},addAction:function(){},removeAction:function(){},saveToBasket:function(t){var e=this;r.dispatch(a.startLoading(this.ID)),r.dispatch(this.addAction(t))["finally"](function(){r.dispatch(a.endLoading(e.ID))})},removeFromBasket:function(t){return r.dispatch(this.removeAction(t)),this.dispatchRemoveSelectedAddon(t)},saveUpdatedParams:function(t){this.updatedParams=t},cleanService:function(t){var e=t.cardIframe;e===this.cardIframe&&(this.cardIframe=void 0),this.drawerIframe=void 0,this.updatedParams=void 0},getTotalPrice:function(){throw u("getTotalPrice")},getCustomTexts:function(){return t.tryCatch(function(){return{}})},dispatchRemoveSelectedAddon:function(e){var n=this;return t.Either.of(e).map(function(t){return n.cardIframe.postMessage({type:"REMOVE_SELECTED_ADDON",payload:t},n.URLS.Card),t})},dispatchSetSelectedAddon:function(e){var n=this;return t.Either.of(e).map(function(t){return n.cardIframe.postMessage({type:"SET_SELECTED_ADDON",payload:t},n.URLS.Card),t})},dispatchRefreshAddon:function(e){var n=this;return t.Either.of(e).map(function(t){return n.cardIframe.postMessage({type:"REFRESH_ADDON",payload:t},n.URLS.Card),t})},setCardIframe:function(t){var e=this;return this.cardIframe=t,function(){e.cleanService({cardIframe:t})}},onCardIframeLoaded:function(){},setDrawerIframe:function(t){this.drawerIframe=t},SET_ADDON_LENS:d,SET_SELECTED_ADDON_LENS:R.identity,GET_ADDON_LENS:d,UPDATE_PARAMS_LENS:d,GET_ADDON_STATE:u("GET_ADDON_STATE").message,URLS:u("URLS").message,ID:u("ID").message,ORIGIN:u("ORIGIN").message,mergeUrl:function(t){var e=this;return function(r){return function(a){return function(o){return function(i){return function(u){return function(d){return function(s){return function(c){var f=n(e.getQueryParams({breakpoint:r,location:a,displayType:o,stateParams:i,bookingModel:u,flightExtras:d,token:c},s));return R.contains("?",t)?t+"&"+f:t+"?"+f}}}}}}}}},getQueryParams:function(){throw u("getQueryParams")},isConfirmEnabled:function(){throw u("isConfirmEnabled")},isConfirmPlusAvailable:function(){return!1},isRebuildNeeded:function(){return!1},onSaveAddon:function(){},onOpenDrawer:function(){},onCardStateChange:function(){},isIframeOn:function(){return!0},onIframeTurnedOff:function(){},buildIframeUrl:function(n){var r=n.location,a=n.displayType,o=n.stateParams,u=n.bookingModel,d=n.flightExtras,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.CAR_HIRE,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",f=s===i.CAR_HIRE?"Card":"card";return t.Box(this.mergeUrl.bind(this)).ap(t.Box(this.URLS[r])).ap(t.Box(e.currentBreakpoint())).ap(t.Box(f)).ap(t.Box(a)).ap(t.Box(o)).ap(t.Box(u)).ap(t.Box(d)).ap(t.Box(s)).ap(t.Box(c)).fold(function(t){return t})},getAddedItems:function(){throw u("getAddedItems")},extractTotalFromBookingModel:function(t,e){return R.pipe(this.getAddedItems(e),o.sumUpTotal)(t)||0},isAllowedToPerformAction:function(e){return t.Either.of(e)}}}]);


"use strict";angular.module("app.booking").service("RAIframeService",["$window","ngFolktale","$ngRedux","RAIframeActions","BookingRead","RaIframeEventsProduct","RaIframeCarHireProduct","RaIframeCarRentalProduct","RaIframeGroundTransfersProduct","$log",function(e,t,n,r,i,o,a,s,u,c){var f=this,d={},h=function(e,t){var n=t.bookingModel,r=R.propEq("ID",e),o=R.any(Boolean,[i.hasCarHire(n),i.hasCarHireSold(n)]),s=R.any(Boolean,[i.hasGroundTransfer(n),i.hasGroundTransferSold(n)]),c=r(a)&&o,f=r(u)&&s;return R.any(Boolean,[c,f])};d[a.ID]=a,d[s.ID]=s,d[o.ID]=o,d[u.ID]=u,this.sandboxExceptions="allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox allow-forms",this.get=function(e){return d[e]},this.isSameOrigin=function(e){return function(n){return e===n.origin?t.Either.of(n):t.Either.Left({msg:"Different Origin between config url: "+e+" and the iframe event "+n.origin})}},this.isType=function(e){return function(n){return e===n.type?t.Either.of(n):t.Either.Left({msg:"Different MSG type"})}},this.dispatchResize=function(e,t){return function(n){e.postMessage({type:"RESIZE",payload:{Breakpoint:n}},t)}},this.isSameProduct=function(e){return function(n){return e&&e!==n.PRODUCT_ID?t.Either.of({msg:"Different Product ID"}):t.Either.of(n)}},this.addWindowListeners=function(t){return function(n){return t?(t.forEach(function(t){e.addEventListener("message",t,!1)}),n):n}},this.removeWindowListeners=function(t){t.forEach(function(t){e.removeEventListener("message",t)})},this.getUpdateParamsListener=function(e,n){return function(r){t.Either.of(r).chain(f.isSameOrigin(e)).map(R.prop("data")).chain(f.isType("UPDATE_PARAMS")).fold(function(){c.debug(r)},n)}},this.getHeightChangeListener=function(e,t){return function(n){n.origin===e&&n.data&&"HEIGHT_CHANGE"===n.data.type&&(c.debug(n),t(n.data))}},this.saveIframeData=function(e,t){n.dispatch(r.saveAddon(e,t))},this.registerIntersectionObserver=function(t){var r=t.productType,i=t.iframe,o=t.iframeUrl,a=.05,s=1+1/a,u=Array.from({length:s},function(e,t){return t*a}),c=function(e){h(r,n.getState())||i.contentWindow.postMessage({payload:babelHelpers["extends"]({},e,{productType:r}),type:"IN_VIEW"},o)},f=R.pick(["bottom","height","left","right","top","width","x","y"]),d=R.pipe(function(e){return{intersectionRatio:e.intersectionRatio,intersectionRect:f(e.intersectionRect),boundingClientRect:f(e.boundingClientRect)}},c),p=R.forEach(R.when(R.prop("isIntersecting"),d)),g=new e.IntersectionObserver(p,{threshold:u});return g.observe(i),function(){return g.unobserve(i)}}}]);


"use strict";angular.module("app.booking").component("refundConfirmation",{templateUrl:"/partials/booking/refund/refund-confirmation/refund-confirmation.html",bindings:{totalRefundAmount:"<",reset:"&",onRefundFinished:"&",dividedBooking:"<",voucherRefunds:"<"},controller:function(){var n=this,o=function(){return n.onRefundFinished()};this.$onDestroy=function(){n.reset(),o()}}});


"use strict";angular.module("app.booking").constant("RA_IFRAME_ACTION_TYPES",{SAVE_ADDON:"[ra-iframe] save addon",UPDATE_PARAMS:"[ra-iframe] update params",INIT_IFRAME:"[ra-iframe] init iframe",START_LOAD:"[ra-iframe] starting loading",END_LOAD:"[ra-iframe] loading ended",DRAWER_ERROR:"[ra-iframe] drawer error",ADD_TO_BOOKING_MODEL_START:"[ra-iframe] add to booking model start",ADD_TO_BOOKING_MODEL_SUCCESS:"[ra-iframe] add to booking model success",ADD_TO_BOOKING_MODEL_ERROR:"[ra-iframe] add to booking model error",REMOVE_FROM_BOOKING_MODEL_START:"[ra-iframe] remove from booking model start",REMOVE_FROM_BOOKING_MODEL_SUCCESS:"[ra-iframe] remove from booking model success",REMOVE_FROM_BOOKING_MODEL_ERROR:"[ra-iframe] remove from booking model error",GET_CONFIG_START:"[ra-iframe] get config start",GET_CONFIG_SUCCESS:"[ra-iframe] get config success",GET_CONFIG_ERROR:"[ra-iframe] get config error"});


"use strict";angular.module("app.booking").component("refundError",{templateUrl:"/partials/booking/refund/refund-error/refund-error.html",bindings:{reset:"&"},controller:function(){function r(e){babelHelpers.classCallCheck(this,r),this.refundMicrositeUrl=e.REFUND_MICROSITE}return r.$inject=["FEATURE_CONFIG"],r.prototype.$onDestroy=function(){this.reset()},r}()});


"use strict";angular.module("app.booking").component("refundFlightCard",{templateUrl:"/partials/booking/refund/refund-flight-card/refund-flight-card.html",bindings:{journey:"<",isInbound:"<",isSelected:"<",onClick:"&",hideTitle:"<"},controller:function(){function e(){babelHelpers.classCallCheck(this,e)}return e.prototype.selectJourney=function(e){this.onClick({$event:{journey:e}})},e.prototype.$onInit=function(){this.legType=this.isInbound?"inbound":"outbound",this.flightNumber=this.journey.flt.replace(/\s/g,""),this.journey.isCancelled?(this.status="trips.booking.refund.cancelled",this.message="trips.refund.flights.card.message.refundable",this.title="trips.refund.flights.card.title.cancelled"):this.journey.isRefundable?this.title="trips.refund.flights.card.title.refundable":(this.isUsed=!0,this.status="trips.booking.refund.flown",this.message="trips.refund.flights.card.message.not-refundable",this.title="trips.refund.flights.card.title.used")},e}()});


"use strict";angular.module("app.booking").component("refundFlights",{templateUrl:"/partials/booking/refund/refund-flights/refund-flights.html",bindings:{journeys:"<",selectedJourneys:"<",setCta:"&",reset:"&",onGetRefundBreakdown:"&",onToggleSelection:"&"},controller:function(){var e=this,n=function(n){return e.onGetRefundBreakdown({$event:{next:n}})};this.hideCardTitle=function(n){return 2===e.journeys.length&&1===n&&e.journeys[0].isCancelled===e.journeys[1].isCancelled&&e.journeys[0].isRefundable===e.journeys[1].isRefundable},this.handleSelection=function(n){var t=n.journey;return e.onToggleSelection({$event:{journey:t}})},this.$onInit=function(){e.setCta({$event:{name:"confirm",fn:function(e){return n(e)}}}),e.setCta({$event:{name:"back",fn:function(e){return e()}}})},this.$onDestroy=function(){e.reset()}}});


"use strict";angular.module("app.booking").component("refundSelectPax",{templateUrl:"/partials/booking/refund/refund-select-pax/select-pax.html",bindings:{passengers:"<",selectedPassengers:"<",lockedPassengers:"<",onUpdateSelection:"&",onGetRefundable:"&",readonly:"<?",setCta:"&",reset:"&"},controller:function(){function e(){var n=this;babelHelpers.classCallCheck(this,e),this.confirmEnabled=!1,this.isPaxLocked=function(e){return!R.none(R.equals(e),n.lockedPassengers)},this.isPaxSelected=function(e){return!R.none(R.equals(e),n.selectedPassengers)}}return e.prototype.$onChanges=function(e){e.selectedPassengers&&e.selectedPassengers.currentValue.length&&!this.confirmEnabled&&!this.readonly?(this.confirmEnabled=!0,this.setCta({$event:{name:"confirmEnabled",fn:this.confirmEnabled}})):e.selectedPassengers&&!e.selectedPassengers.currentValue.length&&this.confirmEnabled&&!this.readonly&&(this.confirmEnabled=!1,this.setCta({$event:{name:"confirmEnabled",fn:this.confirmEnabled}}))},e.prototype.$onInit=function(){var e=this,n=function(n){return e.onGetRefundable({$event:{next:n}})};this.setCta&&!this.readonly&&(this.setCta({$event:{name:"confirmEnabled",fn:this.confirmEnabled}}),this.setCta({$event:{name:"confirm",fn:function(e){return n(e)}}}),this.setCta({$event:{name:"back",fn:function(e){return e()}}}))},e.prototype.$onDestroy=function(){this.reset()},e}()});


"use strict";angular.module("app.booking").component("refundSummary",{templateUrl:"/partials/booking/refund/refund-summary/refund-summary.html",bindings:{passengers:"<",totalRefundAmount:"<",refundItemBreakdown:"<",selectedJourneys:"<",availablePayments:"<",voucherRefunds:"<",setCta:"&",reset:"&",onRefund:"&"},controller:["$filter","AEMConfig","Payments",function(e,t,n){var r=this,i=babelHelpers["extends"]({},n.CARD_PAYMENT_CODES,{paypal:["PP"],ideal:["IA"]}),u=function(e){return r.onRefund({$event:{next:e}})};this.getItemTranslationKey=function(e){return"trips.refund.refund-summary.breakdown-item."+e.type},this.getRouteTitle=function(e){var t=e.isCancelled?"CANCELLED":"NORMAL";return"trips.refund.flights.route-title."+t},this.$onInit=function(){r.otherFees=R.pipe(R.filter(function(t){return e("translate")(r.getItemTranslationKey(t))===r.getItemTranslationKey(t)}),R.reduce(function(e,t){return e+t.total},0))(r.refundItemBreakdown),r.setCta({$event:{name:"confirm",fn:function(e){return u(e)}}}),r.setCta({$event:{name:"back",fn:function(e){return e()}}})},this.getIcon=function(e){var n=t.getStaticFilePrefix(),r=Object.keys(i).find(function(t){return i[t].indexOf(e)>=0});return n+"/resources/ui/img/payment-methods/"+r+".png, "+(n+"/resources/ui/img/payment-methods/"+r+"@2x.png 2x")},this.$onDestroy=function(){r.reset()}}]});


"use strict";angular.module("app.booking").factory("AirMaltaFare",["BookingRead",function(e){var t=function(t,n,r){return R.pipe(R.filter(function(e){return Boolean(e.quantity)}),R.map(function(t){return{code:t.code,qty:e.getPassengerBreakdownAsObject(r)[n]}}))(t)};return{getFareFeatures:t}}]);


"use strict";angular.module("app.booking").factory("AirMaltaFlightSelect",function(){var e=function(e){return R.pathOr(null,["fares","0","fareOption"],e)},t=function(t,n){var r=e(t)===n;return r?t:babelHelpers["extends"]({},t,{isActive:r})},n=function(e){return babelHelpers["extends"]({},e,{isActive:!0})},r=function(e){return["returnFlightListModel","outboundFlightListModel"][e]},i=function(e,n){return e.map(function(e){return t(e,n)})},u=function(e){return e?0:1},l=function(e){return R.pipe(R.pathOr([],["flights"]),R.filter(function(e){return!!e}),R.length,Boolean)(e)};return{disableMixedFares:i,getFareOption:e,resetMixedFare:n,getFlightModelKey:r,getOpositeLegIndex:u,hasSelectedFlight:l}});


"use strict";angular.module("app.booking").factory("farefinderAvailabilityMapping",["Dates",function(a){return function(n){return(n||{}).outbound&&(n.currency=((n.outbound.minFare||{}).price||{}).currencyCode||"",(n.outbound.minFare||{}).day=a.format(a.utc((n.outbound.minFare||{}).day)),(n.outbound.maxFare||{}).day=a.format(a.utc((n.outbound.maxFare||{}).day)),n.outbound.fares.forEach(function(n){n.amount=(n.price||{}).value||0,n.day=a.format(a.utc(n.day))})),(n||{}).inbound&&((n.inbound.minFare||{}).day=a.format(a.utc((n.inbound.minFare||{}).day)),(n.inbound.maxFare||{}).day=a.format(a.utc((n.inbound.maxFare||{}).day)),n.inbound.fares.forEach(function(n){n.amount=(n.price||{}).value||0,n.day=a.format(a.utc(n.day))})),n}}]);


"use strict";angular.module("app.booking").factory("FarefinderMonthlyAvailability",["$http","$q","FareFinderApiConfig","farefinderAvailabilityMapping","MarketConfig",function(t,e,n,r,a){var i=function(t){var e=n.getRestfulApi(t.IsRoundTrip?"farefinderAvailabilityRoundTrip":"farefinderAvailabilityOneWay");return e.compose(t)},o=function(t){var e={};return e.outboundMonthOfDate=t.OutboundDate,e.market=a.getMarket(),t.IsRoundTrip&&(e.inboundMonthOfDate=t.InboundDate),e},u=function(n){var a=e.defer(),u=i(n),f=o(n);return t.get(u,{params:f,timeout:a.promise}).then(function(t){return a.resolve(r(t.data))},function(t){return a.reject(t)}),a},f=function(e){var n=i(e),a=o(e);return t.get(n,{params:a}).then(function(t){return r(t.data)})};return{get:f,deferredGet:u}}]);


"use strict";angular.module("app.booking").factory("FarefinderWeeklyAvailability",["$http","$q","FareFinderApiConfig","farefinderAvailabilityMapping","MarketConfig",function(e,r,t,n,a){var i=function(e){var r=t.getRestfulApi(e.IsRoundTrip?"farefinderAvailabilityRoundTrip":"farefinderAvailabilityOneWay");return r.compose(e)},u=function(e){var r={};return r.outboundWeekOfDate=e.OutboundDate,r.market=a.getMarket(),e.IsRoundTrip&&(r.inboundWeekOfDate=e.InboundDate),r},o=function(t){var a=r.defer(),o=i(t),f=u(t);return e.get(o,{params:f,timeout:a.promise}).then(function(e){return a.resolve(n(e.data))},function(e){return a.reject(e)}),a},f=function(r){var t=i(r),a=u(r);return e.get(t,{params:a}).then(function(e){return n(e.data)})};return{get:f,deferredGet:o}}]);


"use strict";angular.module("app.booking").service("Basket",["$ngRedux","$state","BookingRead","MarketConfig","BookingAccommodation","SamsoniteActions","CabinBagActions","PriorityBoardingActions","FastTrackActions","InsuranceActions","EquipmentActions","ParkingActions","NameChangeActions","VoucherActions","BookingModelActions","ChangeFlightActions","SeatsActions","BagsActions","BreakfastActions","$injector","FlightSearch","RaIframeEventsProduct","FareUpgradeActions","RaIframeCarHireProduct","InflightProductsActions","TravelCreditActions","RaIframeGroundTransfersProduct","CurrencyConversionService","SeatsService","FOOTNOTE_CONFIG","Dates","FEATURE_CONFIG","PaymentActions","TRAVEL_CREDIT","TransfersActions","FEE_CODES","PRESELL_PRODUCT_CODES",function(t,e,n,r,o,a,i,u,c,l,s,p,d,f,m,g,y,h,v,b,A,C,S,k,B,T,q,F,P,O,I,N,E,D,H,x,M){var G=this,L=function(t){return Number(t.toFixed(2))};this.hasFareFootnote=function(){return R.contains(r.getCountry().toUpperCase(),O.fareFootnoteCountries)},this.hasVerboseBaggageStatus=function(){return R.contains(r.getCountry().toUpperCase(),O.verboseBaggageStatusCountries)},this.getTotal=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!1,r=t.getState(),a=r.bookingModel,i=r.payment,u=e?n.getTotalSold(a):n.getBookingTotal(a,!0),c=u;return n.isPaymentFeesApplied(a)?c=0:(c-=n.getPaymentDiscount(a),c-=n.getGroundTransferCTCharge(a)),{amt:R.sum([u,n.totalCarHire(a),o.total.amt]),showOverallTotal:function(){return 0===n.totalCarHire(a)&&0===o.total.amt?!0:!i.dccOfferApplied}(),paymentChargeApplicableAmt:c}},this.getTotalPriceToPay=function(t,e){var r=t.bookingModel,a=t.payment,i=e.isSummary,u=void 0===i?!1:i,c=e.activeBookingState,l=void 0===c?!1:c,s=G.getTotal(u).amt,p=F.getCorporateCardFee(a),d=p>=s?0:p,f=n.getPaymentDiscount(r),m=R.pathOr(0,["total","amt"],o),g=R.pathOr(0,["total","payNowAmt"],o),y=l?n.totalCarHire(r):0;return L(s)+L(d)-L(f)-L(m)+L(g)-L(y)},this.getTotalPriceToPayConfigurationObject=function(t){var n=e.current.name.indexOf("booking.active")>=0,r=!A.model.operatedBy;return{isSummary:t,activeBookingState:n,applyPaymentFee:r}},this.totalPriceToShow=function(){var r=t.getState(),o=r.bookingModel,a=r.payment,i=G.getTotal(),u=e.current.name.indexOf("booking.active")>=0,c=F.getCorporateCardFee(a),l=i.amt<=c?0:c,s=n.getPaymentDiscount(o),p=n.totalCarHire(o);return L(i.amt)+L(l-s-p)+L(u?0:p)};var j=function(e){var r=t.getState(),o=r.bookingModel,a=n.isRyanairFlight(e,o),i=n.isLaudaFlight(e,o);if(!a&&!i)return{};var u=R.pathOr(null,["journeys",e,"model","departUTC"],o),c=R.length(R.pathOr([],["passengers"],o)),l=R.pipe(n.getAllpriorityBoardingItems,R.filter(function(t){return t.key.journeys===e}),R.length)(o),s=R.equals(l,c),p=n.isLeisurePlusLeg(o,e)||n.isBusinessPlusLeg(o,e)||n.isFamilyPlusLeg(o,e)||n.isConnectingFlight(o),d=I.isSameOrAfter(u,N.CABIN_BAG_LAUNCH_DATE)&&R.propOr(!1,"priority-boarding-and-cabin-bags-enabled",N)&&!s&&!p,f=R.subtract(c,l);return{smallBagMessageQty:f,showSmallBagsIncludedMessage:d}},U=function(e){F.getCorporateCardFee(e)&&t.dispatch(E.updateCurrencyConversionOffer())};this.getBreakdownItems=function(r,A,O){var I=arguments.length>3&&void 0!==arguments[3]?arguments[3]:!1,N=[{id:"booking",order:1,model:{total:I?n.getTotalSold(r):n.getBookingTotal(r)},paymentChargeApplicable:!0,showSubtotal:o.total.amt>0||n.totalCarHire(r)>0,products:function(){var o=[],b=R.pipe(R.pathOr([],["journeys"]),R.map(function(t){return t.model}))(r);b=b.map(function(t){return babelHelpers["extends"]({},t,{fares:n.getFaresFor(t.journeyNum,r),infSsrs:n.getInfSsrsFor(t.journeyNum,r),zoneDiscount:n.getZoneDiscountFor(t.journeyNum,r),fats:n.getFatsFor(t.journeyNum,r),segments:n.getSegmentsFor(t.journeyNum,r)},j(t.journeyNum))});var k=R.pipe(R.reduce(function(t,e){return t.concat(e.fares||e.infSsrs||e.fats)},[]),R.filter(function(t){return t.sold===I}),function(t){return t.length>0})(b),O=function(t){return babelHelpers["extends"]({},t.model,{journeyNum:t.key.journeys})},N=I?n.getSoldProducts(r).map(O):n.getUnsoldProducts(r).map(O);k&&(o=o.concat(b.map(function(t,e){return{type:"journey",detail:t,leg:e}})));var L=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.current.name,r={SURE:["booking.home","booking.extras","booking.payment"],FAMI:[]};return R.contains(t,Object.keys(r))&&!R.contains(n,R.path([t],r))},w=R.pipe(R.filter(function(t){return t.sold===I&&t.total>0&&L(t.code)}),R.head(),R.propOr(null,"code"));w(N)&&o.push({type:"UPGRADE",upgradeName:w(N),total:R.pipe(R.filter(function(t){return t.code===w(N)&&t.sold===I}),R.map(R.prop("total")),R.sum())(N),onRemove:function(){t.dispatch(S.removeUpgrade(e.is("booking.active.payment")))},detail:function(){var t=function(t,e,n){return R.pipe(R.filter(function(r){return r.type===e&&r.sold===I&&r.isPartOfBundle===!0&&r.journeyNum===t&&(n?0===r.total:!0)}),R.length())},e=function(e){var o=n.isFamilyPlusLeg(r,e)||n.getBundleByLeg(e)(r);return o?[{label:n.getSegmentsFor(e,r),available:t(e,"SEAT")(N).length,products:[{code:"plus_BBG",qty:t(e,"BAGS")(N)},{code:"plus_priority",qty:t(e,"PRIOBRDNG")(N)},{code:"plus_seats",qty:t(e,"SEAT")(N)},{code:"plus_CBAG",qty:t(e,"CBAG")(N)}]}]:[]};return{items:[].concat(babelHelpers.toConsumableArray(e(0)),babelHelpers.toConsumableArray(e(1)))}}()}),o.push({type:"bags",detail:function(){var o=R.pipe(R.filter(function(t){return"BAG"===t.code&&t.sold===I&&t.isPartOfBundle===!1}))(N),a=R.pipe(R.filter(function(t){return"BBG"===t.code&&t.sold===I&&t.isPartOfBundle===!1}))(N),i=R.pipe(R.filter(function(t){return"5KG"===t.code&&t.sold===I&&t.isPartOfBundle===!1}))(N),u=R.pipe(R.filter(function(t){return t.length}))([[].concat(babelHelpers.toConsumableArray(o)),[].concat(babelHelpers.toConsumableArray(a)),[].concat(babelHelpers.toConsumableArray(i))]);return{zoneDiscount:n.getZoneDiscountFor(0,r),items:u.map(function(o){return{code:o[0].code,qty:o.map(function(t){return t.qty}).reduce(function(t,e){return t+e},0),total:o.map(function(t){return t.total}).reduce(function(t,e){return t+e},0),totalDiscount:o.map(function(t){return t.totalDiscount||0}).reduce(function(t,e){return t+e},0),discountType:R.pathOr("None",["0","discountType"],o),onRemove:!n.isSaraValidated(r)||e.is("booking.active")||e.is("booking.extras")?function(){t.dispatch(h.removeAllByCode(o[0].code))}:angular.noop}})}}()}),o.push({type:"samsonite",detail:function(){var e=t.getState(),o=e.samsonite.codes,a=[];o.forEach(function(t){var e=n.getExtraItemsByType(t,r),o=R.clone(R.head(e));o&&(o=e.reduce(function(t,e){return babelHelpers["extends"]({},t,{amt:t.total+e.total,total:t.total+e.total,vat:t.vat+e.vat,qty:t.qty+e.qty})},babelHelpers["extends"]({},o,{total:0,vat:0,qty:0})),a.push(o))});var i={items:a};return i.items.length&&i.items.push({qty:1,total:0,type:"delivery-fee"}),i}(),onRemove:function(e){t.dispatch(a.removeSamsonite(e))}}),o.push({type:"cbag",detail:function(){var e=R.filter(function(t){return"CBAG"===t.code&&t.sold===I},N),n=e.filter(function(t){return t.total}).length,r={code:"CBAG",qty:n,total:e.reduce(function(t,e){return t+e.total},0),onRemove:function(){t.dispatch(i.removeFromBasket())}};return{items:n?[r]:[]}}()}),o.push({type:t.getState().seats.changeSeatsMode||P.hasChangeSeatAdded(t.getState().bookingModel)?"change-seats":"seats",detail:function(){var o=e.is("booking.active.payment")||e.is("booking.active")||e.is("booking.active.checkin.payment")||e.is("booking.extras")||e.is("booking.payment")?R.pipe(R.filter(function(t){return"SEAT"===t.type&&t.sold===I&&t.total>0}))(N):R.pipe(R.filter(function(t){return"SEAT"===t.type&&t.sold===I}))(N);n.isMandatorySeatNeeded(r)&&!n.hasFamilyPlus(r)&&(o=R.pipe(R.pluck("model"))(n.getNonMandatorySeats(r)));var a={qty:o.length,total:o.map(function(t){return t.total}).reduce(function(t,e){return t+e},0)};return"FAMI"!==w(N)&&(a.onRemove=function(){return t.dispatch(S.getEligibleFareTypeForUpgrade()),t.dispatch(y.clearAllSeats())}),{items:o.length?[a]:[]}}()});var _=function(e){return{type:"breakfast-"+e.toLowerCase(),detail:function(){var n=N.filter(function(t){return"BREK"===t.code&&t.sold===I}),r=n.filter(function(t){return t.breakfastType===e}),o=r.filter(function(t){return t.total>0}).length,a=R.pipe(R.map(R.prop("breakfastType")),R.uniq,R.length)(n),i={qty:o,total:r.reduce(function(t,e){return t+e.total},0),onRemove:function(){a>1?t.dispatch(v.postBreakfasts(e)):t.dispatch(v.deleteBreakfasts())}};return{items:o?[i]:[]}}()}},V=function(e){return{type:"inflight-product-"+e,detail:function(){var n=R.filter(R.whereEq({code:e,sold:I}),N),r=R.pipe(R.filter(function(t){return t.total}),R.length)(n),o=R.reduce(function(t,e){return t+e.total},0,n),a={qty:r,total:o,onRemove:function(){t.dispatch(B.removeInflightProducts(e))}};return{items:r?[a]:[]}}()}},K=function(t){var e=R.filter(R.whereEq({code:t,sold:I}),N),n=R.pipe(R.filter(function(t){return t.total}),R.reduce(function(t,e){return t+e.qty},0))(e),r=R.reduce(function(t,e){return t+e.total},0,e),o={qty:n,total:r};return{type:"presell-product-"+t,detail:{items:n?[o]:[]}}},Y=["IRISH","ENGLISH","CONTINENTAL"];o=R.reduce(function(t,e){return R.append(_(e),t)},o,Y);var $=["ADTM","KIDM","AFTN","CHSE","FRUT","VMEA"];return o=R.reduce(function(t,e){return R.append(V(e),t)},o,$),o=R.reduce(function(t,e){return R.append(K(e),t)},o,M),o.push({type:"fasttrack",detail:function(){var e=R.pipe(R.filter(function(t){return"FAST"===t.type&&t.sold===I}))(N),n=e.filter(function(t){return t.total>0}).length,r={qty:n,total:e.reduce(function(t,e){return t+e.total},0),onRemove:function(){t.dispatch(c.removeAllFromBasket())}};return{items:n?[r]:[]}}()}),o.push({type:"priority-boarding",detail:function(){var e=R.filter(function(t){return"PRIOBRDNG"===t.type},N),n=e.filter(function(t){return t.total}).length,r={qty:n,total:e.reduce(function(t,e){return t+e.total},0),onRemove:function(){var e=t.getState().priorityBoarding.prices;t.dispatch(u.removeAll()),t.dispatch(u.removeAllLocal(e))}};return{items:n?[r]:[]}}()}),o.push({type:"insurance",detail:function(){var e=R.pipe(R.filter(function(t){return"INS"===t.code&&t.sold===I}))(N),n=["RYAN31","GADGET","ANNUAL2"],r=function(n){var r=e.filter(function(t){return t.itemId===n});return Object.assign({},{label:"trips.basket.group.insurance."+n,qty:r.map(function(t){return t.qty}).reduce(function(t,e){return t+e},0),total:r.map(function(t){return t.total}).reduce(function(t,e){return t+e},0),onRemove:function(){t.dispatch(l.removeAllInsurance(n)).then(function(){return t.dispatch(E.updateCurrencyConversionOffer())})}})},o=n.reduce(function(t,n){return e.some(function(t){return t.itemId===n})?t.concat(r(n)):t},[]);return{items:e.length>0?o:[]}}()}),o.push({type:"equip-baby",detail:function(){var e=R.pipe(R.filter(function(t){return"BABY"===t.type&&t.sold===I}))(N),n=e.reduce(function(t,e){return t+e.qty},0);return{items:n?[{label:"trips.basket.group.equipment.baby",qty:n,total:R.pipe(R.map(function(t){return t.total}),R.reduce(function(t,e){return t+e},0))(e),onRemove:function(){t.dispatch(s.removeAll("BABY","BABY"))}}]:[]}}()}),o.push({type:"equip-musc",detail:function(){var e=R.pipe(R.filter(function(t){return"MUSIC"===t.type&&t.sold===I}))(N),n=e.reduce(function(t,e){return t+e.qty},0);return{items:n?[{label:"trips.basket.group.equipment.music",qty:n,total:R.pipe(R.map(function(t){return t.total}),R.reduce(function(t,e){return t+e},0))(e),onRemove:function(){t.dispatch(s.removeAll("MUSC","MUSIC"))}}]:[]}}()}),o.push({type:"equip-sport",detail:function(){var e=R.pipe(R.filter(function(t){return"SPORTS"===t.type&&t.sold===I}))(N),n=R.sortBy(R.prop("code"),angular.copy(e)).reduce(function(t,e){var n=t;return n[0]&&n[0].code===e.code?["qty","vat","amt","total"].forEach(function(t){n[0][t]+=e[t]}):n.unshift(e),n},[]);return{items:n.map(function(e){return angular.extend({},e,{onRemove:function(){t.dispatch(s.removeAll(e.code,"SPORTS"))}})})}}()}),o.push({type:"transfer",detail:function(){var e=R.pipe(R.filter(function(t){return"TRANS"===t.src&&t.sold===I}))(N);return{items:e.map(function(e){return{label:"trips.extra.transfer.data."+e.provider+"-"+e.loc+"-"+e.itemId+".src",qty:e.qty,total:e.total,onRemove:function(){t.dispatch(H.removeSome(e.itemId))}}})}}()}),o.push({type:"parking",detail:function(){var e=R.pipe(R.filter(function(t){return"PARKING"===t.src&&t.sold===I}))(N);return{items:e.map(function(e){return{label:"navitaire.parking.provider.name."+e.itemId,qty:e.qty,total:e.total,onRemove:function(){t.dispatch(p.removeAll())}}})}}()}),o.push({type:"events",detail:{items:N.filter(function(t){return"ERROR"!==t.status&&t.type===C.ID}).map(function(t){return{label:t.qty+" x "+t.name,labelDefault:t.name,qty:t.qty,total:t.total,onRemove:function(){C.removeFromBasket(t.code)}}})}}),o.push({type:"name-change",detail:function(){var e=R.pipe(R.filter(function(t){return"NAME"===t.code&&t.sold===I}))(N);return{items:e.map(function(e){return{label:"trips.extra.basket."+e.code,qty:e.qty,total:e.total,onRemove:function(){t.dispatch(d.cancelNameChange())}}})}}()}),o.push({type:"change-flight",detail:function(){var n=R.pipe(R.filter(function(t){return"FLTCHG"===t.code&&t.sold===I}))(N),r=n.reduce(function(t,e){return babelHelpers["extends"]({},t,{qty:t.qty+e.qty,total:t.total+e.total})},{qty:0,total:0});return{items:0===n.length?[]:[{label:"trips.extra.basket.change-flight",qty:r.qty,total:r.total,onRemove:function(){t.dispatch(m.refresh("booking.active",!0,!0)).then(function(){e.go("booking.active",{},{reload:!0}),t.dispatch(g.resetChangeFlight())})}}]}}()}),o.push({type:"voucher",detail:function(){var t=R.pipe(R.filter(function(t){return~["VHF","VCR"].indexOf(t.code)&&t.sold===I}))(N),e=t.find(function(t){return"VCR"===t.code})||{total:0},n=e.total;return{total:n,items:t.map(function(t){var e={code:t.code,label:"trips.extra.voucher."+t.code,qty:t.qty,total:t.total};return"VCR"===t.code&&(e.subitems=[]),e}).sort(function(t){return"VHF"===t.code?1:0})}}()}),o.push({type:"redeemed-voucher",detail:function(){var e=R.pipe(R.pathOr([],["payments"]),R.map(function(t){return t.model}),R.filter(function(t){return"VO"===t.code&&"Approved"!==t.status}))(r);return{items:e.map(function(e){return{code:e.code,number:e.accNum,currency:e.currency,amt:-e.amt,isReward:e.isReward,dccApplicable:e.dccApplicable,onRemove:function(){t.dispatch(f.remove(e.accNum)).then(function(){return U()})}}})}}()}),o.push({type:"redeemed-travel-credit",detail:function(){var e=R.pipe(R.map(function(t){return t.model}),R.filter(function(t){return t.code===D.CODE&&"Approved"!==t.status}))(n.getTravelCredits(r));return{items:e.map(function(e){return{code:e.code,number:e.accNum,currency:e.currencyCode,amt:-e.amt,onRemove:function(){t.dispatch(T.remove(e.code)).then(function(){return U()})}}})}}()}),o.push({type:"sms-fees",label:!1,detail:function(){var t=R.filter(function(t){return t.code===x.SMS&&t.sold===I},N),e=t.map(function(t){return{qty:1,total:t.total,label:"trips.fees.extras.SMS"}});return{items:e}}()}),o.push({type:"co-fees",label:!1,detail:function(){var t=R.filter(function(t){return t.code===x.CARBON&&t.sold===I},N),e=t.map(function(t){return{qty:1,total:t.total,label:"trips.fees.extras.CARB"}});return{items:e}}()}),o.push({type:"ispcc-fees",label:!1,detail:function(){var t=R.pipe(R.filter(function(t){return t.code===x.ISPCC&&t.sold===I}),R.map(function(t){return{qty:1,total:t.total,label:"trips.fees.extras.ISPCC"}}))(N);return{items:t}}()}),o.push({type:"ground-transfers",detail:function(){var t=function(){return n.addedTransfer(r)}();return{items:t.map(function(e){return{isRyanairMor:e.config.mor,transferType:e.transferType,tripType:e.tripType,from:e.pickup.location.label,pickup:e.pickup.location.name,to:e.dropoff.location.label,dropoff:e.dropoff.location.name,code:"ADT",qty:e.passengers.adults,total:e.price.total.amount,paxLabel:e.paxLabel,onRemove:function(){q.removeFromBasket(t)}}})}}()}),o.push({type:"payment-fee",label:!1,detail:function(){var t=void 0,n=void 0;if(e.is("vouchers.summary"))t=R.reduce(function(t,e){return t+e.model.amt},0,r.fees);else{var o=F.getCorporateCardFee(A),a=F.getCorporateCardFeeRate(A);n=R.multiply(100)(a).toFixed(2),t=G.totalPriceToShow()<=o?0:o}var i=[];return t&&i.push({qty:1,total:t,feeRate:n,label:"trips.fees.payment_fee"}),{items:i}}()}),o}()},{id:"hotels",order:3,totalIconPopup:!0,totalMessage:!0,showSubtotal:!0,products:[{type:"accommodation",detail:Object.assign(function(){var t=o.currentBooking;return{providerId:t.providerId,hotelName:t.hotelName,hotelTotalCost:t.hotelTotalCost,hotelCurrency:t.hotelCurrency,startDate:t.startDate,endDate:t.endDate,nights:t.lengthOfStay,roomAllocations:t.roomAllocations}}(),o.currentBooking.roomSelection),model:{total:o.total,totalPriceInHotelCurrency:o.getTotalPriceInHotelCurrency()},onRemove:function(){o["delete"]().then(function(){var e=b.get("RoomsDetailsActions");t.dispatch(e.removeFromBasket()),t.dispatch(e.clearPaymentOption()),t.dispatch(e.bundleRemoveAllElements())})["catch"](function(){})}}],model:o},{id:"cars",order:2,totalIconPopup:!0,model:babelHelpers["extends"]({},n.carBasketModel(r)),showSubtotal:!0,products:[{type:"carhire",detail:{items:[].concat(babelHelpers.toConsumableArray(n.addedCarHire(r)))},onRemove:function(){var t=n.addedCarHire(r);k.removeFromBasket(t)}}]}];return N[0].vouchersApplied=N[0].products.some(function(t){return"redeemed-voucher"===t.type&&t.detail.items.length}),N[0].travelCreditApplied=N[0].products.some(function(t){return"redeemed-travel-credit"===t.type&&t.detail.items.length}),N}}]);


"use strict";angular.module("app.booking").service("ConfirmationBannerService",["$timeout","$ngRedux","NameChangeActions",function(e,o,n){function t(){c.popover=angular.copy(i),o.dispatch(n.removeResponsePassengers())}var r=this,i={title:"",body:"",values:{},declined:!1,confirmed:!1,visible:!1},c={title:"",body:"",values:{},alerted:!1,confirmed:!1,locked:!1,errored:!1,visible:!1,companions:0,companionsFailed:!1,popover:R.clone(i)},s=!1,d=void 0,u=void 0;return{show:function(){s=!0,c.visible=!0},hide:function(){s=!1,c.visible=!1},confirm:function(e,o,n){return r.reset(),c.confirmed=!0,c.title=e,o&&(c.body=o),n&&Object.keys(n).forEach(function(e){c[e]=n[e]}),r},alert:function(e,o,n){return r.reset(),c.alerted=!0,c.title=e,o&&(c.body=o),n&&Object.keys(n).forEach(function(e){c[e]=n[e]}),r},hold:function(e,o,n){return r.reset(),c.locked=!0,c.title=e,o&&(c.body=o),n&&Object.keys(n).forEach(function(e){c[e]=n[e]}),r},popOver:function(o){var n=function(e,o){R.hasIn(o,R.pathOr({},["popover"],c))&&(c.popover[o]=e)};R.forEachObjIndexed(n,o),e(function(){c.popover.visible=!0},0),e(t,5e3)},showPopover:function(){c.popover.visible=!0},hidePopover:function(){c.popover.visible=!1},setPopover:function(e){c.popover=e},getMessage:function(){return c},isVisible:function(){return s},setAlerted:function(){c.alerted=!0,c.confirmed=!1,c.locked=!1,c.errored=!1},setErrored:function(){c.alerted=!1,c.confirmed=!1,c.locked=!1,c.errored=!0},setConfirmed:function(){c.alerted=!1,c.confirmed=!0,c.locked=!1,c.errored=!1},setLocked:function(){c.alerted=!1,c.confirmed=!1,c.locked=!0,c.errored=!1},setNormal:function(){c.alerted=!1,c.confirmed=!1,c.locked=!1,c.errored=!1},setTitle:function(e){c.title=e},setSecondTitle:function(e){c.secondTitle=e},setBody:function(e){c.body=e},setValue:function(e,o){c.values[e]=o},setValues:function(e){c.values=e},resetValues:function(){c.values={}},reset:function(){r.hide(),c.values={},c.alerted=!1,c.confirmed=!1,c.locked=!1,c.errored=!1,r.setBody(""),r.setSecondTitle(""),r.setTitle(""),c.popover=angular.copy(i)},getPassengersSavedToCompanions:function(){return d},setPassengersSavedToCompanions:function(e){d=e},getFailedToSaveCompanions:function(){return u},setFailedToSaveCompanions:function(e){u=e}}}]);


"use strict";angular.module("app.booking").service("ConnectingFlightService",["Stations",function(e){var n=function(n){return R.pipe(R.pathOr([],["segments"]),R.head,R.pathOr("",["model","dest"]),e.getCityName.bind(e))(n)},t=function(e){return R.pathOr(0,["segments","length"],e)>1};return{getConnectingCityByLeg:n,isConnectingLeg:t}}]);


"use strict";angular.module("app.booking").service("GutterBannerService",["Dates","DateConfig","MarketConfig","SiteConfiguration","BookingRead","LEG_TYPE","$window","CAR_RENTAL_SUPPORTED_LANGUAGES","Utilities","$interpolate","CAR_RENTAL_ADPLAT",function(a,e,r,o,t,i,n,s,d,u,p){this.openCarHireTab=function(l){var m=r.getMarket().split("-"),f=babelHelpers.slicedToArray(m,2),y=f[1],g=s.find(function(a){return a===r.getLanguage().toLowerCase()||a===y.toLowerCase()}),c=u(o.get("carRentalSearchUrl"))({operator:r.isLaudaMotion()?"laudamotion":"ryanair"}),C=t.getModel("journeys",l)[i.outbound],A=t.getModel("journeys",l)[i.inbound],D=a.parseISOFull(C.arrive).add(30,"minutes"),L=A?a.parseISOFull(A.depart).subtract(2,"hours"):a.parseISOFull(D).add(1,"days"),F={preflang:g||"en",puDay:a.parse(D).format(e.displayFormats.dayTwoDigits),puMonth:a.parse(D).format(e.displayFormats.month),puYear:a.parse(D).format(e.displayFormats.year),puHour:a.format(D,"HH"),puMinute:a.format(D,"mm"),doDay:a.parse(L).format(e.displayFormats.dayTwoDigits),doMonth:a.parse(L).format(e.displayFormats.month),doYear:a.parse(L).format(e.displayFormats.year),doHour:a.format(L,"HH"),doMinute:a.format(L,"mm"),driversAge:30,prefcurrency:t.getBookingCurrency(l),affiliateCode:"ryanair",from:t.getDestCityCode(l),to:t.getDestCityCode(l),adplat:p.LEADERBOARD},M=n.open("","_blank");M.location.href=c+"?"+d.serialize(F)}}]);


"use strict";angular.module("app.booking").constant("CHANGE_NAME_ACTION_TYPES",{CHANGE_NAME_MODEL_ALREADY_EXIST:"[ChangeName] change name model already exist",CHANGE_NAME_SETUP_MODEL:"[ChangeName] setup change name model with initial data",REGISTER_NEW_CHANGE:"[ChangeName] register new pax change",RESET_PAX_CHANGE:"[ChangeName] reset pax name change request",PRICE_UPDATED:"[ChangeName] update total price",CHANGE_NAME_UPDATE_AVOIDED:"[ChangeName] change name update avoided",CHANGE_NAME_UPDATE_START:"[ChangeName] change name requested",CHANGE_NAME_UPDATE_SUCCESS:"[ChangeName] change name succedded",CHANGE_NAME_UPDATE_FAILED:"[ChangeName] change name failed",CHANGE_NAME_RESET:"[ChangeName] cancel change name requested",CHANGE_NAME_REVERTED:"[ChangeName] change name reverted",CHANGE_NAME_RESET_FAILED:"[ChangeName] cancel change name failed",FEES_REQUESTED:"[ChangeName] change name fees requested",FEES_RECEIVED:"[ChangeName] change name fees received",FEE_REQUEST_AVOIDED:"[ChangeName] change name fees request avoided",FEES_REQUEST_FAILED:"[ChangeName] change name fees request failed",TOGGLE_CONFIRMATION_BANNER:"[ChangeName] toggle confirmation banner on active trip page",REMOVE_RESPONSE_FROM_MODEL:"[ChangeName] clean response value from NameChange model",SET_NAME_CHANGE_BTN_TYPE:"[ChangeName] set name change button type",CHECK_PRICE_START:"[ChangeName] check price started",CHECK_PRICE_SUCCESS:"[ChangeName] check price succedded",CHECK_PRICE_FAILED:"[ChangeName] check price failed",RESET_BTN_TYPE:"[ChangeName] reset button type"});


"use strict";angular.module("app.booking").service("NameChangeActions",["CHANGE_NAME_ACTION_TYPES","$state","$http","RezApiConfig","$log","BasketMessageQueue","BookingModelActions","ModelQuery","$ngRedux","$q","NameChangeUtils",function(e,a,n,t,r,o,i,g,s,E,p){return{saveChanges:function(o){var i=this;return function(g,s){var u=R.path(["nameChange"],s()),h=p.getPaxesForUpdate(u);if(0===h.length)return g({type:e.CHANGE_NAME_UPDATE_AVOIDED}),E.when([]);g({type:e.CHANGE_NAME_UPDATE_START});var c="check_price"===o;c&&g({type:e.CHECK_PRICE_START});var C=c?t.nameChangeCheckPrice:t.nameChange;return n({method:"POST",url:C,data:{passengers:h}}).then(function(n){var t=n.data,r=R.path(["bookingModel"],s()),o=p.isOnlyInfantsWereChanged(r,u),E=p.getUpdatedPaxAndFees(t.passengers,r),h={passengers:E.passengers,paxFees:E.paxFees};if(o&&(h.response=t),c)g(i.setNameChangeBtnType("confirm")),g({type:e.CHECK_PRICE_SUCCESS,payload:t.passengers}),g(i.recalculatePrice());else{g({type:e.CHANGE_NAME_UPDATE_SUCCESS,payload:h});var C=R.path(["nameChange"],s());p.pushMessage(C),g(i.toggleNameChangeConfirmaionBanner(!0,o)),a.go("booking.active",{displayTooltipNameChange:!t.passengers.map(function(e){return e.paxFees.length}).every(Boolean)},{reload:!0})}})["catch"](function(a){return r.warn(e.CHANGE_NAME_UPDATE_FAILED,": ",a),g({type:e.CHANGE_NAME_UPDATE_FAILED,payload:a.data}),c&&g({type:e.CHECK_PRICE_FAILED,payload:a.data}),[]})}},cancelNameChange:function(){var a=this;return function(o){return o({type:e.CHANGE_NAME_RESET}),n["delete"](t.nameChange).then(function(n){o({type:e.CHANGE_NAME_REVERTED,payload:n}),o(a.toggleNameChangeConfirmaionBanner(!1)),o(i.refresh("",!1,!0))})["catch"](function(a){return r.warn(e.CHANGE_NAME_RESET_FAILED,": ",a),o({type:e.CHANGE_NAME_RESET_FAILED,payload:a.data}),[]})}},getFee:function(){var a=this;return function(o){o({type:e.FEES_REQUESTED}),n.get(t.nameChange).then(function(n){var t={fees:n.data.changeNameFeePrices.map(function(e,a){return{fee:e,isFree:n.data.freeChangeForPassengerAvailability[a],freeChangePeriodEnds:n.data.freeChangePeriodEnds,isGroupBooking:R.pathOr(!1,["isGroupBooking"],n.data)}}),gracePeriodChange:R.pathOr({},["gracePeriodChange"],n.data),isGroupBooking:R.pathOr(!1,["isGroupBooking"],n.data),groupBookingChange:R.pathOr(!1,["groupBookingChange"],n.data),minorChange:R.pathOr(!1,["minorChange"],n.data)};return o({type:e.FEES_RECEIVED,payload:t}),o(a.recalculatePrice()),t})["catch"](function(a){return r.warn(e.FEES_REQUEST_FAILED,": ",a),o({type:e.FEES_REQUEST_FAILED,payload:a.data}),[]})}},recalculatePrice:function(){return function(a,n){var t=R.pathOr({},["nameChange"],n()),r={price:p.calcPrice(t)};a({type:e.PRICE_UPDATED,payload:r})}},setupChangeNameModel:function(){var a=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!1;return function(t,r){if(!n&&R.pathOr(!1,["nameChange","modelCreated"],r()))return void t({type:e.CHANGE_NAME_MODEL_ALREADY_EXIST});var o=R.path(["bookingModel"],r()),i={origPax:p.getOriginalPaxes(o),curPax:p.getOriginalPaxes(o)},g=p.listOfChangedName(o,i),s=R.assoc("registry",g,i);t({type:e.CHANGE_NAME_SETUP_MODEL,payload:s}),t(a.getFee())}},registerPaxChange:function(a,n,t,r){return function(o,i){var g=R.path(["nameChange"],i()),s=!R.equals(n.name,R.path(["origPax",a,"name"],g))||!R.equals(n.inf,R.path(["origPax",a,"inf"],g)),E={disableConfirm:!t||!r,curPax:R.update(a,n,R.pathOr([],["curPax"],g)),registry:R.update(a,s,R.pathOr([],["registry"],g))};o({type:e.REGISTER_NEW_CHANGE,payload:E})}},toggleNameChangeConfirmaionBanner:function(a){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1;return{type:e.TOGGLE_CONFIRMATION_BANNER,payload:{isPaxNameChangeBannerShown:a,onlyInfNamesChanges:n}}},removeResponsePassengers:function(){return{type:e.REMOVE_RESPONSE_FROM_MODEL,payload:{response:null}}},resetPaxChange:function(a,n){var t=this;return function(r,o){var i=R.path(["nameChange"],o()),g=R.path(["curPax",a],i),s=R.pathOr({},["origPax",a,"inf"]),E=R.pathOr({},["origPax",a,"name"]),p=R.assocPath(["inf"],s(i)),u=R.assocPath(["name"],E(i)),h=n?p(g):u(g),c=R.update(a,h,R.pathOr([],["curPax"],i)),C=R.equals(i.origPax,c),l=!R.equals(h.name,R.path(["origPax",a,"name"],i))||!R.equals(h.inf,R.path(["origPax",a,"inf"],i)),_={disableConfirm:C,curPax:c,registry:R.update(a,l,R.pathOr([],["registry"],i))};r({type:e.RESET_PAX_CHANGE,payload:_}),r(t.recalculatePrice())}},setNameChangeBtnType:function(a){return function(n){n({type:e.SET_NAME_CHANGE_BTN_TYPE,payload:a})}},resetBtnType:function(){return{type:e.RESET_BTN_TYPE}}}}]);


"use strict";angular.module("app.booking").factory("NameChangeReducer",["CHANGE_NAME_ACTION_TYPES",function(e){var n={modelCreated:!1,getFees:!1,disableConfirm:!0,response:null,origPax:null,curPax:null,price:0,adultChange:[],infantChange:[],fees:null,names:{},registry:[],isPaxNameChangeBannerShown:!1,onlyInfNamesChanges:!1,minorChange:{},isGroupBooking:!1,groupBookingChange:{},gracePeriodChange:{},btnType:"check_price",btnKey:"trips.side.check_price",showInfoSection:!1,updatedPassengers:[]};return function(){var s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,r=arguments[1],a=r.type,E=r.payload;switch(a){case e.CHANGE_NAME_SETUP_MODEL:return babelHelpers["extends"]({},s,E,{modelCreated:!0,updatedPassengers:[],disableConfirm:!0,btnType:"check_price",btnKey:"trips.side.check_price"});case e.FEES_REQUESTED:return babelHelpers["extends"]({},s,{getFees:!1});case e.FEE_REQUEST_AVOIDED:return babelHelpers["extends"]({},s,{getFees:!0});case e.SET_NAME_CHANGE_BTN_TYPE:return babelHelpers["extends"]({},s,{btnType:E,btnKey:"trips.side."+E,showInfoSection:"confirm"===E});case e.CHECK_PRICE_START:return babelHelpers["extends"]({},s,{isLoading:!0});case e.CHECK_PRICE_SUCCESS:return babelHelpers["extends"]({},s,{updatedPassengers:E,isLoading:!1});case e.FEES_RECEIVED:return babelHelpers["extends"]({},s,E,{getFees:!0});case e.REGISTER_NEW_CHANGE:case e.PRICE_UPDATED:case e.CHANGE_NAME_UPDATE_SUCCESS:case e.REMOVE_RESPONSE_FROM_MODEL:case e.TOGGLE_CONFIRMATION_BANNER:case e.RESET_PAX_CHANGE:return babelHelpers["extends"]({},s,E);case e.CHANGE_NAME_UPDATE_FAILED:case e.CHECK_PRICE_FAILED:case e.CHANGE_RESET_FAILED:return babelHelpers["extends"]({},s,{modifyBookingModelError:E,isLoading:!1});case e.RESET_BTN_TYPE:return babelHelpers["extends"]({},s,{btnType:"confirm",btnKey:"trips.side.confirm",showInfoSection:!1});default:return s}}}]);


"use strict";angular.module("app.booking").service("NameChangeUtils",["BasketMessageQueue","Passengers","Dates","ModelQuery",function(e,n,t,r){var a={checkAttribute:function(e,n){return function(t){var r=["first","last","title"],a=R.eqProps(R.__,e,n),u=R.complement(a),s=R.complement(R.equals),i=R.compose(R.all(a),R.filter(s(t)));return R.and(i(r),u(t))}},checkAreNamesSwitched:function(e,n){var t=R.all(R.identity),r=R.prop("first"),a=R.prop("last");return t([R.equals(r(e),a(n)),R.equals(r(n),a(e)),R.eqProps("title",e,n)])},checkIsFreeNameChange:function(e,n){var t=R.apply(R.__,[e,n]),r=t(a.checkAttribute),u=R.any(R.identity),s=t(angular.equals),i=t(a.checkAreNamesSwitched);return u([s,r("first"),r("last"),i])},onlyInfantInPaxChanged:function(e,n){return!R.equals(e.inf,n.inf)&&R.equals(e.name,n.name)},getPaxCurrentFee:function(e,n,t){var a=R.pipe(r.byIdentity("paxFees"),r.byKey({passengers:R.path([e,"num"],n.curPax)}),r.byModel({code:"NAME",sold:!1}),R.head)(t);return a?R.pathOr(0,["model","total"],a):0},calcPrice:function(e){var n=R.path(["updatedPassengers"],e);return n.reduce(function(e,n){return e+n.paxFees.reduce(function(e,n){return e+n.total},0)},0)},getUpdatedPaxAndFees:function(e,n){var t=function(n){var t=R.pathOr({},["model"],n),r=R.find(R.propEq("paxNum",R.path(["num"],t)))(e);return r?R.set(R.lensPath(["model"]),R.merge(t,r),n):n},a=function(e){var n=R.pathOr({},["paxFees",0],e);return{identity:"paxFees",key:{journeys:R.pathOr(0,["journeyNum"],n),segments:R.pathOr(0,["segmentNum"],n),passengers:e.num},model:n}},u=R.pipe(r.byIdentity("passengers"),R.map(t))(n),s=R.map(a,e);return{passengers:u,paxFees:s}},pushMessage:function(t){var r=[];t.curPax.forEach(function(e,n){R.equals(e.name,t.origPax[n].name)||r.push(e.name),e.inf&&!R.equals(e.inf,t.origPax[n].inf)&&r.push(e.inf)}),r.length>0&&e.enqueue({code:"PASSANGER_UPDATED",names:r,titles:n.titles})},getPaxesForUpdate:function(e){var n=function(n){return R.pathOr(!1,["registry",n.num],e)},t=function(e){var n={paxNum:R.pathOr("",["num"],e),type:R.pathOr("",["type"],e),name:R.clone(R.pathOr({},["name"],e))};return e.inf&&(n.inf=R.clone(R.pathOr({},["inf"],e))),n};return R.pipe(R.path(["curPax"]),R.filter(n),R.map(t))(e)},getOriginalPaxes:function(e){var n=function(n){var t=R.pipe(r.byIdentity("checkin"),r.byKey({passengers:n.key.id}),r.byModel({status:"reprint"}),r.hasAny)(e);return babelHelpers["extends"]({},n.model,{isCheckedIn:t})};return R.pipe(r.byIdentity("passengers"),R.map(n))(e)},isOnlyInfantsWereChanged:function(e,n){var t=function(e){return R.pathOr(!1,["registry",e.num],n)},u=function(n){return R.pipe(r.byIdentity("passengers"),r.byKey({id:n.num}),R.pluck("model"),R.head)(e)},s=function(e){var n=u(e);return a.onlyInfantInPaxChanged(n,e)};return R.pipe(R.path(["curPax"]),R.filter(t),R.map(s),R.all(R.equals(!0)))(n)},listOfChangedName:function(e,n){var t=function(n){return R.pipe(r.byIdentity("passengers"),r.byKey({id:n.num}),R.head,R.pathOr({},["model","name"]),R.complement(R.equals(R.pathOr({},["name"],n))))(e)},u=function(t){return a.getPaxCurrentFee(t,n,e)>0},s=function(e){return R.or(t(e),u(e.num))};return R.map(s,n.origPax)},isChanged:function(e){return R.pipe(r.byIdentity("paxFees"),r.byModel({code:"NAME",sold:!1}),r.hasAny)(e)}};return a}]);


"use strict";angular.module("app.booking").factory("FlightSpecialAssistanceAvailability",function(){var t=function e(t,s){babelHelpers.classCallCheck(this,e),this.assistance=t||[],this.wheelchair=s||[],this.isDepartureDateNear=this.assistance.length&&this.assistance.some(function(t){return t.isDepartureDateNear})||this.wheelchair.length&&this.wheelchair.some(function(t){return t.isDepartureDateNear}),this.travelsWithInfant=this.assistance.length&&this.assistance.some(function(t){return t.travelsWithInfant})||this.wheelchair.length&&this.wheelchair.some(function(t){return t.travelsWithInfant})};return t});


"use strict";angular.module("app.booking").factory("PassengerSpecialAssistance",["SpecialAssistanceType",function(e){var s={assistanceTypeCode:"",wheelchairAssistance:{isRequired:!1,wheelchairTypeCode:""}},a=function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s;babelHelpers.classCallCheck(this,n),this.isRequired=e,this.outbound=a,this.inbound=t};return a}]);


"use strict";angular.module("app.booking").factory("SpecialAssistanceService",["$http","$log","AEMConfig","RezApiConfig","SpecialAssistanceType","FlightSpecialAssistanceAvailability",function(e,t,n,a,s,i){var r=n.getSpecialAssistanceTypesUrl(),c=function(){function n(){babelHelpers.classCallCheck(this,n)}return n.prototype.getAssistanceTypes=function(){var n=this;return e.get(r,{cache:!0}).then(function(e){n.assistanceTypes=e.data},function(e){t.warn(e)})},n.prototype.getAssistanceAvailability=function(t){return e.get(a.specialAssistance).then(function(e){var n=R.addIndex(R.map),a=R.ifElse(R.equals(0),R.always("outbound"),R.always("inbound")),r=function(e,t){return R.assoc("type",a(t),e)},c=n(r,e.data.specialAssistance),u=function(e){return function(t){return new s(e,t.code,t.nest,t.available,t.childPrms)}},o=t.map(function(e,t){return c.map(function(e){var n=u(t),a=R.map(n,e.assistance);a.unshift(s.NotRequired);var r=R.map(n,e.postural);a.push({code:"posturalContainer",isAssistanceContainer:!0,childPrms:r});var c=R.map(n,e.wheelchair);return new i(a,c)})});return o.areAllFlightsDepartureDatesNear=o.some(function(e){return e.length&&e.every(function(e){return e.isDepartureDateNear})}),o})["catch"](function(e){return e||{}})},n}(),u=new c;return u.getAssistanceTypes(),u}]);


"use strict";angular.module("app.booking").factory("SpecialAssistanceType",function(){var e=function(){function e(t,i,a,s){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:!1;babelHelpers.classCallCheck(this,e),this.code=i,this.nestCode=a,this.availabilityCode=s[t],this.isAssistanceContainer=!1,this.requiresWheelchair=n,this.childPrms=r.map(function(i){return new e(t,i.code,i.nest,i.available,i.childPrms,i.requiresWheelchair)}),this.isUnavailable="PRMNotAvailable"===s[t],this.isDepartureDateNear="DepartureTimeLimit"===s[t],this.areGuideDogsAllowed="GuideDogsInvalidJourney"!==s[t],this.travelsWithInfant="PRMwithInfants"===s[t],this.isSeatRestricted="PRMSeatRestriction"===s[t],this.isSeatAvailable="PRMNoSeatsAvailable"!==s[t]}return babelHelpers.createClass(e,null,[{key:"NotRequired",get:function(){return new e(0,"NORQ","",["Ok"])}}]),e}();return e});


"use strict";angular.module("app.booking").service("SpecialAssistanceUtils",["SpecialAssistanceType",function(e){var n=function(e,n){return R.reduce(function(t,s){return R.assoc(e[s]||s,n[s],t)},{},R.keys(n))};return{getNestedSpecialAssistance:function(e,n){return n.childPrms.find(function(n){return R.contains(n.code,e)})},getSpecialAssistance:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],s=void 0,r=n.length>=3;if(r){var i=t.assistance.filter(function(e){return R.contains(e.code,n)});s=i.find(function(t){return e.getNestedSpecialAssistance(n,t)})}else s=t.assistance.find(function(e){return R.contains(e.code,n)})||t.assistance.find(function(e){return e.isAssistanceContainer}).childPrms.find(function(e){return R.contains(e.code,n)});return s},getSpecialAssistanceFromModel:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments[1];return this.getSpecialAssistance(e,R.path(["model"],n))},getWheelchairFromModel:function(e,n){return R.pathOr([],["model","wheelchair"],n).find(function(n){return R.contains(n.code,e)})},renamePaxNum:function(e){return n({num:"paxNum"},e)},getPassengersSpecialAssistancePayload:function(n,t){var s=function(e,n,t){return{journeyNum:n,segmentNum:t,sold:!0,type:"",code:e,qty:1,vat:0,amt:0,total:0}};return n.map(function(n){return t.prms.filter(function(e){return e.key.passengers===n.key.id}).reduce(function(r,i){var c=r,a=[];return t.SARequired[n.key.id].model&&(i.model.assistanceType.code&&i.model.assistanceType.code!==e.NotRequired.code&&a.push(s(i.model.assistanceType.code,i.key.journeys,i.key.segments)),i.model.wheelchairSelector.wheelchairType.code&&i.model.wheelchairRequired&&a.push(s(i.model.wheelchairSelector.wheelchairType.code,i.key.journeys,i.key.segments)),i.model.wheelchairSelector.assistanceType.code&&i.model.wheelchairRequired&&a.push(s(i.model.wheelchairSelector.assistanceType.code,i.key.journeys,i.key.segments))),c.SegPRM=c.SegPRM.concat(a),c},{SegPRM:[]})})}}}]);


"use strict";angular.module("app.booking").service("TripTypeService",["$http","$q","$ngRedux","BookingRead","Dates","SegmentApiConfig","FARE_TYPES","REQUEST_AREA",function(e,r,t,a,i,u,n,s){var p=function(){return R.pathOr(!0,["launchDarkly","segmentation-enabled"],t.getState())},o=function(e){var r=a.isPotentialBooking(e),t=a.isBooked(e);return r?s.POTENTIAL:t?s.ACTIVE:s.HOMEPAGE},c=function(e){var r=R.pipe(a.getPassengerBreakdownAsObject,R.mapObjIndexed(R.flip(R.repeat)),R.values,R.flatten)(e),t=R.pipe(a.getFlightsDeparturesTime,R.map(i.utc))(e),u=o(e);return{price:{currencyCode:R.path(["curr"],a.getBookingInfo(e)),value:a.getFaresCostFor(e)},departureAirportCode:a.getOriginCityCode(e),arrivalAirportCode:a.getDestCityCode(e),outboundDepartureDate:t[0],inboundDepartureDate:t[1],passengerTypes:r,requestArea:u}},d=R.ifElse(R.isNil,function(){var e=new Error;throw e.message="Preflight Request failed",e.message},R.identity),l={tripType:"NONE",subTripType:"NONE"},g=function(e){if(!R.isEmpty(R.pathOr([],["fares"],e))){var r=a.isBooked(e),t=r?a.isRegularPurchased(e):!1,i=r?a.isLeisurePlusPurchased(e):a.hasLeisurePlus(e),u=r?a.isBusinessPlusPurchased(e):a.hasBusinessPlus(e),s=a.isConnectingFlight(e),p=r?a.isFamilyPlusPurchased(e):a.hasFamilyPlus(e),o=a.isErasmus(e),c=[{type:n.BUSINESS_PLUS,active:u},{type:n.LEISURE_PLUS,active:i&&!u&&!t},{type:n.FAMILY_PLUS,active:p&&!i&&!u&&!t},{type:n.REGULAR,active:t&&!i&&!u},{type:n.ERASMUS,active:o&&!i&&!u&&!p&&!t},{type:n.CONNECTING_FLIGHT,active:s&&!i&&!u&&!p&&!o&&!t},{type:n.STANDARD,active:!(s||i||u||p||o||t)}];return R.pipe(R.filter(function(e){var r=e.active;return r}),R.head,R.prop("type"))(c)}},y={},v=function(t){var a=t.departureAirportCode,n=t.arrivalAirportCode,o=t.outboundDepartureDate,c=t.inboundDepartureDate,g=t.passengers;if(!o&&!c||!p())return r.resolve(l);var v=s.HOMEPAGE,f=R.pipe(R.pickBy(R.gt(R.__,0)),R.keys)(g),E={departureAirportCode:a,arrivalAirportCode:n,outboundDepartureDate:i.utc(i.formatISOFull(o)),inboundDepartureDate:c?i.utc(i.formatISOFull(c)):void 0,passengerTypes:f,requestArea:v};if(R.equals(y.payload,E))return y.request;var T=e.post(u.tripTypes,E).then(function(e){var r=e.data;return d(r)})["catch"](function(){return l});return y={payload:E,request:T},T},f=function(t){if(R.isEmpty(R.pathOr([],["fares"],t))||!p())return r.resolve(l);var a=c(t);return e.post(u.tripTypes,a).then(function(e){var r=e.data;return d(r)})["catch"](function(){return l})};return{getSegmentPayload:c,getFareType:g,getTripType:f,getTripTypeForFareSelect:v}}]);


"use strict";angular.module("app.booking").component("crossSellingInsuranceCard",{template:'<div ng-include="::$ctrl.template"></div>',bindings:{passengers:"<",insurance:"<",extra:"<",language:"<",isMobile:"<",isLaptop:"<",isActiveChoice:"<",isItalianMarket:"<",hasDiscount:"<",originCountryCode:"<",brexitAffectedJourneyFrom:"<",showError:"<",onGetOffersForAllPassengers:"&",onAddInsuranceFor:"&",onConfirmInsurance:"&",onConfirmInsuranceRemoval:"&",onReset:"&",onMakeChoice:"&",onUnmakeChoice:"&"},controller:function(){function e(n,i,s,t,r,o,a,c){babelHelpers.classCallCheck(this,e),this.InsuranceLinkService=c,this.staticFilePrefix=i.getStaticFilePrefix(),this.marketCountry=n.getCountry().toUpperCase(),this.insurancePlusEnabled=s["insurance-plus-on-payment-page-enabled"],this.isToggleDisabled=!0,this.insuranceType=this.insurancePlusEnabled?t.insurancePlus:t.insurance,this.insuranceRefundText=n.isCurrentMarket("en-ie")||n.isCurrentMarket("en-gb")?"refund_and_gadget":"refund",this.benefits=[{text:"trips.extra.cross-selling.insurance.personal_belongings",icon:"glyphs.baggage"},{text:"trips.extra.cross-selling.insurance.cancellation",icon:"glyphs.empty-state-flight"},{text:"trips.extra.cross-selling.insurance.medical_expenses",icon:"glyphs.first-aid"}],this.isCheckinFlow=r.is("booking.active.checkin.insurance"),this.InsurancePolicyLink=o,this.$ngRedux=a,this.hasInsuranceOffers=!0}return e.$inject=["MarketConfig","AEMConfig","FEATURE_CONFIG","INSURANCE_TYPES","$state","InsurancePolicyLink","$ngRedux","InsuranceLinkService"],e.prototype.handleSelectionChanges=function(){var e=R.equals(R.path(["selectedOffers","length"],this.insurance),R.prop("length",this.passengers)),n=R.not(R.prop("isSelectionConfirmed",this.insurance))&&e&&this.isOpened;this.isToggleDisabled=R.not(e)&&R.not(this.isOpened),n&&this.onConfirmInsurance()},e.prototype.handleBasketRemoval=function(){this.isOpened=!1,this.onConfirmInsuranceRemoval(),this.isActiveChoice&&this.dismissInsurance()},e.prototype.setCountryPolicies=function(){var e=this,n=R.pipe(R.when(R.equals("GB"),function(){return"UK"}),R.when(R.equals("BE"),function(){return"BE_FR"}),R.toLower),i=function(i){return R.pipe(R.filter(R.whereEq({code:i})),R.reject(R.isEmpty),R.map(function(e){var i=e.code,s=e.name;return{flag:i.toLowerCase(),code:n(i),name:s}}),R.head)(R.propOr([],"countries",e.insurance))};this.policy=R.pipe(R.prop("paxCORs"),R.uniq,R.map(i),R.head)(this.insurance),this.policyQueryParams=this.policy&&this.InsurancePolicyLink.getQueryParams(this.policy.flag)},e.prototype.onToggle=function(e){this.isOpened=e,this.showDetails=1===this.passengers.length,e?this.handleSelectionChanges():this.onConfirmInsuranceRemoval()},e.prototype.addInsurance=function(){this.onMakeChoice(),this.onToggle(!0)},e.prototype.dismissInsurance=function(){this.onMakeChoice()},e.prototype.removeInsurance=function(){this.onToggle(!1),this.dismissInsurance()},e.prototype.toggleShowDetails=function(){this.showDetails=!this.showDetails},e.prototype.$onInit=function(){this.showDetails=1===this.passengers.length,this.headerTranslationKey=this.isActiveChoice?"trips.extra.cross-selling.insurance.please-protect":"trips.extra.cross-selling.insurance.protect-my-trip",this.discountFormat=R.cond([[R.equals("en"),R.always('<span class="csi-card__discount-info-bold">50</span>%\n            <span class="csi-card__discount-info-off">OFF</span>')],[R.T,R.always('<span class="csi-card__discount-info-bold">-50</span>%')]])(this.language),this.passengerDetails=R.pluck("model",this.passengers),this.isSiglePassenger=R.equals(1,this.passengers.length)},e.prototype.$onChanges=function(e){var n=this,i=e.insurance,s=e.extra;this.isXcover=R.pathOr(!1,["launchDarkly","insurance-new-provider-logo-enabled"],this.$ngRedux.getState()),this.ipidLink=this.InsuranceLinkService.getIpidLink(this.originCountryCode),this.policyLink=this.InsuranceLinkService.getPlusLink(this.originCountryCode),this.policyLinkAdd=this.InsuranceLinkService.getPolicyLinkAdd(this.originCountryCode),this.providerLogo=this.isXcover?{isXcover:!0,standard:this.staticFilePrefix+"/resources/ui/ryanair3.0/flight-extras/Insurance/xcover-logo-h@1x.png",retina:this.staticFilePrefix+"/resources/ui/ryanair3.0/flight-extras/Insurance/xcover-logo-h@2x.png"}:{isXcover:!1,standard:this.staticFilePrefix+"/resources/ui/img/logos/ea-logo.png",retina:this.staticFilePrefix+"/resources/ui/img/logos/ea-logo@2x.png"};var t=function(e,n){return R.not(R.equals(R.path(["currentValue",n],e),R.path(["previousValue",n],e)))},r=R.once(function(e){var i=e.minPrice,s=n.hasDiscount&&i?i/50*100:void 0;n.price={minPrice:i,wasPrice:s}}),o=R.once(function(e,i){var s=n.hasDiscount?e:void 0;n.price={minPrice:i,wasPrice:s}}),a=R.once(function(e){var i=e.countries,s=R.find(R.whereEq({code:n.originCountryCode}),i);s&&(n.countryCode=n.originCountryCode,n.onGetOffersForAllPassengers({$event:{countryCode:n.countryCode}}),n.template="/partials/booking/components/cross-selling-card/insurance/cross-selling-insurance-card.html")});if(R.propOr(!1,"currentValue",s)&&!this.insurancePlusEnabled&&r(R.prop("currentValue",s)),R.pathOr(!1,["currentValue","offersForPax","length"],i)&&this.insurancePlusEnabled){var c=function(e){return R.pipe(R.find(R.propEq("code",n.insuranceType)),R.prop("price"))(e)},u=c(R.last(i.currentValue.offersForPax)),l=c(i.currentValue.offersForPax[0]);o(l,u)}t(i,"countries")&&R.path(["countries","length"],this.insurance)&&a(R.prop("currentValue",i)),(t(i,"paxCORs")&&R.path(["countries","length"],this.insurance)||t(i,"countries")&&R.path(["paxCORs","length"],this.insurance))&&this.setCountryPolicies(),t(i,"selectedOffers")&&this.handleSelectionChanges(),t(i,"isSelectionConfirmed")&&R.path(["previousValue","isSelectionConfirmed"],i)&&this.handleBasketRemoval(),t(i,"isSelectionConfirmed")&&(this.isOpened=this.insurance.isSelectionConfirmed),t(i,"offersForPax")&&!R.path(["selectionTotal"],this.insurance)&&(this.hasInsuranceOffers=this.insurance.offersForPax.length>0,this.hasInsuranceOffers?this.onUnmakeChoice():this.dismissInsurance())},e.prototype.$onDestroy=function(){this.onReset()},e}()});


"use strict";angular.module("app.booking").component("addedMark",{templateUrl:"/partials/booking/components/priority-boarding-view/added-mark/added-mark.html",bindings:{translationKey:"<"},controller:function a(){babelHelpers.classCallCheck(this,a)}});


"use strict";angular.module("app.booking").component("baggageInfo",{templateUrl:"/partials/booking/components/priority-boarding-view/baggage-info/baggage-info.html",controller:function o(){babelHelpers.classCallCheck(this,o)}});


"use strict";angular.module("app.booking").component("flightDetails",{templateUrl:"/partials/booking/components/priority-boarding-view/flight-details/flight-details.html",bindings:{isInbound:"<",journey:"<"},controller:function i(){babelHelpers.classCallCheck(this,i)}});


"use strict";angular.module("app.booking").component("passengerDetailsCard",{templateUrl:"/partials/booking/components/priority-boarding-view/passenger-details-card/passenger-details-card.html",bindings:{index:"<",passenger:"<",isActive:"<",isCarouselEnabled:"<",hasSelection:"<",showPassengerName:"<",onSelect:"&"},controller:function(){function e(t){babelHelpers.classCallCheck(this,e),Object.assign(this,{PASSENGER_TYPES:t})}return e.$inject=["PASSENGER_TYPES"],e.prototype.$onInit=function(){var e,t=(e={},babelHelpers.defineProperty(e,this.PASSENGER_TYPES.Adult,"trips.booking.priority.adult"),babelHelpers.defineProperty(e,this.PASSENGER_TYPES.Teen,"trips.booking.priority.teen"),babelHelpers.defineProperty(e,this.PASSENGER_TYPES.Child,"trips.booking.priority.child"),e);this.translationKey=t[this.passenger.model.type],this.hasInfant=Boolean(R.path(["model","inf"],this.passenger)),this.selectionStateTranslationKey="trips.booking.priority.no-bags"},e.prototype.$onChanges=function(e){var t=e.hasSelection;t&&(this.selectionStateTranslationKey=t.currentValue?"trips.booking.priority.bags-added":"trips.booking.priority.no-bags")},e.prototype.onClick=function(){this.onSelect({$event:{passenger:this.passenger}})},e}()});


"use strict";angular.module("app.booking").component("passengersList",{templateUrl:"/partials/booking/components/priority-boarding-view/passengers-list/passengers-list.html",bindings:{passengers:"<",activePassengerId:"<",isCarouselEnabled:"<",isMobile:"<",hasSelection:"<",paxToMoveIndex:"<",onSelect:"&"},controller:function(){function e(s,n){babelHelpers.classCallCheck(this,e),Object.assign(this,{$scope:s,BookingRead:n})}return e.$inject=["$scope","BookingRead"],e.prototype.$onInit=function(){this.carousel=this.$scope.$ctrl.carousel,this.counts=this.BookingRead.enumPassengersByType(this.passengers).map(function(e){return e.model["enum"]})},e.prototype.$onChanges=function(e){this.carousel&&e.paxToMoveIndex&&!e.paxToMoveIndex.isFirstChange()&&this.carousel.goToPage(e.paxToMoveIndex.currentValue)},e.prototype.onSelectHandler=function(e){var s=e.passenger;this.onSelect({$event:{passenger:s}})},e}()});


"use strict";angular.module("app.booking").component("priorityCabinBagCard",{bindings:{option:"<",journeyNum:"<",selectedType:"<",config:"<",onSelect:"&"},templateUrl:"/partials/booking/components/priority-boarding-view/priority-cabin-bag-card/priority-cabin-bag-card.html",controller:function(){function i(o,t,n){babelHelpers.classCallCheck(this,i),Object.assign(this,{BAGS_OPTIONS:o,AEMConfig:t,isMobile:n.isPhone()})}return i.$inject=["BAGS_OPTIONS","AEMConfig","Device"],i.prototype.$onInit=function(){this.warningTextTranslationKey=this.option.showWarningMessageForLauda?"trips.booking.priority.carry-on-warning-text-lauda":"trips.booking.priority.carry-on-warning-text",this.addedTextTranslationKey=this.option.isIncluded?"trips.booking.priority.included":"trips.booking.priority.added",this.imageUrl=R.pathOr(""+(this.AEMConfig.getStaticFilePrefix()+this.option.imageUrl),["productImage"],this.config)},i.prototype.$onChanges=function(i){R.path(["option","currentValue"],i)&&(this.showWarningMessage=this.option.showWarningMessage||this.option.isLauda&&!this.option.showWarningMessageForLauda)},i.prototype.onSelectOption=function(){this.onSelect({$event:{journeyNum:this.journeyNum,optionType:this.option.type}})},i.prototype.shouldShowPrice=function(){var i=this.option,o=i.price,t=i.isDisabled,n=i.isIncluded;return o&&!t&&!n},i.prototype.isOptionEnabled=function(){var i=this.option,o=i.isSoldOut,t=i.isIncluded,n=i.isDisabled;return!o&&!t&&!n},i}()});


"use strict";angular.module("app.booking").component("boardingPassesProducts",{templateUrl:"/partials/booking/checkin/boarding-passes/boarding-passes-products/boarding-passes-products.html",bindings:{products:"<",onProductsEngagedFromBardingPass:"&"},controller:function(){function o(){babelHelpers.classCallCheck(this,o)}return o.prototype.openProductDialog=function(o){this.onProductsEngagedFromBardingPass({$event:{link:o}})},o}()});


"use strict";angular.module("app.booking").component("bagsProduct",{templateUrl:"/partials/booking/checkin/checkin-extras/checkin-bags/checkin-bags-product.html",bindings:{products:"<",passengers:"<",bags:"<",booking:"<",journeys:"<",onChange:"&"},controller:["CARD_STATES","BagsUtils","BookingRead","$ngRedux","BagsActions",function(n,e,t,a,s){var o=this,i=function(n,e){return!R.isNil(n)&&!R.isNil(e)&&n===e&&e>0};this.updateStatus=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a={};a.count=e.getQtyOfAllAddedBagsAndUpgrades(o.bags),a.state=n.DEFAULT,a.total=e.getTotalUnsoldData(o.bags).totalBalance;var s=e.getQtySoldBags(o.bags),g=e.getMaxBagsCount({numberOfPax:o.numberOfPax,bags:o.bags,journeys:o.journeys,segments:o.booking.segments});g>s&&s>0?(a.state=n.PURCHASED_SOME,a.purchaseInformation={BAG:e.getQtySoldBagsByCode(o.bags,"BAG"),BBG:e.getQtySoldBagsByCode(o.bags,"BBG")}):a.count===g&&g>s?a.state=n.ADDED_ALL:i(g,s)?a.state=n.PURCHASED_ALL:a.count>0&&(a.state=n.ADDED_SOME),t.code&&(a.code=t.code),o.onChange({$event:a})};var g=function(n){return function(e,t){Object.assign(n,{$actions:{bags:t}})}},r=a.connect(null,s)(g(this));this.bagAdd=function(n){return o.$actions.bags.addBag(n.code,n.passenger,n.journey)},this.bagRemove=function(n){return o.$actions.bags.removeBag(n.code,n.passenger,n.journey)},this.upgradeAdd=function(n){return o.$actions.bags.addUpgrade(n.bagCode,n.upgradeCode,n.passenger,n.journey)},this.upgradeRemove=function(n){return o.$actions.bags.removeUpgrade(n.upgradeCode,n.passenger,n.journey)},this.getPaxDisplayName=R.pipe(R.prop("model"),function(n){var e=n.name;return e.first+" "+e.last}),this.isPaxInfant=R.path(["model","inf"]),this.hasAddedBagOrBagUpgrade=function(n){return e.hasAddedBagOrBagUpgrade(n)(o.bags)},this.$onInit=function(){var n=babelHelpers.slicedToArray(o.passengers,1);o.selectedPax=n[0],o.isActiveTrip=t.isBooked(o.booking),o.isConnectingFlight=t.isConnectingFlight(o.booking),o.hasSpanishDiscount=t.hasSpanishDiscount(o.booking),o.numberOfPax=t.getPaxCount(o.booking),o.$actions.bags.syncBags(),o.bagsMinPrice=R.pipe(R.filter(function(n){return"BAGS"===n.code}),R.head,R.propOr(0,"minPrice"))(o.products),o.zoneDiscount=R.path(["pct"],t.getZoneDiscountFor(0,o.booking)),o.$actions.bags.getMetadata()},this.$onChanges=function(){o.updateStatus()},this.$onDestroy=function(){r()}}]});


"use strict";angular.module("app.booking").component("cabinBagProduct",{templateUrl:"/partials/booking/checkin/checkin-extras/checkin-cabin-bag/checkin-cabin-bag-product.html",bindings:{booking:"<",passengers:"<",journeys:"<",onChange:"&"},controller:["CARD_STATES","$ngRedux","CabinBagActions","BookingRead",function(a,n,t,e){var o=this,s=function(){return e.getCabinBagItems(!1)(o.booking).length},i=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t={};t.state=a.DEFAULT,t.count=o.$state.cabinBagFor.reduce(function(a,n){return a+n.passengers.reduce(function(a,n){return a+(n.hasCabinBag&&!n.hasSoldCabinBag?1:0)},0)},0),t.total=o.$state.cabinBagFor.reduce(function(a,n){return a+n.passengers.reduce(function(a,t){return a+(t.hasCabinBag&&!t.hasSoldCabinBag?n.prices[t.type]:0)},0)},0),o.updateAllState="add",o.soldBags>0&&(t.state=a.PURCHASED_SOME,t.purchaseInformation={count:o.soldBags,destinations:R.map(function(a){return{destination:a.airport,sold:a.soldCabinBags}},o.$state.cabinBagFor)}),o.$state.cabinBagFor.every(function(a){return!a.isAvailable})?t.state=a.UNAVAILABLE:o.$state.cabinBagFor.every(function(a){return a.isMaxedOut})||o.$state.cabinBagFor.some(function(a){return!a.isAvailable})&&o.$state.cabinBagFor.some(function(a){return a.isMaxedOut})?t.state=a.PURCHASED_ALL:t.count===o.maxSellableCabinBag?(t.state=a.ADDED_ALL,o.updateAllState="remove"):t.count>0&&(t.state=a.ADDED_SOME),0!==n&&(t.code=o.CODE),o.onChange({$event:t}),o.$actions.updateCtaState()};this.update=function(a,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!1,e=s();if(o.$actions.updatePax(a,n),!t){o.$actions.updateLocalBasket(a,n.model.journeyNum);var r=s()-e;i(r)}},this.updateAll=function(){var a=s(),n="add"===o.updateAllState;o.$actions.updateCabinBagsForJourneys(n),n?o.$actions.addAllToLocalBasket():o.$actions.resetLocalBasket();var t=s()-a;i(t)},this.updatePassengerListFor=function(a){var n=s();o.$actions.closePassengerListFor(a),a.passengers.forEach(function(n){n.hasCabinBag&&!n.hasSoldCabinBag?o.$actions.addToLocalBasket(n,a.model.journeyNum):n.hasSoldCabinBag||o.$actions.removeFromLocalBasket(n,a.model.journeyNum)});var t=s()-n;i(t)};var r=function(a){return{cabinBagFor:a.cabinBag.cabinBagFor,ssrs:a.bookingModel.ssrs}},c=n.connect(r,t)(function(a,n){o.$state=a,o.$actions=n});this.$onInit=function(){o.$actions.prepareCabinBagsForJourneys(o.passengers,o.journeys),o.soldBags=o.$state.cabinBagFor.reduce(function(a,n){return a+n.soldCabinBags},0),o.maxSellableCabinBag=o.$state.cabinBagFor.reduce(function(a,n){return a+n.maxCabinBags},0)-o.soldBags,i()},this.$onDestroy=function(){c()}}]});


"use strict";angular.module("app.booking").component("fasttrackProduct",{templateUrl:"/partials/booking/checkin/checkin-extras/checkin-fasttrack/checkin-fasttrack-product.html",bindings:{products:"<",passengers:"<",booking:"<",onChange:"&"},controller:["CARD_STATES","AEMConfig","FastTrackUtils","FastTrackActions","$ngRedux","PASSENGER_TYPES","FEATURE_CONFIG",function(t,a,r,e,n,s,o){var c=this,u=function(t){return{bookingModel:t.bookingModel,fastTrack:t.fastTrack,terms:r.getTerms(t.bookingModel),journeys:R.path(["journeys"],t.bookingModel),showLoader:R.pathOr(!0,["isLoading"],t.fastTrack),pricesValues:R.pathOr([],["priceBreakdown"],t.fastTrack),totalBalance:r.getTotalBalance(t.bookingModel,t.fastTrack),countOfCurrentFastTrack:r.getFastTrackCount(t.bookingModel,t.fastTrack)}},i=n.connect(u,e)(this),l=function(t){var a=t.passengers.some(function(t){return t.hasFasttrack&&!t.hasSoldFasttrack});1===t.passengers.length?t.ctaState=a?"remove":"add":t.passengers.length>1&&(t.ctaState=a?"modify":"add")},d=function(){return c.fastTrackFor.reduce(function(t,a){var r=a.passengers.filter(function(t){return t.hasSoldFasttrack}).length;return t+r},0)},f=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r={};r.state=t.DEFAULT,r.total=c.totalBalance,r.count=c.countOfCurrentFastTrack,c.updateAllState="add",c.fastTrackFor.some(function(t){return t.somePaxHasSoldFasttrack})&&(r.state=t.PURCHASED_SOME,c.soldFastTrackCount=c.soldFastTrackCount||d(),r.purchaseInformation={count:c.soldFastTrackCount}),c.fastTrackFor.every(function(t){return!t.isAvailable})?r.state=t.UNAVAILABLE:c.fastTrackFor.every(function(t){return t.isMaxedOut||!t.isAvailable||0===c.maxFasttrack})?r.state=t.PURCHASED_ALL:r.count===c.maxFasttrack?(r.state=t.ADDED_ALL,c.updateAllState="remove"):r.count>0&&(r.state=t.ADDED_SOME),0!==a&&(r.code="FAST"),c.onChange({$event:r}),c.fastTrackFor.forEach(function(t){l(t)})},k=function(t){if(!t.isFasttrackSold&&t.withChild){var a=t.passengers.filter(function(t){return t.type===s.Adult}).some(function(t){return t.hasFasttrack});t.passengers.filter(function(t){return t.type!==s.Adult}).forEach(function(t){t.canAddChild=a,t.hasFasttrack=a&&t.hasFasttrack})}};this.addFastTrack=function(t){var a=c.countOfCurrentFastTrack,r=t.paxNum,e=t.journeyInfo,n=t.journeyInfo,s=n.journeyNum,o=n.passengers;c.addToJourney(s,r),o.find(function(t){return t.num===r}).hasFasttrack=!0;var u=c.countOfCurrentFastTrack-a;f(u),k(e),c.performAutoAddForChildren(e),c.updateResult=c.getUpdateResult()},this.removeFastTrack=function(t){var a=c.countOfCurrentFastTrack,r=t.paxNum,e=t.journeyInfo,n=t.journeyInfo,s=n.journeyNum,o=n.passengers;c.removeFromJourney(s,r),o.find(function(t){return t.num===r}).hasFasttrack=!1;var u=c.countOfCurrentFastTrack-a;f(u),k(e),c.updateResult=c.getUpdateResult()},this.performAutoAddForChildren=function(t){var a=t.passengers,r=t.orig;R.find(R.equals(r),o.AIRPORTS_WITH_AUTO_ADDING_CHILD_FAST_TRACK)&&a.forEach(function(a){if(!a.hasFasttrack&&!a.hasSoldFasttrack&&a.type===s.Child){var r={paxNum:a.num,journeyInfo:t};c.addFastTrack(r)}})},this.updateAll=function(){var t=c.countOfCurrentFastTrack,a=c.countOfCurrentFastTrack<c.maxFasttrack?"add":"remove",r=c.fastTrackFor.filter(function(t){return t.isAvailable});c.updateFastTrackAllPassengers(r,a);var e=c.countOfCurrentFastTrack-t;c.fastTrackFor.forEach(function(t){t.isAddedToAllPax=e>0,t.passengers.filter(function(t){return!t.hasSoldFasttrack}).forEach(function(a){a.hasFasttrack=t.isAddedToAllPax}),k(t)}),f(e),c.updateResult=c.getUpdateResult(!0)},this.$onInit=function(){c.fastTrackFor=r.getFastTrackFor(c.bookingModel,c.fastTrack,c.passengers,c.pricesValues),c.maxFasttrack=r.getMaxFasttrackFor(c.fastTrackFor),c.fastTrackMinPrice=R.pipe(R.filter(function(t){return"FAST"===t.code}),R.head,R.pathOr(0,["minPrice"]))(c.products),f(),c.shouldShowChildrenMessage=c.fastTrackFor.some(function(t){return t.isAvailable&&t.withChild}),c.isMultiPax=c.fastTrackFor[0].passengers.length>1,c.brusselsAirportImage=a.getStaticFilePrefix()+"/resources/ui/img/brussels-airport"},this.getUpdateAllButtonTranslationKey=function(){var t=c.isMultiPax?"-for-all":"";return"trips.checkin.products.FAST."+c.updateAllState+t},this.getUpdateAllMessageTranslationKey=function(){var t=c.isMultiPax?"-all":"";return"trips.checkin.products.FAST.quick-add"+t},this.toggleInformation=function(){c.showInformation=!c.showInformation},this.getAddForAllPrice=function(){return c.fastTrackFor.reduce(function(t,a){var e=a.passengers.reduce(function(t,e){var n=e.hasSoldFasttrack?0:r.getPriceForPassenger(a,e);return t+n},0);return t+e},0)},this.getUpdateResult=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!1,a=c.isMultiPax?"-for-all":"",r=[{condition:c.countOfCurrentFastTrack===c.maxFasttrack,state:"added",translationKey:"trips.checkin.products.FAST.added"+a},{condition:!c.countOfCurrentFastTrack&&t,state:"removed",translationKey:"trips.checkin.products.FAST.removed"+a}];return r.find(function(t){return t.condition})||{}},this.$onDestroy=function(){i()}}]});


"use strict";angular.module("app.booking").component("inflightProducts",{templateUrl:"/partials/booking/checkin/checkin-extras/checkin-inflight-products/checkin-inflight-products.html",bindings:{bookingModel:"<",passengers:"<",journeys:"<",inflightProducts:"<",onChange:"&"},controller:function(){function t(e,i,n,o,s,r,c){babelHelpers.classCallCheck(this,t),Object.assign(this,{$filter:e,$ngRedux:i,BookingRead:n,CARD_STATES:o,InflightProductsActions:s,InflightProductsUtils:r,staticFilePrefix:c.getStaticFilePrefix()})}return t.$inject=["$filter","$ngRedux","BookingRead","CARD_STATES","InflightProductsActions","InflightProductsUtils","AEMConfig"],t.prototype.getProductDescriptionPreview=function(t){var e="trips.inflight.products."+t.code+(t.type?"."+t.type:"")+".preview";return R.pipe(this.$filter("translate"),R.when(R.pipe(R.length,R.lt(60)),function(t){return R.take(60,t)+"..."}))(e)},t.prototype.setSelectedForPax=function(t,e,i,n){this.$ngRedux.dispatch(this.InflightProductsActions.setSelectedProductForPassenger(t,e,i,n))},t.prototype.updatePassengerListFor=function(t,e){this.$ngRedux.dispatch(this.InflightProductsActions.updateSelectedProducts(t,e))},t.prototype.updateAllPassengersFor=function(t,e){var i=R.not(R.prop("isAddedToAllPax",e));this.$ngRedux.dispatch(this.InflightProductsActions.setSelectedProductForAllPassengers(t.index,e.journeyNum,i))},t.prototype.toggleDropdown=function(t,e){this.$ngRedux.dispatch(this.InflightProductsActions.toggleDropdown(t,e))},t.prototype.updateStatus=function(t){var e={};e.state=this.CARD_STATES.DEFAULT,e.total=this.InflightProductsUtils.getTotalBalance(t),e.count=R.propOr([],"items",t).length,this.isConnectingFlight?e.state=this.CARD_STATES.UNAVAILABLE:e.count>0&&(e.state=this.CARD_STATES.ADDED_SOME),this.onChange({$event:e})},t.prototype.updateSelectedProducts=function(t,e){var i="add"===t.ctaState?this.InflightProductsActions.addSelectedProduct:this.InflightProductsActions.removeSelectedProduct;this.$ngRedux.dispatch(i(R.pathOr(0,["passengers",0,"paxNum"],t),t.journeyNum,e))},t.prototype.$onInit=function(){this.isConnectingFlight=this.BookingRead.isConnectingFlight(this.bookingModel),this.$ngRedux.dispatch(this.InflightProductsActions.getCheckinProductCard(this.passengers,R.prop("segments",this.bookingModel)))},t.prototype.$onChanges=function(t){var e=t.inflightProducts,i=R.propOr(!1,"currentValue",e),n=R.propOr(!1,"previousValue",e);R.not(R.equals(i,n))&&this.updateStatus(i)},t}()});


"use strict";angular.module("app.booking").component("insuranceProduct",{templateUrl:"/partials/booking/checkin/checkin-extras/checkin-insurance/checkin-insurance-product.html",bindings:{countries:"<",products:"<",passengers:"<",onChange:"&"},controller:function(){function e(t,n,s,r,i,o,a,u,c){var h=this;babelHelpers.classCallCheck(this,e);var p=function(e){var t=e.insurance,n=e.bookingModel;return{insuranceOffers:R.pathOr([],["offersForPax"],t),insuranceItems:R.pipe(R.pathOr([],["addons"]),i.byModel({code:"INS"}))(n),journeys:R.path(["journeys"],n),hasCancelledFlights:R.pipe(o.getCancelledFlights,R.any(function(e){return e}))(n)}};Object.assign(this,{CARD_STATES:n,Dates:s,ModelQuery:i,Stations:u,InsurancePolicyLink:c,unsubscribe:t.connect(p,r)(function(e,t){Object.assign(h,{$state:e,$actions:t})}),benefits:["belongings","cancellations","medical","provided-by-assistance"],isItalianMarket:"IT"===a.getCountry().toUpperCase()})}return e.$inject=["$ngRedux","CARD_STATES","Dates","InsuranceActions","ModelQuery","BookingRead","MarketConfig","Stations","InsurancePolicyLink"],e.prototype.$onInit=function(){var e=R.pathOr("",["journeys",0,"model","orig"],this.$state),t=R.pipe(R.when(R.equals("gb"),function(){return"uk"}),R.when(R.equals("be"),function(){return"be_fr"})),n=this.Stations.getCountryCode(e);this.countryCode=t(n),this.policyQueryParams=n&&this.InsurancePolicyLink.getQueryParams(n),this.countryName=this.Stations.getCountryName(e),this.passengersWithInsModel=this.getModelForProductCard(this.passengers.map(function(e){return e.model}),this.$state.insuranceItems,n),this.maxSellable=this.passengersWithInsModel.reduce(function(e,t){return e+(t.hasInsurance?0:1)},0),this.insuranceMinPrice=R.pipe(R.filter(function(e){return"INSURANCE"===e.code}),R.head,R.pathOr(0,["minPrice"]))(this.products),this.loadOffersForPassengers(),this.updateStatus()},e.prototype.getModelForProductCard=function(e,t,n){var s=this;return e.map(function(e){var r=R.pipe(s.ModelQuery.byModel({sold:!1,paxNum:e.num}),R.map(function(e){var t=e.model;return{code:t.itemId,qty:t.qty,price:t.total,startDate:t.start,countryOfResidence:t.src}}),R.head)(t),i=R.pipe(s.ModelQuery.byModel({sold:!0,paxNum:e.num}),R.head,Boolean)(t);return r&&(s.$actions.removeInsuranceFor(e.num),s.$actions.addInsuranceFor(e.num,{itemId:r.code,paxNum:e.num,total:r.price,code:"INS",src:r.countryOfResidence,sold:!1,qty:r.qty})),babelHelpers["extends"]({},e,{countryOfResidence:n,hasInsurance:i,selectedOffer:r})})},e.prototype.getPriceForPassenger=function(e){return R.pipe(R.pathOr([],["insuranceOffers",e]),R.find(R.propEq("code","RYAN31")),R.pathOr(0,["price"]))(this.$state)},e.prototype.getTotalPrice=function(){return this.$state.insuranceOffers.reduce(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return R.pipe(R.find(R.propEq("code","RYAN31")),R.pathOr(0,["price"]),function(t){return e+t})(t)},0)},e.prototype.addInsurances=function(){var e=this;this.passengersWithInsModel=this.passengersWithInsModel.filter(function(e){return!e.hasInsurance}).map(function(t){var n=R.find(R.propEq("code","RYAN31"))(e.$state.insuranceOffers[t.num]);return e.$actions.removeInsuranceFor(t.num),e.$actions.addInsuranceFor(t.num,{itemId:n.code,paxNum:t.num,total:n.price,code:"INS",src:t.countryOfResidence,sold:!1,qty:1}),babelHelpers["extends"]({},t,{selectedOffer:n})}),this.updateStatus()},e.prototype.removeInsurances=function(){var e=this;this.passengersWithInsModel=this.passengersWithInsModel.filter(function(e){return!e.hasInsurance}).map(function(t){return e.$actions.removeInsuranceFor(t.num),babelHelpers["extends"]({},t,{selectedOffer:null})}),this.updateStatus()},e.prototype.loadOffersForPassengers=function(){var e=this;this.passengersWithInsModel.filter(function(e){return!e.hasInsurance}).forEach(function(t){return e.$actions.getOffer(t.countryOfResidence,t.num)})},e.prototype.isInsuranceAddedForAll=function(){return R.pipe(R.filter(function(e){return!e.hasInsurance}),R.all(function(e){return e.selectedOffer}))(this.passengersWithInsModel)},e.prototype.updateStatus=function(){var e={};e.count=this.passengersWithInsModel.reduce(function(e,t){return e+(t.selectedOffer?1:0)},0),e.total=this.passengersWithInsModel.reduce(function(e,t){return e+(t.selectedOffer?t.selectedOffer.price:0)},0),e.state=this.CARD_STATES.DEFAULT,e.unsynchronized=R.gt(R.pathOr(0,["$state","initInsuranceItems","length"],this),R.pathOr(0,["$state","insuranceItems","length"],this)),this.passengersWithInsModel.some(function(e){return e.hasInsurance})&&(e.state=this.CARD_STATES.PURCHASED_SOME,e.purchaseInformation={},e.purchaseInformation.paxCount=R.pipe(this.ModelQuery.byModel({sold:!0}),R.length)(this.$state.insuranceItems)),e.count>0&&e.count===this.maxSellable?e.state=this.CARD_STATES.ADDED_ALL:e.count>0?e.state=this.CARD_STATES.ADDED_SOME:this.passengersWithInsModel.every(function(e){return e.hasInsurance})?e.state=this.CARD_STATES.PURCHASED_ALL:this.$state.hasCancelledFlights&&(e.state=this.CARD_STATES.UNAVAILABLE),this.onChange({$event:e})},e.prototype.$onChanges=function(e){if(R.path(["countries","currentValue","length"],e)){var t=this.Stations.getCountryCode(R.pathOr("",["journeys",0,"model","orig"],this.$state));this.countries.find(R.propEq("code",R.toUpper(t)))||this.onChange({$event:{state:this.CARD_STATES.UNAVAILABLE}})}},e.prototype.$onDestroy=function(){this.unsubscribe()},e}()});


"use strict";angular.module("app.booking").component("parkingProduct",{templateUrl:"/partials/booking/checkin/checkin-extras/checkin-parking/checkin-parking.component.html",bindings:{onToggle:"&",onChange:"&"},controller:function(){function t(e,i,n,a,s,r,o){var g=this;babelHelpers.classCallCheck(this,t),Object.assign(this,{$ngRedux:e,ParkingService:i,BookingRead:n,ParkingActions:a,Dates:s,CARD_STATES:o}),this.subscriptions=[],this.subscriptions.push(r.onPhone(function(t){var e=t.matches;g.isMobile=e})),this.PARKING_DAYS_RANGE=i.maxParkingDays,this.vrn=null,this.isMoreInfoOpened=!1}return t.$inject=["$ngRedux","ParkingService","BookingRead","ParkingActions","Dates","Device","CARD_STATES"],t.prototype.updateStatus=function(){var t={};t.count=this.$state.hasAddedParking?1:0,t.state=this.$state.hasAddedParking?this.CARD_STATES.ADDED_ALL:this.CARD_STATES.DEFAULT,t.total=R.pathOr(0,["$state","existingParking","total"],this),this.onChange({$event:t})},t.prototype.getParkings=function(){var t=this;this.$actions.parking.getParkings(this.Dates.formatISO(this.Dates.parse(this.calendar.start.value)),this.Dates.formatISO(this.Dates.parse(this.calendar.end.value))).then(function(){if(t.$state.hasAddedParking){var e=t.ParkingService.findExistingParking(t.$state.existingParking,t.$state.parking.parkings);e?(t.$actions.parking.setSelectedOffer(e),t.vrn=t.$state.existingParking.pax):t.$actions.parking.removeAll()}})},t.prototype.startDateChanged=function(t){var e=t.value;e&&(this.calendar.start.value=e,this.calendar.end.min=e,this.calendar.end.max=this.Dates.format(this.Dates.parse(e).clone().add(this.PARKING_DAYS_RANGE-1,"days")),this.Dates.parse(e)>this.Dates.parse(this.calendar.end.value)?this.calendar.end.value=this.Dates.format(this.Dates.parse(e).clone().add(1,"days")):this.getParkings())},t.prototype.endDateChanged=function(t){var e=t.value;e&&(this.calendar.end.value=e,this.getParkings())},t.prototype.onParkingSelect=function(t){var e=t.selectedParking;this.$actions.parking.setSelectedOffer(e)},t.prototype.onVRNChanged=function(t){var e=t.value;this.vrn=e},t.prototype.confirmParking=function(t){var e=this;if(t.$setSubmitted(),t.$valid){var i={offerKey:this.$state.parking.selectedOffer.key,offerSkuKey:this.$state.parking.selectedOffer.skuKey,registrationNumber:this.vrn,startDate:this.Dates.formatISO(this.Dates.parse(this.calendar.start.value)),returnDate:this.Dates.formatISO(this.Dates.parse(this.calendar.end.value)),price:this.$state.parking.selectedOffer.price};this.$ngRedux.dispatch(this.ParkingActions.postParkings(i)).then(function(){e.$state.parking.isAddingToBookingModelError||(e.onToggle(),e.isMoreInfoOpened=!1)})}},t.prototype.removeParking=function(t){var e=this;t.$setPristine(),t.$setUntouched(),this.vrn=null,this.isMoreInfoOpened=!1,this.$actions.parking.removeSelectedOffer(),this.$state.hasAddedParking?this.$actions.parking.removeAll().then(function(){e.$state.parking.isRemovingFromBookingModelError||e.onToggle()}):this.onToggle()},t.prototype.onMoreInfoToggle=function(){this.isMoreInfoOpened=!this.isMoreInfoOpened},t.prototype.$onInit=function(){var t=this,e=function(e){var i=e.parking,n=e.bookingModel;return{parking:i,bookingModel:n,journeys:t.BookingRead.getModel("journeys",n),hasAddedParking:t.ParkingService.hasAddedParking(n),existingParking:R.pipe(R.pluck("model"),R.either(R.head,function(){return null}))(t.BookingRead.getParkingItems(!1)(n)),isLoading:i.isLoadingOffers||i.isAddingToBookingModel||i.isRemovingFromBookingModel}};this.subscriptions.push(this.$ngRedux.connect(e,[this.ParkingActions])(function(e,i){var n=babelHelpers.slicedToArray(i,1),a=n[0];t.$state=babelHelpers["extends"]({},t.$state,e),t.$actions={parking:a},t.updateStatus()})),this.locationCode=R.path(["0","orig"],this.$state.journeys),this.calendar||(this.calendar=this.ParkingService.getCalendar(this.$state.journeys,this.$state.existingParking)),this.getParkings()},t.prototype.$onDestroy=function(){this.subscriptions.forEach(function(t){return t()})},t}()});


"use strict";angular.module("app.booking").component("transfersProduct",{templateUrl:"/partials/booking/checkin/checkin-extras/checkin-transfers/checkin-transfers.component.html",bindings:{onChange:"&"},controller:function(){function t(e,s,n,r,a){babelHelpers.classCallCheck(this,t),Object.assign(this,{$ngRedux:e,TransfersActions:s,CARD_STATES:n,BookingRead:r,GroundTransfersCardFactory:a}),this.subscriptions=[],this.isMoreInfoOpened=!1}return t.$inject=["$ngRedux","TransfersActions","CARD_STATES","BookingRead","GroundTransfersCardFactory"],t.prototype.updateStatus=function(){var t={},e=R.pathOr(0,["transfers","totalPrice"],this.$state);t.count=e?1:0,this.$state.availableCount===this.$state.purchasedTransfers.length?t.state=this.CARD_STATES.UNAVAILABLE:this.$state.purchasedTransfers.length?(t.state=this.CARD_STATES.PURCHASED_SOME,t.purchaseInformation={}):t.state=e?this.CARD_STATES.ADDED_ALL:this.CARD_STATES.DEFAULT,t.total=e,this.onChange({$event:t})},t.prototype.onMoreInfoToggle=function(){this.isMoreInfoOpened=!this.isMoreInfoOpened},t.prototype.$onInit=function(){var t=this,e=function(e){var s=e.transfers,n=e.bookingModel,r=e.checkin;return{transfers:s,purchasedTransfers:t.BookingRead.getGroundTransfersItems(!0)(n),availableCount:t.GroundTransfersCardFactory.getAvailableCount({extras:r.products}),providers:R.path(["providers"],s),paxCount:t.BookingRead.getPaxCount(n),isCancelledFlight:t.BookingRead.getCancelledFlights(n),journeys:R.pipe(R.pathOr([],["journeys"]),R.pluck("model"))(n),existingTransfers:R.pipe(R.pathOr([],["addons"]),R.pluck("model"),R.filter(function(t){return"TRANS"===t.src}))(n)}};this.subscriptions.push(this.$ngRedux.connect(e,[this.TransfersActions])(function(e,s){var n=babelHelpers.slicedToArray(s,1),r=n[0];t.$state=babelHelpers["extends"]({},t.$state,e),t.$actions={transfers:r}})),this.$actions.transfers.clear(),this.$actions.transfers.getTransfers(),this.updateStatus()},t.prototype.onAddSelectedOffer=function(t){var e=t.journey,s=t.data;this.$actions.transfers.addSelectedOffer({journey:e,data:s}),this.updateStatus()},t.prototype.onRemoveSelectedOffer=function(t){var e=t.journey;this.$actions.transfers.removeSelectedOffer({journey:e}),this.updateStatus(),0===R.pathOr(0,["transfers","totalPrice"],this.$state)&&this.$actions.transfers.resetSelectedOffers(!1)},t.prototype.$onDestroy=function(){this.subscriptions.forEach(function(t){return t()})},t}()});


"use strict";angular.module("app.booking").component("checkinProductCard",{templateUrl:"/partials/booking/checkin/checkin-extras/products/checkin-product-card.html",transclude:!0,bindings:{product:"<",transfersTotalPrice:"<",booking:"<",bags:"<",passengers:"<",journeys:"<",isOpen:"<",onUnaccessible:"&",highlight:"<",onProductAction:"&",onSyncRequired:"&",onCardToggle:"&",onRemoveTransfers:"&",priorityBoarding:"<",showProductWithoutImage:"<",checkinExtrasConfig:"<"},controller:function(){function t(i,e,o,s,n,r,c,a,h){babelHelpers.classCallCheck(this,t),Object.assign(this,{AEMConfig:i,CARD_STATES:e,BookingRead:o,Device:s,CheckinExtrasService:n,$ngRedux:r,ParkingActions:c,ParkingService:a,EXTRAS_CARD_CODES:h})}return t.$inject=["AEMConfig","CARD_STATES","BookingRead","Device","CheckinExtrasService","$ngRedux","ParkingActions","ParkingService","EXTRAS_CARD_CODES"],t.prototype.setDisplayPrice=function(){this.displayPrice=this.isOpen||this.count?this.total:this.minPrice},t.prototype.$onInit=function(){var t=this,i=function(i,e){return R.pipe(R.filter(function(i){return i.targetProduct===t.product.code}),R.head,R.pathOr(e,[i]))(t.checkinExtrasConfig)};"INFLIGHT"!==this.product.code&&(this.imageUrl=i("productImage",""+(this.AEMConfig.getStaticFilePrefix()+this.CheckinExtrasService.getFallbackImageForProduct(this.product.code))),this.merchandisingText=i("merchandisingText","")),this.state=this.CARD_STATES.UNAVAILABLE,this.count=0,this.total=0,this.purchaseInformation={},this.minPrice=this.product.minPrice,this.productImage=this.Device.isMobile()?this.product.image+"-mobile":this.product.image,this.isConnectingTrip=this.BookingRead.getBookingInfo(this.booking).isConnectingFlight,this.image=this.AEMConfig.getStaticFilePrefix()+"/resources/ui/img/check_in/"+this.productImage+".jpg",this.imageRetina=this.AEMConfig.getStaticFilePrefix()+"/resources/ui/img/check_in/"+this.productImage+"@2x.jpg",this.setDisplayPrice(),this.isDiscountAvailable=R.propOr(!1,"dsc",this.product),this.isTargetedDiscount=this.isDiscountAvailable&&R.propEq("discountType","TargetedDiscount",this.product)},t.prototype.$onChanges=function(){this.setDisplayPrice()},t.prototype.getTranslationsProductType=function(){var t="",i=".GENERAL";switch(R.propOr([],"types",this.product).length){case 0:return t;case 1:return"."+this.product.types[0];default:return i}},t.prototype.setStatus=function(t){var i=t.state,e=t.count,o=t.total,s=t.purchaseInformation,n=t.code,r=t.unsynchronized,c=e-this.count;if(this.state=i,[this.CARD_STATES.UNAVAILABLE,this.CARD_STATES.PURCHASED_ALL].indexOf(this.state)>=0&&this.onUnaccessible&&this.onUnaccessible(),this.count=e,this.total=o,this.purchaseInformation=s,r&&this.onSyncRequired({$event:{unsynchronized:r}}),0!==c&&n){var a=Math.abs(c),h=c>0?"Added "+a+" x Products":"Removed "+a+" x Products";this.onProductAction({$event:{action:h,code:n}})}this.setDisplayPrice()},t.prototype.toggleCard=function(){this.onCardToggle({$event:{code:this.product.code}})},t.prototype.removeTransfers=function(){this.onRemoveTransfers()},t}()});


"use strict";angular.module("app.booking").component("prioritySelector",{bindings:{type:"@",onRadioChange:"&",journey:"<",minPrice:"<",isMobile:"<",prioritySelection:"<",priorityBoardingImageUrls:"<",discount:"<"},templateUrl:"/partials/booking/checkin/checkin-priority/priority-selector/priority-selector.component.html",controller:function(){var e=this,t=R.once(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return[{title:"trips.checkin.priority.selector.payed.title",text:"trips.checkin.priority.selector.payed.text",price:e,discount:t},{title:"trips.checkin.priority.selector.free.title",text:"trips.checkin.priority.selector.free.text",textMobile:"trips.checkin.priority.selector.free.price",price:0}]});this.$onInit=function(){e.isDiscountAvailable=R.propOr(!1,"value",e.discount),e.isTargetedDiscount=e.isDiscountAvailable&&R.propEq("type","TargetedDiscount",e.discount)},this.$onChanges=function(i){R.pathOr(!1,["minPrice","currentValue"],i)&&R.pathOr(0,["discount","currentValue"],i)&&(e.selectionModel=t(i.minPrice.currentValue,i.discount.currentValue),e.selectionModel&&e.prioritySelection&&(e.selection=e.prioritySelection.reduce(function(t,i,r){return i?R.path([r,"price"],e.selectionModel):t},null)))}}});


"use strict";angular.module("app.booking").component("prioritySelectorNewPolicy",{templateUrl:"/partials/booking/checkin/checkin-priority/selector-new-policy/priority-selector-new-policy.component.html",bindings:{isLaudaJourney:"<",showWarningMessageForLauda:"<",isMobile:"<",options:"<",optionSelected:"<",journey:"<",staticFilePrefix:"<",onToggle:"&",onAddPriorityBoarding:"&",onRemovePriorityBoarding:"&",onAddCabinBag:"&",onRemoveCabinBag:"&"},controller:function(){function i(o){babelHelpers.classCallCheck(this,i),Object.assign(this,{BAGS_OPTIONS:o})}return i.$inject=["BAGS_OPTIONS"],i.prototype.$onInit=function(){this.warningMessageTranslationKey=this.showWarningMessageForLauda?"trips.extra.priority-and-cabin-bags.carry-on.card.warning-lauda":"trips.extra.priority-and-cabin-bags.carry-on.card.warning-text-one"},i.prototype.onRadioChanged=function(i){switch(i){case this.BAGS_OPTIONS.CARRY_ON:this.onRemovePriorityBoarding(),this.onRemoveCabinBag();break;case this.BAGS_OPTIONS.CABIN_BAG:this.onRemovePriorityBoarding(),this.onAddCabinBag();break;case this.BAGS_OPTIONS.PRIORITY_BOARDING:this.onRemoveCabinBag(),this.onAddPriorityBoarding()}this.onToggle({$event:{value:i}})},i}()});


"use strict";angular.module("app.booking").component("checkinInfoBanner",{templateUrl:"/partials/booking/checkin/information-templates/banner/checkin-info-banner.component.html",bindings:{checkedInCount:"<?",covidLinks:"<?",type:"<"},controller:function(){switch(this.type){case"warning":this.icon="glyphs.warning";break;default:this.icon="glyphs.circle-tick"}}});


"use strict";angular.module("app.booking").component("basket",{templateUrl:"/partials/booking/directives/basket/basket/basket.html",bindings:{bookingModel:"<",passengers:"<",operatedBy:"<",scrollableContent:"<",heldFare:"<",breakdown:"<",total:"<",paymentFee:"<",paymentDiscount:"<",totalPriceToShow:"<",totalVatPriceToShow:"<",totalPriceLabel:"<",hideGroupTotal:"<",classList:"<",paymentMethods:"<",selectedPaymentMethod:"<",isFlightChanged:"<",onSelectMethod:"&",hideHeader:"<",dcc:"<",showFeeMsg:"<",showLaudaFeeMsg:"<",isLaudaMotion:"<",hideTotalPrice:"<"},controller:function(){var e=this;this.selectMethod=function(t){var o=t.method;return e.onSelectMethod({$event:{method:o}})}}});


"use strict";angular.module("app.booking").component("basketGroup",{templateUrl:"/partials/booking/directives/basket/basket-group/basket-group.html",bindings:{bookingModel:"<",item:"<",passengers:"<",operatedBy:"<",hideGroupTotal:"<",isFlightChanged:"<",hideHeader:"<",paymentFee:"<",paymentDiscount:"<",total:"<",isLaudaMotion:"<"},controller:["$state","BookingRead","ModelQuery","MasterpassPayment","FEATURE_CONFIG","Session",function(e,t,o,i,a,n){var r=this,s=!!t.getHoldFareObjects(this.bookingModel).length,d=e.current.name.indexOf("booking.active")>=0,l=function(){r.groupTotalPrice=r.item.model.total+(r.item.paymentChargeApplicable?r.paymentFee-r.paymentDiscount:0)-(r.activeCarHire?r.activeCarHire:0)},c=function(e,i){return R.pipe(t.getEventItems(!1),o.sumUpTotal,R.equals(e))(i)};this.isVoucherVisible=function(){return"booking"===r.item.id&&!s&&!r.hideFlightTotal&&!i.isInProgress()&&!r.operatedBy&&!c(R.pathOr(0,["total","amt"],r),r.bookingModel)&&e.current.name.indexOf("booking.active.checkin.payment")<0&&!t.hasSpanishDiscount(r.bookingModel)},this.showRedeemTravelCreditsSection=function(){return a["travel-credits-enabled"]&&e.is("booking.payment")&&!t.isDomestic(r.bookingModel)&&"booking"===r.item.id&&!s&&!r.operatedBy&&!r.isBlacklistedAccount&&n.getAuthenticated()},this.$onInit=function(){if(r.defaultId="booking",r.hideHeader=R.pathOr(!1,["hideHeader"],r),t.hasCarHire(r.bookingModel)&&d){r.activeCarHire="cars"===r.item.id?r.item.model.total:0;var e=R.pipe(R.pathOr([],["addons"]),o.byModel({src:"CARHIRE"}),o.complement(R.pathOr([],["addons"],r.bookingModel)),o.byModel({sold:!1}),o.hasAny)(r.bookingModel);e&&(r.hideFlightTotal=r.hideGroupTotal)}},this.$onChanges=function(e){var t=e.item,o=e.paymentFee,i=e.paymentDiscount;(t.currentValue||o.currentValue||i.currentValue)&&l()}}]});


"use strict";angular.module("app.booking").component("basketLineItem",{templateUrl:"/partials/booking/directives/basket/basket-line-item/basket-line-item.html",bindings:{bookingModel:"<",item:"<",line:"<",operatedBy:"<",isFlightChanged:"<",isLaudaMotion:"<",itemIndex:"<"},controller:["BookingRead","FREE_BUNDLED_SSRS","CC_DEFAULT_METHOD","Basket","$filter","AIRLINE_CONFIG","PASSENGER_TYPES","InfantDiscountService","AirMaltaFare","FARE_OPTION_TRANSLATION_KEYS","ConnectingFlightService","MarketConfig",function(e,t,n,i,o,r,a,s,l,u,d,g){var c=this,h=o("fareBreakdownPrice"),p=["AA"],f=e.getModel("journeys",this.bookingModel),m=R.path(["isConnectingFlight"],e.getBookingInfo(this.bookingModel)),y=d.isConnectingLeg(this.line.detail);this.isConnectingFlight=m,this.isReturnFlight=this.bookingModel.journeys.length>1,this.isPotentialBooking=e.isPotentialBooking(this.bookingModel),this.isFamilyPlus=e.hasFamilyPlus(this.bookingModel),this.isPlusLeg=e.isLeisurePlusLeg(this.bookingModel,this.itemIndex),this.hasUpgradeDetails=!1,this.translationFareType=u[this.line.detail.fareOption]||u.STANDARD,this.marketCountry=g.getCountry().toUpperCase(),this.line.detail.segments&&(m&&y?(this.includedPBNumber=e.getPaxCount(this.bookingModel)*this.line.detail.segments.length,this.line.detail.segments[0].model.origBold="bold",this.line.detail.segments[0].model.destBold="",this.line.detail.segments[1].model.origBold="",this.line.detail.segments[1].model.destBold="bold"):(this.line.detail.segments[0].model.origBold="bold",this.line.detail.segments[0].model.destBold="bold")),this.line.detail.infSsrs&&(this.infantTotal=this.line.detail.infSsrs.reduce(function(e,t){return e+s.getInfantFeePrice(t)},0)),this.$onInit=function(){c.hasFareFootnote=i.hasFareFootnote(),"bags"===c.line.type&&i.hasVerboseBaggageStatus()&&e.hasBagsForJourney(c.bookingModel,0)&&e.hasBagsForJourney(c.bookingModel,1)&&(c.hasBagsBothLegs=!0),c.includeFatInFare=R.pathOr([],["detail","fats"],c.line).some(function(e){return R.contains(e.code,p)}),c.getInfantTranslationKey=s.getInfantTranslationKey,c.isSpanishInfant=s.isSpanishInfant},this.itemPrice=function(t){var n=e.getBundlePriceForPassengerTypeByJourney(t.code,c.line.leg,c.bookingModel);return h(t.amt,t.fat,n,c.includeFatInFare)},this.freeObjects=function(){var n={},i=function(n){return f.map(function(i,o){if(e.isBusinessPlusLeg(c.bookingModel,i.journeyNum)||e.isLeisurePlusLeg(c.bookingModel,i.journeyNum)||c.operatedBy||e.isErasmus(c.bookingModel)){var s=[],u=e.getAggregatedObjects(o,n,c.bookingModel).map(function(e){return e.model});if(u=u.filter(function(e){return c.isPlusLeg?"SEAT"===e.type||e.isPartOfBundle:0===e.total}),c.operatedBy&&(u=u.filter(function(e){return 0===e.segmentNum})),u.forEach(function(e){var t=s.find(function(t){return e.code===t.code});t?(t.qty+=e.qty,t.total+=e.total):s.push(babelHelpers["extends"]({},e))}),s.length>0&&(c.includedPBNumber=0),c.operatedBy){if(c.operatedBy===r.AIRMALTA.airline&&n!==a.Infant){var d=r.getAirlineConfig(c.operatedBy),g=c.line.detail.fareOption===d.fareOptions.goSmart?"goSmartFareFeatures":"goLightFareFeatures",h=R.prop(g,d);return l.getFareFeatures(h,n,c.bookingModel)}return s.filter(function(e){return e.isPartOfBundle})}return s.filter(function(e){return R.intersection([e.type,e.code],t).length})}return[]})},o=R.pluck("code",e.getFaresFor(0,c.bookingModel));return o.forEach(function(e){n[e]=i(e)}),n}();var b=function(t,n,i){return R.pipe(e.getMandatorySeatForAdultPessengerByJourney,R.pluck("model"))(t,n,i)},k=function(e,t,n){var i=e.find(function(e){return e.code===n});return[].concat(babelHelpers.toConsumableArray(e.filter(function(e){return e.code!==n})),[{code:n,count:R.pathOr(0,["count"],i)+t.qty,total:R.pathOr(0,["total"],i)+t.total}])},B=function(e){return e.reduce(function(e,t){return R.ifElse(function(e){return 0===R.path(["total"],e)},function(t){return k(e,t,"free_reserved")},function(t){return k(e,t,"additional")})(t)},[])};this.mandatorySeats=function(){if(e.isMandatorySeatNeeded(c.bookingModel)&&"journey"===c.line.type){var t=e.getPaxWhoNeedMandatorySeats(c.bookingModel),n={ADT:[],CHD:[]};return f.forEach(function(i,o){n.ADT[o]=[],n.CHD[o]=[];var r=R.pipe(e.getSeatsByPassengerTypeByJourney,R.pluck("model"))(o,"ADT",c.bookingModel);t.forEach(function(e){var t=b(o,e.key.id,c.bookingModel);if("ADT"===e.model.type&&t&&n.ADT[o].push(t.reduce(function(e,t){return k(e,t,"reserved")},[])),"ADT"===e.model.type&&r){var i=c.item.products.find(function(e){return"seats"===e.type});i.detail.items.length>0?n.ADT[o].push([{code:"additional",count:1,total:m?r[0].total+r[1].total:r[0].total}]):n.ADT[o].push(r.reduce(function(e,t){return k(e,t,"additional")},[]))}});var a=R.pipe(e.getSeatsByPassengerTypeByJourney,R.pluck("model"))(o,"CHD",c.bookingModel);a&&n.CHD[o].push(B(a))}),n}return{}}(),this.getLineItemDesc=function(e,t){return t.label?t.label:t.code?"trips.basket.group.item."+e+"."+t.code:"trips.basket.group.item."+e},this.showFat=function(e){return!~p.indexOf(e.code)},this.carPaidForExtras=function(){var e=R.pipe(R.filter(function(e){return!e.includedInRate}))(R.pathOr([],["line","detail","items","0","extras"],c));return babelHelpers["extends"]({},e,{totalQuantity:e.reduce(function(e,t){return e+t.selected},0)})},this.getTotalDiscount=function(){return R.pipe(R.map(function(e){return R.pathOr(0,["totalDiscount"],e)}),R.reduce(function(e,t){return e+t},0))(R.pathOr([],["line","detail","items"],c))},this.checkUpgrade=function(e){return"UPGRADE"===R.path(["type"],e)&&R.pipe(R.path(["detail","items"]),R.pluck("products"),R.flatten,R.map(R.pathOr(0,["qty"])),R.reduce(R.add,0),R.lt(0))(e)},this.getBagsTotal=function(e){return R.propEq("discountType","TargetedDiscount",e)?e.total:e.total+e.totalDiscount},this.$onChanges=function(t){"journey"===c.line.type&&i.hasVerboseBaggageStatus()&&!e.hasBagsForJourney(c.bookingModel,c.line.detail.journeyNum)&&(c.hasNoCheckinBaggage=!0),c.hasUpgradeDetails=c.checkUpgrade(R.path(["line","currentValue"],t))},this.canItemBeRemoved=function(t){return t.onRemove&&"change-seats"!==c.line.type&&(!c.isFlightChanged||"change-flight"===c.line.type)&&!("seats"===c.line.type&&e.isPlusBundle(c.bookingModel))},this.getFeeDiscount=function(e){return e*(.01*n.perc)},this.vouchersDiscount=e.getVouchersDiscount(this.bookingModel),this.travelCreditsDiscount=e.getTravelCreditsDiscount(this.bookingModel),this.shouldShowFreeItemPrice=function(e){return e.total>0&&(!c.isPlusLeg||"SEAT"!==e.type)}}]});


"use strict";angular.module("app.booking").component("tripsBreakdown",{templateUrl:"/partials/booking/directives/breakdown/trips-breakdown-popup/trips-breakdown-popup.html",bindings:{dropDownDisabled:"<",isSummaryView:"<",bookingModel:"<",totalPrice:"<",selectedPaymentMethod:"<",operatedBy:"<",isLaudaMotion:"<"},controller:["$scope","$filter","Basket","BookingRead","DccService","MorphPopupManager","FEATURE_CONFIG",function(e,t,o,n,a,r,i){var s=this,l="trips.summary.heading.view_summary",p=l,u=function(){var e=o.getTotal(),t=n.getHoldFareObjects(s.bookingModel);s.showOverallTotal=e.showOverallTotal,s.holdFareSelected=t.length>0;var a=R.reduce(function(e,t){return e+t.model.total},0,t);s.basketTotal=s.holdFareSelected?a:s.totalPrice,s.basketVatTotal=n.getVatSumForJourneys(s.bookingModel),s.hideTotalPrice=R.pathOr(!1,["price-breakdown-hide-total-price-enabled"],i)&&n.hasNonRyanairProductsBySold(s.bookingModel,!1),s.basketEmpty=function(){var e=R.pipe(R.pathOr([],["journeys"]),R.pluck("model"))(s.bookingModel);return!e.length||!e.every(function(e){return!!e})}()};this.getTranslatedSummaryLabel=function(){return p===l&&(p=t("translate")(l)),p},this.basketPopupId="basketVisible",this.toggleBasket=function(){return e.$evalAsync(function(){r.isOpen(s.basketPopupId)?r.closeAllPopup():(r.openPopup(s.basketPopupId),s.basketOpened=!0)})},r.onClose(this.basketPopupId,function(){return e.$evalAsync(function(){return s.basketOpened=!1,s.basketOpened})}),this.toggleBasketWhenDropDownEnable=function(){return!s.dropDownDisabled&&s.toggleBasket()},this.$onInit=function(){a.subscribe(u,!0)},this.$onChanges=function(e){(e.bookingModel||e.selectedPaymentMethod||e.totalPrice)&&u()},this.$postLink=function(){s.basketOpened=!1},this.$onDestroy=function(){a.unsubscribe(u)}}]});


"use strict";angular.module("app.booking").controller("ChangeFlightCtrl",["$scope","$q","$state","$log","$ngRedux","ChangeFlightActions","AllPlaces","Dates","DateConfig","Payments","Utilities","BookingRead","BookingModelActions","ModelQuery","LEG_TYPE","MarketConfig","Currency","Session","AdobeAnalytic","ANALYTICS_EVENT","Device","ChangeFlightUtil",function(e,t,n,a,s,o,i,r,l,g,h,c,u,d,f,p,b,m,y,k,F,S){var D=this,M=[];M.push(F.onPhone(function(e){var t=e.matches;D.isMobile=t}));var v=function(e){var t=angular.copy(e.bookingModel);return R.path(["bookingData","flightsChanged"],D)!==e.changeFlight.changed&&(D.bookingUpdating=!1),{changingCancelledFlight:R.pipe(c.getCancelledFlights,R.any(R.identity))(e.changeFlight.originalFlightData),confirmButtonTranslateId:e.changeFlight.paymentNotRequired?"trips.changeflight.drawer.confirm":"trips.changeflight.drawer.purchase",availableFlights:e.changeFlight.availableFlights,flightModel:e.changeFlight.flightModel,validFareSelection:e.changeFlight.changed&&!e.changeFlight.hasErrorsOnSelectedFares,messages:e.changeFlight.messages,originalFlightData:e.changeFlight.originalFlightData,bookingData:{paymentNotRequired:e.changeFlight.paymentNotRequired,selectedFlights:e.changeFlight.selectedFlights,bookingModel:t,journeys:R.pathOr([],["journeys"],t),passengers:R.pathOr([],["passengers"],t),hasIncludedSeats:c.hasBusinessOrLeisureOrFamilyPlus(t)},selectedFlights:e.changeFlight.selectedFlights}},C=function(t,n){if(D.flightModel&&D.flightModel!==t.flightModel){var a=!R.isEmpty(t.flightModel.departure),s=!R.isEmpty(t.flightModel.destination),o=t.flightModel.type&&"one-way"===t.flightModel.type?!0:!!t.flightModel.endDate,i=!!t.flightModel.startDate;"Outbound"!==D.flightModel.ChangeFlight||o||(D.flightModel.endDate=D.flightModel.endDate,(D.bookingData.journeys[f.inbound]||{}).isCancelled||(D.flightModel.startDate=D.flightModel.endDate,D.setShowAutoCorrectDateWarning(!0)));var r=t.selectedFlights.some(function(e){return e});D.validSearch=!!t.flightModel.type&&o&&i&&a&&s&&r,e.$broadcast("change-flight:reset-validation")}Object.assign(D,t,n)};M.push(s.connect(v,o)(C)),this.setAvailableFlights(this.bookingData.bookingModel),this.savedAvailableFlights=[],this.disableNextSeatStep=!1,this.isReturnFlight=this.bookingData.journeys.length>1,this.shared={passengers:this.bookingData.passengers,selectedPassengers:null,passengersWithBoughtSeats:[[],[]],selectedRetrievedDoc:null,selectSeats:[!1,!1],showBackBtn:!1,totalPrice:0,showTotalPrice:!1,goToSeatsConfirmStep:!1,seats:this.bookingData.bookingModel.seats};var j=["search-flights","select-fare","confirm"],B={},P={"search-flights":["search-flights"],"select-fare":["select-fare"],confirm:["confirm"]},T=function(e){var n={type:e.journeys.length>1?"return":"one-way",startDate:r.utc(e.journeys[f.outbound].model.departUTC).format(l.baseFormat),discounts:{},flightOutKey:e.journeys[f.outbound].model.flt,passengers:c.getPassengerBreakdownAsObject(e.bookingModel)};e.journeys[f.inbound]&&(n.flightInKey=e.journeys[f.inbound].model.flt,n.endDate=r.utc(e.journeys[f.inbound].model.departUTC).format(l.baseFormat)),D.setChangeFlightModel(n);var s=i.findOne("category","airport",e.journeys[f.outbound].model.orig),o=i.findOne("category","airport",e.journeys[f.outbound].model.dest);t.all([s,o]).then(function(t){D.setChangeFlightModelDeparture(t[f.outbound]),D.setChangeFlightModelDestination(t[f.inbound]);var n=angular.copy(D.flightModel,{});n.startDateUTC=r.utc(e.journeys[f.outbound].model.departUTC),e.journeys[f.inbound]&&(n.endDateUTC=r.utc(e.journeys[f.inbound].model.departUTC)),D.setChangeFlightOriginalFlightModel(n)})["catch"](function(e){return a.error(e)})};T(this.bookingData);var w=function(e){return D.bookingData.bookingModel.journeys.map(function(t){var n=t.key.journey;return D.bookingData.bookingModel.passengers.some(function(t){var a=t.key.id,s=c.isSetaPerPaxPerJourney(n,a,D.bookingData.bookingModel),o=R.pipe(c.getSeatsForPassengerByJourney,d.sumUpTotal)(n,a,D.bookingData.bookingModel);return c.getSoldSeatForPassengerByJourney(!0,a,n,D.bookingData.bookingModel)&&(e||D.bookingData.selectedFlights[n])&&(o>0||s||D.bookingData.hasIncludedSeats)})})};this.hasSoldSeats=w(!0),this.resolveSteps=function(){return D.isReturnFlight&&(j.unshift("select-flights"),P={"select-flights":["select-flights"],"search-flights":["search-flights"],"select-fare":["select-fare"],confirm:["confirm"]}),D.hasSoldSeats.some(function(e){return e})&&(j.splice(j.length-1,0,"select-seats"),P="return"===D.flightModel.type?{"select-flights":["select-flights"],"search-flights":["search-flights"],"select-fare":["select-fare"],"select-seats":["select-seats"],confirm:["confirm"]}:{"search-flights":["search-flights"],"select-fare":["select-fare"],"select-seats":["select-seats"],confirm:["confirm"]}),D.milestones=h.createStepIterator(Object.keys(P)),D.visibleSteps=D.milestones.steps.filter(function(e){return"select-seats"!==e}),B=h.createStepIterator(j),D.steps=B,D.currentStep=B.current,D.bookingData.journeys.map(function(e){var t=e.key.journey;return D.bookingData.bookingModel.seats.map(function(e){var n=e.key.journeys;return t===n?D.bookingData.passengers.map(function(n){var a=n.key.id,s=n.model.type,o=c.isSetaPerPaxPerJourney(t,a,D.bookingData.bookingModel);return e.key.passengers===n.key.id&&(e.model.total>0||"CHD"===s||o||D.bookingData.hasIncludedSeats)&&D.shared.passengersWithBoughtSeats[t].push(n),n}):e})})},this.resolveSteps(),this.stepCta=null,this.stepCtaBack=null,this.dialogButtonsDisabled=!1,this.isMobileSeatInfoOpened=!1,this.showProgressTabs=!0;var I=function(){D.milestones.current=D.milestones.steps.find(function(e){return P[e].some(function(e){return e===B.current})}),D.showProgressTabs="select-seats"!==D.milestones.current},O=function(e,t){var n="booking.active.manage-trip.change-flight",a={stateName:n+"."+t,fromStateName:n+"."+e,locale:p.getMarket(),currency:b.get("vmCurrency"),isAuthenticated:m.isAuthenticated,myRyanairId:m.getClientId()};y.triggerTrackingEvent(k.pageLoad,a)};this.nextStep=function(t){t?B.current=t:B.isLast?e.closeThisDialog():(O(B.current,B.nextStep),B.next(),"select-seats"===B.current&&S.seatsNotChanged(D.originalFlightData,D.bookingData.bookingModel)&&B.next()),D.shared.showBackBtn=!B.isFirst,I()},this.previousStep=function(){B.previous(),O(B.nextStep,B.current),"select-seats"===B.current&&B.previous(),D.shared.showBackBtn=!!B.currentIndex,I()},this.cta=function(){D.stepCta(function(e){D.nextStep(e)},function(){D.showSpinner=!1})},this.ctaBack=function(){D.stepCtaBack(function(){D.previousStep()})},this.moreInfo=!1,this.toggleInfo=function(){D.moreInfo=!D.moreInfo},this.confirmChanges=function(){D.bookingData.paymentNotRequired?D.confirmNoPaymentChangeFlight().then(function(){e.closeThisDialog()}):(g.changeFlightPayment=!0,e.closeThisDialog("payment"))},this.cancelChanges=function(){s.dispatch(u.refresh("booking.active",!1,!0)).then(function(){n.go("booking.active",{},{reload:!0}),D.resetChangeFlight()})},this.toggleMobileSeatMapInfo=function(e){D.isMobileSeatInfoOpened=e,R.not(e)&&(D.seatConfirmation={isConfirmed:!1})},this.toggleSeatConfirmation=function(e){D.seatConfirmation={isConfirmed:e},e&&(D.isMobileSeatInfoOpened=!1)},e.$watch(function(){return D.bookingData.selectedFlights},function(){D.validSelection=D.bookingData.selectedFlights.some(function(e){return e})}),e.$watch(function(){return D.shared.seatSelectionStep},function(){var e=D.isReturnFlight?D.shared.seatSelectionStep:"seats.oneWayFlight";switch(e){case"seats.oneWayFlight":case"seats.inboundMap":D.seatSelectButton="trips.seats.seatmap_review-seats";break;case"seats.outboundMap":D.seatSelectButton="trips.seats.seatmap_next-flight";break;default:D.seatSelectButton="trips.changeflight.drawer.continue"}D.showProgressTabs=!D.shared.seatSelectionStep}),e.$on("$destroy",function(){s.dispatch(o.resetChangeFlight()),M.forEach(function(e){return e()})})}]);


"use strict";angular.module("app.booking").component("flightStatus",{templateUrl:"/partials/booking/directives/itinerary/flight-status/flight-status.html",bindings:{status:"<",operatedBy:"<"},controller:["BOOKING_STATES","BOOKING_STATES_OPS",function(t,i){var s="trips.itinerary.flight_status_",a=this.operatedBy?i.CONFIRMED:t.CONFIRMED;this.flightStatusMessage=this.status!==a?s+"not_confirmed":s+"confirmed"}]});


"use strict";angular.module("app.booking").component("itineraryBreakdownJourneyItem",{templateUrl:"/partials/booking/directives/itinerary/itinerary-breakdown-journey/itinerary-breakdown-journey.html",bindings:{passengers:"<",journeyType:"<",journey:"<",mandatorySeats:"<",isBusinessPlus:"<",isLeisurePlus:"<",bookingModel:"<",isPartOfUpgrade:"<",isErasmus:"<",isFamilyPlus:"<",isFareSeparateBundle:"<"},controller:["$state","BookingRead","FARE_TYPES","$filter","Dates","FEATURE_CONFIG","InfantDiscountService","ConnectingFlightService",function(e,n,r,i,t,o,s,a){var u=this,p=i("fareBreakdownPrice"),l=function(e){return R.pipe(R.pluck("model"),R.filter(function(e){return R.contains(e.code,["BBG","FAST","PS","PF","PB","RVOU"])&&0===e.total}),R.map(R.when(R.whereEq({code:"PS",isPartOfBundle:!0}),R.assoc("oldCode","PB"))),R.map(R.when(R.whereEq({code:"RVOU"}),R.assoc("type","RVOU"))))(n.getSoldSsrsForPassengerByJourney(!0,e,u.journeyType,u.bookingModel))},c=function(e){return R.pipe(R.pluck("model"),R.filter(function(e){return 0===e.total}))(n.getSeatsForPassengerByJourney(u.journeyType,e,u.bookingModel))},g=function(e){var n=R.reduce(function(e,n){return babelHelpers["extends"]({},n,{qty:n.qty+e.qty})},{qty:0}),r=function(e,n){var r=n.num,i=n.type,t=R.converge(R.concat,[l,c])(r);return e[i]=R.concat(e[i]||[],t),e},i=R.pipe(R.groupBy(R.prop("type")),R.map(n),R.values);e&&e.length>0&&(u.extras=R.pipe(R.reduce(r,{}),R.map(i))(e))},y=function(){u.promoDiscount=R.pipe(R.reduce(function(e,n){return e+(""===n.code?n.total||n.amt:0)},0))(R.pathOr([],["journey","fats"],u))},d=function(e){var r=R.pathOr(null,["journeys",e,"model","departUTC"],u.bookingModel),i=R.length(R.pathOr([],["passengers"],u.bookingModel)),s=R.pipe(n.getPriorityBoardingItems(!0),R.filter(function(n){return n.key.journeys===e}),R.length)(u.bookingModel),a=R.equals(s,i);u.showSmallBagsIncludedMessage=t.isSameOrAfter(r,o.CABIN_BAG_LAUNCH_DATE)&&R.propOr(!1,"priority-boarding-and-cabin-bags-enabled",o)&&!a&&!u.isConnectingLeg,u.smallBagMessageQty=R.subtract(i,s)};this.containsObjKey=function(e,n){return n.some(function(n){return n.code===e})},this.$onInit=function(){u.getInfantFeePrice=s.getInfantFeePrice,u.getInfantTranslationKey=s.getInfantTranslationKey,u.isSpanishInfant=s.isSpanishInfant,u.isInItinerary=e.is("booking.active.itinerary"),u.isConnectingLeg=a.isConnectingLeg(u.journey),u.connectingAirportName=u.isConnectingLeg&&a.getConnectingCityByLeg(u.journey),u.isBusinessPlus="PLUS"===u.journey.fareOption,u.isLeisurePlus="SURE"===u.journey.fareOption,u.isRegular="REGU"===u.journey.fareOption,u.isConnectingFlight=n.isConnectingFlight(u.bookingModel),u.displayBusinessDiscounts=u.isBusinessPlus||u.isLeisurePlus||u.isErasmus||u.isFamilyPlus||u.isConnectingFlight||u.isRegular,u.sendSMS=R.pipe(R.pathOr([],["extras"]),R.pluck("model"),R.filter(function(e){return"SMS"===e.code&&!e.sold}),R.length)(u.bookingModel)>0,u.isFareSeparateBundle?u.fareType=r.STANDARD:u.isBusinessPlus?u.fareType=r.BUSINESS_PLUS:u.isLeisurePlus?u.fareType=r.LEISURE_PLUS:u.isRegular?u.fareType=r.REGULAR:u.fareType=r.STANDARD,d(u.journey.journeyNum),y(),u.isFareSeparateBundle||g(u.passengers)},this.getFarePrice=function(e){var n=R.prop("total"),r=function(e){return p(e.amt,e.fat,0,u.containsObjKey("AA",u.journey.fats))},i=function(e){return R.applySpec({price:e,applyFee:R.prop("isHandlingFeeApplicable")})};return R.pipe(R.prop("bundles"),R.map(i(n)),R.append(i(r)(e)),R.pluck("price"),R.sum)(e)}}]});


"use strict";angular.module("app.booking").component("itineraryBreakdownJourneyItemOps",{templateUrl:"/partials/booking/directives/itinerary/itinerary-breakdown-journey-ops/itinerary-breakdown-journey-ops.html",bindings:{passengers:"<",journeysNumber:"<",fees:"<",bookingModel:"<"},controller:["BookingRead","FARE_TYPES",function(e,r){var n=this,t=function(e,r){return R.pipe(R.pluck(e),R.sum)(r)},o=R.propSatisfies(R.lt(0),"count"),a=R.filter(R.whereEq({isPartOfBundle:!0,total:0})),i=R.filter(R.whereEq({segmentNum:0})),u=R.curry(function(e,r){return babelHelpers["extends"]({},r,{count:R.multiply(e,r.count)})}),p=function(e){return R.reduce(function(r,n){var t=babelHelpers["extends"]({},r),o=t[n[e]];return o?t[n[e]]=[].concat(babelHelpers.toConsumableArray(o),[babelHelpers["extends"]({},n)]):t[n[e]]=[babelHelpers["extends"]({},n)],t},{})},s=R.curry(function(e,r){var n=r,o=e[r],a=t("amt",o),i=t("vat",o),u=t("total",o),p=t("qty",o);return{code:n,count:p,netPrice:a,vat:i,totalPrice:u}}),l=function(r,n){var t=function(r){var t=R.pipe(R.map(function(r){return e.getSoldSsrsByPassenger(!0,r.num,n,!1)}),function(e){var r;return(r=R).concat.apply(r,babelHelpers.toConsumableArray(e).concat([[]]))},R.pluck("model"),a,i,p("code"))(r);return R.pipe(R.keys,R.map(s(t)),R.filter(o))(t)};return R.pipe(p("type"),R.map(t))(r)};this.$onInit=function(){n.fareType=r.STANDARD;var e=R.pipe(R.filter(R.propEq("type","FARE")),p("code"))(n.fees);n.extras=l(n.passengers,n.bookingModel),n.fares=R.pipe(R.keys,R.map(s(e)),R.filter(o),R.map(u(n.journeysNumber)))(e)}}]});


"use strict";angular.module("app.booking").component("itineraryCarHireInfo",{templateUrl:"/partials/booking/directives/itinerary/itinerary-car-hire-info/itinerary-car-hire-info.html",bindings:{carHire:"<"},controller:["Dates","DateConfig",function(r,i){this.toTripHistoryFormat=function(t){return r.utc(t).format(R.path(["displayFormats","tripHistoryDate"],i))}}]});


"use strict";angular.module("app.booking").component("itineraryExtras",{templateUrl:"/partials/booking/directives/itinerary/itinerary-extras/itinerary-extras.html",bindings:{passengers:"<",addons:"<"},controller:["Dates","DateConfig",function(t,a){this.emptyExtras=0===this.addons.length,this.hasInsurance=R.pipe(R.filter(function(t){return"INS"===t.code&&t.sold}),R.length)(this.addons)>0,this.getDateRange=function(e){return{start:t.parseISO(e.start).format(a.displayFormats.dayOfWeekAndDayAndMonth),end:t.parseISO(e.end).format(a.displayFormats.dayOfWeekAndDayAndMonth)}},this.formatDate=function(e){return t.parseISO(e).format(a.specials.richDateInput.format)}}]});


"use strict";angular.module("app.booking").component("itineraryFlightInfo",{templateUrl:"/partials/booking/directives/itinerary/itinerary-flight-info/itinerary-flight-info.html",bindings:{journeys:"<",bookingModel:"<"},controller:["BookingRead","Dates","AEMConfig",function(e,i,n){var t=this;this.journeys=this.journeys.map(function(i){return babelHelpers["extends"]({},i,{segments:e.getSegmentsFor(i.journeyNum,t.bookingModel)})}),this.getConnectionTime=function(e){return i.utc(t.journeys[e].segments[1].model.departUTC).subtract(i.utc(t.journeys[e].segments[0].model.arriveUTC))},this.isFlexiPlusLeg=function(i){return e.isBusinessPlusLeg(t.bookingModel,i)},this.isPlusLeg=function(i){return e.isLeisurePlusLeg(t.bookingModel,i)},this.isFamilyPlusLeg=function(i){return e.isFamilyPlusLeg(t.bookingModel,i)},this.staticFilePrefix=n.getStaticFilePrefix()}]});


"use strict";angular.module("app.booking").component("itineraryGroundTransferInfo",{templateUrl:"/partials/booking/directives/itinerary/itinerary-ground-transfer-info/itinerary-ground-transfer-info.html",bindings:{groundTransfer:"<"},controller:["Dates","DateConfig",function(r,t){this.toTripHistoryFormat=function(n){return r.utc(n).format(R.path(["displayFormats","tripHistoryDate"],t))}}]});


"use strict";angular.module("app.booking").component("itineraryPassengers",{templateUrl:"/partials/booking/directives/itinerary/itinerary-passengers/itinerary-passengers.html",bindings:{passengers:"<"},controller:function(){}});


"use strict";angular.module("app.booking").component("itineraryPrice",{templateUrl:"/partials/booking/directives/itinerary/itinerary-price/itinerary-price.html",bindings:{journeys:"<",passengers:"<",payments:"<",addons:"<",extras:"<",fees:"<",paymentFee:"<",isBusinessPlus:"<",isLeisurePlus:"<",isPartOfUpgrade:"<",bookingModel:"<",operatedBy:"<",isErasmus:"<",isFamilyPlus:"<",isFareSeparateBundle:"<"},controller:["BookingRead","MarketConfig","PaymentOptionFees","Configuration","DISCOUNTED_BAG_OR_INFANT_CODE",function(e,t,o,i,n){var a=this,r=function(e){return e.code===n?e.amt:0},s=function(e){return R.reduce(function(t,o){return t+o[e]},0)},l=R.pipe(R.filter(r),s("amt"))(this.payments),d=R.pipe(R.filter(R.whereEq({status:"Approved",type:"PrePaid"})),s("amt"))(this.payments);this.paymentMethodMultiplier=1;var p=function(){var t=R.pathEq(["carHire","0","model","serviceProvider"],"rentalcars",a.bookingModel),o=R.pathEq(["carHire","0","model","status"],"PENDING",a.bookingModel)&&t;return e.getBookingSoldTotal(a.bookingModel,a.paymentMethodMultiplier,o)},u=p();this.feeDisplayType=t.getCCFeeDisplayType(),this.itineraryTotalPrice=u+l-d,this.displayVOAndTCDiscount=u>0,this.itineraryDccTotal=e.getDccTotalCost(this.bookingModel),this.itineraryDccCurrency=R.pipe(R.find(R.path(["model","dccCurrency"])),R.path(["model","dccCurrency"]))(this.bookingModel.payments);var c=function(t,o,i){return R.pipe(e.getMandatorySeatForAdultPessengerByJourney,R.pluck("model"))(t,o,i)},y=R.curry(function(e,t,o){return babelHelpers["extends"]({},t,babelHelpers.defineProperty({},e,{count:R.pathOr(0,[e,"count"],t)+o.qty,total:R.pathOr(0,[e,"total"],t)+o.total}))}),h=R.reduce(function(e,t){return R.ifElse(R.pathEq(["total"],0),y("freeReservedSeat",e),y("additionalSeat",e))(t)},{});if(e.isMandatorySeatNeeded(this.bookingModel)&&e.hasSomeAdultWithCode("SETA",this.bookingModel)){var g=e.getPaxWhoNeedMandatorySeats(this.bookingModel),f={SETA:{count:0,total:0},additionalSeat:{count:0,total:0},freeReservedSeat:{count:0,total:0}};g.forEach(function(t){var o=R.pipe(R.chain(function(o){return e.getSeatsForPassengerByJourney(o,t.key.id,a.bookingModel)}),R.pluck("model"),R.filter(function(e){return e.total>0}))([0,1]);"ADT"===t.model.type&&o&&(f.additionalSeat=o.reduce(function(e,t){return{count:e.count+t.qty,total:e.total+t.total}},f.additionalSeat))});var m=R.pipe(e.getSeatsByPassengerType,R.pluck("model"))("CHD",this.bookingModel);if(m){var M=h(m);Object.keys(M).forEach(function(e){f[e].count+=M[e].count,f[e].total+=M[e].total})}this.mandatorySeatsGroupedByType=f}if(e.isMandatorySeatNeeded(this.bookingModel)&&e.hasSomeAdultWithCode("SETA",this.bookingModel)){var k=e.getPaxWhoNeedMandatorySeats(this.bookingModel);this.mandatorySeats=this.journeys.map(function(t,o){var i={ADT:[]},n=R.pipe(e.getSeatsByPassengerTypeByJourney,R.pluck("model"))(o,"ADT",a.bookingModel);k.forEach(function(t){var r=c(o,t.key.id,a.bookingModel);"ADT"===t.model.type&&r&&i.ADT.push(r.reduce(y("SETA"),{})),"ADT"===t.model.type&&n&&i.ADT.push({additional:{count:1,total:e.getBookingInfo(a.bookingModel).isConnectingFlight?n[0].total+n[1].total:n[0].total}})});var r=R.pipe(e.getSeatsByPassengerTypeByJourney,R.pluck("model"))(o,"CHD",a.bookingModel);return r&&(i.CHD=h(r)),i})}if("INC"===this.feeDisplayType){var T=function(e){var t=o.get("savedMethods").find(function(t){return t.feeType===e.code}),n=R.prop("perc",t)||0,r=R.prop("vat",i.get("opts"))||0;a.paymentMethodMultiplier=1+n/100*(1+r/100)},b=function(){a.itineraryTotalPrice=p()+l-d};if(this.paymentFee)if(this.paymentFeeTotal=R.pipe(s("total"))(this.paymentFee),o.get("savedMethods"))T(this.paymentFee),b();else{var S=this.journeys[0];o.getMethods({origin:S.orig,destination:S.dest}).then(function(){T(a.paymentFee),b()})}}var v=function(e){return R.pathEq([e,"0","model","status"],"CONFIRMED",a.bookingModel)};this.isCarHireSectionVisible=v("carHire"),this.isGroundTransferSectionVisible=v("groundTransfer")}]});


"use strict";angular.module("app.booking").component("itineraryProducts",{templateUrl:"/partials/booking/directives/itinerary/itinerary-products/itinerary-products.html",bindings:{passengers:"<",bookingModel:"<",operatedBy:"<",isPartOfUpgrade:"<"},controller:["BookingRead","HIDDEN_ITINERARY_SSRS",function(n,e){var o=this,r=this.isPartOfUpgrade?"":"SURE",s=R.when(function(){return o.operatedBy},R.filter(R.whereEq({segmentNum:0}))),t=function(t,i){return R.pipe(R.pluck("model"),R.filter(function(n){return!~e.indexOf(n.code)&&"EXPR"!==n.code&&n.code!==r}),s)(n.getSoldSsrsForPassengerByJourney(!0,t,i,o.bookingModel))},i=function(e){return e&&e.some(function(e){return n.hasAnySoldSeatByPassenger(!0,e.num,o.bookingModel)||n.hasAnySoldSsrsByPassenger(!0,e.num,o.bookingModel)})},u=function(e){return e&&e.some(function(e){return n.hasAnySoldSeatForPassengerByJourney(!0,e.num,1,o.bookingModel)||n.hasAnySoldSsrsForPassengerByJourney(!0,e.num,1,o.bookingModel)})},a=function(n){var e=[];return n.forEach(function(n){var o=e.find(function(e){return n.code===e.code});o&&"FAMI"!==o.code&&"SURE"!==o.code&&"REGU"!==o.code&&(o.qty+=n.qty,o.total+=n.total),!o||"FAMI"!==o.code&&"SURE"!==o.code&&"REGU"!==o.code||(o.total+=n.total),o||e.push(babelHelpers["extends"]({},n))}),e};this.isConnectingFlight=n.getBookingInfo(this.bookingModel).isConnectingFlight,this.showProducts=i(this.passengers),this.showInbound=u(this.passengers),this.visibleSsrs=R.pipe(R.map(function(n){return babelHelpers["extends"]({},n,{outboundProducts:a(t(n.num,0)),inboundProducts:a(t(n.num,1))})}))(this.passengers),this.hasInboundProducts=function(e){return n.hasAnySoldSsrsForPassengerByJourney(!0,e.num,1,o.bookingModel)},this.hasExtras=function(e,r){return n.hasAnySoldSeatForPassengerByJourney(!0,e.num,r,o.bookingModel)||n.hasAnySoldSsrsForPassengerByJourney(!0,e.num,r,o.bookingModel)},this.hasAnySoldSeatForPassengerByJourney=function(e,r){return n.hasAnySoldSeatForPassengerByJourney(!0,e.num,r,o.bookingModel)},this.getSoldSeatForPassengerByJourney=function(e,r){return R.pipe(n.getSoldSeatForPassengerByJourney,R.pluck("model"))(!0,e.num,r,o.bookingModel)}}]});


"use strict";angular.module("app.booking").component("itineraryProductsSummary",{templateUrl:"/partials/booking/directives/itinerary/itinerary-products-summary/itinerary-products-summary.html",bindings:{passengers:"<",payments:"<",addons:"<",extras:"<",fees:"<",bookingModel:"<",feeDisplayType:"<",paymentMethodMultiplier:"<",isPartOfUpgrade:"<",mandatorySeatsGroupedByType:"<",isFareSeparateBundle:"<",displayVoAndTcDiscount:"<"},controller:["BookingRead","TRAVEL_CREDIT","DISCOUNTED_BAG_OR_INFANT_CODE",function(e,t,o){var r=this,n={},a=R.pipe(R.pluck("model"),R.pluck("num"))(e.getPaxWhoNeedMandatorySeats(this.bookingModel)),s=e.isMandatorySeatNeeded(this.bookingModel)?a:[];this.passengers.forEach(function(t){var o=R.pipe(R.pluck("model"))(e.getSoldSeatByPassenger(!0,t.num,r.bookingModel));o.forEach(function(o){o&&(!R.contains(t.num,s)||!e.hasSomeAdultWithCode("SETA",r.bookingModel)&&o.total>0)&&(n[o.type]?n[o.type].push(o):n[o.type]=[o],n=babelHelpers["extends"]({},n,babelHelpers.defineProperty({},o.type,n[o.type])))});var a=R.pipe(R.pluck("model"),R.reject(function(e){return R.contains(e.code,["EXPR"])}))(e.getSoldSsrsByPassenger(!0,t.num,r.bookingModel,r.isFareSeparateBundle));a.forEach(function(e){"BAG"===e.code||"BBG"===e.code?n.BAGS=R.pipe(R.either(function(e){return e.BAGS},function(){return[]}),R.append(e))(n):"SETA"===e.code?n.SEAT=R.pipe(R.pathOr([],["SEAT"]),R.append(e))(n):n[e.code]?n[e.code].push(e):n[e.code]=[e],n=babelHelpers["extends"]({},n)});var p=R.pluck("model",e.getSoldPaxFeesByPassenger(!0,t.num,r.bookingModel));p.forEach(function(e){n[e.code]?n[e.code].push(e):n[e.code]=[e],n=babelHelpers["extends"]({},n,babelHelpers.defineProperty({},e.code,n[e.code]))})}),this.addons.forEach(function(e){var t=babelHelpers["extends"]({},e,{src:"INS"===e.code&&e.itemId?e.itemId:e.src});n[t.src]?n[t.src].push(t):n[t.src]=[t],n=babelHelpers["extends"]({},n,babelHelpers.defineProperty({},t.src,n[t.src]))}),this.extras.forEach(function(e){n[e.code]?n[e.code].push(e):n[e.code]=[e],n=babelHelpers["extends"]({},n,babelHelpers.defineProperty({},e.code,n[e.code]))}),this.fees.forEach(function(e){("PaymentFee"!==e.type||"EXC"===r.feeDisplayType)&&(n[e.type]?n[e.type].push(e):n[e.type]=[e],n=babelHelpers["extends"]({},n,babelHelpers.defineProperty({},e.type,n[e.type])))}),this.payments.forEach(function(e){if("VO"===e.code){var t=babelHelpers["extends"]({},e,{qty:1,total:-1*e.amt});n[t.code]?n[t.code].push(t):n[t.code]=[t],n=babelHelpers["extends"]({},n,babelHelpers.defineProperty({},t.code,n[t.code]))}}),this.payments.forEach(function(e){if(e.code===t.CODE){var o=babelHelpers["extends"]({},e,{qty:1,total:-1*e.amt});n[o.code]?n[o.code].push(o):n[o.code]=[o],n=babelHelpers["extends"]({},n,babelHelpers.defineProperty({},o.code,n[o.code]))}});var p=n.BAGS&&R.filter(function(e){return e.code===o},this.payments).length?R.reduce(function(e,t){return t.totalDiscount+e},0,n.BAGS):0;!function(e){e&&(n.BS?n.BS.push({total:-e,qty:1,recalculated:!0}):n.BS=[{total:-e,qty:1,recalculated:!0}]),n.BAGS&&n.BAGS.map(function(e){return e.totalDiscount&&!e.recalculatedBAGS?babelHelpers["extends"]({},e,{recalculatedBAGS:!0}):e})}(p);var i=function(e){var t=R.pipe(R.map(function(e){return n.BS&&e.totalDiscount>0&&e.totalWithoutDiscount||e.total}),R.sum);return r.isPartOfUpgrade?t(e):R.pipe(R.map(R.when(R.propEq("isHandlingFeeApplicable",!0),R.evolve({total:R.multiply(r.paymentMethodMultiplier)}))),t)(e)},l=R.propSatisfies(function(e){return!parseInt(e,10)},"total"),c=R.propEq("isPartOfBundle",!0),d=R.propSatisfies(R.contains(R.__,["SMS"]),"code"),u=R.pipe(d,R.not),y=R.allPass([l,c,u]),f=R.reject(y),b=R.pipe(R.pluck("qty"),R.sum),h=R.contains(R.__,["SURE","PLUS"]),m=R.curry(function(t,o,n){var a=R.contains(n,["PS","PB"])&&e.isConnectingFlight(r.bookingModel),s=t||a?o[n]:f(o[n]),p=i(s),l=b(s);return{key:n,count:l,details:s,totalPrice:p}}),S=R.propSatisfies(R.lt(0),"count"),g=R.pipe(R.keys,R.reject(h),R.map(m(this.isFareSeparateBundle,n)),R.filter(S));this.products=g(n)}]});


"use strict";angular.module("app.booking").filter("sortAsPartOfBundle",function(){var e=function(e){switch(e){case"SURE":case"PLUS":case"REGU":case"FAMI":return 1;case"PS":return 2;case"BAGS":return 3;case"SEAT":return 4;case"FAST":return 5;default:return 6}};return function(r){return[].concat(babelHelpers.toConsumableArray(r)).sort(function(r,t){return e(r.key)<e(t.key)?-1:e(r.key)>e(t.key)?1:0})}});


"use strict";angular.module("app.booking").component("itineraryProductsSummaryOps",{templateUrl:"/partials/booking/directives/itinerary/itinerary-products-summary-ops/itinerary-products-summary-ops.html",bindings:{fees:"<"},controller:function(){var t=this.fees.reduce(function(t,e){var r=babelHelpers["extends"]({},t),a=r[e.type];return a?r[e.type]=[].concat(babelHelpers.toConsumableArray(a),[babelHelpers["extends"]({},e)]):r[e.type]=[babelHelpers["extends"]({},e)],r},{}),e=function(t,e){return R.pipe(R.pluck(t),R.sum)(e)},r=R.propSatisfies(R.lt(0),"count"),a=R.curry(function(t,r){var a=r,s=t[r],i=e("amt",s),n=e("vat",s),o=e("total",s),p=e("qty",s);return{type:a,count:p,netPrice:i,vat:n,totalPrice:o}});this.products=R.pipe(R.keys,R.map(a(t)),R.filter(r))(t),this.totalVat=e("vat",this.products)}});


"use strict";angular.module("app.booking").component("reservationNumber",{templateUrl:"/partials/booking/directives/itinerary/reservation-number/reservation-number.html",bindings:{number:"<"},controller:function(){}});


"use strict";angular.module("app.booking").component("raIframeCard",{templateUrl:"/partials/booking/ra-iframe/components/ra-iframe-card/ra-iframe-card.component.html",bindings:{iframeId:"@",onError:"&",onLoad:"&",type:"@"},controller:["RAIframeService","$element","ngFolktale","$state","$log","Device","$filter","$ngRedux","RAIframeActions","CarRentalActions","$stateParams","smoothScroll","$timeout","RA_IFRAME_TYPES","IFRAME_IDS","$window","BookingRead","FEATURE_CONFIG","RaIframeCarRentalService",function(e,a,i,t,n,r,o,d,s,c,l,f,p,m,u,g,h,E,I){var A=this,T=e.get(this.iframeId);this.sandboxExceptions=e.sandboxExceptions;var D=function(e){return{isRebuildNeeded:T.isRebuildNeeded(e.bookingModel,R.pathOr({},["$state","bookingModel"],A)),state:e.raiframe[A.iframeId],bookingModel:e.bookingModel,flightExtras:e.flightExtras,isCarRentalAtPageEnabled:R.pathOr(!1,["car-rental-at-page-enabled"],E),isActiveTrip:!h.isPotentialBooking(e.bookingModel),carRentalToken:R.pathOr("",["carRental","token"],e),isCheckinDialogOpen:!!R.path(["checkin","checkinSteps","length"],e)}},S=[],b=function(e){if(T.onOpenDrawer(e),T.handleGetAddon)T.handleGetAddon(d.getState().bookingModel,e);else{var a=T.GET_ADDON_STATE;"function"==typeof T.GET_ADDON_STATE&&(a=T.GET_ADDON_STATE(d.getState().bookingModel)),t.go(a,e)}},_=function(a){i.Either.of(a).chain(e.isSameOrigin(T.ORIGIN)).map(function(e){return e.data}).chain(e.isSameProduct(T.PRODUCT_ID)).chain(e.isType("GET_ADDON")).map(T.GET_ADDON_LENS.bind(T)).fold(n.warn,b)},O=function(a){i.Either.of(a).chain(e.isSameOrigin(T.ORIGIN)).map(function(e){return e.data}).chain(e.isSameProduct(T.PRODUCT_ID)).chain(e.isType("GET_ADDON_ERROR")).map(T.GET_ADDON_LENS.bind(T)).fold(n.debug,function(){A.onError()})},N=function(a){i.Either.of(a).chain(e.isSameOrigin(T.ORIGIN)).map(R.prop("data")).chain(e.isSameProduct(T.PRODUCT_ID)).chain(e.isType("QUICK_ADD_CAR_HIRE_INSURANCE")).map(R.prop("payload")).map(R.tap(function(e){return T.quickSaveToBasket(e)})).chain(function(e){return T.dispatchSetSelectedAddon(e)}).fold(n.debug,n.debug)},k=e.getUpdateParamsListener(T.ORIGIN,R.pipe(function(e){return T.UPDATE_PARAMS_LENS(e,"card")},T.saveUpdatedParams.bind(T))),C=function(){return d.connect(D,[s,c])(function(e,i){var t=babelHelpers.slicedToArray(i,2),n=t[0],r=t[1],d=e.isCarRentalAtPageEnabled,s=e.isCheckinDialogOpen,c=e.isActiveTrip,f=e.bookingModel,p=e.flightExtras,u=e.carRentalToken,g=void 0===u?"":u,E=e.isRebuildNeeded,D=e.state,S=R.path(["0"],a.find("iframe"));S&&(s?S.classList.add("ra-ifcard__iframe--inactive"):S.classList.remove("ra-ifcard__iframe--inactive"));var b=R.pathOr({},["carHire","0","model"],f),C=I.isNeedToShowCarRentalIframe({isCarRentalAtPageEnabled:d,isActiveTrip:c,carHireModel:b}),v=b.confirmationId,U=void 0===v?"":v,L=C?m.CAR_RENTAL:m.CAR_HIRE;if(!g&&U&&C){var P=R.pathOr("",["0","email"],h.getModel("contacts",f));I.getBookingToken({bookingRef:U,emailAddress:P}).then(function(e){var a=e.data;A.iframeUrl=o("trustUrl")(T.buildIframeUrl({location:"Card",displayType:A.type,stateParams:l,bookingModel:f,flightExtras:p.extras},L,a.token))})}else(p.extras&&!A.iframeUrl||E)&&(A.iframeUrl=o("trustUrl")(T.buildIframeUrl({location:"Card",displayType:A.type,stateParams:l,bookingModel:f,flightExtras:p.extras},L,g)));T.onCardStateChange(D,R.pathOr({},["$state","state"],A),A),A.WINDOW_LISTENERS=C&&"EVENTS"!==T.ID?[]:[k,_,O,N],Object.assign(A,{$state:e,$actions:[n,r]})})};this.$onInit=function(){d.dispatch(s.initIframe({id:T.ID,ORIGIN:T.ORIGIN,CARD_URL:T.URLS.Card,DRAWER_URL:T.URLS.Drawer})),S.push(C())};var v=function(a){return function(i){S.push(r.onResize(e.dispatchResize(i,a)))}},U=function(){l.scrollTo===T.ID&&p(function(){f(a[0])},0,!1)},L=angular.noop,P=angular.noop;this.$postLink=function(){U(),i.fromNullable(a.find("iframe")[0]).fold(n.debug,function(a){a.onload=A.onLoad;var i=a.contentWindow;L=T.setCardIframe(i),T.onCardIframeLoaded(),e.addWindowListeners(A.WINDOW_LISTENERS)(i),v(T.URLS.Card)(i),P=e.registerIntersectionObserver({iframe:a,iframeUrl:T.URLS.Card,productType:A.iframeId})})},this.$onDestroy=function(){P(),L(),e.removeWindowListeners(A.WINDOW_LISTENERS),S.forEach(function(e){return e()})}}]});


"use strict";angular.module("app.booking").component("raIframeDrawer",{templateUrl:["$attrs",function(n){return"modal"===n.type?"/partials/booking/ra-iframe/components/ra-iframe-drawer/ra-iframe-drawer-modal.component.html":"/partials/booking/ra-iframe/components/ra-iframe-drawer/ra-iframe-drawer.component.html"}],bindings:{iframeId:"@",popupName:"@",bannerIcon:"@",bannerTitle:"@",bannerContent:"@",buttonConfirm:"@",dialogTitle:"@",noCancelButton:"@",excludePaymentFee:"@",onLoad:"&"},controller:["RAIframeService","$element","ngFolktale","$stateParams","$log","$timeout","DialogManager","$scope","Device","$filter","RAIframeActions","$ngRedux",function(n,e,t,a,o,i,r,s,l,d,f,u){var c=this,m=n.get(this.iframeId),b=[];this.sandboxExceptions=n.sandboxExceptions;var g=function(n){return{state:n.raiframe[c.iframeId],bookingModel:n.bookingModel,flightExtras:n.flightExtras}},p=function(){return u.connect(g,f)(function(n,e){n.flightExtras.extras&&!c.iframeUrl&&(c.iframeUrl=d("trustUrl")(m.buildIframeUrl({location:"Drawer",stateParams:a,bookingModel:n.bookingModel,flightExtras:n.flightExtras.extras}))),R.pathOr(!1,["$state","state","isLoading"],c)&&!n.state.isLoading&&c.closeDialog(),Object.assign(c,{$state:n,$actions:e})})};this.$onInit=function(){b.push(p()),c.totalPrice=m.extractTotalFromBookingModel(c.$state.bookingModel,!1)},this.ctaDisabled=!0;var h=function(n){return s.$evalAsync(function(){c.ctaDisabled=!m.isConfirmEnabled(n,c.$state.bookingModel),c.isConfirmPlusAvailable=m.isConfirmPlusAvailable(n,c.$state.bookingModel)}),n},E=function(e){return m.onSaveAddon(e),n.saveIframeData(c.iframeId,e),e},D=function(n){"object"===("undefined"==typeof n?"undefined":babelHelpers["typeof"](n))?c.total=n:(c.total=void 0,c.totalPrice=n)},x=function(n){c.buttonTexts=babelHelpers["extends"]({},n)},A=function(n){return t.Box(n).chain(m.getTotalPrice.bind(m)).fold(o.debug,D.bind(c)),n},$=function(n){return t.Box(n).chain(m.getCustomTexts.bind(m)).fold(angular.noop,x.bind(c)),n},I=function(e){t.Either.of(e).chain(n.isSameOrigin(m.ORIGIN)).map(function(n){return n.data}).chain(n.isType("SELECT_ADDON")).map(m.SET_ADDON_LENS.bind(m)).map(E).map(A).map($).fold(o.debug,h.bind(c))},v=function(e){t.Either.of(e).chain(n.isSameOrigin(m.ORIGIN)).map(function(n){return n.data}).chain(n.isType("UPDATE_PARAMS")).map(function(n){return m.UPDATE_PARAMS_LENS(n,"drawer")}).fold(o.debug,function(n){return m.saveUpdatedParams(n),n})},S=[I,v],T=function(e){return function(t){b.push(c.resize=l.onResize(n.dispatchResize(t,e)))}};this.$postLink=function(){i(function(){t.fromNullable(e.find("iframe")[0]).map(function(n){return Object.assign(n,{onload:c.onLoad})}).map(function(n){return n.contentWindow}).map(function(n){return m.setDrawerIframe(n),n}).map(n.addWindowListeners(S)).fold(o.debug,T(m.URLS.Drawer).bind(c))},300,!1)},this.closeDialog=function(){r.close(c.popupName||c.iframeId)},this.confirm=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!1;t.fromNullable(c.$state.state.addon).chain(m.isAllowedToPerformAction.bind(m)).map(function(e){return m.saveToBasket(e,n),m.SET_SELECTED_ADDON_LENS(e,n)}).chain(m.dispatchSetSelectedAddon.bind(m)).fold(o.debug,o.debug)},this.$onDestroy=function(){b.forEach(function(n){return n()}),n.removeWindowListeners(S)}}]});


"use strict";angular.module("app.booking").component("refundPaxAvatar",{templateUrl:"/partials/booking/refund/refund-select-pax/pax-avatar/pax-avatar.html",bindings:{label:"<",isChild:"<",isChecked:"<"},controller:function(){function a(){babelHelpers.classCallCheck(this,a)}return a.prototype.$onInit=function(){this.nameInitials=R.pipe(R.propOr("","label"),R.match(/\b(\w)/g),R.take(2))(this)},a}()});


"use strict";angular.module("app.booking").component("refundSelectPaxItem",{templateUrl:"/partials/booking/refund/refund-select-pax/select-pax-item/select-pax-item.html",bindings:{pax:"<",paxIndex:"<",readonly:"<?",isLocked:"<",isSelected:"<",onUpdateSelection:"&"},controller:function(){function e(){babelHelpers.classCallCheck(this,e)}return e.prototype.$onInit=function(){this.avatarLabel=this.pax.name.first+" "+this.pax.name.last,this.childAvatarLabel=this.pax.inf?this.pax.inf.first+" "+this.pax.inf.last:""},e}()});


"use strict";angular.module("app.booking").component("crossSellingInsurancePassenger",{templateUrl:"/partials/booking/components/cross-selling-card/insurance/passenger/cross-selling-insurance-passenger.html",bindings:{passenger:"<",offers:"<",totalPerPassenger:"<",insuranceType:"<",onAddInsuranceFor:"&"},controller:function(){function e(){babelHelpers.classCallCheck(this,e)}return e.prototype.addInsuranceFor=function(e){var n=R.pipe(R.assoc("paxNum",this.passenger.num),R.assoc("start",null))(e);this.onAddInsuranceFor({$event:{passengerNum:this.passenger.num,insurance:n}})},e.prototype.setPrice=function(e){var n=e.offers,r=R.contains(R.prop("type",this.passenger),["TEEN","CHD"]),s=R.find(R.whereEq({code:this.insuranceType}),n),t=R.prop("price",s),o=r?t/50*100:void 0;this.price={currentPrice:t,wasPrice:o},this.addInsuranceFor(s)},e.prototype.$onChanges=function(e){var n=e.offers,r=function(e,n){return R.not(R.equals(R.path(["currentValue",n],e),R.path(["previousValue",n],e)))};R.not(R.isEmpty(R.prop("currentValue",n)))&&r(n,"length")&&this.setPrice({offers:R.prop("currentValue",n)})},e}()});


//# sourceMappingURL=booking-46a9407c81.bundle.js.map
